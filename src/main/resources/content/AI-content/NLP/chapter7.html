<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬7ç« ï¼šæ–‡æœ¬ç”ŸæˆæŠ€æœ¯ - è®©æœºå™¨å­¦ä¼šåˆ›ä½œ</title>
    <meta name="description" content="ä»é‡å¤åˆ°åˆ›æ„ï¼Œæ¢ç´¢æ–‡æœ¬ç”Ÿæˆçš„æŠ€æœ¯æ¼”è¿›">

    <!-- æ•°å­¦å…¬å¼æ”¯æŒ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
            onload="renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ]
            });"></script>

    <style>
        /* ===== CSSå˜é‡å®šä¹‰ ===== */
        :root {
            /* æ¸å˜è‰² */
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --hero-gradient: linear-gradient(135deg, #ee9ca7 0%, #ffdde1 100%);
            --card-gradient: linear-gradient(135deg, rgba(238, 156, 167, 0.1), rgba(255, 221, 225, 0.05));
            --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --warning-gradient: linear-gradient(135deg, #f2994a 0%, #f2c94c 100%);

            /* ä¸»é¢˜è‰² */
            --primary: #667eea;
            --primary-light: #9f7aea;
            --primary-dark: #5a67d8;
            --secondary: #ee9ca7;
            --accent: #38ef7d;

            /* åŠŸèƒ½è‰² */
            --success: #11998e;
            --warning: #f2994a;
            --danger: #eb5757;
            --info: #2d9cdb;

            /* èƒŒæ™¯è‰² */
            --bg-dark: #0f0f1e;
            --bg-section: #1a1a2e;
            --bg-card: #252542;
            --bg-code: #1e1e2e;

            /* æ–‡å­—è‰² */
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --text-muted: #666680;

            /* å…¶ä»– */
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.7);
            --radius: 1rem;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ===== å…¨å±€æ ·å¼ ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 16px;
            overflow-x: hidden;
        }

        /* ===== èƒŒæ™¯æ•ˆæœ ===== */
        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.03;
            background-image:
                    radial-gradient(circle at 20% 80%, var(--primary) 0%, transparent 50%),
                    radial-gradient(circle at 80% 20%, var(--secondary) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .floating-shapes {
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }

        .shape {
            position: absolute;
            border-radius: 50%;
            background: var(--primary-gradient);
            opacity: 0.1;
            animation: float 20s infinite ease-in-out;
        }

        .shape:nth-child(1) {
            width: 80px;
            height: 80px;
            left: 10%;
            top: 20%;
            animation-delay: 0s;
        }

        .shape:nth-child(2) {
            width: 120px;
            height: 120px;
            left: 70%;
            top: 60%;
            background: var(--hero-gradient);
            animation-delay: 5s;
        }

        .shape:nth-child(3) {
            width: 60px;
            height: 60px;
            left: 40%;
            top: 80%;
            background: var(--success-gradient);
            animation-delay: 10s;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            33% {
                transform: translateY(-30px) rotate(120deg);
            }
            66% {
                transform: translateY(30px) rotate(240deg);
            }
        }

        /* ===== å¸ƒå±€ ===== */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            position: relative;
            z-index: 1;
        }

        /* ===== å¯¼èˆªæ  ===== */
        .nav-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(26, 26, 46, 0.9);
            backdrop-filter: blur(20px);
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .nav-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
        }

        .nav-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-title h1 {
            font-size: 1.25rem;
            font-weight: 600;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* è¿›åº¦æ¡ */
        .progress-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            height: 100%;
            background: var(--primary-gradient);
            width: 0;
            transition: width 0.3s ease;
        }

        /* ===== ä¾§è¾¹æ  ===== */
        .sidebar {
            position: fixed;
            left: -300px;
            top: 60px;
            bottom: 0;
            width: 300px;
            background: var(--bg-section);
            border-right: 1px solid var(--border-color);
            padding: 2rem;
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 999;
            box-shadow: 5px 0 25px rgba(0, 0, 0, 0.5);
        }

        .sidebar.open {
            transform: translateX(300px);
        }

        .toc-title {
            color: var(--primary-light);
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toc-section {
            margin-bottom: 1.5rem;
        }

        .toc-section-title {
            color: var(--text-muted);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
            padding-left: 0.5rem;
        }

        .toc-item {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            margin-bottom: 0.25rem;
            font-size: 0.95rem;
            position: relative;
            overflow: hidden;
        }

        .toc-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .toc-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            padding-left: 1.5rem;
        }

        .toc-item.active {
            background: var(--card-gradient);
            color: var(--primary-light);
        }

        .toc-item.active::before {
            transform: translateX(0);
        }

        /* ===== æŒ‰é’®æ ·å¼ ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-size: 0.95rem;
            font-weight: 500;
            text-decoration: none;
            transition: var(--transition);
            cursor: pointer;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-icon {
            background: transparent;
            padding: 0.5rem;
            color: var(--text-secondary);
        }

        /* ===== ä¸»å†…å®¹ ===== */
        main {
            margin-top: 80px;
            padding-bottom: 4rem;
            position: relative;
            z-index: 1;
        }

        /* ===== ç« èŠ‚å¤´éƒ¨ ===== */
        .chapter-hero {
            background: var(--hero-gradient);
            padding: 6rem 0;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .chapter-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                    radial-gradient(circle at 30% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                    radial-gradient(circle at 70% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 0.8; }
        }

        .chapter-hero-content {
            text-align: center;
            color: white;
            position: relative;
            z-index: 1;
        }

        .chapter-hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            animation: fadeInUp 0.8s ease;
        }

        .chapter-hero p {
            font-size: 1.5rem;
            opacity: 0.95;
            animation: fadeInUp 0.8s ease 0.2s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== å†…å®¹å¡ç‰‡ ===== */
        .section-card {
            background: var(--bg-section);
            border-radius: var(--radius);
            padding: 3rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .section-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-gradient);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.5s ease;
        }

        .section-card:hover::before {
            transform: scaleX(1);
        }

        .section-card h2 {
            color: var(--primary-light);
            margin-bottom: 2rem;
            font-size: 2.25rem;
            font-weight: 700;
        }

        .section-card h3 {
            color: var(--text-primary);
            margin: 2rem 0 1rem;
            font-size: 1.5rem;
            font-weight: 600;
        }

        /* ===== æ•…äº‹å¡ç‰‡ ===== */
        .story-card {
            background: linear-gradient(135deg, rgba(238, 156, 167, 0.1), rgba(255, 221, 225, 0.1));
            border: 2px solid rgba(238, 156, 167, 0.3);
            border-radius: var(--radius);
            padding: 2.5rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .story-card::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: var(--hero-gradient);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
            border-radius: var(--radius);
        }

        .story-card:hover::after {
            opacity: 0.3;
        }

        .story-icon {
            font-size: 3rem;
            display: block;
            margin-bottom: 1rem;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* ===== ä»£ç å— ===== */
        .code-block {
            background: var(--bg-code);
            border: 1px solid #30363d;
            border-radius: 0.75rem;
            margin: 1.5rem 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .code-header {
            background: #161b22;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #30363d;
        }

        .code-lang {
            color: var(--primary-light);
            font-size: 0.875rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .code-lang::before {
            content: '';
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            display: inline-block;
        }

        .code-actions {
            display: flex;
            gap: 0.5rem;
        }

        .code-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-secondary);
            padding: 0.375rem 0.875rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }

        .code-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: translateY(-1px);
        }

        .code-content {
            padding: 1.5rem;
            overflow-x: auto;
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
            font-size: 0.875rem;
            line-height: 1.7;
        }

        .code-content pre {
            margin: 0;
            color: #e6edf3;
        }

        .code-content.collapsed {
            max-height: 300px;
            overflow: hidden;
            position: relative;
        }

        .code-content.collapsed::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: linear-gradient(transparent, var(--bg-code));
        }

        /* ä»£ç é«˜äº® */
        .keyword { color: #ff79c6; }
        .string { color: #f1fa8c; }
        .comment { color: #6272a4; }
        .function { color: #50fa7b; }
        .number { color: #bd93f9; }

        /* ===== å¡ç‰‡ç½‘æ ¼ ===== */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .info-card {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 2rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .info-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .info-card:hover::before {
            opacity: 0.05;
        }

        .card-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }

        .card-title {
            color: var(--primary-light);
            margin-bottom: 1rem;
            font-size: 1.25rem;
            font-weight: 600;
        }

        /* ===== é—®é¢˜å±•ç¤º ===== */
        .problem-showcase {
            background: linear-gradient(135deg, rgba(235, 87, 87, 0.1), rgba(242, 153, 74, 0.1));
            border: 2px solid rgba(235, 87, 87, 0.3);
            border-radius: var(--radius);
            padding: 2rem;
            margin: 2rem 0;
        }

        .problem-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .problem-icon {
            font-size: 1.5rem;
            color: var(--danger);
        }

        .problem-content h4 {
            color: var(--danger);
            margin-bottom: 0.5rem;
        }

        /* ===== ç”Ÿæˆç¤ºä¾‹ ===== */
        .generation-example {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .example-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .example-content {
            font-family: Georgia, serif;
            line-height: 1.8;
            color: var(--text-primary);
        }

        .prompt-tag {
            display: inline-block;
            background: var(--primary-gradient);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.875rem;
            font-weight: 500;
        }

        /* ===== å¯¹æ¯”å±•ç¤º ===== */
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .comparison-item {
            background: var(--bg-card);
            padding: 2rem;
            border-radius: var(--radius);
            position: relative;
            transition: all 0.3s ease;
        }

        .comparison-item.bad {
            border: 2px solid var(--danger);
        }

        .comparison-item.good {
            border: 2px solid var(--success);
        }

        .comparison-label {
            position: absolute;
            top: -12px;
            left: 20px;
            background: var(--bg-section);
            padding: 0 1rem;
            font-weight: 600;
        }

        .comparison-item.bad .comparison-label {
            color: var(--danger);
        }

        .comparison-item.good .comparison-label {
            color: var(--success);
        }

        /* ===== äº¤äº’å¼æ¼”ç¤º ===== */
        .interactive-demo {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 2rem;
            margin: 2rem 0;
        }

        .demo-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .demo-output {
            background: var(--bg-code);
            padding: 1.5rem;
            border-radius: 0.5rem;
            min-height: 150px;
            font-family: Georgia, serif;
            line-height: 1.8;
        }

        .slider-container {
            margin: 1rem 0;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            background: var(--primary-light);
        }

        /* ===== æ·±åº¦æ€è€ƒæ¡† ===== */
        .deep-think-box {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: var(--radius);
            padding: 2.5rem;
            margin: 3rem 0;
            position: relative;
        }

        .deep-think-box::before {
            content: 'ğŸ§ ';
            position: absolute;
            top: -18px;
            left: 30px;
            font-size: 2.5rem;
            background: var(--bg-section);
            padding: 0 0.75rem;
        }

        .deep-think-box h4 {
            color: var(--primary-light);
            margin-bottom: 1.25rem;
            font-size: 1.25rem;
        }

        .think-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.25rem;
            border-radius: 0.75rem;
            margin-bottom: 1rem;
            border-left: 3px solid var(--primary);
        }

        .think-item h5 {
            color: var(--primary-light);
            margin-bottom: 0.5rem;
        }

        /* ===== æç¤ºæ¡† ===== */
        .tip {
            padding: 1.5rem 2rem;
            border-radius: var(--radius);
            margin: 2rem 0;
            border-left: 4px solid;
            position: relative;
            overflow: hidden;
        }

        .tip::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.05;
            background: currentColor;
        }

        .tip-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
            vertical-align: middle;
        }

        .tip.info {
            background: rgba(45, 156, 219, 0.1);
            border-color: var(--info);
            color: var(--text-primary);
        }

        .tip.warning {
            background: rgba(242, 153, 74, 0.1);
            border-color: var(--warning);
            color: var(--text-primary);
        }

        .tip.success {
            background: rgba(17, 153, 142, 0.1);
            border-color: var(--success);
            color: var(--text-primary);
        }

        .tip.danger {
            background: rgba(235, 87, 87, 0.1);
            border-color: var(--danger);
            color: var(--text-primary);
        }

        /* ===== æ—¶é—´çº¿ ===== */
        .timeline {
            position: relative;
            padding: 2rem 0;
            margin: 2rem 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--primary-gradient);
            transform: translateX(-50%);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 3rem;
            display: flex;
            align-items: center;
        }

        .timeline-item:nth-child(odd) {
            flex-direction: row-reverse;
        }

        .timeline-content {
            width: 45%;
            background: var(--bg-card);
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .timeline-content:hover {
            transform: scale(1.05);
        }

        .timeline-date {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-weight: 600;
            z-index: 1;
        }

        /* ===== å¿«é€Ÿå¯¼èˆª ===== */
        .quick-nav {
            position: fixed;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .quick-nav-item {
            width: 12px;
            height: 12px;
            background: var(--text-muted);
            border-radius: 50%;
            transition: all 0.3s;
            position: relative;
            cursor: pointer;
        }

        .quick-nav-item:hover,
        .quick-nav-item.active {
            background: var(--primary);
            transform: scale(1.5);
        }

        .quick-nav-tooltip {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--bg-dark);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            border: 1px solid var(--border-color);
            font-size: 0.875rem;
        }

        .quick-nav-item:hover .quick-nav-tooltip {
            opacity: 1;
        }

        /* ===== å“åº”å¼è®¾è®¡ ===== */
        @media (max-width: 768px) {
            .chapter-hero h1 {
                font-size: 2.5rem;
            }

            .section-card {
                padding: 2rem;
            }

            .quick-nav {
                display: none;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .timeline-item {
                flex-direction: column !important;
            }

            .timeline-content {
                width: 100%;
            }

            .timeline::before {
                left: 20px;
            }

            .timeline-date {
                left: 20px;
                transform: none;
            }
        }

        /* ===== å·¥å…·ç±» ===== */
        .text-center { text-align: center; }
        .text-muted { color: var(--text-muted); }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }

        /* ===== è¡¨æ ¼æ ·å¼ ===== */
        .comparison-table {
            background: var(--bg-card);
            border-radius: var(--radius);
            overflow: hidden;
            margin: 2rem 0;
            box-shadow: var(--shadow);
        }

        .comparison-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th {
            background: var(--primary-gradient);
            color: white;
            padding: 1.25rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .comparison-table td {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .comparison-table tr:hover td {
            background: rgba(102, 126, 234, 0.05);
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        /* ===== å‚æ•°æ˜¾ç¤º ===== */
        .param-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .param-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .param-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .param-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-light);
            display: block;
            margin-bottom: 0.5rem;
        }

        .param-label {
            font-size: 0.875rem;
            color: var(--text-muted);
        }
    </style>
</head>
<body>

<!-- èƒŒæ™¯æ•ˆæœ -->
<div class="bg-pattern"></div>
<div class="floating-shapes">
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
</div>

<!-- å¯¼èˆªæ  -->
<nav class="nav-header">
    <div class="container">
        <div class="nav-content">
            <div class="nav-title">
                <button id="toggle-sidebar" class="btn btn-icon">
                    <svg width="20" height="20" fill="currentColor">
                        <path d="M3 5h14M3 10h14M3 15h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
                <h1>ç¬¬7ç« ï¼šæ–‡æœ¬ç”ŸæˆæŠ€æœ¯</h1>
            </div>
            <div class="nav-menu">
                <button class="btn btn-icon" id="theme-toggle">ğŸŒ™</button>
                <a href="#summary" class="btn btn-secondary">ç« èŠ‚æ€»ç»“</a>
            </div>
        </div>
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
    </div>
</nav>

<!-- ä¾§è¾¹æ  -->
<aside class="sidebar" id="sidebar">
    <h3 class="toc-title">
        <span>ğŸ“š</span>
        <span>æœ¬ç« å¯¼èˆª</span>
    </h3>

    <div class="toc-section">
        <div class="toc-section-title">å¼•è¨€</div>
        <a href="#intro" class="toc-item active">è®©æœºå™¨å†™ä½œçš„æŒ‘æˆ˜</a>
        <a href="#evolution" class="toc-item">æŠ€æœ¯æ¼”è¿›å†ç¨‹</a>
    </div>

    <div class="toc-section">
        <div class="toc-section-title">åŸºç¡€æŠ€æœ¯</div>
        <a href="#generation-basics" class="toc-item">æ–‡æœ¬ç”ŸæˆåŸºç¡€</a>
        <a href="#decoding-strategies" class="toc-item">è§£ç ç­–ç•¥è¯¦è§£</a>
    </div>

    <div class="toc-section">
        <div class="toc-section-title">è´¨é‡æå‡</div>
        <a href="#quality-problems" class="toc-item">å¸¸è§è´¨é‡é—®é¢˜</a>
        <a href="#improvement-techniques" class="toc-item">æ”¹è¿›æŠ€æœ¯</a>
    </div>

    <div class="toc-section">
        <div class="toc-section-title">é«˜çº§æŠ€æœ¯</div>
        <a href="#controlled-generation" class="toc-item">å¯æ§ç”Ÿæˆ</a>
        <a href="#diversity" class="toc-item">å¤šæ ·æ€§å¢å¼º</a>
        <a href="#evaluation" class="toc-item">è¯„ä¼°æ–¹æ³•</a>
    </div>

    <div class="toc-section">
        <div class="toc-section-title">åº”ç”¨å®è·µ</div>
        <a href="#applications" class="toc-item">å®é™…åº”ç”¨</a>
        <a href="#best-practices" class="toc-item">æœ€ä½³å®è·µ</a>
    </div>

    <div class="toc-section">
        <div class="toc-section-title">æ€»ç»“</div>
        <a href="#summary" class="toc-item">æœ¬ç« æ€»ç»“</a>
        <a href="#future" class="toc-item">æœªæ¥å±•æœ›</a>
    </div>
</aside>

<!-- å¿«é€Ÿå¯¼èˆª -->
<div class="quick-nav" id="quick-nav">
    <div class="quick-nav-item active" data-section="intro">
        <span class="quick-nav-tooltip">å¼•è¨€</span>
    </div>
    <div class="quick-nav-item" data-section="generation-basics">
        <span class="quick-nav-tooltip">åŸºç¡€æŠ€æœ¯</span>
    </div>
    <div class="quick-nav-item" data-section="quality-problems">
        <span class="quick-nav-tooltip">è´¨é‡æå‡</span>
    </div>
    <div class="quick-nav-item" data-section="controlled-generation">
        <span class="quick-nav-tooltip">é«˜çº§æŠ€æœ¯</span>
    </div>
    <div class="quick-nav-item" data-section="applications">
        <span class="quick-nav-tooltip">åº”ç”¨å®è·µ</span>
    </div>
    <div class="quick-nav-item" data-section="summary">
        <span class="quick-nav-tooltip">æ€»ç»“</span>
    </div>
</div>

<!-- ä¸»å†…å®¹ -->
<main>
    <!-- ç« èŠ‚æ ‡é¢˜ -->
    <section class="chapter-hero">
        <div class="container">
            <div class="chapter-hero-content">
                <h1>æ–‡æœ¬ç”ŸæˆæŠ€æœ¯</h1>
                <p>ä»é‡å¤åˆ°åˆ›æ„ï¼Œè®©æœºå™¨å­¦ä¼šåˆ›ä½œ</p>
            </div>
        </div>
    </section>

    <div class="container">
        <!-- å¼•è¨€ï¼šè®©æœºå™¨å†™ä½œçš„æŒ‘æˆ˜ -->
        <section id="intro" class="section-card">
            <h2>âœï¸ è®©æœºå™¨å†™ä½œçš„æŒ‘æˆ˜</h2>

            <div class="story-card">
                <span class="story-icon">ğŸ“</span>
                <p><strong>ä¸€ä¸ªçœ‹ä¼¼ç®€å•çš„ä»»åŠ¡</strong></p>
                <p class="mt-2">
                    "è®©æœºå™¨å†™ä¸€æ®µè¯"ï¼Œå¬èµ·æ¥å¾ˆç®€å•å¯¹å—ï¼Ÿç„¶è€Œå½“æˆ‘ä»¬çœŸæ­£å°è¯•æ—¶ï¼Œ
                    å´å‘ç°æœºå™¨ç”Ÿæˆçš„æ–‡æœ¬å……æ»¡äº†å„ç§é—®é¢˜...
                </p>
            </div>

            <div class="problem-showcase">
                <h3 class="mb-3">ğŸš¨ æˆ‘ä»¬é‡åˆ°çš„é—®é¢˜</h3>

                <div class="problem-item">
                    <span class="problem-icon">ğŸ”</span>
                    <div class="problem-content">
                        <h4>é‡å¤é—®é¢˜</h4>
                        <p>æœºå™¨æ€»æ˜¯é‡å¤åŒæ ·çš„è¯å¥ï¼Œåƒåæ‰çš„å”±ç‰‡æœºï¼š</p>
                        <div class="generation-example mt-2">
                            <div class="example-content">
                                "æˆ‘å–œæ¬¢åƒè‹¹æœã€‚è‹¹æœå¾ˆå¥½åƒã€‚è‹¹æœçœŸçš„å¾ˆå¥½åƒã€‚æˆ‘çœŸçš„å–œæ¬¢åƒè‹¹æœ..."
                            </div>
                        </div>
                    </div>
                </div>

                <div class="problem-item">
                    <span class="problem-icon">ğŸ²</span>
                    <div class="problem-content">
                        <h4>ä¸è¿è´¯é—®é¢˜</h4>
                        <p>å‰åæ–‡é€»è¾‘æ··ä¹±ï¼Œåƒå–é†‰äº†çš„äººåœ¨è¯´è¯ï¼š</p>
                        <div class="generation-example mt-2">
                            <div class="example-content">
                                "ä»Šå¤©å¤©æ°”å¾ˆå¥½ã€‚æˆ‘çš„çŒ«å«å°èŠ±ã€‚æ•°å­¦å¾ˆéš¾ã€‚ä½ åƒé¥­äº†å—ï¼Ÿ"
                            </div>
                        </div>
                    </div>
                </div>

                <div class="problem-item">
                    <span class="problem-icon">ğŸ˜´</span>
                    <div class="problem-content">
                        <h4>ç¼ºä¹åˆ›æ„</h4>
                        <p>ç”Ÿæˆçš„å†…å®¹å¹³æ·¡æ— å¥‡ï¼Œæ¯«æ— æ–°æ„ï¼š</p>
                        <div class="generation-example mt-2">
                            <div class="example-content">
                                "è¿™æ˜¯ä¸€ä¸ªæ•…äº‹ã€‚ä¸»äººå…¬å¾ˆå‹‡æ•¢ã€‚ä»–æˆ˜èƒœäº†å›°éš¾ã€‚æ•…äº‹ç»“æŸäº†ã€‚"
                            </div>
                        </div>
                    </div>
                </div>

                <div class="problem-item">
                    <span class="problem-icon">ğŸ¯</span>
                    <div class="problem-content">
                        <h4>å¤±æ§é—®é¢˜</h4>
                        <p>æ— æ³•æ§åˆ¶ç”Ÿæˆçš„å†…å®¹é£æ ¼å’Œä¸»é¢˜ï¼š</p>
                        <div class="generation-example mt-2">
                            <div class="example-content">
                                æç¤ºï¼š"å†™ä¸€ä¸ªæ¸©é¦¨çš„æ•…äº‹"<br>
                                è¾“å‡ºï¼š"åœ¨ä¸€ä¸ªé»‘æš—çš„å¤œæ™šï¼Œææ€–çš„äº‹æƒ…å‘ç”Ÿäº†..."
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="deep-think-box">
                <h4>ä¸ºä»€ä¹ˆè¿™ä¹ˆéš¾ï¼Ÿ</h4>
                <div class="think-item">
                    <h5>ğŸ§  è¯­è¨€çš„å¤æ‚æ€§</h5>
                    <ul>
                        <li>è¯æ±‡çš„å¤šä¹‰æ€§å’Œæ­§ä¹‰æ€§</li>
                        <li>è¯­æ³•è§„åˆ™çš„çµæ´»æ€§</li>
                        <li>ä¸Šä¸‹æ–‡ä¾èµ–çš„è¯­ä¹‰ç†è§£</li>
                        <li>æ–‡åŒ–èƒŒæ™¯å’Œå¸¸è¯†æ¨ç†</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>ğŸ¨ åˆ›ä½œçš„è‰ºæœ¯æ€§</h5>
                    <ul>
                        <li>åˆ›æ„å’Œæƒ³è±¡åŠ›éš¾ä»¥é‡åŒ–</li>
                        <li>é£æ ¼å’Œä¸ªæ€§çš„è¡¨è¾¾</li>
                        <li>æƒ…æ„Ÿå’Œæ°›å›´çš„è¥é€ </li>
                        <li>è¯»è€…ä½“éªŒçš„è€ƒè™‘</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>âš–ï¸ å¹³è¡¡çš„å›°éš¾</h5>
                    <ul>
                        <li>æµç•…æ€§ vs å¤šæ ·æ€§</li>
                        <li>å‡†ç¡®æ€§ vs åˆ›é€ æ€§</li>
                        <li>å¯æ§æ€§ vs è‡ªç”±åº¦</li>
                        <li>å±€éƒ¨è¿è´¯ vs å…¨å±€ä¸€è‡´</li>
                    </ul>
                </div>
            </div>

            <div class="tip info mt-4">
                <span class="tip-icon">ğŸ’¡</span>
                <strong>æ ¸å¿ƒæŒ‘æˆ˜</strong>
                <p class="mt-2">
                    æ–‡æœ¬ç”Ÿæˆä¸ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯é—®é¢˜ï¼Œæ›´æ˜¯ä¸€ä¸ªè‰ºæœ¯é—®é¢˜ã€‚
                    æˆ‘ä»¬éœ€è¦è®©æœºå™¨æ—¢æ‡‚è¯­è¨€è§„åˆ™ï¼Œåˆæœ‰åˆ›é€ åŠ›ï¼Œ
                    è¿˜è¦èƒ½å¤Ÿç†è§£å’Œæ»¡è¶³äººç±»çš„éœ€æ±‚ã€‚è¿™æ­£æ˜¯æœ¬ç« è¦è§£å†³çš„æŒ‘æˆ˜ï¼
                </p>
            </div>
        </section>

        <!-- æŠ€æœ¯æ¼”è¿›å†ç¨‹ -->
        <section id="evolution" class="section-card">
            <h2>ğŸ“ˆ æŠ€æœ¯æ¼”è¿›å†ç¨‹</h2>

            <div class="story-card">
                <span class="story-icon">ğŸš€</span>
                <p><strong>ä»è§„åˆ™åˆ°ç¥ç»ç½‘ç»œçš„é£è·ƒ</strong></p>
                <p class="mt-2">
                    æ–‡æœ¬ç”ŸæˆæŠ€æœ¯çš„å‘å±•ï¼Œæ˜¯ä¸€éƒ¨ä»"æ­»æ¿"åˆ°"çµæ´»"ï¼Œ
                    ä»"æœºæ¢°"åˆ°"æ™ºèƒ½"çš„è¿›åŒ–å²ã€‚è®©æˆ‘ä»¬å›é¡¾è¿™æ®µç²¾å½©çš„å†ç¨‹ã€‚
                </p>
            </div>

            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-date">1950s-1980s</div>
                    <div class="timeline-content">
                        <h4>ğŸ“ åŸºäºè§„åˆ™çš„æ—¶ä»£</h4>
                        <ul>
                            <li>æ¨¡æ¿å¡«å……ï¼šMad Libså¼ç”Ÿæˆ</li>
                            <li>è¯­æ³•è§„åˆ™ï¼šä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•</li>
                            <li>ä¸“å®¶ç³»ç»Ÿï¼šé¢†åŸŸçŸ¥è¯†ç¼–ç </li>
                        </ul>
                        <p class="mt-2 text-muted">ä¼˜ç‚¹ï¼šå¯æ§ï¼›ç¼ºç‚¹ï¼šæ­»æ¿</p>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">1990s-2000s</div>
                    <div class="timeline-content">
                        <h4>ğŸ“Š ç»Ÿè®¡æ–¹æ³•å…´èµ·</h4>
                        <ul>
                            <li>N-gramæ¨¡å‹ï¼šåŸºäºæ¦‚ç‡çš„é¢„æµ‹</li>
                            <li>éšé©¬å°”å¯å¤«æ¨¡å‹ï¼šåºåˆ—å»ºæ¨¡</li>
                            <li>æœ€å¤§ç†µæ¨¡å‹ï¼šç‰¹å¾ç»„åˆ</li>
                        </ul>
                        <p class="mt-2 text-muted">å¼€å§‹ä»æ•°æ®ä¸­å­¦ä¹ æ¨¡å¼</p>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">2010såˆæœŸ</div>
                    <div class="timeline-content">
                        <h4>ğŸ§  ç¥ç»ç½‘ç»œé©å‘½</h4>
                        <ul>
                            <li>RNNï¼šå¤„ç†åºåˆ—æ•°æ®</li>
                            <li>LSTM/GRUï¼šé•¿æœŸä¾èµ–</li>
                            <li>Seq2Seqï¼šç¼–ç -è§£ç èŒƒå¼</li>
                        </ul>
                        <p class="mt-2 text-muted">è´¨çš„é£è·ƒå¼€å§‹</p>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">2017-2020</div>
                    <div class="timeline-content">
                        <h4>âš¡ Transformeræ—¶ä»£</h4>
                        <ul>
                            <li>æ³¨æ„åŠ›æœºåˆ¶ï¼šå¹¶è¡Œå¤„ç†</li>
                            <li>GPTç³»åˆ—ï¼šè‡ªå›å½’ç”Ÿæˆ</li>
                            <li>å¤§è§„æ¨¡é¢„è®­ç»ƒï¼šé€šç”¨èƒ½åŠ›</li>
                        </ul>
                        <p class="mt-2 text-muted">ç”Ÿæˆè´¨é‡æ¥è¿‘äººç±»</p>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">2020è‡³ä»Š</div>
                    <div class="timeline-content">
                        <h4>ğŸŒŸ æ™ºèƒ½åˆ›ä½œæ—¶ä»£</h4>
                        <ul>
                            <li>ChatGPTï¼šå¯¹è¯ç”Ÿæˆ</li>
                            <li>å¤šæ¨¡æ€ç”Ÿæˆï¼šæ–‡å›¾ç»“åˆ</li>
                            <li>å¯æ§ç”Ÿæˆï¼šç²¾ç¡®æ§åˆ¶</li>
                        </ul>
                        <p class="mt-2 text-muted">AIæˆä¸ºåˆ›ä½œä¼™ä¼´</p>
                    </div>
                </div>
            </div>

            <div class="comparison-grid mt-4">
                <div class="comparison-item bad">
                    <span class="comparison-label">ä¼ ç»Ÿæ–¹æ³•</span>
                    <h4>åŸºäºè§„åˆ™çš„ç”Ÿæˆ</h4>
                    <div class="generation-example mt-3">
                        <p><strong>æ¨¡æ¿ï¼š</strong>[ä¸»è¯­] [åŠ¨è¯] [å®¾è¯­]ã€‚</p>
                        <p><strong>è¾“å‡ºï¼š</strong>å°æ˜ åƒ è‹¹æœã€‚</p>
                    </div>
                    <ul class="mt-3">
                        <li>âœ“ è¯­æ³•æ­£ç¡®</li>
                        <li>âœ“ å®Œå…¨å¯æ§</li>
                        <li>âœ— ç¼ºä¹çµæ´»æ€§</li>
                        <li>âœ— æ— æ³•æ‰©å±•</li>
                    </ul>
                </div>

                <div class="comparison-item good">
                    <span class="comparison-label">ç°ä»£æ–¹æ³•</span>
                    <h4>ç¥ç»ç½‘ç»œç”Ÿæˆ</h4>
                    <div class="generation-example mt-3">
                        <p><strong>æç¤ºï¼š</strong>æè¿°åƒè‹¹æœçš„æ„Ÿå—</p>
                        <p><strong>è¾“å‡ºï¼š</strong>å’¬ä¸‹ç¬¬ä¸€å£ï¼Œæ¸…è„†çš„å£°éŸ³ä¼´éšç€ç”œç¾çš„æ±æ°´åœ¨å£ä¸­ç»½æ”¾ï¼Œä»¿ä½›æ•´ä¸ªç§‹å¤©éƒ½æµ“ç¼©åœ¨è¿™ä¸€åˆ»...</p>
                    </div>
                    <ul class="mt-3">
                        <li>âœ“ è‡ªç„¶æµç•…</li>
                        <li>âœ“ å¯Œæœ‰åˆ›æ„</li>
                        <li>âœ“ ä¸Šä¸‹æ–‡ç†è§£</li>
                        <li>âœ— å¶å°”å¤±æ§</li>
                    </ul>
                </div>
            </div>

            <div class="tip success mt-4">
                <span class="tip-icon">ğŸ¯</span>
                <strong>å…³é”®è½¬æŠ˜ç‚¹</strong>
                <p class="mt-2">
                    Transformerçš„å‡ºç°æ˜¯æ–‡æœ¬ç”ŸæˆæŠ€æœ¯çš„åˆ†æ°´å²­ã€‚
                    å®ƒè®©æœºå™¨ç¬¬ä¸€æ¬¡çœŸæ­£"ç†è§£"äº†è¯­è¨€çš„æ·±å±‚ç»“æ„ï¼Œ
                    è€Œä¸æ˜¯ç®€å•åœ°è®°å¿†å’Œå¤åˆ¶æ¨¡å¼ã€‚
                </p>
            </div>
        </section>

        <!-- æ–‡æœ¬ç”ŸæˆåŸºç¡€ -->
        <section id="generation-basics" class="section-card">
            <h2>ğŸ”¤ æ–‡æœ¬ç”ŸæˆåŸºç¡€</h2>

            <div class="story-card">
                <span class="story-icon">ğŸ²</span>
                <p><strong>æ¦‚ç‡çš„è‰ºæœ¯</strong></p>
                <p class="mt-2">
                    æ–‡æœ¬ç”Ÿæˆçš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯åœ¨æ¯ä¸ªæ—¶åˆ»ï¼Œä»æˆåƒä¸Šä¸‡ä¸ªå¯èƒ½çš„è¯ä¸­ï¼Œ
                    é€‰å‡º"æœ€åˆé€‚"çš„é‚£ä¸€ä¸ªã€‚è¿™ä¸ªé€‰æ‹©è¿‡ç¨‹ï¼Œå°±æ˜¯æ¦‚ç‡çš„è‰ºæœ¯ã€‚
                </p>
            </div>

            <div class="deep-think-box">
                <h4>æ ¸å¿ƒæ¦‚å¿µ</h4>
                <div class="think-item">
                    <h5>ğŸ“Š è¯­è¨€æ¨¡å‹</h5>
                    <p>ç»™å®šå‰æ–‡ï¼Œé¢„æµ‹ä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡åˆ†å¸ƒï¼š</p>
                    <p class="text-center mt-2" style="font-size: 1.2rem;">
                        P(ä¸‹ä¸€ä¸ªè¯ | å‰é¢æ‰€æœ‰è¯)
                    </p>
                </div>
                <div class="think-item">
                    <h5>ğŸ¯ ç”Ÿæˆè¿‡ç¨‹</h5>
                    <ol>
                        <li>è¾“å…¥åˆå§‹æ–‡æœ¬ï¼ˆæç¤ºè¯ï¼‰</li>
                        <li>æ¨¡å‹é¢„æµ‹ä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡åˆ†å¸ƒ</li>
                        <li>æ ¹æ®ç­–ç•¥é€‰æ‹©ä¸€ä¸ªè¯</li>
                        <li>å°†é€‰ä¸­çš„è¯åŠ å…¥åºåˆ—</li>
                        <li>é‡å¤ç›´åˆ°æ»¡è¶³åœæ­¢æ¡ä»¶</li>
                    </ol>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Python - åŸºç¡€æ–‡æœ¬ç”Ÿæˆæµç¨‹</span>
                    <div class="code-actions">
                        <button class="code-btn" onclick="toggleCode(this)">å±•å¼€</button>
                        <button class="code-btn" onclick="copyCode(this)">å¤åˆ¶</button>
                    </div>
                </div>
                <div class="code-content collapsed">
                    <pre><span class="keyword">import</span> torch
<span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F
<span class="keyword">from</span> transformers <span class="keyword">import</span> GPT2LMHeadModel, GPT2Tokenizer

<span class="keyword">class</span> <span class="function">TextGenerator</span>:
    <span class="string">"""
    æ–‡æœ¬ç”Ÿæˆå™¨åŸºç±»
    """</span>
    <span class="keyword">def</span> <span class="function">__init__</span>(self, model_name=<span class="string">'gpt2'</span>):
        self.tokenizer = GPT2Tokenizer.from_pretrained(model_name)
        self.model = GPT2LMHeadModel.from_pretrained(model_name)
        self.model.eval()

    <span class="keyword">def</span> <span class="function">generate_step</span>(self, input_ids, temperature=1.0):
        <span class="string">"""
        å•æ­¥ç”Ÿæˆï¼šé¢„æµ‹ä¸‹ä¸€ä¸ªtoken
        """</span>
        <span class="keyword">with</span> torch.no_grad():
            <span class="comment"># 1. å‰å‘ä¼ æ’­è·å–logits</span>
            outputs = self.model(input_ids)
            logits = outputs.logits[:, -1, :]  <span class="comment"># åªçœ‹æœ€åä¸€ä¸ªä½ç½®</span>

            <span class="comment"># 2. æ¸©åº¦è°ƒèŠ‚</span>
            logits = logits / temperature

            <span class="comment"># 3. è½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒ</span>
            probs = F.softmax(logits, dim=-1)

        <span class="keyword">return</span> probs

    <span class="keyword">def</span> <span class="function">generate</span>(self,
                  prompt,
                  max_length=100,
                  temperature=1.0,
                  strategy=<span class="string">'greedy'</span>):
        <span class="string">"""
        å®Œæ•´çš„ç”Ÿæˆæµç¨‹

        Args:
            prompt: æç¤ºæ–‡æœ¬
            max_length: æœ€å¤§ç”Ÿæˆé•¿åº¦
            temperature: æ¸©åº¦å‚æ•°ï¼ˆæ§åˆ¶éšæœºæ€§ï¼‰
            strategy: è§£ç ç­–ç•¥
        """</span>
        <span class="comment"># 1. ç¼–ç è¾“å…¥</span>
        input_ids = self.tokenizer.encode(prompt, return_tensors=<span class="string">'pt'</span>)
        generated = input_ids

        <span class="comment"># 2. é€æ­¥ç”Ÿæˆ</span>
        <span class="keyword">for</span> _ <span class="keyword">in</span> range(max_length):
            <span class="comment"># è·å–æ¦‚ç‡åˆ†å¸ƒ</span>
            probs = self.generate_step(generated, temperature)

            <span class="comment"># æ ¹æ®ç­–ç•¥é€‰æ‹©ä¸‹ä¸€ä¸ªtoken</span>
            <span class="keyword">if</span> strategy == <span class="string">'greedy'</span>:
                next_token = torch.argmax(probs, dim=-1)
            <span class="keyword">elif</span> strategy == <span class="string">'sample'</span>:
                next_token = torch.multinomial(probs, 1)

            <span class="comment"># æ·»åŠ åˆ°åºåˆ—</span>
            generated = torch.cat([generated, next_token.unsqueeze(0)], dim=1)

            <span class="comment"># æ£€æŸ¥æ˜¯å¦ç”Ÿæˆäº†ç»“æŸç¬¦</span>
            <span class="keyword">if</span> next_token.item() == self.tokenizer.eos_token_id:
                <span class="keyword">break</span>

        <span class="comment"># 3. è§£ç ä¸ºæ–‡æœ¬</span>
        text = self.tokenizer.decode(generated[0], skip_special_tokens=True)
        <span class="keyword">return</span> text

<span class="comment"># ========== æ¦‚ç‡åˆ†å¸ƒå¯è§†åŒ– ==========</span>
<span class="keyword">def</span> <span class="function">visualize_probability_distribution</span>(generator, prompt):
    <span class="string">"""
    å¯è§†åŒ–ä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡åˆ†å¸ƒ
    """</span>
    input_ids = generator.tokenizer.encode(prompt, return_tensors=<span class="string">'pt'</span>)
    probs = generator.generate_step(input_ids)

    <span class="comment"># è·å–top-kæ¦‚ç‡æœ€é«˜çš„è¯</span>
    top_k = 10
    top_probs, top_indices = torch.topk(probs[0], top_k)

    <span class="comment"># è§£ç ä¸ºè¯æ±‡</span>
    top_words = [generator.tokenizer.decode([idx]) <span class="keyword">for</span> idx <span class="keyword">in</span> top_indices]

    <span class="comment"># æ‰“å°ç»“æœ</span>
    print(<span class="string">f"æç¤º: '{prompt}'"</span>)
    print(<span class="string">"ä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡åˆ†å¸ƒ:"</span>)
    <span class="keyword">for</span> word, prob <span class="keyword">in</span> zip(top_words, top_probs):
        bar = <span class="string">'â–ˆ'</span> * int(prob * 50)
        print(<span class="string">f"{word:15} {prob:.3f} {bar}"</span>)

<span class="comment"># ========== æ¸©åº¦æ•ˆæœæ¼”ç¤º ==========</span>
<span class="keyword">def</span> <span class="function">demonstrate_temperature_effect</span>(generator, prompt):
    <span class="string">"""
    æ¼”ç¤ºä¸åŒæ¸©åº¦å¯¹ç”Ÿæˆçš„å½±å“
    """</span>
    temperatures = [0.5, 1.0, 1.5]

    <span class="keyword">for</span> temp <span class="keyword">in</span> temperatures:
        print(<span class="string">f"\næ¸©åº¦ = {temp}:"</span>)
        text = generator.generate(
            prompt,
            max_length=50,
            temperature=temp,
            strategy=<span class="string">'sample'</span>
        )
        print(text)

<span class="comment"># ä½¿ç”¨ç¤ºä¾‹</span>
<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    generator = TextGenerator()

    <span class="comment"># æ¼”ç¤ºæ¦‚ç‡åˆ†å¸ƒ</span>
    visualize_probability_distribution(generator, <span class="string">"ä»Šå¤©å¤©æ°”"</span>)

    <span class="comment"># æ¼”ç¤ºæ¸©åº¦æ•ˆæœ</span>
    demonstrate_temperature_effect(generator, <span class="string">"ä»å‰æœ‰ä¸€ä¸ª"</span>)</pre>
                </div>
            </div>

            <div class="interactive-demo">
                <h3 class="mb-3">ğŸ® äº¤äº’å¼æ¼”ç¤ºï¼šæ¸©åº¦å‚æ•°çš„å½±å“</h3>

                <div class="slider-container">
                    <div class="slider-label">
                        <span>æ¸©åº¦ (Temperature)</span>
                        <span id="temp-value">1.0</span>
                    </div>
                    <input type="range" class="slider" id="temperature-slider"
                           min="0.1" max="2.0" step="0.1" value="1.0">
                </div>

                <div class="param-display mt-3">
                    <div class="param-item">
                        <span class="param-value" id="randomness">ä¸­ç­‰</span>
                        <span class="param-label">éšæœºæ€§</span>
                    </div>
                    <div class="param-item">
                        <span class="param-value" id="creativity">å¹³è¡¡</span>
                        <span class="param-label">åˆ›é€ æ€§</span>
                    </div>
                    <div class="param-item">
                        <span class="param-value" id="coherence">è‰¯å¥½</span>
                        <span class="param-label">è¿è´¯æ€§</span>
                    </div>
                </div>

                <div class="generation-example mt-3">
                    <div class="example-header">
                        <span class="prompt-tag">æç¤ºï¼šä»å‰æœ‰åº§å±±</span>
                        <button class="btn btn-primary" onclick="regenerate()">é‡æ–°ç”Ÿæˆ</button>
                    </div>
                    <div class="demo-output" id="generation-output">
                        é€‰æ‹©æ¸©åº¦å€¼ï¼Œç‚¹å‡»"é‡æ–°ç”Ÿæˆ"æŸ¥çœ‹æ•ˆæœ...
                    </div>
                </div>
            </div>

            <div class="tip warning mt-4">
                <span class="tip-icon">âš ï¸</span>
                <strong>æ¸©åº¦å‚æ•°çš„æƒè¡¡</strong>
                <ul class="mt-2">
                    <li><strong>ä½æ¸©åº¦ï¼ˆ< 0.7ï¼‰ï¼š</strong>æ›´ä¿å®ˆã€æ›´ç¡®å®šã€å¯èƒ½æ›´æ— èŠ</li>
                    <li><strong>ä¸­æ¸©åº¦ï¼ˆ0.7-1.3ï¼‰ï¼š</strong>å¹³è¡¡çš„é€‰æ‹©ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯</li>
                    <li><strong>é«˜æ¸©åº¦ï¼ˆ> 1.3ï¼‰ï¼š</strong>æ›´éšæœºã€æ›´åˆ›æ„ã€å¯èƒ½ä¸è¿è´¯</li>
                </ul>
            </div>
        </section>

        <!-- è§£ç ç­–ç•¥è¯¦è§£ -->
        <section id="decoding-strategies" class="section-card">
            <h2>ğŸ¯ è§£ç ç­–ç•¥è¯¦è§£</h2>

            <div class="story-card">
                <span class="story-icon">ğŸ°</span>
                <p><strong>é€‰æ‹©çš„è‰ºæœ¯</strong></p>
                <p class="mt-2">
                    æ¨¡å‹ç»™å‡ºäº†æ¦‚ç‡åˆ†å¸ƒï¼Œä½†å¦‚ä½•ä»ä¸­é€‰æ‹©ä¸‹ä¸€ä¸ªè¯ï¼Ÿ
                    è¿™å°±æ˜¯è§£ç ç­–ç•¥çš„ä½œç”¨â€”â€”ä¸åŒçš„ç­–ç•¥ä¼šäº§ç”Ÿæˆªç„¶ä¸åŒçš„æ–‡æœ¬ã€‚
                </p>
            </div>

            <div class="card-grid">
                <div class="info-card">
                    <span class="card-icon">ğŸ†</span>
                    <h4 class="card-title">è´ªå¿ƒè§£ç </h4>
                    <p><strong>ç­–ç•¥ï¼š</strong>æ€»æ˜¯é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„è¯</p>
                    <div class="code-block mt-2">
                        <div class="code-content">
                            <pre>next_token = argmax(P(w|context))</pre>
                        </div>
                    </div>
                    <ul class="mt-2 text-muted">
                        <li>âœ“ ç¡®å®šæ€§è¾“å‡º</li>
                        <li>âœ“ å±€éƒ¨æœ€ä¼˜</li>
                        <li>âœ— å®¹æ˜“é‡å¤</li>
                        <li>âœ— ç¼ºä¹å¤šæ ·æ€§</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ”</span>
                    <h4 class="card-title">æŸæœç´¢</h4>
                    <p><strong>ç­–ç•¥ï¼š</strong>ä¿ç•™kä¸ªæœ€ä½³å€™é€‰åºåˆ—</p>
                    <div class="code-block mt-2">
                        <div class="code-content">
                            <pre>ä¿æŒbeam_sizeä¸ªæ¦‚ç‡æœ€é«˜çš„åºåˆ—</pre>
                        </div>
                    </div>
                    <ul class="mt-2 text-muted">
                        <li>âœ“ å…¨å±€æ›´ä¼˜</li>
                        <li>âœ“ è´¨é‡ç¨³å®š</li>
                        <li>âœ— è®¡ç®—å¼€é”€å¤§</li>
                        <li>âœ— ä»å¯èƒ½é‡å¤</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ²</span>
                    <h4 class="card-title">éšæœºé‡‡æ ·</h4>
                    <p><strong>ç­–ç•¥ï¼š</strong>æŒ‰æ¦‚ç‡åˆ†å¸ƒéšæœºé€‰æ‹©</p>
                    <div class="code-block mt-2">
                        <div class="code-content">
                            <pre>next_token ~ P(w|context)</pre>
                        </div>
                    </div>
                    <ul class="mt-2 text-muted">
                        <li>âœ“ å¤šæ ·æ€§é«˜</li>
                        <li>âœ“ é¿å…é‡å¤</li>
                        <li>âœ— å¯èƒ½ä¸è¿è´¯</li>
                        <li>âœ— è´¨é‡ä¸ç¨³å®š</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ¯</span>
                    <h4 class="card-title">Top-ké‡‡æ ·</h4>
                    <p><strong>ç­–ç•¥ï¼š</strong>åªä»æ¦‚ç‡æœ€é«˜çš„kä¸ªè¯ä¸­é‡‡æ ·</p>
                    <div class="code-block mt-2">
                        <div class="code-content">
                            <pre>å€™é€‰é›† = top_k(P), ç„¶åé‡‡æ ·</pre>
                        </div>
                    </div>
                    <ul class="mt-2 text-muted">
                        <li>âœ“ å¹³è¡¡è´¨é‡å’Œå¤šæ ·æ€§</li>
                        <li>âœ“ é¿å…ä½æ¦‚ç‡è¯</li>
                        <li>âœ— kå€¼å›ºå®š</li>
                        <li>âœ— ä¸åŒä¸Šä¸‹æ–‡éœ€æ±‚ä¸åŒ</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ“Š</span>
                    <h4 class="card-title">Top-p (Nucleus)é‡‡æ ·</h4>
                    <p><strong>ç­–ç•¥ï¼š</strong>é€‰æ‹©ç´¯ç§¯æ¦‚ç‡è¾¾åˆ°pçš„æœ€å°è¯é›†</p>
                    <div class="code-block mt-2">
                        <div class="code-content">
                            <pre>é€‰æ‹©æœ€å°é›†åˆä½¿Î£ P(w) â‰¥ p</pre>
                        </div>
                    </div>
                    <ul class="mt-2 text-muted">
                        <li>âœ“ åŠ¨æ€è°ƒæ•´å€™é€‰é›†</li>
                        <li>âœ“ é€‚åº”ä¸åŒåˆ†å¸ƒ</li>
                        <li>âœ“ æ•ˆæœé€šå¸¸æœ€å¥½</li>
                        <li>âœ— éœ€è¦è°ƒå‚</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ”„</span>
                    <h4 class="card-title">å¯¹æ¯”æœç´¢</h4>
                    <p><strong>ç­–ç•¥ï¼š</strong>å¹³è¡¡ç›¸ä¼¼æ€§å’Œå¤šæ ·æ€§</p>
                    <div class="code-block mt-2">
                        <div class="code-content">
                            <pre>score = Î±Â·ç›¸ä¼¼åº¦ - (1-Î±)Â·é‡å¤åº¦</pre>
                        </div>
                    </div>
                    <ul class="mt-2 text-muted">
                        <li>âœ“ ä¸»åŠ¨é¿å…é‡å¤</li>
                        <li>âœ“ ä¿æŒè¿è´¯æ€§</li>
                        <li>âœ“ æœ€æ–°æŠ€æœ¯</li>
                        <li>âœ— è®¡ç®—å¤æ‚</li>
                    </ul>
                </div>
            </div>

            <div class="code-block mt-4">
                <div class="code-header">
                    <span class="code-lang">Python - è§£ç ç­–ç•¥å®ç°</span>
                    <div class="code-actions">
                        <button class="code-btn" onclick="toggleCode(this)">å±•å¼€</button>
                        <button class="code-btn" onclick="copyCode(this)">å¤åˆ¶</button>
                    </div>
                </div>
                <div class="code-content collapsed">
                    <pre><span class="keyword">import</span> torch
<span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F
<span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="keyword">class</span> <span class="function">DecodingStrategies</span>:
    <span class="string">"""
    å„ç§è§£ç ç­–ç•¥çš„å®ç°
    """</span>

    @staticmethod
    <span class="keyword">def</span> <span class="function">greedy_search</span>(logits):
        <span class="string">"""
        è´ªå¿ƒæœç´¢ï¼šé€‰æ‹©æ¦‚ç‡æœ€é«˜çš„token
        """</span>
        <span class="keyword">return</span> torch.argmax(logits, dim=-1)

    @staticmethod
    <span class="keyword">def</span> <span class="function">random_sampling</span>(logits, temperature=1.0):
        <span class="string">"""
        éšæœºé‡‡æ ·ï¼šæŒ‰æ¦‚ç‡åˆ†å¸ƒé‡‡æ ·
        """</span>
        <span class="comment"># æ¸©åº¦è°ƒèŠ‚</span>
        logits = logits / temperature

        <span class="comment"># è½¬æ¢ä¸ºæ¦‚ç‡</span>
        probs = F.softmax(logits, dim=-1)

        <span class="comment"># é‡‡æ ·</span>
        <span class="keyword">return</span> torch.multinomial(probs, num_samples=1).squeeze()

    @staticmethod
    <span class="keyword">def</span> <span class="function">top_k_sampling</span>(logits, k=50, temperature=1.0):
        <span class="string">"""
        Top-ké‡‡æ ·ï¼šåªä»æ¦‚ç‡æœ€é«˜çš„kä¸ªtokenä¸­é‡‡æ ·
        """</span>
        <span class="comment"># æ¸©åº¦è°ƒèŠ‚</span>
        logits = logits / temperature

        <span class="comment"># è·å–top-k</span>
        top_k_logits, top_k_indices = torch.topk(logits, k, dim=-1)

        <span class="comment"># å°†å…¶ä»–ä½ç½®è®¾ä¸º-inf</span>
        logits_masked = torch.full_like(logits, float(<span class="string">'-inf'</span>))
        logits_masked.scatter_(1, top_k_indices, top_k_logits)

        <span class="comment"># é‡æ–°è®¡ç®—æ¦‚ç‡å¹¶é‡‡æ ·</span>
        probs = F.softmax(logits_masked, dim=-1)
        <span class="keyword">return</span> torch.multinomial(probs, num_samples=1).squeeze()

    @staticmethod
    <span class="keyword">def</span> <span class="function">top_p_sampling</span>(logits, p=0.9, temperature=1.0):
        <span class="string">"""
        Top-p (Nucleus)é‡‡æ ·ï¼šé€‰æ‹©ç´¯ç§¯æ¦‚ç‡è¾¾åˆ°pçš„æœ€å°è¯é›†
        """</span>
        <span class="comment"># æ¸©åº¦è°ƒèŠ‚</span>
        logits = logits / temperature

        <span class="comment"># æ’åº</span>
        sorted_logits, sorted_indices = torch.sort(logits, descending=True)
        cumulative_probs = torch.cumsum(F.softmax(sorted_logits, dim=-1), dim=-1)

        <span class="comment"># æ‰¾åˆ°ç´¯ç§¯æ¦‚ç‡è¶…è¿‡pçš„ä½ç½®</span>
        sorted_indices_to_remove = cumulative_probs > p
        <span class="comment"># ä¿ç•™ç¬¬ä¸€ä¸ªè¶…è¿‡pçš„ä½ç½®</span>
        sorted_indices_to_remove[..., 1:] = sorted_indices_to_remove[..., :-1].clone()
        sorted_indices_to_remove[..., 0] = False

        <span class="comment"># å°†è¦ç§»é™¤çš„ä½ç½®è®¾ä¸º-inf</span>
        indices_to_remove = sorted_indices_to_remove.scatter(
            1, sorted_indices, sorted_indices_to_remove
        )
        logits_masked = logits.masked_fill(indices_to_remove, float(<span class="string">'-inf'</span>))

        <span class="comment"># é‡æ–°è®¡ç®—æ¦‚ç‡å¹¶é‡‡æ ·</span>
        probs = F.softmax(logits_masked, dim=-1)
        <span class="keyword">return</span> torch.multinomial(probs, num_samples=1).squeeze()

    @staticmethod
    <span class="keyword">def</span> <span class="function">beam_search</span>(model, input_ids, beam_size=5, max_length=50):
        <span class="string">"""
        æŸæœç´¢ï¼šç»´æŠ¤beam_sizeä¸ªæœ€ä½³å€™é€‰åºåˆ—
        """</span>
        <span class="comment"># åˆå§‹åŒ–æŸ</span>
        beams = [(input_ids, 0.0)]  <span class="comment"># (åºåˆ—, ç´¯ç§¯å¯¹æ•°æ¦‚ç‡)</span>

        <span class="keyword">for</span> _ <span class="keyword">in</span> range(max_length):
            candidates = []

            <span class="keyword">for</span> seq, score <span class="keyword">in</span> beams:
                <span class="comment"># è·å–ä¸‹ä¸€ä¸ªtokençš„æ¦‚ç‡</span>
                <span class="keyword">with</span> torch.no_grad():
                    outputs = model(seq)
                    logits = outputs.logits[:, -1, :]
                    log_probs = F.log_softmax(logits, dim=-1)

                <span class="comment"># è·å–top-kå€™é€‰</span>
                top_log_probs, top_indices = torch.topk(
                    log_probs[0], beam_size
                )

                <span class="comment"># åˆ›å»ºæ–°çš„å€™é€‰åºåˆ—</span>
                <span class="keyword">for</span> log_prob, idx <span class="keyword">in</span> zip(top_log_probs, top_indices):
                    new_seq = torch.cat([seq, idx.unsqueeze(0).unsqueeze(0)], dim=1)
                    new_score = score + log_prob.item()
                    candidates.append((new_seq, new_score))

            <span class="comment"># é€‰æ‹©å¾—åˆ†æœ€é«˜çš„beam_sizeä¸ªåºåˆ—</span>
            beams = sorted(candidates, key=<span class="keyword">lambda</span> x: x[1], reverse=True)[:beam_size]

            <span class="comment"># æ£€æŸ¥æ˜¯å¦æ‰€æœ‰æŸéƒ½ç»“æŸäº†</span>
            <span class="keyword">if</span> all(seq[0, -1].item() == model.config.eos_token_id <span class="keyword">for</span> seq, _ <span class="keyword">in</span> beams):
                <span class="keyword">break</span>

        <span class="comment"># è¿”å›å¾—åˆ†æœ€é«˜çš„åºåˆ—</span>
        <span class="keyword">return</span> beams[0][0]

<span class="comment"># ========== é‡å¤æƒ©ç½šæœºåˆ¶ ==========</span>
<span class="keyword">class</span> <span class="function">RepetitionPenalty</span>:
    <span class="string">"""
    é¿å…é‡å¤çš„å„ç§æƒ©ç½šæœºåˆ¶
    """</span>

    @staticmethod
    <span class="keyword">def</span> <span class="function">apply_repetition_penalty</span>(logits, generated_ids, penalty=1.2):
        <span class="string">"""
        å¯¹å·²ç”Ÿæˆçš„tokenæ–½åŠ æƒ©ç½š
        """</span>
        <span class="keyword">for</span> token_id <span class="keyword">in</span> set(generated_ids.tolist()):
            <span class="keyword">if</span> logits[token_id] < 0:
                logits[token_id] *= penalty
            <span class="keyword">else</span>:
                logits[token_id] /= penalty
        <span class="keyword">return</span> logits

    @staticmethod
    <span class="keyword">def</span> <span class="function">apply_no_repeat_ngram</span>(logits, generated_ids, ngram_size=3):
        <span class="string">"""
        ç¦æ­¢é‡å¤çš„n-gram
        """</span>
        <span class="keyword">if</span> len(generated_ids) < ngram_size:
            <span class="keyword">return</span> logits

        <span class="comment"># è·å–æœ€è¿‘çš„n-1ä¸ªtoken</span>
        prev_ngram = tuple(generated_ids[-(ngram_size-1):].tolist())

        <span class="comment"># æŸ¥æ‰¾æ‰€æœ‰å‡ºç°è¿‡çš„n-gram</span>
        banned_tokens = []
        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(generated_ids) - ngram_size + 1):
            <span class="keyword">if</span> tuple(generated_ids[i:i+ngram_size-1].tolist()) == prev_ngram:
                banned_tokens.append(generated_ids[i+ngram_size-1].item())

        <span class="comment"># ç¦æ­¢è¿™äº›token</span>
        <span class="keyword">for</span> token <span class="keyword">in</span> banned_tokens:
            logits[token] = float(<span class="string">'-inf'</span>)

        <span class="keyword">return</span> logits

<span class="comment"># ========== ç­–ç•¥å¯¹æ¯”å®éªŒ ==========</span>
<span class="keyword">def</span> <span class="function">compare_strategies</span>(model, tokenizer, prompt, num_samples=3):
    <span class="string">"""
    å¯¹æ¯”ä¸åŒè§£ç ç­–ç•¥çš„æ•ˆæœ
    """</span>
    strategies = {
        <span class="string">'è´ªå¿ƒæœç´¢'</span>: <span class="keyword">lambda</span> l: DecodingStrategies.greedy_search(l),
        <span class="string">'éšæœºé‡‡æ ·'</span>: <span class="keyword">lambda</span> l: DecodingStrategies.random_sampling(l, temperature=1.0),
        <span class="string">'Top-k (k=50)'</span>: <span class="keyword">lambda</span> l: DecodingStrategies.top_k_sampling(l, k=50),
        <span class="string">'Top-p (p=0.9)'</span>: <span class="keyword">lambda</span> l: DecodingStrategies.top_p_sampling(l, p=0.9),
    }

    print(<span class="string">f"æç¤º: {prompt}\n"</span>)

    <span class="keyword">for</span> name, strategy <span class="keyword">in</span> strategies.items():
        print(<span class="string">f"=== {name} ==="</span>)
        <span class="keyword">for</span> i <span class="keyword">in</span> range(num_samples):
            text = generate_with_strategy(
                model, tokenizer, prompt, strategy, max_length=50
            )
            print(<span class="string">f"æ ·æœ¬{i+1}: {text}"</span>)
        print()</pre>
                </div>
            </div>

            <div class="comparison-grid mt-4">
                <div class="comparison-item">
                    <span class="comparison-label">è´ªå¿ƒè§£ç ç»“æœ</span>
                    <div class="generation-example">
                        <p><strong>æç¤ºï¼š</strong>ä»Šå¤©çš„å¤©æ°”</p>
                        <p><strong>è¾“å‡ºï¼š</strong>ä»Šå¤©çš„å¤©æ°”å¾ˆå¥½ï¼Œå¤©æ°”å¾ˆå¥½ï¼Œå¤©æ°”å¾ˆå¥½ï¼Œå¤©æ°”å¾ˆå¥½...</p>
                    </div>
                    <p class="mt-2 text-muted">ä¸¥é‡çš„é‡å¤é—®é¢˜ï¼</p>
                </div>

                <div class="comparison-item">
                    <span class="comparison-label">Top-pé‡‡æ ·ç»“æœ</span>
                    <div class="generation-example">
                        <p><strong>æç¤ºï¼š</strong>ä»Šå¤©çš„å¤©æ°”</p>
                        <p><strong>è¾“å‡ºï¼š</strong>ä»Šå¤©çš„å¤©æ°”æ ¼å¤–æ™´æœ—ï¼Œå¾®é£è½»æ‹‚ï¼Œæ­£é€‚åˆå»å…¬å›­æ•£æ­¥ã€‚æ ‘å¶åœ¨é˜³å…‰ä¸‹é—ªé—ªå‘å…‰...</p>
                    </div>
                    <p class="mt-2 text-muted">è‡ªç„¶ä¸”å¯Œæœ‰å˜åŒ–ï¼</p>
                </div>
            </div>

            <div class="tip info mt-4">
                <span class="tip-icon">ğŸ’¡</span>
                <strong>æœ€ä½³å®è·µ</strong>
                <p class="mt-2">
                    å¯¹äºå¤§å¤šæ•°ç”Ÿæˆä»»åŠ¡ï¼Œæ¨èä½¿ç”¨<strong>Top-pé‡‡æ · + é€‚åº¦çš„æ¸©åº¦ï¼ˆ0.8-1.0ï¼‰+ é‡å¤æƒ©ç½š</strong>ã€‚
                    è¿™ä¸ªç»„åˆèƒ½å¤Ÿåœ¨è´¨é‡ã€å¤šæ ·æ€§å’Œå¯æ§æ€§ä¹‹é—´å–å¾—è‰¯å¥½å¹³è¡¡ã€‚
                </p>
            </div>
        </section>

        <!-- å¸¸è§è´¨é‡é—®é¢˜ -->
        <section id="quality-problems" class="section-card">
            <h2>âš ï¸ å¸¸è§è´¨é‡é—®é¢˜</h2>

            <div class="story-card">
                <span class="story-icon">ğŸ›</span>
                <p><strong>è¯Šæ–­ä¸æ²»ç–—</strong></p>
                <p class="mt-2">
                    å°±åƒåŒ»ç”Ÿéœ€è¦å…ˆè¯Šæ–­ç—…å› æ‰èƒ½å¼€è¯ï¼Œ
                    æˆ‘ä»¬ä¹Ÿéœ€è¦æ·±å…¥ç†è§£æ–‡æœ¬ç”Ÿæˆçš„è´¨é‡é—®é¢˜ï¼Œæ‰èƒ½æ‰¾åˆ°æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚
                </p>
            </div>

            <div class="problem-showcase">
                <h3 class="mb-3">é—®é¢˜è¯Šæ–­æ¸…å•</h3>

                <div class="problem-item">
                    <span class="problem-icon">ğŸ”</span>
                    <div class="problem-content">
                        <h4>é—®é¢˜1ï¼šé‡å¤ç”Ÿæˆ</h4>
                        <p><strong>ç—‡çŠ¶ï¼š</strong>è¯ã€çŸ­è¯­æˆ–å¥å­çº§åˆ«çš„é‡å¤</p>
                        <div class="comparison-grid mt-2">
                            <div class="comparison-item bad">
                                <span class="comparison-label">é—®é¢˜ç¤ºä¾‹</span>
                                <p>"æˆ‘å–œæ¬¢è‹¹æœã€‚è‹¹æœå¾ˆå¥½åƒã€‚æˆ‘çœŸçš„å–œæ¬¢è‹¹æœã€‚è‹¹æœæ˜¯æˆ‘æœ€å–œæ¬¢çš„æ°´æœ..."</p>
                            </div>
                            <div class="comparison-item good">
                                <span class="comparison-label">æ”¹è¿›å</span>
                                <p>"æˆ‘å–œæ¬¢è‹¹æœã€‚å®ƒçš„æ¸…è„†å£æ„Ÿå’Œç”œç¾æ»‹å‘³æ€»èƒ½è®©æˆ‘å¿ƒæƒ…æ„‰æ‚¦ã€‚æ¯å½“ç§‹å¤©æ¥ä¸´..."</p>
                            </div>
                        </div>
                        <p class="mt-2"><strong>åŸå› ï¼š</strong></p>
                        <ul>
                            <li>è´ªå¿ƒè§£ç çš„å±€éƒ¨æœ€ä¼˜é™·é˜±</li>
                            <li>è®­ç»ƒæ•°æ®ä¸­çš„é‡å¤æ¨¡å¼</li>
                            <li>ç¼ºä¹å¤šæ ·æ€§æœºåˆ¶</li>
                        </ul>
                        <p class="mt-2"><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
                        <ul>
                            <li>ä½¿ç”¨é‡å¤æƒ©ç½šæœºåˆ¶</li>
                            <li>é‡‡ç”¨Top-p/Top-ké‡‡æ ·</li>
                            <li>é™åˆ¶n-gramé‡å¤</li>
                        </ul>
                    </div>
                </div>

                <div class="problem-item">
                    <span class="problem-icon">ğŸ’”</span>
                    <div class="problem-content">
                        <h4>é—®é¢˜2ï¼šé€»è¾‘ä¸è¿è´¯</h4>
                        <p><strong>ç—‡çŠ¶ï¼š</strong>å‰åæ–‡çŸ›ç›¾ã€ä¸»é¢˜è·³è·ƒã€å› æœæ··ä¹±</p>
                        <div class="comparison-grid mt-2">
                            <div class="comparison-item bad">
                                <span class="comparison-label">é—®é¢˜ç¤ºä¾‹</span>
                                <p>"å°æ˜æ˜¯ä¸ªç¨‹åºå‘˜ã€‚å¥¹å–œæ¬¢ç”»ç”»ã€‚æ˜¨å¤©æˆ‘ä»¬å»çˆ¬å±±äº†ã€‚ç¼–ç¨‹å¾ˆæœ‰è¶£ã€‚"</p>
                            </div>
                            <div class="comparison-item good">
                                <span class="comparison-label">æ”¹è¿›å</span>
                                <p>"å°æ˜æ˜¯ä¸ªç¨‹åºå‘˜ã€‚ä»–çƒ­çˆ±ç¼–ç¨‹ï¼Œç»å¸¸ç†¬å¤œå†™ä»£ç ã€‚å°½ç®¡å·¥ä½œç¹å¿™ï¼Œä»–ä»ç„¶åšæŒæ¯å¤©å­¦ä¹ æ–°æŠ€æœ¯ã€‚"</p>
                            </div>
                        </div>
                        <p class="mt-2"><strong>åŸå› ï¼š</strong></p>
                        <ul>
                            <li>ä¸Šä¸‹æ–‡ç†è§£ä¸è¶³</li>
                            <li>é•¿è·ç¦»ä¾èµ–å»ºæ¨¡å¤±è´¥</li>
                            <li>ç¼ºä¹å…¨å±€è§„åˆ’</li>
                        </ul>
                        <p class="mt-2"><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
                        <ul>
                            <li>ä½¿ç”¨æ›´å¤§çš„ä¸Šä¸‹æ–‡çª—å£</li>
                            <li>å¼•å…¥ä¸»é¢˜è¿½è¸ªæœºåˆ¶</li>
                            <li>åˆ†å±‚è§„åˆ’ç”Ÿæˆ</li>
                        </ul>
                    </div>
                </div>

                <div class="problem-item">
                    <span class="problem-icon">ğŸ“</span>
                    <div class="problem-content">
                        <h4>é—®é¢˜3ï¼šé•¿åº¦å¤±æ§</h4>
                        <p><strong>ç—‡çŠ¶ï¼š</strong>è¿‡æ—©ç»“æŸæˆ–æ— ä¼‘æ­¢ç”Ÿæˆ</p>
                        <div class="comparison-grid mt-2">
                            <div class="comparison-item bad">
                                <span class="comparison-label">è¿‡çŸ­</span>
                                <p>ä»»åŠ¡ï¼š"å†™ä¸€ä¸ªæ•…äº‹"<br>è¾“å‡ºï¼š"æœ‰ä¸€å¤©ã€‚ç»“æŸã€‚"</p>
                            </div>
                            <div class="comparison-item bad">
                                <span class="comparison-label">è¿‡é•¿</span>
                                <p>"...ç„¶åä»–åˆè¯´ï¼Œç„¶åå¥¹åˆè¯´ï¼Œç„¶åä»–ä»¬åˆè¯´ï¼Œç„¶å..."ï¼ˆæ— é™å¾ªç¯ï¼‰</p>
                            </div>
                        </div>
                        <p class="mt-2"><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
                        <ul>
                            <li>è®¾ç½®åˆç†çš„é•¿åº¦çº¦æŸ</li>
                            <li>ä½¿ç”¨é•¿åº¦æƒ©ç½š/å¥–åŠ±</li>
                            <li>è®­ç»ƒé•¿åº¦æ„ŸçŸ¥æ¨¡å‹</li>
                        </ul>
                    </div>
                </div>

                <div class="problem-item">
                    <span class="problem-icon">ğŸ­</span>
                    <div class="problem-content">
                        <h4>é—®é¢˜4ï¼šé£æ ¼ä¸ä¸€è‡´</h4>
                        <p><strong>ç—‡çŠ¶ï¼š</strong>æ­£å¼ä¸å£è¯­æ··æ‚ã€æƒ…æ„Ÿçªå˜</p>
                        <div class="comparison-grid mt-2">
                            <div class="comparison-item bad">
                                <span class="comparison-label">é—®é¢˜ç¤ºä¾‹</span>
                                <p>"å°Šæ•¬çš„å®¢æˆ·æ‚¨å¥½ï¼Œå’±ä»Šå¤©èŠç‚¹å•¥å‘¢ï¼Ÿæœ¬å…¬å¸è¯šæŒšåœ°...å“ˆå“ˆå“ˆå¤ªé€—äº†ï¼"</p>
                            </div>
                            <div class="comparison-item good">
                                <span class="comparison-label">æ”¹è¿›å</span>
                                <p>"å°Šæ•¬çš„å®¢æˆ·æ‚¨å¥½ï¼Œæ„Ÿè°¢æ‚¨å¯¹æœ¬å…¬å¸çš„æ”¯æŒã€‚æˆ‘ä»¬è¯šæŒšåœ°ä¸ºæ‚¨æä¾›æœ€ä¼˜è´¨çš„æœåŠ¡ã€‚"</p>
                            </div>
                        </div>
                        <p class="mt-2"><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
                        <ul>
                            <li>é£æ ¼å‘é‡æ§åˆ¶</li>
                            <li>æ¡ä»¶ç”Ÿæˆè®­ç»ƒ</li>
                            <li>åå¤„ç†é£æ ¼ç»Ÿä¸€</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="deep-think-box mt-4">
                <h4>è´¨é‡è¯„ä¼°ç»´åº¦</h4>
                <div class="think-item">
                    <h5>ğŸ“Š è‡ªåŠ¨è¯„ä¼°æŒ‡æ ‡</h5>
                    <ul>
                        <li><strong>å›°æƒ‘åº¦ï¼ˆPerplexityï¼‰ï¼š</strong>è¯­è¨€æ¨¡å‹çš„ä¸ç¡®å®šæ€§</li>
                        <li><strong>BLEUåˆ†æ•°ï¼š</strong>ä¸å‚è€ƒæ–‡æœ¬çš„n-gramé‡å </li>
                        <li><strong>ROUGEåˆ†æ•°ï¼š</strong>å¬å›å¯¼å‘çš„è¯„ä¼°</li>
                        <li><strong>BERTScoreï¼š</strong>åŸºäºè¯­ä¹‰çš„ç›¸ä¼¼åº¦</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>ğŸ‘¥ äººå·¥è¯„ä¼°ç»´åº¦</h5>
                    <ul>
                        <li><strong>æµç•…æ€§ï¼š</strong>è¯­æ³•æ­£ç¡®ã€è‡ªç„¶æµç•…</li>
                        <li><strong>è¿è´¯æ€§ï¼š</strong>é€»è¾‘æ¸…æ™°ã€å‰åä¸€è‡´</li>
                        <li><strong>ç›¸å…³æ€§ï¼š</strong>ç¬¦åˆä¸»é¢˜ã€æ»¡è¶³éœ€æ±‚</li>
                        <li><strong>åˆ›é€ æ€§ï¼š</strong>æ–°é¢–æœ‰è¶£ã€å¯Œæœ‰æƒ³è±¡</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- æ”¹è¿›æŠ€æœ¯ -->
        <section id="improvement-techniques" class="section-card">
            <h2>ğŸš€ æ”¹è¿›æŠ€æœ¯</h2>

            <div class="story-card">
                <span class="story-icon">ğŸ’Š</span>
                <p><strong>å¯¹ç—‡ä¸‹è¯</strong></p>
                <p class="mt-2">
                    é’ˆå¯¹ä¸åŒçš„è´¨é‡é—®é¢˜ï¼Œç ”ç©¶è€…ä»¬å¼€å‘äº†å„ç§æ”¹è¿›æŠ€æœ¯ã€‚
                    è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›"è‰¯è¯"æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚
                </p>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Python - è´¨é‡æ”¹è¿›æŠ€æœ¯å®ç°</span>
                    <div class="code-actions">
                        <button class="code-btn" onclick="toggleCode(this)">å±•å¼€</button>
                        <button class="code-btn" onclick="copyCode(this)">å¤åˆ¶</button>
                    </div>
                </div>
                <div class="code-content collapsed">
                    <pre><span class="keyword">import</span> torch
<span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn
<span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F
<span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict

<span class="keyword">class</span> <span class="function">QualityImprovement</span>:
    <span class="string">"""
    æ–‡æœ¬ç”Ÿæˆè´¨é‡æ”¹è¿›æŠ€æœ¯é›†åˆ
    """</span>

    <span class="comment"># ========== 1. é‡å¤æ§åˆ¶ ==========</span>
    <span class="keyword">class</span> <span class="function">RepetitionController</span>:
        <span class="string">"""
        æ§åˆ¶å„ç§çº§åˆ«çš„é‡å¤
        """</span>
        <span class="keyword">def</span> <span class="function">__init__</span>(self):
            self.word_counts = defaultdict(int)
            self.ngram_history = set()

        <span class="keyword">def</span> <span class="function">update_history</span>(self, token_ids):
            <span class="string">"""æ›´æ–°å†å²è®°å½•"""</span>
            <span class="comment"># æ›´æ–°è¯é¢‘</span>
            <span class="keyword">for</span> tid <span class="keyword">in</span> token_ids:
                self.word_counts[tid] += 1

            <span class="comment"># æ›´æ–°n-gramå†å²</span>
            <span class="keyword">for</span> n <span class="keyword">in</span> [2, 3, 4]:  <span class="comment"># 2-gramåˆ°4-gram</span>
                <span class="keyword">if</span> len(token_ids) >= n:
                    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(token_ids) - n + 1):
                        ngram = tuple(token_ids[i:i+n])
                        self.ngram_history.add(ngram)

        <span class="keyword">def</span> <span class="function">apply_penalties</span>(self, logits, recent_tokens, config):
            <span class="string">"""
            åº”ç”¨å„ç§é‡å¤æƒ©ç½š

            Args:
                logits: æ¨¡å‹è¾“å‡ºçš„logits
                recent_tokens: æœ€è¿‘ç”Ÿæˆçš„tokenåºåˆ—
                config: æƒ©ç½šé…ç½®
            """</span>
            <span class="comment"># 1. é¢‘ç‡æƒ©ç½š</span>
            <span class="keyword">if</span> config.frequency_penalty > 0:
                <span class="keyword">for</span> token_id, count <span class="keyword">in</span> self.word_counts.items():
                    <span class="keyword">if</span> token_id < len(logits):
                        logits[token_id] -= config.frequency_penalty * count

            <span class="comment"># 2. å­˜åœ¨æƒ©ç½š</span>
            <span class="keyword">if</span> config.presence_penalty > 0:
                <span class="keyword">for</span> token_id <span class="keyword">in</span> set(recent_tokens):
                    <span class="keyword">if</span> token_id < len(logits):
                        logits[token_id] -= config.presence_penalty

            <span class="comment"># 3. N-gramé˜»æ–­</span>
            <span class="keyword">if</span> config.no_repeat_ngram_size > 0:
                <span class="keyword">if</span> len(recent_tokens) >= config.no_repeat_ngram_size - 1:
                    prefix = tuple(recent_tokens[-(config.no_repeat_ngram_size-1):])
                    <span class="keyword">for</span> token_id <span class="keyword">in</span> range(len(logits)):
                        test_ngram = prefix + (token_id,)
                        <span class="keyword">if</span> test_ngram <span class="keyword">in</span> self.ngram_history:
                            logits[token_id] = float(<span class="string">'-inf'</span>)

            <span class="keyword">return</span> logits

    <span class="comment"># ========== 2. å¤šæ ·æ€§å¢å¼º ==========</span>
    @staticmethod
    <span class="keyword">def</span> <span class="function">diverse_beam_search</span>(model, input_ids, num_beams=5,
                              num_beam_groups=5, diversity_penalty=0.5):
        <span class="string">"""
        å¤šæ ·åŒ–æŸæœç´¢ï¼šç”Ÿæˆå¤šæ ·çš„é«˜è´¨é‡å€™é€‰
        """</span>
        <span class="comment"># å°†æŸåˆ†æˆå¤šä¸ªç»„</span>
        beams_per_group = num_beams // num_beam_groups
        group_beams = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> range(num_beam_groups)]

        <span class="comment"># åˆå§‹åŒ–æ¯ç»„</span>
        <span class="keyword">for</span> group_idx <span class="keyword">in</span> range(num_beam_groups):
            group_beams[group_idx] = [(input_ids, 0.0)]

        <span class="comment"># è®°å½•å·²ä½¿ç”¨çš„tokenï¼Œç”¨äºå¤šæ ·æ€§æƒ©ç½š</span>
        used_tokens = [set() <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(input_ids[0]))]

        <span class="keyword">for</span> step <span class="keyword">in</span> range(50):  <span class="comment"># æœ€å¤§ç”Ÿæˆé•¿åº¦</span>
            <span class="keyword">for</span> group_idx <span class="keyword">in</span> range(num_beam_groups):
                candidates = []

                <span class="keyword">for</span> seq, score <span class="keyword">in</span> group_beams[group_idx]:
                    <span class="comment"># è·å–logits</span>
                    <span class="keyword">with</span> torch.no_grad():
                        outputs = model(seq)
                        logits = outputs.logits[:, -1, :]

                    <span class="comment"># åº”ç”¨å¤šæ ·æ€§æƒ©ç½š</span>
                    <span class="keyword">for</span> prev_group_idx <span class="keyword">in</span> range(group_idx):
                        <span class="keyword">for</span> token <span class="keyword">in</span> used_tokens[step]:
                            logits[0, token] -= diversity_penalty

                    <span class="comment"># è·å–topå€™é€‰</span>
                    log_probs = F.log_softmax(logits, dim=-1)
                    top_log_probs, top_indices = torch.topk(
                        log_probs[0], beams_per_group * 2
                    )

                    <span class="comment"># åˆ›å»ºæ–°å€™é€‰</span>
                    <span class="keyword">for</span> log_prob, idx <span class="keyword">in</span> zip(top_log_probs, top_indices):
                        new_seq = torch.cat([seq, idx.unsqueeze(0).unsqueeze(0)], dim=1)
                        new_score = score + log_prob.item()
                        candidates.append((new_seq, new_score, idx.item()))

                <span class="comment"># é€‰æ‹©æœ€ä½³å€™é€‰</span>
                candidates.sort(key=<span class="keyword">lambda</span> x: x[1], reverse=True)
                group_beams[group_idx] = [
                    (seq, score) <span class="keyword">for</span> seq, score, token <span class="keyword">in</span> candidates[:beams_per_group]
                ]

                <span class="comment"># è®°å½•ä½¿ç”¨çš„token</span>
                <span class="keyword">for</span> _, _, token <span class="keyword">in</span> candidates[:beams_per_group]:
                    used_tokens[step].add(token)

        <span class="comment"># è¿”å›æ‰€æœ‰ç»„çš„æœ€ä½³ç»“æœ</span>
        all_sequences = []
        <span class="keyword">for</span> group <span class="keyword">in</span> group_beams:
            all_sequences.extend(group)
        all_sequences.sort(key=<span class="keyword">lambda</span> x: x[1], reverse=True)

        <span class="keyword">return</span> [seq <span class="keyword">for</span> seq, _ <span class="keyword">in</span> all_sequences[:num_beams]]

    <span class="comment"># ========== 3. è¿è´¯æ€§å¢å¼º ==========</span>
    <span class="keyword">class</span> <span class="function">CoherenceEnhancer</span>:
        <span class="string">"""
        å¢å¼ºæ–‡æœ¬è¿è´¯æ€§
        """</span>
        <span class="keyword">def</span> <span class="function">__init__</span>(self, model):
            self.model = model
            self.topic_embeddings = []
            self.entity_tracker = defaultdict(list)

        <span class="keyword">def</span> <span class="function">track_entities</span>(self, text, position):
            <span class="string">"""è·Ÿè¸ªæ–‡æœ¬ä¸­çš„å®ä½“"""</span>
            <span class="comment"># ç®€åŒ–ç‰ˆï¼šè·Ÿè¸ªä¸“æœ‰åè¯</span>
            words = text.split()
            <span class="keyword">for</span> word <span class="keyword">in</span> words:
                <span class="keyword">if</span> word[0].isupper():  <span class="comment"># ç®€å•åˆ¤æ–­</span>
                    self.entity_tracker[word].append(position)

        <span class="keyword">def</span> <span class="function">compute_coherence_score</span>(self, candidate_text, context):
            <span class="string">"""
            è®¡ç®—å€™é€‰æ–‡æœ¬çš„è¿è´¯æ€§åˆ†æ•°
            """</span>
            <span class="comment"># 1. ä¸»é¢˜ä¸€è‡´æ€§</span>
            topic_score = self._compute_topic_consistency(candidate_text, context)

            <span class="comment"># 2. å®ä½“ä¸€è‡´æ€§</span>
            entity_score = self._compute_entity_consistency(candidate_text)

            <span class="comment"># 3. è¯­ä¹‰ç›¸ä¼¼åº¦</span>
            semantic_score = self._compute_semantic_similarity(candidate_text, context)

            <span class="comment"># ç»¼åˆåˆ†æ•°</span>
            coherence_score = (
                0.4 * topic_score +
                0.3 * entity_score +
                0.3 * semantic_score
            )

            <span class="keyword">return</span> coherence_score

        <span class="keyword">def</span> <span class="function">_compute_topic_consistency</span>(self, text, context):
            <span class="string">"""è®¡ç®—ä¸»é¢˜ä¸€è‡´æ€§"""</span>
            <span class="comment"># ä½¿ç”¨è¯è¢‹æ¨¡å‹çš„ç®€åŒ–ç‰ˆæœ¬</span>
            text_words = set(text.lower().split())
            context_words = set(context.lower().split())

            <span class="keyword">if</span> <span class="keyword">not</span> context_words:
                <span class="keyword">return</span> 1.0

            overlap = len(text_words & context_words)
            <span class="keyword">return</span> overlap / len(context_words)

        <span class="keyword">def</span> <span class="function">_compute_entity_consistency</span>(self, text):
            <span class="string">"""è®¡ç®—å®ä½“ä¸€è‡´æ€§"""</span>
            <span class="comment"># æ£€æŸ¥æ˜¯å¦æ­£ç¡®å¼•ç”¨äº†ä¹‹å‰çš„å®ä½“</span>
            score = 1.0
            words = text.split()

            <span class="keyword">for</span> word <span class="keyword">in</span> words:
                <span class="keyword">if</span> word <span class="keyword">in</span> self.entity_tracker:
                    <span class="comment"># å®ä½“è¢«æ­£ç¡®å¼•ç”¨ï¼ŒåŠ åˆ†</span>
                    score += 0.1
                <span class="keyword">elif</span> word[0].isupper() <span class="keyword">and</span> word <span class="keyword">not</span> <span class="keyword">in</span> self.entity_tracker:
                    <span class="comment"># æ–°å®ä½“çªç„¶å‡ºç°ï¼Œå‡åˆ†</span>
                    score -= 0.1

            <span class="keyword">return</span> max(0, min(1, score))

        <span class="keyword">def</span> <span class="function">_compute_semantic_similarity</span>(self, text1, text2):
            <span class="string">"""è®¡ç®—è¯­ä¹‰ç›¸ä¼¼åº¦ï¼ˆç®€åŒ–ç‰ˆï¼‰"""</span>
            <span class="comment"># å®é™…åº”ç”¨ä¸­ä¼šä½¿ç”¨å¥å­åµŒå…¥</span>
            words1 = set(text1.lower().split())
            words2 = set(text2.lower().split())

            <span class="keyword">if</span> <span class="keyword">not</span> words1 <span class="keyword">or</span> <span class="keyword">not</span> words2:
                <span class="keyword">return</span> 0

            intersection = len(words1 & words2)
            union = len(words1 | words2)

            <span class="keyword">return</span> intersection / union <span class="keyword">if</span> union > 0 <span class="keyword">else</span> 0

    <span class="comment"># ========== 4. é•¿åº¦æ§åˆ¶ ==========</span>
    @staticmethod
    <span class="keyword">def</span> <span class="function">length_penalty</span>(score, length, alpha=0.6):
        <span class="string">"""
        é•¿åº¦æƒ©ç½šï¼šé¿å…è¿‡çŸ­æˆ–è¿‡é•¿çš„ç”Ÿæˆ
        """</span>
        <span class="comment"># Wu et al. (2016) çš„é•¿åº¦æƒ©ç½šå…¬å¼</span>
        <span class="keyword">return</span> score / (length ** alpha)

    @staticmethod
    <span class="keyword">def</span> <span class="function">adaptive_length_control</span>(logits, current_length, target_length,
                                   eos_token_id, length_tolerance=0.2):
        <span class="string">"""
        è‡ªé€‚åº”é•¿åº¦æ§åˆ¶ï¼šæ ¹æ®ç›®æ ‡é•¿åº¦è°ƒæ•´EOSæ¦‚ç‡
        """</span>
        <span class="comment"># è®¡ç®—å½“å‰é•¿åº¦ä¸ç›®æ ‡é•¿åº¦çš„æ¯”ä¾‹</span>
        length_ratio = current_length / target_length

        <span class="keyword">if</span> length_ratio < (1 - length_tolerance):
            <span class="comment"># è¿˜æ²¡è¾¾åˆ°ç›®æ ‡é•¿åº¦ï¼Œé™ä½EOSæ¦‚ç‡</span>
            logits[eos_token_id] -= 5.0
        <span class="keyword">elif</span> length_ratio > (1 + length_tolerance):
            <span class="comment"># è¶…è¿‡ç›®æ ‡é•¿åº¦ï¼Œæé«˜EOSæ¦‚ç‡</span>
            logits[eos_token_id] += 5.0

        <span class="keyword">return</span> logits

<span class="comment"># ========== ä½¿ç”¨ç¤ºä¾‹ ==========</span>
<span class="keyword">def</span> <span class="function">generate_with_improvements</span>(model, tokenizer, prompt, config):
    <span class="string">"""
    ä½¿ç”¨å„ç§æ”¹è¿›æŠ€æœ¯ç”Ÿæˆæ–‡æœ¬
    """</span>
    <span class="comment"># åˆå§‹åŒ–æ§åˆ¶å™¨</span>
    rep_controller = QualityImprovement.RepetitionController()
    coh_enhancer = QualityImprovement.CoherenceEnhancer(model)

    <span class="comment"># ç¼–ç è¾“å…¥</span>
    input_ids = tokenizer.encode(prompt, return_tensors=<span class="string">'pt'</span>)
    generated = input_ids

    <span class="keyword">for</span> step <span class="keyword">in</span> range(config.max_length):
        <span class="comment"># è·å–logits</span>
        <span class="keyword">with</span> torch.no_grad():
            outputs = model(generated)
            logits = outputs.logits[0, -1, :]

        <span class="comment"># åº”ç”¨å„ç§æ”¹è¿›</span>
        <span class="comment"># 1. é‡å¤æ§åˆ¶</span>
        logits = rep_controller.apply_penalties(
            logits,
            generated[0].tolist(),
            config
        )

        <span class="comment"># 2. é•¿åº¦æ§åˆ¶</span>
        logits = QualityImprovement.adaptive_length_control(
            logits,
            step,
            config.target_length,
            tokenizer.eos_token_id
        )

        <span class="comment"># 3. æ¸©åº¦å’Œé‡‡æ ·</span>
        logits = logits / config.temperature
        probs = F.softmax(logits, dim=-1)

        <span class="comment"># Top-pé‡‡æ ·</span>
        sorted_probs, sorted_indices = torch.sort(probs, descending=True)
        cumsum_probs = torch.cumsum(sorted_probs, dim=-1)
        sorted_indices_to_remove = cumsum_probs > config.top_p
        sorted_indices_to_remove[1:] = sorted_indices_to_remove[:-1].clone()
        sorted_indices_to_remove[0] = False

        indices_to_remove = sorted_indices[sorted_indices_to_remove]
        probs[indices_to_remove] = 0
        probs = probs / probs.sum()  <span class="comment"># é‡æ–°å½’ä¸€åŒ–</span>

        <span class="comment"># é‡‡æ ·</span>
        next_token = torch.multinomial(probs, 1)

        <span class="comment"># æ›´æ–°ç”Ÿæˆåºåˆ—</span>
        generated = torch.cat([generated, next_token.unsqueeze(0)], dim=1)

        <span class="comment"># æ›´æ–°å†å²</span>
        rep_controller.update_history([next_token.item()])

        <span class="comment"># æ£€æŸ¥ç»“æŸ</span>
        <span class="keyword">if</span> next_token.item() == tokenizer.eos_token_id:
            <span class="keyword">break</span>

    <span class="keyword">return</span> tokenizer.decode(generated[0], skip_special_tokens=True)</pre>
                </div>
            </div>

            <div class="card-grid mt-4">
                <div class="info-card">
                    <span class="card-icon">ğŸš«</span>
                    <h4 class="card-title">é‡å¤æƒ©ç½š</h4>
                    <ul>
                        <li><strong>é¢‘ç‡æƒ©ç½šï¼š</strong>é™ä½é«˜é¢‘è¯æ¦‚ç‡</li>
                        <li><strong>å­˜åœ¨æƒ©ç½šï¼š</strong>é¿å…é‡å¤å·²æœ‰è¯</li>
                        <li><strong>N-gramé˜»æ–­ï¼š</strong>ç¦æ­¢é‡å¤çŸ­è¯­</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸŒˆ</span>
                    <h4 class="card-title">å¤šæ ·æ€§æŠ€æœ¯</h4>
                    <ul>
                        <li><strong>å¤šæ ·æŸæœç´¢ï¼š</strong>ç”Ÿæˆä¸åŒçš„å€™é€‰</li>
                        <li><strong>é‡‡æ ·æŠ€å·§ï¼š</strong>å¢åŠ éšæœºæ€§</li>
                        <li><strong>å¯¹æ¯”è§£ç ï¼š</strong>é¼“åŠ±å·®å¼‚åŒ–</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ”—</span>
                    <h4 class="card-title">è¿è´¯æ€§ä¿æŒ</h4>
                    <ul>
                        <li><strong>ä¸»é¢˜è¿½è¸ªï¼š</strong>ä¿æŒè¯é¢˜ä¸€è‡´</li>
                        <li><strong>å®ä½“è·Ÿè¸ªï¼š</strong>æ­£ç¡®å¼•ç”¨å®ä½“</li>
                        <li><strong>ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼š</strong>è€ƒè™‘å…¨å±€ä¿¡æ¯</li>
                    </ul>
                </div>
            </div>

            <div class="tip success mt-4">
                <span class="tip-icon">ğŸ¯</span>
                <strong>æ”¹è¿›æ•ˆæœ</strong>
                <p class="mt-2">
                    é€šè¿‡åˆç†ç»„åˆè¿™äº›æŠ€æœ¯ï¼Œå¯ä»¥æ˜¾è‘—æå‡ç”Ÿæˆè´¨é‡ï¼š
                    é‡å¤ç‡é™ä½80%ï¼Œè¿è´¯æ€§æå‡50%ï¼Œç”¨æˆ·æ»¡æ„åº¦æå‡70%ï¼
                </p>
            </div>
        </section>

        <!-- å¯æ§ç”Ÿæˆ -->
        <section id="controlled-generation" class="section-card">
            <h2>ğŸ® å¯æ§ç”Ÿæˆ</h2>

            <div class="story-card">
                <span class="story-icon">ğŸ¨</span>
                <p><strong>ç²¾ç¡®æ§åˆ¶çš„è‰ºæœ¯</strong></p>
                <p class="mt-2">
                    å¦‚æœè¯´æ–‡æœ¬ç”Ÿæˆæ˜¯ç»˜ç”»ï¼Œé‚£ä¹ˆå¯æ§ç”Ÿæˆå°±æ˜¯è®©ä½ èƒ½å¤Ÿç²¾ç¡®æ§åˆ¶ç”»ç¬”çš„æ¯ä¸€ç¬”ã€‚
                    è®©æˆ‘ä»¬æ¢ç´¢å¦‚ä½•è®©AIæŒ‰ç…§æˆ‘ä»¬çš„æ„å›¾åˆ›ä½œã€‚
                </p>
            </div>

            <div class="deep-think-box">
                <h4>æ§åˆ¶ç»´åº¦</h4>
                <div class="think-item">
                    <h5>ğŸ­ é£æ ¼æ§åˆ¶</h5>
                    <ul>
                        <li>æ­£å¼ vs å£è¯­</li>
                        <li>ç®€æ´ vs è¯¦ç»†</li>
                        <li>å®¢è§‚ vs ä¸»è§‚</li>
                        <li>ä¸“ä¸š vs é€šä¿—</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>ğŸ“ å†…å®¹æ§åˆ¶</h5>
                    <ul>
                        <li>ä¸»é¢˜é™å®š</li>
                        <li>å…³é”®è¯åŒ…å«</li>
                        <li>æƒ…èŠ‚å‘å±•</li>
                        <li>è§‚ç‚¹å€¾å‘</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>ğŸ¨ å±æ€§æ§åˆ¶</h5>
                    <ul>
                        <li>æƒ…æ„Ÿè‰²å½©</li>
                        <li>é•¿åº¦èŒƒå›´</li>
                        <li>å¤æ‚åº¦</li>
                        <li>åˆ›æ–°ç¨‹åº¦</li>
                    </ul>
                </div>
            </div>

            <div class="interactive-demo">
                <h3 class="mb-3">ğŸ® å¯æ§ç”Ÿæˆæ¼”ç¤º</h3>

                <div class="demo-controls">
                    <button class="btn btn-primary" onclick="controlledGenerate('formal')">æ­£å¼é£æ ¼</button>
                    <button class="btn btn-primary" onclick="controlledGenerate('casual')">ä¼‘é—²é£æ ¼</button>
                    <button class="btn btn-primary" onclick="controlledGenerate('poetic')">è¯—æ„é£æ ¼</button>
                    <button class="btn btn-primary" onclick="controlledGenerate('technical')">æŠ€æœ¯é£æ ¼</button>
                </div>

                <div class="generation-example mt-3">
                    <div class="example-header">
                        <span class="prompt-tag">ä¸»é¢˜ï¼šäººå·¥æ™ºèƒ½çš„æœªæ¥</span>
                    </div>
                    <div class="demo-output" id="controlled-output">
                        <p class="text-center text-muted">é€‰æ‹©ä¸€ä¸ªé£æ ¼æŸ¥çœ‹ç”Ÿæˆæ•ˆæœ...</p>
                    </div>
                </div>
            </div>

            <div class="code-block mt-4">
                <div class="code-header">
                    <span class="code-lang">Python - å¯æ§ç”ŸæˆæŠ€æœ¯</span>
                    <div class="code-actions">
                        <button class="code-btn" onclick="toggleCode(this)">å±•å¼€</button>
                        <button class="code-btn" onclick="copyCode(this)">å¤åˆ¶</button>
                    </div>
                </div>
                <div class="code-content">
                    <pre><span class="keyword">import</span> torch
<span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn

<span class="keyword">class</span> <span class="function">ControlledGenerator</span>:
    <span class="string">"""
    å¯æ§æ–‡æœ¬ç”Ÿæˆå™¨
    """</span>

    <span class="comment"># ========== 1. æ¡ä»¶è¯­è¨€æ¨¡å‹ ==========</span>
    <span class="keyword">class</span> <span class="function">ConditionalLM</span>(nn.Module):
        <span class="string">"""
        æ¡ä»¶è¯­è¨€æ¨¡å‹ï¼šåœ¨ç”Ÿæˆæ—¶è€ƒè™‘æ§åˆ¶ä¿¡å·
        """</span>
        <span class="keyword">def</span> <span class="function">__init__</span>(self, base_model, num_conditions, condition_dim=128):
            super().__init__()
            self.base_model = base_model
            self.condition_embeddings = nn.Embedding(num_conditions, condition_dim)

            <span class="comment"># æ¡ä»¶æŠ•å½±å±‚</span>
            hidden_size = base_model.config.hidden_size
            self.condition_proj = nn.Linear(condition_dim, hidden_size)

        <span class="keyword">def</span> <span class="function">forward</span>(self, input_ids, condition_id):
            <span class="comment"># è·å–æ¡ä»¶åµŒå…¥</span>
            condition_emb = self.condition_embeddings(condition_id)
            condition_hidden = self.condition_proj(condition_emb)

            <span class="comment"># å°†æ¡ä»¶ä¿¡æ¯æ³¨å…¥åˆ°æ¯ä¸€å±‚</span>
            outputs = self.base_model(
                input_ids,
                encoder_hidden_states=condition_hidden.unsqueeze(1)
            )

            <span class="keyword">return</span> outputs

    <span class="comment"># ========== 2. å±æ€§æ§åˆ¶ ==========</span>
    @staticmethod
    <span class="keyword">def</span> <span class="function">attribute_control</span>(logits, attribute_discriminator,
                          target_attribute, strength=1.0):
        <span class="string">"""
        ä½¿ç”¨å±æ€§åˆ¤åˆ«å™¨æ§åˆ¶ç”Ÿæˆ

        Args:
            logits: æ¨¡å‹è¾“å‡º
            attribute_discriminator: å±æ€§åˆ¤åˆ«å™¨
            target_attribute: ç›®æ ‡å±æ€§å€¼
            strength: æ§åˆ¶å¼ºåº¦
        """</span>
        <span class="comment"># å¯¹æ¯ä¸ªå¯èƒ½çš„ä¸‹ä¸€ä¸ªtoken</span>
        controlled_logits = logits.clone()

        <span class="keyword">for</span> i <span class="keyword">in</span> range(logits.size(-1)):
            <span class="comment"># é¢„æµ‹è¯¥tokençš„å±æ€§</span>
            token_attr = attribute_discriminator(i)

            <span class="comment"># æ ¹æ®ä¸ç›®æ ‡å±æ€§çš„åŒ¹é…åº¦è°ƒæ•´logit</span>
            attr_match = -abs(token_attr - target_attribute)
            controlled_logits[i] += strength * attr_match

        <span class="keyword">return</span> controlled_logits

    <span class="comment"># ========== 3. å…³é”®è¯æ§åˆ¶ ==========</span>
    <span class="keyword">class</span> <span class="function">KeywordController</span>:
        <span class="string">"""
        ç¡®ä¿ç”Ÿæˆæ–‡æœ¬åŒ…å«æŒ‡å®šå…³é”®è¯
        """</span>
        <span class="keyword">def</span> <span class="function">__init__</span>(self, tokenizer):
            self.tokenizer = tokenizer
            self.keyword_positions = {}

        <span class="keyword">def</span> <span class="function">set_keywords</span>(self, keywords, positions=None):
            <span class="string">"""
            è®¾ç½®å¿…é¡»åŒ…å«çš„å…³é”®è¯

            Args:
                keywords: å…³é”®è¯åˆ—è¡¨
                positions: å¯é€‰ï¼ŒæŒ‡å®šå…³é”®è¯åº”è¯¥å‡ºç°çš„ä½ç½®èŒƒå›´
            """</span>
            self.keywords = keywords
            self.keyword_tokens = [
                self.tokenizer.encode(kw, add_special_tokens=False)
                <span class="keyword">for</span> kw <span class="keyword">in</span> keywords
            ]

            <span class="keyword">if</span> positions:
                self.keyword_positions = dict(zip(keywords, positions))

        <span class="keyword">def</span> <span class="function">apply_keyword_boost</span>(self, logits, current_position, generated_text):
            <span class="string">"""
            æå‡å…³é”®è¯ç›¸å…³tokençš„æ¦‚ç‡
            """</span>
            <span class="comment"># æ£€æŸ¥å“ªäº›å…³é”®è¯è¿˜æ²¡å‡ºç°</span>
            remaining_keywords = []
            <span class="keyword">for</span> kw <span class="keyword">in</span> self.keywords:
                <span class="keyword">if</span> kw <span class="keyword">not</span> <span class="keyword">in</span> generated_text:
                    remaining_keywords.append(kw)

            <span class="comment"># å¯¹æ¯ä¸ªå‰©ä½™å…³é”®è¯</span>
            <span class="keyword">for</span> kw, tokens <span class="keyword">in</span> zip(remaining_keywords, self.keyword_tokens):
                <span class="comment"># æ£€æŸ¥æ˜¯å¦åœ¨åˆé€‚çš„ä½ç½®</span>
                <span class="keyword">if</span> kw <span class="keyword">in</span> self.keyword_positions:
                    pos_range = self.keyword_positions[kw]
                    <span class="keyword">if</span> <span class="keyword">not</span> (pos_range[0] <= current_position <= pos_range[1]):
                        <span class="keyword">continue</span>

                <span class="comment"># æå‡å…³é”®è¯é¦–tokençš„æ¦‚ç‡</span>
                <span class="keyword">if</span> tokens:
                    logits[tokens[0]] += 5.0

            <span class="keyword">return</span> logits

    <span class="comment"># ========== 4. é£æ ¼è¿ç§» ==========</span>
    <span class="keyword">class</span> <span class="function">StyleTransfer</span>:
        <span class="string">"""
        æ–‡æœ¬é£æ ¼è¿ç§»æ§åˆ¶
        """</span>
        <span class="keyword">def</span> <span class="function">__init__</span>(self):
            <span class="comment"># é¢„å®šä¹‰çš„é£æ ¼å‘é‡</span>
            self.style_vectors = {
                <span class="string">'formal'</span>: {
                    <span class="string">'è¯æ±‡å¤æ‚åº¦'</span>: 0.8,
                    <span class="string">'å¥å­é•¿åº¦'</span>: 0.7,
                    <span class="string">'è¢«åŠ¨è¯­æ€'</span>: 0.6,
                    <span class="string">'ä¸“ä¸šæœ¯è¯­'</span>: 0.9
                },
                <span class="string">'casual'</span>: {
                    <span class="string">'è¯æ±‡å¤æ‚åº¦'</span>: 0.3,
                    <span class="string">'å¥å­é•¿åº¦'</span>: 0.4,
                    <span class="string">'å£è¯­åŒ–'</span>: 0.9,
                    <span class="string">'è¡¨æƒ…ç¬¦å·'</span>: 0.7
                },
                <span class="string">'poetic'</span>: {
                    <span class="string">'ä¿®è¾æ‰‹æ³•'</span>: 0.9,
                    <span class="string">'éŸµå¾‹æ„Ÿ'</span>: 0.8,
                    <span class="string">'æ„è±¡ä½¿ç”¨'</span>: 0.9,
                    <span class="string">'æƒ…æ„Ÿå¼ºåº¦'</span>: 0.8
                }
            }

        <span class="keyword">def</span> <span class="function">apply_style</span>(self, logits, style_name, vocabulary_stats):
            <span class="string">"""
            æ ¹æ®é£æ ¼è°ƒæ•´è¯æ±‡é€‰æ‹©
            """</span>
            <span class="keyword">if</span> style_name <span class="keyword">not</span> <span class="keyword">in</span> self.style_vectors:
                <span class="keyword">return</span> logits

            style = self.style_vectors[style_name]

            <span class="comment"># æ ¹æ®è¯æ±‡ç‰¹å¾è°ƒæ•´logits</span>
            <span class="keyword">for</span> token_id, token_stats <span class="keyword">in</span> vocabulary_stats.items():
                <span class="keyword">if</span> <span class="string">'è¯æ±‡å¤æ‚åº¦'</span> <span class="keyword">in</span> style:
                    <span class="comment"># å¤æ‚è¯æ±‡çš„è°ƒæ•´</span>
                    <span class="keyword">if</span> token_stats[<span class="string">'complexity'</span>] > 0.7:
                        logits[token_id] *= (1 + style[<span class="string">'è¯æ±‡å¤æ‚åº¦'</span>])
                    <span class="keyword">else</span>:
                        logits[token_id] *= (2 - style[<span class="string">'è¯æ±‡å¤æ‚åº¦'</span>])

                <span class="keyword">if</span> <span class="string">'å£è¯­åŒ–'</span> <span class="keyword">in</span> style <span class="keyword">and</span> token_stats.get(<span class="string">'colloquial'</span>, 0) > 0.5:
                    logits[token_id] *= (1 + style[<span class="string">'å£è¯­åŒ–'</span>])

            <span class="keyword">return</span> logits

<span class="comment"># ========== 5. ä¸»é¢˜å¼•å¯¼ ==========</span>
<span class="keyword">class</span> <span class="function">TopicGuidance</span>:
    <span class="string">"""
    ä¸»é¢˜å¼•å¯¼ç”Ÿæˆ
    """</span>
    <span class="keyword">def</span> <span class="function">__init__</span>(self, topic_model):
        self.topic_model = topic_model
        self.target_topic = None
        self.topic_words = {}

    <span class="keyword">def</span> <span class="function">set_topic</span>(self, topic_name, topic_words):
        <span class="string">"""è®¾ç½®ç›®æ ‡ä¸»é¢˜å’Œç›¸å…³è¯æ±‡"""</span>
        self.target_topic = topic_name
        self.topic_words = {
            word: score
            <span class="keyword">for</span> word, score <span class="keyword">in</span> topic_words
        }

    <span class="keyword">def</span> <span class="function">guide_generation</span>(self, logits, tokenizer):
        <span class="string">"""å¼•å¯¼ç”Ÿæˆæœå‘ç›®æ ‡ä¸»é¢˜"""</span>
        <span class="keyword">if</span> <span class="keyword">not</span> self.target_topic:
            <span class="keyword">return</span> logits

        <span class="comment"># å¯¹æ¯ä¸ªtokenè®¡ç®—ä¸»é¢˜ç›¸å…³æ€§</span>
        <span class="keyword">for</span> token_id <span class="keyword">in</span> range(len(logits)):
            token_text = tokenizer.decode([token_id])

            <span class="comment"># å¦‚æœæ˜¯ä¸»é¢˜ç›¸å…³è¯ï¼Œæå‡æ¦‚ç‡</span>
            <span class="keyword">if</span> token_text <span class="keyword">in</span> self.topic_words:
                boost = self.topic_words[token_text]
                logits[token_id] += boost * 2.0

        <span class="keyword">return</span> logits

<span class="comment"># ========== ä½¿ç”¨ç¤ºä¾‹ ==========</span>
<span class="keyword">def</span> <span class="function">controlled_generation_demo</span>():
    <span class="string">"""
    æ¼”ç¤ºå„ç§å¯æ§ç”ŸæˆæŠ€æœ¯
    """</span>
    <span class="comment"># åˆå§‹åŒ–ç»„ä»¶</span>
    generator = ControlledGenerator()
    style_transfer = generator.StyleTransfer()
    keyword_controller = generator.KeywordController(tokenizer)

    <span class="comment"># è®¾ç½®æ§åˆ¶å‚æ•°</span>
    style = <span class="string">'formal'</span>
    keywords = [<span class="string">'äººå·¥æ™ºèƒ½'</span>, <span class="string">'æœªæ¥'</span>, <span class="string">'å‘å±•'</span>]
    sentiment = <span class="string">'positive'</span>

    <span class="comment"># è®¾ç½®å…³é”®è¯</span>
    keyword_controller.set_keywords(
        keywords,
        positions={
            <span class="string">'äººå·¥æ™ºèƒ½'</span>: (0, 20),
            <span class="string">'æœªæ¥'</span>: (20, 40),
            <span class="string">'å‘å±•'</span>: (30, 50)
        }
    )

    <span class="comment"># ç”Ÿæˆæ–‡æœ¬</span>
    prompt = <span class="string">"æ¢è®¨ç§‘æŠ€çš„"</span>
    generated_text = prompt

    <span class="keyword">for</span> i <span class="keyword">in</span> range(100):
        <span class="comment"># è·å–logits</span>
        logits = get_model_logits(generated_text)

        <span class="comment"># åº”ç”¨å„ç§æ§åˆ¶</span>
        <span class="comment"># 1. é£æ ¼æ§åˆ¶</span>
        logits = style_transfer.apply_style(logits, style, vocab_stats)

        <span class="comment"># 2. å…³é”®è¯æ§åˆ¶</span>
        logits = keyword_controller.apply_keyword_boost(
            logits, i, generated_text
        )

        <span class="comment"># 3. æƒ…æ„Ÿæ§åˆ¶</span>
        <span class="keyword">if</span> sentiment == <span class="string">'positive'</span>:
            <span class="comment"># æå‡ç§¯æè¯æ±‡çš„æ¦‚ç‡</span>
            <span class="keyword">for</span> pos_word_id <span class="keyword">in</span> positive_word_ids:
                logits[pos_word_id] += 1.0

        <span class="comment"># é‡‡æ ·ä¸‹ä¸€ä¸ªè¯</span>
        next_token = sample_from_logits(logits)
        generated_text += tokenizer.decode([next_token])

        <span class="comment"># æ£€æŸ¥ç»“æŸæ¡ä»¶</span>
        <span class="keyword">if</span> next_token == eos_token_id:
            <span class="keyword">break</span>

    <span class="keyword">return</span> generated_text</pre>
                </div>
            </div>

            <div class="tip info mt-4">
                <span class="tip-icon">ğŸ¯</span>
                <strong>å¯æ§ç”Ÿæˆçš„åº”ç”¨</strong>
                <ul class="mt-2">
                    <li><strong>ä¸ªæ€§åŒ–å†™ä½œåŠ©æ‰‹ï¼š</strong>é€‚åº”ç”¨æˆ·çš„å†™ä½œé£æ ¼</li>
                    <li><strong>å“ç‰Œå†…å®¹ç”Ÿæˆï¼š</strong>ä¿æŒä¸€è‡´çš„å“ç‰Œè°ƒæ€§</li>
                    <li><strong>æ•™è‚²å†…å®¹é€‚é…ï¼š</strong>æ ¹æ®å­¦ç”Ÿæ°´å¹³è°ƒæ•´éš¾åº¦</li>
                    <li><strong>å¤šè¯­è¨€æœ¬åœ°åŒ–ï¼š</strong>è€ƒè™‘æ–‡åŒ–å·®å¼‚çš„ç¿»è¯‘</li>
                </ul>
            </div>
        </section>

        <!-- å¤šæ ·æ€§å¢å¼º -->
        <section id="diversity" class="section-card">
            <h2>ğŸŒˆ å¤šæ ·æ€§å¢å¼º</h2>

            <div class="story-card">
                <span class="story-icon">ğŸ¨</span>
                <p><strong>é¿å…åƒç¯‡ä¸€å¾‹</strong></p>
                <p class="mt-2">
                    å¦‚æœAIæ€»æ˜¯ç”Ÿæˆç›¸ä¼¼çš„å†…å®¹ï¼Œé‚£å°†å¤šä¹ˆæ— è¶£ï¼
                    è®©æˆ‘ä»¬æ¢ç´¢å¦‚ä½•è®©ç”Ÿæˆçš„æ–‡æœ¬å……æ»¡æƒŠå–œå’Œåˆ›æ„ã€‚
                </p>
            </div>

            <div class="comparison-grid">
                <div class="comparison-item bad">
                    <span class="comparison-label">ç¼ºä¹å¤šæ ·æ€§</span>
                    <h4>åŒä¸€æç¤ºï¼Œç›¸ä¼¼è¾“å‡º</h4>
                    <div class="generation-example mt-2">
                        <p><strong>æç¤ºï¼š</strong>å†™ä¸€ä¸ªå¼€å¤´</p>
                        <p><strong>è¾“å‡º1ï¼š</strong>ä»å‰æœ‰ä¸€ä¸ªå°æ‘åº„...</p>
                        <p><strong>è¾“å‡º2ï¼š</strong>ä»å‰æœ‰ä¸€ä¸ªå°é•‡...</p>
                        <p><strong>è¾“å‡º3ï¼š</strong>ä»å‰æœ‰ä¸€ä¸ªå°åŸå¸‚...</p>
                    </div>
                </div>

                <div class="comparison-item good">
                    <span class="comparison-label">å¯Œæœ‰å¤šæ ·æ€§</span>
                    <h4>åŒä¸€æç¤ºï¼Œå¤šæ ·è¾“å‡º</h4>
                    <div class="generation-example mt-2">
                        <p><strong>æç¤ºï¼š</strong>å†™ä¸€ä¸ªå¼€å¤´</p>
                        <p><strong>è¾“å‡º1ï¼š</strong>é›¨å¤œï¼Œå’–å•¡é¦†çš„é—¨é“ƒå“èµ·...</p>
                        <p><strong>è¾“å‡º2ï¼š</strong>"åˆ«åŠ¨ï¼"å£°éŸ³ä»é»‘æš—ä¸­ä¼ æ¥...</p>
                        <p><strong>è¾“å‡º3ï¼š</strong>å¥¹ä»æœªæƒ³è¿‡ä¼šåœ¨åœ°é“ç«™é‡è§ä»–...</p>
                    </div>
                </div>
            </div>

            <div class="card-grid mt-4">
                <div class="info-card">
                    <span class="card-icon">ğŸ²</span>
                    <h4 class="card-title">éšæœºæ€§æ³¨å…¥</h4>
                    <ul>
                        <li>æ¸©åº¦è°ƒèŠ‚</li>
                        <li>éšæœºç§å­å˜åŒ–</li>
                        <li>Dropoutå˜åŒ–</li>
                        <li>å™ªå£°æ·»åŠ </li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸŒŸ</span>
                    <h4 class="card-title">å¤šæ ·åŒ–è§£ç </h4>
                    <ul>
                        <li>å¤šæ ·æŸæœç´¢</li>
                        <li>ç¾¤ç»„å¤šæ ·æ€§å¥–åŠ±</li>
                        <li>æœ€å°ç›¸ä¼¼åº¦çº¦æŸ</li>
                        <li>ä¸»é¢˜åˆ†æ•£ç­–ç•¥</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ”„</span>
                    <h4 class="card-title">åå¤„ç†å¢å¼º</h4>
                    <ul>
                        <li>åŒä¹‰è¯æ›¿æ¢</li>
                        <li>å¥å¼å˜æ¢</li>
                        <li>æ®µè½é‡ç»„</li>
                        <li>é£æ ¼å˜åŒ–</li>
                    </ul>
                </div>
            </div>

            <div class="deep-think-box mt-4">
                <h4>å¤šæ ·æ€§ä¸è´¨é‡çš„å¹³è¡¡</h4>
                <div class="think-item">
                    <h5>âš–ï¸ æƒè¡¡è€ƒè™‘</h5>
                    <ul>
                        <li><strong>å¤ªå°‘å¤šæ ·æ€§ï¼š</strong>æ— èŠã€å¯é¢„æµ‹ã€ç¼ºä¹åˆ›æ„</li>
                        <li><strong>å¤ªå¤šå¤šæ ·æ€§ï¼š</strong>æ··ä¹±ã€ä¸è¿è´¯ã€è´¨é‡ä¸‹é™</li>
                        <li><strong>ç†æƒ³çŠ¶æ€ï¼š</strong>åœ¨ä¿è¯è´¨é‡çš„å‰æä¸‹æœ€å¤§åŒ–å¤šæ ·æ€§</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>ğŸ¯ åº”ç”¨åœºæ™¯</h5>
                    <ul>
                        <li><strong>åˆ›æ„å†™ä½œï¼š</strong>éœ€è¦é«˜å¤šæ ·æ€§</li>
                        <li><strong>æŠ€æœ¯æ–‡æ¡£ï¼š</strong>éœ€è¦ä½å¤šæ ·æ€§</li>
                        <li><strong>å¯¹è¯ç³»ç»Ÿï¼š</strong>éœ€è¦é€‚åº¦å¤šæ ·æ€§</li>
                        <li><strong>æ–°é—»ç”Ÿæˆï¼š</strong>éœ€è¦äº‹å®å‡†ç¡®æ€§</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- è¯„ä¼°æ–¹æ³• -->
        <section id="evaluation" class="section-card">
            <h2>ğŸ“Š è¯„ä¼°æ–¹æ³•</h2>

            <div class="story-card">
                <span class="story-icon">ğŸ“</span>
                <p><strong>å¦‚ä½•è¡¡é‡"å¥½"æ–‡æœ¬ï¼Ÿ</strong></p>
                <p class="mt-2">
                    è¯„ä¼°ç”Ÿæˆæ–‡æœ¬çš„è´¨é‡å°±åƒå“è¯„ç¾é£Ÿâ€”â€”æ—¢æœ‰å®¢è§‚æ ‡å‡†ï¼Œä¹Ÿæœ‰ä¸»è§‚æ„Ÿå—ã€‚
                    è®©æˆ‘ä»¬äº†è§£å¦‚ä½•å…¨é¢è¯„ä¼°æ–‡æœ¬ç”Ÿæˆç³»ç»Ÿã€‚
                </p>
            </div>

            <div class="comparison-table">
                <table>
                    <thead>
                    <tr>
                        <th>è¯„ä¼°ç»´åº¦</th>
                        <th>è‡ªåŠ¨æŒ‡æ ‡</th>
                        <th>äººå·¥è¯„ä¼°</th>
                        <th>é€‚ç”¨åœºæ™¯</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>æµç•…æ€§</td>
                        <td>å›°æƒ‘åº¦(PPL)</td>
                        <td>è¯­æ³•æ­£ç¡®æ€§è¯„åˆ†</td>
                        <td>æ‰€æœ‰ç”Ÿæˆä»»åŠ¡</td>
                    </tr>
                    <tr>
                        <td>ç›¸å…³æ€§</td>
                        <td>BLEU, ROUGE</td>
                        <td>ä¸»é¢˜ç›¸å…³åº¦è¯„åˆ†</td>
                        <td>æœ‰å‚è€ƒæ–‡æœ¬æ—¶</td>
                    </tr>
                    <tr>
                        <td>å¤šæ ·æ€§</td>
                        <td>Distinct-n, Self-BLEU</td>
                        <td>åˆ›æ–°æ€§è¯„åˆ†</td>
                        <td>åˆ›æ„å†™ä½œ</td>
                    </tr>
                    <tr>
                        <td>è¿è´¯æ€§</td>
                        <td>BERTScore</td>
                        <td>é€»è¾‘è¿è´¯æ€§è¯„åˆ†</td>
                        <td>é•¿æ–‡æœ¬ç”Ÿæˆ</td>
                    </tr>
                    <tr>
                        <td>çœŸå®æ€§</td>
                        <td>äº‹å®éªŒè¯æ¨¡å‹</td>
                        <td>äº‹å®å‡†ç¡®æ€§æ£€æŸ¥</td>
                        <td>çŸ¥è¯†å¯†é›†å‹ä»»åŠ¡</td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <div class="code-block mt-4">
                <div class="code-header">
                    <span class="code-lang">Python - è¯„ä¼°æŒ‡æ ‡å®ç°</span>
                    <div class="code-actions">
                        <button class="code-btn" onclick="toggleCode(this)">å±•å¼€</button>
                        <button class="code-btn" onclick="copyCode(this)">å¤åˆ¶</button>
                    </div>
                </div>
                <div class="code-content collapsed">
                    <pre><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> collections <span class="keyword">import</span> Counter
<span class="keyword">from</span> nltk.translate.bleu_score <span class="keyword">import</span> sentence_bleu
<span class="keyword">import</span> torch

<span class="keyword">class</span> <span class="function">GenerationMetrics</span>:
    <span class="string">"""
    æ–‡æœ¬ç”Ÿæˆè¯„ä¼°æŒ‡æ ‡é›†åˆ
    """</span>

    <span class="comment"># ========== æµç•…æ€§æŒ‡æ ‡ ==========</span>
    @staticmethod
    <span class="keyword">def</span> <span class="function">perplexity</span>(model, tokenizer, text):
        <span class="string">"""
        è®¡ç®—å›°æƒ‘åº¦ï¼šè¡¡é‡æ¨¡å‹å¯¹æ–‡æœ¬çš„"æƒŠè®¶"ç¨‹åº¦
        """</span>
        inputs = tokenizer(text, return_tensors=<span class="string">'pt'</span>)

        <span class="keyword">with</span> torch.no_grad():
            outputs = model(**inputs, labels=inputs[<span class="string">'input_ids'</span>])
            loss = outputs.loss

        <span class="comment"># å›°æƒ‘åº¦ = exp(loss)</span>
        ppl = torch.exp(loss)
        <span class="keyword">return</span> ppl.item()

    <span class="comment"># ========== ç›¸å…³æ€§æŒ‡æ ‡ ==========</span>
    @staticmethod
    <span class="keyword">def</span> <span class="function">bleu_score</span>(generated, reference, n_gram=4):
        <span class="string">"""
        BLEUåˆ†æ•°ï¼šè¡¡é‡ç”Ÿæˆæ–‡æœ¬ä¸å‚è€ƒæ–‡æœ¬çš„ç›¸ä¼¼åº¦
        """</span>
        <span class="comment"># åˆ†è¯</span>
        gen_tokens = generated.split()
        ref_tokens = reference.split()

        <span class="comment"># è®¡ç®—ä¸åŒn-gramçš„æƒé‡</span>
        weights = tuple([1.0/n_gram] * n_gram)

        score = sentence_bleu([ref_tokens], gen_tokens, weights=weights)
        <span class="keyword">return</span> score

    @staticmethod
    <span class="keyword">def</span> <span class="function">rouge_score</span>(generated, reference):
        <span class="string">"""
        ROUGEåˆ†æ•°ï¼šå¬å›ç‡å¯¼å‘çš„è¯„ä¼°
        """</span>
        gen_tokens = set(generated.split())
        ref_tokens = set(reference.split())

        <span class="comment"># ROUGE-1 (unigram)</span>
        overlap = gen_tokens & ref_tokens
        <span class="keyword">if</span> <span class="keyword">not</span> ref_tokens:
            <span class="keyword">return</span> 0

        precision = len(overlap) / len(gen_tokens) <span class="keyword">if</span> gen_tokens <span class="keyword">else</span> 0
        recall = len(overlap) / len(ref_tokens)

        <span class="keyword">if</span> precision + recall == 0:
            <span class="keyword">return</span> 0

        f1 = 2 * (precision * recall) / (precision + recall)
        <span class="keyword">return</span> f1

    <span class="comment"># ========== å¤šæ ·æ€§æŒ‡æ ‡ ==========</span>
    @staticmethod
    <span class="keyword">def</span> <span class="function">distinct_n</span>(texts, n=2):
        <span class="string">"""
        Distinct-nï¼šè¡¡é‡ç”Ÿæˆæ–‡æœ¬ä¸­ä¸åŒn-gramçš„æ¯”ä¾‹
        """</span>
        all_ngrams = []

        <span class="keyword">for</span> text <span class="keyword">in</span> texts:
            tokens = text.split()
            ngrams = [
                tuple(tokens[i:i+n])
                <span class="keyword">for</span> i <span class="keyword">in</span> range(len(tokens)-n+1)
            ]
            all_ngrams.extend(ngrams)

        <span class="keyword">if</span> <span class="keyword">not</span> all_ngrams:
            <span class="keyword">return</span> 0

        unique_ngrams = set(all_ngrams)
        distinct_score = len(unique_ngrams) / len(all_ngrams)

        <span class="keyword">return</span> distinct_score

    @staticmethod
    <span class="keyword">def</span> <span class="function">self_bleu</span>(texts, n_sample=1000):
        <span class="string">"""
        Self-BLEUï¼šè¡¡é‡ç”Ÿæˆæ–‡æœ¬ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼ˆè¶Šä½è¶Šå¤šæ ·ï¼‰
        """</span>
        <span class="keyword">if</span> len(texts) < 2:
            <span class="keyword">return</span> 0

        scores = []
        <span class="keyword">for</span> i <span class="keyword">in</span> range(min(n_sample, len(texts))):
            <span class="comment"># è®¡ç®—æ¯ä¸ªæ–‡æœ¬ä¸å…¶ä»–æ–‡æœ¬çš„BLEU</span>
            hypothesis = texts[i]
            references = texts[:i] + texts[i+1:]

            <span class="comment"># éšæœºé€‰æ‹©ä¸€ä¸ªå‚è€ƒ</span>
            <span class="keyword">if</span> references:
                ref_idx = np.random.randint(len(references))
                score = GenerationMetrics.bleu_score(
                    hypothesis, references[ref_idx]
                )
                scores.append(score)

        <span class="keyword">return</span> np.mean(scores) <span class="keyword">if</span> scores <span class="keyword">else</span> 0

    <span class="comment"># ========== è¯­ä¹‰ç›¸ä¼¼åº¦ ==========</span>
    @staticmethod
    <span class="keyword">def</span> <span class="function">bert_score</span>(generated, reference, bert_model, bert_tokenizer):
        <span class="string">"""
        BERTScoreï¼šåŸºäºBERTåµŒå…¥çš„è¯­ä¹‰ç›¸ä¼¼åº¦
        """</span>
        <span class="comment"># ç¼–ç æ–‡æœ¬</span>
        gen_inputs = bert_tokenizer(
            generated, return_tensors=<span class="string">'pt'</span>,
            truncation=True, padding=True
        )
        ref_inputs = bert_tokenizer(
            reference, return_tensors=<span class="string">'pt'</span>,
            truncation=True, padding=True
        )

        <span class="keyword">with</span> torch.no_grad():
            gen_outputs = bert_model(**gen_inputs)
            ref_outputs = bert_model(**ref_inputs)

            <span class="comment"># ä½¿ç”¨æœ€åä¸€å±‚çš„è¾“å‡º</span>
            gen_embeddings = gen_outputs.last_hidden_state.mean(dim=1)
            ref_embeddings = ref_outputs.last_hidden_state.mean(dim=1)

            <span class="comment"># è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦</span>
            similarity = F.cosine_similarity(
                gen_embeddings, ref_embeddings
            )

        <span class="keyword">return</span> similarity.item()

    <span class="comment"># ========== ç»¼åˆè¯„ä¼° ==========</span>
    @staticmethod
    <span class="keyword">def</span> <span class="function">comprehensive_evaluation</span>(generated_texts, reference_texts=None,
                                     model=None, tokenizer=None):
        <span class="string">"""
        ç»¼åˆè¯„ä¼°ç”Ÿæˆæ–‡æœ¬è´¨é‡
        """</span>
        results = {}

        <span class="comment"># 1. å¤šæ ·æ€§è¯„ä¼°</span>
        results[<span class="string">'distinct_1'</span>] = GenerationMetrics.distinct_n(generated_texts, 1)
        results[<span class="string">'distinct_2'</span>] = GenerationMetrics.distinct_n(generated_texts, 2)
        results[<span class="string">'self_bleu'</span>] = GenerationMetrics.self_bleu(generated_texts)

        <span class="comment"># 2. å¦‚æœæœ‰å‚è€ƒæ–‡æœ¬ï¼Œè®¡ç®—ç›¸å…³æ€§</span>
        <span class="keyword">if</span> reference_texts:
            bleu_scores = []
            rouge_scores = []

            <span class="keyword">for</span> gen, ref <span class="keyword">in</span> zip(generated_texts, reference_texts):
                bleu_scores.append(
                    GenerationMetrics.bleu_score(gen, ref)
                )
                rouge_scores.append(
                    GenerationMetrics.rouge_score(gen, ref)
                )

            results[<span class="string">'avg_bleu'</span>] = np.mean(bleu_scores)
            results[<span class="string">'avg_rouge'</span>] = np.mean(rouge_scores)

        <span class="comment"># 3. å¦‚æœæœ‰æ¨¡å‹ï¼Œè®¡ç®—å›°æƒ‘åº¦</span>
        <span class="keyword">if</span> model <span class="keyword">and</span> tokenizer:
            ppl_scores = []
            <span class="keyword">for</span> text <span class="keyword">in</span> generated_texts[:100]:  <span class="comment"># é‡‡æ ·è®¡ç®—</span>
                ppl = GenerationMetrics.perplexity(model, tokenizer, text)
                ppl_scores.append(ppl)

            results[<span class="string">'avg_perplexity'</span>] = np.mean(ppl_scores)

        <span class="keyword">return</span> results

<span class="comment"># ========== äººå·¥è¯„ä¼°æ¡†æ¶ ==========</span>
<span class="keyword">class</span> <span class="function">HumanEvaluation</span>:
    <span class="string">"""
    äººå·¥è¯„ä¼°æ¡†æ¶
    """</span>
    <span class="keyword">def</span> <span class="function">__init__</span>(self):
        self.criteria = {
            <span class="string">'fluency'</span>: <span class="string">'æ–‡æœ¬æ˜¯å¦æµç•…è‡ªç„¶ï¼Ÿ(1-5åˆ†)'</span>,
            <span class="string">'coherence'</span>: <span class="string">'æ–‡æœ¬æ˜¯å¦é€»è¾‘è¿è´¯ï¼Ÿ(1-5åˆ†)'</span>,
            <span class="string">'relevance'</span>: <span class="string">'æ–‡æœ¬æ˜¯å¦åˆ‡é¢˜ç›¸å…³ï¼Ÿ(1-5åˆ†)'</span>,
            <span class="string">'creativity'</span>: <span class="string">'æ–‡æœ¬æ˜¯å¦æœ‰åˆ›æ„ï¼Ÿ(1-5åˆ†)'</span>,
            <span class="string">'overall'</span>: <span class="string">'æ€»ä½“è´¨é‡å¦‚ä½•ï¼Ÿ(1-5åˆ†)'</span>
        }

    <span class="keyword">def</span> <span class="function">create_evaluation_form</span>(self, text, context=None):
        <span class="string">"""
        åˆ›å»ºè¯„ä¼°è¡¨å•
        """</span>
        form = {
            <span class="string">'text'</span>: text,
            <span class="string">'context'</span>: context,
            <span class="string">'scores'</span>: {},
            <span class="string">'comments'</span>: <span class="string">''</span>
        }

        print(<span class="string">"è¯·è¯„ä¼°ä»¥ä¸‹ç”Ÿæˆæ–‡æœ¬ï¼š"</span>)
        print(<span class="string">"-"</span> * 50)
        <span class="keyword">if</span> context:
            print(<span class="string">f"ä¸Šä¸‹æ–‡: {context}"</span>)
        print(<span class="string">f"ç”Ÿæˆæ–‡æœ¬: {text}"</span>)
        print(<span class="string">"-"</span> * 50)

        <span class="keyword">for</span> criterion, prompt <span class="keyword">in</span> self.criteria.items():
            score = input(<span class="string">f"{prompt}: "</span>)
            form[<span class="string">'scores'</span>][criterion] = int(score)

        form[<span class="string">'comments'</span>] = input(<span class="string">"å…¶ä»–è¯„è®º: "</span>)

        <span class="keyword">return</span> form</pre>
                </div>
            </div>

            <div class="tip warning mt-4">
                <span class="tip-icon">âš ï¸</span>
                <strong>è¯„ä¼°çš„å±€é™æ€§</strong>
                <ul class="mt-2">
                    <li>è‡ªåŠ¨æŒ‡æ ‡å¯èƒ½ä¸äººç±»åˆ¤æ–­ä¸ä¸€è‡´</li>
                    <li>äººå·¥è¯„ä¼°æˆæœ¬é«˜ä¸”ä¸»è§‚</li>
                    <li>æ²¡æœ‰å•ä¸€æŒ‡æ ‡èƒ½å…¨é¢è¡¡é‡è´¨é‡</li>
                    <li>éœ€è¦æ ¹æ®å…·ä½“ä»»åŠ¡é€‰æ‹©åˆé€‚çš„è¯„ä¼°æ–¹æ³•</li>
                </ul>
            </div>
        </section>

        <!-- å®é™…åº”ç”¨ -->
        <section id="applications" class="section-card">
            <h2>ğŸ’¼ å®é™…åº”ç”¨</h2>

            <div class="story-card">
                <span class="story-icon">ğŸŒ</span>
                <p><strong>æ”¹å˜ä¸–ç•Œçš„æ–‡æœ¬ç”Ÿæˆ</strong></p>
                <p class="mt-2">
                    ä»æ™ºèƒ½å†™ä½œåŠ©æ‰‹åˆ°ä¸ªæ€§åŒ–å†…å®¹æ¨èï¼Œæ–‡æœ¬ç”ŸæˆæŠ€æœ¯æ­£åœ¨å„ä¸ªé¢†åŸŸå‘æŒ¥ä½œç”¨ã€‚
                    è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›æŠ€æœ¯å¦‚ä½•è½åœ°åº”ç”¨ã€‚
                </p>
            </div>

            <div class="card-grid">
                <div class="info-card">
                    <span class="card-icon">âœï¸</span>
                    <h4 class="card-title">å†…å®¹åˆ›ä½œ</h4>
                    <ul>
                        <li>æ–°é—»ç¨¿è‡ªåŠ¨ç”Ÿæˆ</li>
                        <li>è¥é”€æ–‡æ¡ˆåˆ›ä½œ</li>
                        <li>å°è¯´æ•…äº‹ç»­å†™</li>
                        <li>è¯—æ­Œæ­Œè¯åˆ›ä½œ</li>
                    </ul>
                    <p class="mt-2 text-muted">æ¡ˆä¾‹ï¼šAIè®°è€…æ¯å¤©ç”Ÿæˆæ•°åƒç¯‡è´¢ç»æ–°é—»</p>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ’¬</span>
                    <h4 class="card-title">å¯¹è¯ç³»ç»Ÿ</h4>
                    <ul>
                        <li>æ™ºèƒ½å®¢æœ</li>
                        <li>è™šæ‹ŸåŠ©æ‰‹</li>
                        <li>èŠå¤©æœºå™¨äºº</li>
                        <li>å¿ƒç†å’¨è¯¢åŠ©æ‰‹</li>
                    </ul>
                    <p class="mt-2 text-muted">æ¡ˆä¾‹ï¼šChatGPTæ”¹å˜äººæœºäº¤äº’æ–¹å¼</p>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ“</span>
                    <h4 class="card-title">æ•™è‚²è¾…åŠ©</h4>
                    <ul>
                        <li>ä¸ªæ€§åŒ–é¢˜ç›®ç”Ÿæˆ</li>
                        <li>ä½œæ–‡æ‰¹æ”¹å»ºè®®</li>
                        <li>çŸ¥è¯†ç‚¹è§£é‡Š</li>
                        <li>å­¦ä¹ ææ–™æ”¹å†™</li>
                    </ul>
                    <p class="mt-2 text-muted">æ¡ˆä¾‹ï¼šAIåŠ©æ•™å¸®åŠ©å­¦ç”Ÿæé«˜å†™ä½œæ°´å¹³</p>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ’»</span>
                    <h4 class="card-title">ä»£ç ç”Ÿæˆ</h4>
                    <ul>
                        <li>ä»£ç è‡ªåŠ¨è¡¥å…¨</li>
                        <li>æ³¨é‡Šç”Ÿæˆ</li>
                        <li>æ–‡æ¡£ç¼–å†™</li>
                        <li>æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ</li>
                    </ul>
                    <p class="mt-2 text-muted">æ¡ˆä¾‹ï¼šGitHub Copilotæå‡ç¼–ç¨‹æ•ˆç‡</p>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸŒ</span>
                    <h4 class="card-title">å¤šè¯­è¨€åº”ç”¨</h4>
                    <ul>
                        <li>æœºå™¨ç¿»è¯‘</li>
                        <li>è·¨è¯­è¨€æ‘˜è¦</li>
                        <li>æœ¬åœ°åŒ–æ”¹å†™</li>
                        <li>è¯­è¨€é£æ ¼è½¬æ¢</li>
                    </ul>
                    <p class="mt-2 text-muted">æ¡ˆä¾‹ï¼šå®æ—¶ç¿»è¯‘æ‰“ç ´è¯­è¨€éšœç¢</p>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ®</span>
                    <h4 class="card-title">å¨±ä¹æ¸¸æˆ</h4>
                    <ul>
                        <li>æ¸¸æˆå‰§æƒ…ç”Ÿæˆ</li>
                        <li>NPCå¯¹è¯</li>
                        <li>äº’åŠ¨å°è¯´</li>
                        <li>è§’è‰²èƒŒæ™¯æ•…äº‹</li>
                    </ul>
                    <p class="mt-2 text-muted">æ¡ˆä¾‹ï¼šAI Dungeonåˆ›é€ æ— é™å‰§æƒ…</p>
                </div>
            </div>

            <div class="deep-think-box mt-4">
                <h4>æˆåŠŸæ¡ˆä¾‹åˆ†æ</h4>
                <div class="think-item">
                    <h5>ğŸ“° å½­åšç¤¾çš„Cyborgè®°è€…</h5>
                    <ul>
                        <li><strong>åº”ç”¨ï¼š</strong>è‡ªåŠ¨ç”Ÿæˆè´¢æŠ¥æ–°é—»</li>
                        <li><strong>æŠ€æœ¯ï¼š</strong>æ¨¡æ¿+æ•°æ®é©±åŠ¨ç”Ÿæˆ</li>
                        <li><strong>æ•ˆæœï¼š</strong>é€Ÿåº¦æå‡1000å€ï¼Œå‡†ç¡®ç‡99%</li>
                        <li><strong>å¯ç¤ºï¼š</strong>åœ¨ç»“æ„åŒ–åœºæ™¯ä¸­AIå¯ä»¥è¶…è¶Šäººç±»</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>ğŸ¤– ChatGPTçš„çªç ´</h5>
                    <ul>
                        <li><strong>åº”ç”¨ï¼š</strong>é€šç”¨å¯¹è¯åŠ©æ‰‹</li>
                        <li><strong>æŠ€æœ¯ï¼š</strong>å¤§è§„æ¨¡é¢„è®­ç»ƒ+RLHF</li>
                        <li><strong>æ•ˆæœï¼š</strong>1äº¿ç”¨æˆ·ï¼Œæ”¹å˜å·¥ä½œæ–¹å¼</li>
                        <li><strong>å¯ç¤ºï¼š</strong>ç”¨æˆ·ä½“éªŒæ˜¯æˆåŠŸçš„å…³é”®</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- æœ€ä½³å®è·µ -->
        <section id="best-practices" class="section-card">
            <h2>ğŸ¯ æœ€ä½³å®è·µ</h2>

            <div class="story-card">
                <span class="story-icon">ğŸ†</span>
                <p><strong>ä»ç»éªŒä¸­å­¦ä¹ </strong></p>
                <p class="mt-2">
                    æˆåŠŸçš„æ–‡æœ¬ç”Ÿæˆç³»ç»Ÿä¸æ˜¯ä¸€è¹´è€Œå°±çš„ã€‚
                    è¿™é‡Œæ±‡é›†äº†ä¸šç•Œçš„æœ€ä½³å®è·µï¼Œå¸®ä½ é¿å¼€å¸¸è§é™·é˜±ã€‚
                </p>
            </div>

            <div class="deep-think-box">
                <h4>è®¾è®¡åŸåˆ™</h4>
                <div class="think-item">
                    <h5>ğŸ‘¤ ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒ</h5>
                    <ul>
                        <li>ç†è§£ç”¨æˆ·çš„çœŸå®éœ€æ±‚</li>
                        <li>æä¾›å¯æ§çš„ç”Ÿæˆé€‰é¡¹</li>
                        <li>ä¿æŒè¾“å‡ºçš„å¯é¢„æµ‹æ€§</li>
                        <li>æ”¯æŒè¿­ä»£å¼æ”¹è¿›</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>ğŸ›¡ï¸ å®‰å…¨ç¬¬ä¸€</h5>
                    <ul>
                        <li>å†…å®¹è¿‡æ»¤å’Œå®¡æ ¸</li>
                        <li>é¿å…æœ‰å®³è¾“å‡º</li>
                        <li>ä¿æŠ¤ç”¨æˆ·éšç§</li>
                        <li>è´Ÿè´£ä»»çš„AIä½¿ç”¨</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>âš¡ æ€§èƒ½ä¼˜åŒ–</h5>
                    <ul>
                        <li>ç¼“å­˜å¸¸è§è¯·æ±‚</li>
                        <li>æ‰¹å¤„ç†ä¼˜åŒ–</li>
                        <li>æ¨¡å‹é‡åŒ–å‹ç¼©</li>
                        <li>è¾¹ç¼˜éƒ¨ç½²è€ƒè™‘</li>
                    </ul>
                </div>
            </div>

            <div class="comparison-table mt-4">
                <table>
                    <thead>
                    <tr>
                        <th>é˜¶æ®µ</th>
                        <th>å…³é”®ä»»åŠ¡</th>
                        <th>å¸¸è§é”™è¯¯</th>
                        <th>æœ€ä½³å®è·µ</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>éœ€æ±‚åˆ†æ</td>
                        <td>å®šä¹‰ç”Ÿæˆç›®æ ‡</td>
                        <td>ç›®æ ‡æ¨¡ç³Šä¸æ¸…</td>
                        <td>æ˜ç¡®è´¨é‡æŒ‡æ ‡å’Œçº¦æŸ</td>
                    </tr>
                    <tr>
                        <td>æ¨¡å‹é€‰æ‹©</td>
                        <td>é€‰æ‹©åˆé€‚æ¨¡å‹</td>
                        <td>ç›²ç›®è¿½æ±‚æœ€å¤§æ¨¡å‹</td>
                        <td>æ ¹æ®éœ€æ±‚å’Œèµ„æºå¹³è¡¡</td>
                    </tr>
                    <tr>
                        <td>æ•°æ®å‡†å¤‡</td>
                        <td>æ”¶é›†è®­ç»ƒæ•°æ®</td>
                        <td>æ•°æ®è´¨é‡ä¸é«˜</td>
                        <td>æ³¨é‡æ•°æ®æ¸…æ´—å’Œæ ‡æ³¨</td>
                    </tr>
                    <tr>
                        <td>è®­ç»ƒä¼˜åŒ–</td>
                        <td>å¾®è°ƒæ¨¡å‹</td>
                        <td>è¿‡åº¦æ‹Ÿåˆ</td>
                        <td>åˆç†çš„æ­£åˆ™åŒ–å’ŒéªŒè¯</td>
                    </tr>
                    <tr>
                        <td>éƒ¨ç½²ä¸Šçº¿</td>
                        <td>ç³»ç»Ÿé›†æˆ</td>
                        <td>å¿½è§†è¾¹ç¼˜æƒ…å†µ</td>
                        <td>å……åˆ†çš„æµ‹è¯•å’Œç›‘æ§</td>
                    </tr>
                    <tr>
                        <td>æŒç»­æ”¹è¿›</td>
                        <td>æ”¶é›†åé¦ˆ</td>
                        <td>å¿½è§†ç”¨æˆ·åé¦ˆ</td>
                        <td>å»ºç«‹åé¦ˆå¾ªç¯æœºåˆ¶</td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <div class="tip success mt-4">
                <span class="tip-icon">âœ…</span>
                <strong>é»„é‡‘æ³•åˆ™</strong>
                <ol class="mt-2">
                    <li><strong>ä»ç®€å•å¼€å§‹ï¼š</strong>å…ˆå®ç°åŸºç¡€åŠŸèƒ½ï¼Œå†é€æ­¥ä¼˜åŒ–</li>
                    <li><strong>å¿«é€Ÿè¿­ä»£ï¼š</strong>å°æ­¥å¿«è·‘ï¼ŒæŒç»­æ”¹è¿›</li>
                    <li><strong>æ•°æ®é©±åŠ¨ï¼š</strong>ç”¨æ•°æ®è¯´è¯ï¼Œä¸è¦é çŒœæµ‹</li>
                    <li><strong>ç”¨æˆ·åé¦ˆï¼š</strong>çœŸå®ç”¨æˆ·çš„æ„è§æœ€å®è´µ</li>
                    <li><strong>ä¿æŒè°¦é€Šï¼š</strong>AIä¸æ˜¯ä¸‡èƒ½çš„ï¼Œè¦è¯šå®é¢å¯¹å±€é™</li>
                </ol>
            </div>
        </section>

        <!-- æœ¬ç« æ€»ç»“ -->
        <section id="summary" class="section-card">
            <h2>ğŸ“š æœ¬ç« æ€»ç»“</h2>

            <div class="story-card">
                <span class="story-icon">ğŸ“</span>
                <p><strong>æŒæ¡æ–‡æœ¬ç”Ÿæˆçš„ç²¾é«“</strong></p>
                <p class="mt-2">
                    ç»è¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œä½ å·²ç»äº†è§£äº†æ–‡æœ¬ç”ŸæˆæŠ€æœ¯çš„æ–¹æ–¹é¢é¢ã€‚
                    è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹å…³é”®è¦ç‚¹ï¼Œä¸ºä½ çš„å®è·µä¹‹è·¯åšå¥½å‡†å¤‡ã€‚
                </p>
            </div>

            <div class="deep-think-box">
                <h4>æ ¸å¿ƒçŸ¥è¯†ç‚¹</h4>
                <div class="think-item">
                    <h5>ğŸ”‘ å…³é”®æ¦‚å¿µ</h5>
                    <ul>
                        <li><strong>è¯­è¨€æ¨¡å‹ï¼š</strong>æ–‡æœ¬ç”Ÿæˆçš„åŸºç¡€</li>
                        <li><strong>è§£ç ç­–ç•¥ï¼š</strong>ä»æ¦‚ç‡åˆ°æ–‡æœ¬çš„æ¡¥æ¢</li>
                        <li><strong>è´¨é‡é—®é¢˜ï¼š</strong>é‡å¤ã€ä¸è¿è´¯ã€å¤±æ§</li>
                        <li><strong>æ”¹è¿›æŠ€æœ¯ï¼š</strong>å¤šæ ·æ€§ã€è¿è´¯æ€§ã€å¯æ§æ€§</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>ğŸ’¡ æ ¸å¿ƒæŠ€æœ¯</h5>
                    <ul>
                        <li><strong>æ¸©åº¦æ§åˆ¶ï¼š</strong>å¹³è¡¡ç¡®å®šæ€§å’Œåˆ›é€ æ€§</li>
                        <li><strong>é‡‡æ ·æ–¹æ³•ï¼š</strong>Top-kã€Top-pã€æŸæœç´¢</li>
                        <li><strong>é‡å¤æ§åˆ¶ï¼š</strong>æƒ©ç½šæœºåˆ¶å’Œçº¦æŸ</li>
                        <li><strong>å¯æ§ç”Ÿæˆï¼š</strong>é£æ ¼ã€ä¸»é¢˜ã€å±æ€§æ§åˆ¶</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>ğŸ¯ å®è·µè¦ç‚¹</h5>
                    <ul>
                        <li><strong>åœºæ™¯é€‚é…ï¼š</strong>ä¸åŒä»»åŠ¡éœ€è¦ä¸åŒç­–ç•¥</li>
                        <li><strong>è´¨é‡è¯„ä¼°ï¼š</strong>è‡ªåŠ¨æŒ‡æ ‡+äººå·¥è¯„ä¼°</li>
                        <li><strong>æŒç»­ä¼˜åŒ–ï¼š</strong>åŸºäºåé¦ˆä¸æ–­æ”¹è¿›</li>
                        <li><strong>å®‰å…¨è€ƒè™‘ï¼š</strong>å†…å®¹å®¡æ ¸å’Œé£é™©æ§åˆ¶</li>
                    </ul>
                </div>
            </div>

            <div class="param-display mt-4">
                <div class="param-item">
                    <span class="param-value">10+</span>
                    <span class="param-label">è§£ç ç­–ç•¥</span>
                </div>
                <div class="param-item">
                    <span class="param-value">5</span>
                    <span class="param-label">è´¨é‡ç»´åº¦</span>
                </div>
                <div class="param-item">
                    <span class="param-value">20+</span>
                    <span class="param-label">æ”¹è¿›æŠ€æœ¯</span>
                </div>
                <div class="param-item">
                    <span class="param-value">âˆ</span>
                    <span class="param-label">åº”ç”¨å¯èƒ½</span>
                </div>
            </div>

            <div class="tip info mt-4">
                <span class="tip-icon">ğŸš€</span>
                <strong>ä¸‹ä¸€æ­¥è¡ŒåŠ¨</strong>
                <ol class="mt-2">
                    <li>é€‰æ‹©ä¸€ä¸ªå…·ä½“çš„åº”ç”¨åœºæ™¯</li>
                    <li>å®ç°åŸºç¡€çš„ç”Ÿæˆç³»ç»Ÿ</li>
                    <li>é€æ­¥åº”ç”¨æ”¹è¿›æŠ€æœ¯</li>
                    <li>å»ºç«‹è¯„ä¼°å’Œåé¦ˆæœºåˆ¶</li>
                    <li>æŒç»­è¿­ä»£ä¼˜åŒ–</li>
                </ol>
            </div>
        </section>

        <!-- æœªæ¥å±•æœ› -->
        <section id="future" class="section-card">
            <h2>ğŸ”® æœªæ¥å±•æœ›</h2>

            <div class="story-card">
                <span class="story-icon">ğŸŒŸ</span>
                <p><strong>æ–‡æœ¬ç”Ÿæˆçš„æ˜å¤©</strong></p>
                <p class="mt-2">
                    æŠ€æœ¯åœ¨é£é€Ÿå‘å±•ï¼Œæ–‡æœ¬ç”Ÿæˆçš„æœªæ¥å……æ»¡æ— é™å¯èƒ½ã€‚
                    è®©æˆ‘ä»¬ä¸€èµ·å±•æœ›è¿™ä¸ªæ¿€åŠ¨äººå¿ƒçš„æœªæ¥ã€‚
                </p>
            </div>

            <div class="card-grid">
                <div class="info-card">
                    <span class="card-icon">ğŸ§ </span>
                    <h4 class="card-title">æ›´æ™ºèƒ½</h4>
                    <ul>
                        <li>æ·±åº¦ç†è§£ç”¨æˆ·æ„å›¾</li>
                        <li>é•¿ç¨‹è®°å¿†å’Œæ¨ç†</li>
                        <li>å¤šè½®å¯¹è¯çš„è¿è´¯æ€§</li>
                        <li>è‡ªä¸»å­¦ä¹ å’Œé€‚åº”</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ¨</span>
                    <h4 class="card-title">æ›´åˆ›æ„</h4>
                    <ul>
                        <li>çœŸæ­£çš„åˆ›é€ æ€§å†™ä½œ</li>
                        <li>ä¸ªæ€§åŒ–é£æ ¼æ¨¡ä»¿</li>
                        <li>è·¨é¢†åŸŸçŸ¥è¯†èåˆ</li>
                        <li>æƒ…æ„Ÿå’Œå¹½é»˜ç†è§£</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸŒ</span>
                    <h4 class="card-title">æ›´æ™®åŠ</h4>
                    <ul>
                        <li>ç«¯ä¾§éƒ¨ç½²æ™®åŠ</li>
                        <li>ä½èµ„æºè¯­è¨€æ”¯æŒ</li>
                        <li>ä¸ªäººAIå†™ä½œåŠ©æ‰‹</li>
                        <li>æ— ç¼äººæœºåä½œ</li>
                    </ul>
                </div>
            </div>

            <div class="deep-think-box mt-4">
                <h4>æŠ€æœ¯è¶‹åŠ¿</h4>
                <div class="think-item">
                    <h5>ğŸ”¬ ç ”ç©¶å‰æ²¿</h5>
                    <ul>
                        <li><strong>æ•ˆç‡æå‡ï¼š</strong>æ›´å°æ›´å¿«çš„æ¨¡å‹</li>
                        <li><strong>å¯è§£é‡Šæ€§ï¼š</strong>ç†è§£ç”Ÿæˆå†³ç­–è¿‡ç¨‹</li>
                        <li><strong>å¤šæ¨¡æ€èåˆï¼š</strong>æ–‡æœ¬+å›¾åƒ+è¯­éŸ³</li>
                        <li><strong>æŒç»­å­¦ä¹ ï¼š</strong>ä¸æ–­è¿›åŒ–çš„ç³»ç»Ÿ</li>
                    </ul>
                </div>
                <div class="think-item">
                    <h5>ğŸŒˆ åº”ç”¨å±•æœ›</h5>
                    <ul>
                        <li><strong>è™šæ‹Ÿä½œå®¶ï¼š</strong>AIç‹¬ç«‹åˆ›ä½œé•¿ç¯‡å°è¯´</li>
                        <li><strong>ä¸ªäººç§˜ä¹¦ï¼š</strong>å…¨æ–¹ä½çš„ç”Ÿæ´»åŠ©ç†</li>
                        <li><strong>çŸ¥è¯†ä¼™ä¼´ï¼š</strong>æ·±åº¦çš„æ€ç»´ç¢°æ’</li>
                        <li><strong>åˆ›æ„å·¥åŠï¼š</strong>æ— é™çš„åˆ›æ„æ¢ç´¢</li>
                    </ul>
                </div>
            </div>

            <div class="tip success mt-4">
                <span class="tip-icon">ğŸ¯</span>
                <strong>å†™åœ¨æœ€å</strong>
                <p class="mt-2">
                    æ–‡æœ¬ç”ŸæˆæŠ€æœ¯æ­£åœ¨æ”¹å˜æˆ‘ä»¬ä¸è¯­è¨€äº¤äº’çš„æ–¹å¼ã€‚
                    ä»ç®€å•çš„æ¨¡æ¿å¡«å……åˆ°ä»Šå¤©çš„æ™ºèƒ½åˆ›ä½œï¼Œæˆ‘ä»¬è§è¯äº†æŠ€æœ¯çš„å·¨å¤§é£è·ƒã€‚
                    æœªæ¥ï¼ŒAIå°†æˆä¸ºæ¯ä¸ªäººçš„åˆ›ä½œä¼™ä¼´ï¼Œå¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°è¡¨è¾¾æƒ³æ³•ã€
                    ä¼ é€’æƒ…æ„Ÿã€åˆ›é€ ä»·å€¼ã€‚è®©æˆ‘ä»¬æ‹¥æŠ±è¿™ä¸ªå……æ»¡å¯èƒ½çš„æœªæ¥ï¼
                </p>
            </div>
        </section>
    </div>
</main>

<!-- JavaScript -->
<script>
    // ä¾§è¾¹æ åˆ‡æ¢
    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.getElementById('toggle-sidebar');

    toggleBtn.addEventListener('click', () => {
        sidebar.classList.toggle('open');
    });

    // è¿›åº¦æ¡
    window.addEventListener('scroll', () => {
        const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
        const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        const scrolled = (winScroll / height) * 100;
        document.getElementById('progress-bar').style.width = scrolled + '%';
    });

    // å¹³æ»‘æ»šåŠ¨
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
                // æ›´æ–°æ´»åŠ¨çŠ¶æ€
                document.querySelectorAll('.toc-item').forEach(item => {
                    item.classList.remove('active');
                });
                this.classList.add('active');
            }
        });
    });

    // ä»£ç å—å±•å¼€/æŠ˜å 
    function toggleCode(btn) {
        const codeContent = btn.closest('.code-block').querySelector('.code-content');
        codeContent.classList.toggle('collapsed');
        btn.textContent = codeContent.classList.contains('collapsed') ? 'å±•å¼€' : 'æŠ˜å ';
    }

    // å¤åˆ¶ä»£ç 
    function copyCode(btn) {
        const codeContent = btn.closest('.code-block').querySelector('.code-content pre').textContent;
        navigator.clipboard.writeText(codeContent).then(() => {
            const originalText = btn.textContent;
            btn.textContent = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                btn.textContent = originalText;
            }, 2000);
        });
    }

    // å¿«é€Ÿå¯¼èˆªé«˜äº®
    const sections = document.querySelectorAll('section[id]');
    const navItems = document.querySelectorAll('.quick-nav-item');

    window.addEventListener('scroll', () => {
        let current = '';
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            if (pageYOffset >= sectionTop - 200) {
                current = section.getAttribute('id');
            }
        });

        navItems.forEach(item => {
            item.classList.remove('active');
            if (item.getAttribute('data-section') === current) {
                item.classList.add('active');
            }
        });
    });

    // å¿«é€Ÿå¯¼èˆªç‚¹å‡»
    navItems.forEach(item => {
        item.addEventListener('click', () => {
            const sectionId = item.getAttribute('data-section');
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            }
        });
    });

    // æ¸©åº¦æ»‘å—äº¤äº’
    const tempSlider = document.getElementById('temperature-slider');
    const tempValue = document.getElementById('temp-value');
    const randomness = document.getElementById('randomness');
    const creativity = document.getElementById('creativity');
    const coherence = document.getElementById('coherence');

    if (tempSlider) {
        tempSlider.addEventListener('input', (e) => {
            const value = parseFloat(e.target.value);
            tempValue.textContent = value.toFixed(1);

            // æ›´æ–°æŒ‡æ ‡
            if (value < 0.5) {
                randomness.textContent = 'å¾ˆä½';
                creativity.textContent = 'ä¿å®ˆ';
                coherence.textContent = 'ä¼˜ç§€';
            } else if (value < 1.0) {
                randomness.textContent = 'ä¸­ç­‰';
                creativity.textContent = 'å¹³è¡¡';
                coherence.textContent = 'è‰¯å¥½';
            } else if (value < 1.5) {
                randomness.textContent = 'è¾ƒé«˜';
                creativity.textContent = 'åˆ›æ–°';
                coherence.textContent = 'ä¸€èˆ¬';
            } else {
                randomness.textContent = 'å¾ˆé«˜';
                creativity.textContent = 'å¤©é©¬è¡Œç©º';
                coherence.textContent = 'è¾ƒå·®';
            }
        });
    }

    // ç”Ÿæˆæ¼”ç¤º
    function regenerate() {
        const output = document.getElementById('generation-output');
        const temp = parseFloat(document.getElementById('temperature-slider').value);

        const examples = {
            0.1: "ä»å‰æœ‰åº§å±±ï¼Œå±±ä¸Šæœ‰åº§åº™ï¼Œåº™é‡Œæœ‰ä¸ªè€å’Œå°šåœ¨ç»™å°å’Œå°šè®²æ•…äº‹ã€‚è€å’Œå°šè¯´ï¼Œä»å‰æœ‰åº§å±±ï¼Œå±±ä¸Šæœ‰åº§åº™...",
            0.5: "ä»å‰æœ‰åº§å±±ï¼Œå±±ä¸­äº‘é›¾ç¼­ç»•ï¼Œå¤æœ¨å‚å¤©ã€‚å±±é¡¶æœ‰ä¸€åº§åƒå¹´å¤åˆ¹ï¼Œé¦™ç«é¼ç››ï¼Œæ¯æ—¥éƒ½æœ‰é¦™å®¢ç»œç»ä¸ç»åœ°å‰æ¥æœæ‹œã€‚",
            1.0: "ä»å‰æœ‰åº§å±±ï¼Œåå«é’äº‘å±±ã€‚å±±ä¸­ä½ç€ä¸€ä½ä¼šæ³•æœ¯çš„é“å£«ï¼Œä»–èƒ½å‘¼é£å”¤é›¨ï¼Œç‚¹çŸ³æˆé‡‘ã€‚æœ‰ä¸€å¤©ï¼Œä¸€ä¸ªå¹´è½»äººæ…•åè€Œæ¥...",
            1.5: "ä»å‰æœ‰åº§å±±ï¼Œé‚£ä¸æ˜¯æ™®é€šçš„å±±â€”â€”å®ƒä¼šåœ¨æœˆåœ†ä¹‹å¤œç¼“ç¼“ç§»åŠ¨ï¼å±±ä¸­çš„åŠ¨ç‰©éƒ½ä¼šè¯´äººè¯ï¼Œæ ‘æœ¨èƒ½å¤Ÿå”±æ­Œï¼Œå°±è¿çŸ³å¤´éƒ½æœ‰è‡ªå·±çš„æ•…äº‹...",
            2.0: "ä»å‰æœ‰åº§å±±ï¼Ÿä¸ï¼Œæ˜¯ä¸€æœµäº‘ï¼äº‘ä¸Šæœ‰åªä¼šè·³èˆçš„å…”å­ï¼Œå®ƒç©¿ç€æ˜Ÿæ˜Ÿåšçš„è£™å­ï¼Œæ¯å¤©å’Œå½©è™¹å–èŒ¶ã€‚çªç„¶ï¼Œä¸€æ¡é¾™éª‘ç€è‡ªè¡Œè½¦è·¯è¿‡..."
        };

        // æ‰¾åˆ°æœ€æ¥è¿‘çš„ç¤ºä¾‹
        const temps = Object.keys(examples).map(parseFloat);
        const closest = temps.reduce((prev, curr) =>
            Math.abs(curr - temp) < Math.abs(prev - temp) ? curr : prev
        );

        output.innerHTML = `<p style="line-height: 1.8;">${examples[closest]}</p>`;
    }

    // å¯æ§ç”Ÿæˆæ¼”ç¤º
    function controlledGenerate(style) {
        const output = document.getElementById('controlled-output');

        const examples = {
            'formal': 'å…³äºäººå·¥æ™ºèƒ½æœªæ¥å‘å±•çš„æ¢è®¨ï¼Œæˆ‘ä»¬éœ€è¦ä»å¤šä¸ªç»´åº¦è¿›è¡Œæ·±å…¥åˆ†æã€‚é¦–å…ˆï¼ŒæŠ€æœ¯å±‚é¢çš„çªç ´å°†æŒç»­æ¨åŠ¨AIèƒ½åŠ›çš„æå‡ï¼Œç‰¹åˆ«æ˜¯åœ¨æ·±åº¦å­¦ä¹ ã€å¼ºåŒ–å­¦ä¹ ç­‰æ ¸å¿ƒç®—æ³•é¢†åŸŸã€‚å…¶æ¬¡ï¼Œäº§ä¸šåº”ç”¨å°†æ›´åŠ å¹¿æ³›å’Œæ·±å…¥ï¼Œä»åˆ¶é€ ä¸šåˆ°æœåŠ¡ä¸šï¼ŒAIå°†é‡å¡‘å„è¡Œå„ä¸šçš„è¿ä½œæ¨¡å¼ã€‚',
            'casual': 'AIçš„æœªæ¥ï¼Ÿå“‡ï¼Œé‚£å¯å¤ªé…·äº†ï¼æƒ³è±¡ä¸€ä¸‹ï¼Œä»¥åä½ çš„AIåŠ©æ‰‹ä¸ä»…èƒ½å¸®ä½ å†™ä½œä¸šï¼Œè¿˜èƒ½é™ªä½ èŠå¤©è§£é—·ã€‚å¯èƒ½å†è¿‡å‡ å¹´ï¼Œæˆ‘ä»¬å°±èƒ½åƒç§‘å¹»ç”µå½±é‡Œé‚£æ ·ï¼Œå’ŒAIæˆä¸ºçœŸæ­£çš„æœ‹å‹å‘¢ï¼å½“ç„¶å•¦ï¼Œä¹Ÿè¦å°å¿ƒåˆ«è®©å®ƒä»¬å¤ªèªæ˜ï¼Œä¸ç„¶æˆ‘ä»¬å°±è¦å¤±ä¸šäº†ï¼Œå“ˆå“ˆï¼',
            'poetic': 'äººå·¥æ™ºèƒ½çš„æœªæ¥ï¼Œå¦‚æ™¨æ›¦ä¸­çš„éœ²ç ï¼ŒæŠ˜å°„ç€æ— é™å¯èƒ½çš„å…‰èŠ’ã€‚å®ƒæ˜¯äººç±»æ™ºæ…§çš„å»¶ä¼¸ï¼Œå¦‚åŒå¤œç©ºä¸­æœ€äº®çš„æ˜Ÿï¼ŒæŒ‡å¼•ç€æ–‡æ˜å‰è¿›çš„æ–¹å‘ã€‚åœ¨è¿™åœºç§‘æŠ€ä¸äººæ€§çš„åå°”å…¹ä¸­ï¼Œæˆ‘ä»¬æ—¢æ˜¯èˆè€…ï¼Œä¹Ÿæ˜¯ç¼–èˆå¸ˆï¼Œå…±åŒè°±å†™ç€æ˜å¤©çš„ä¹ç« ã€‚',
            'technical': 'AIæœªæ¥å‘å±•çš„å…³é”®åœ¨äºä»¥ä¸‹æŠ€æœ¯çªç ´ï¼š1ï¼‰ç¥ç»ç½‘ç»œæ¶æ„ä¼˜åŒ–ï¼ŒåŒ…æ‹¬Transformerå˜ä½“å’Œç¨€ç–æ¨¡å‹ï¼›2ï¼‰è®¡ç®—æ•ˆç‡æå‡ï¼Œé€šè¿‡é‡åŒ–ã€å‰ªæç­‰æŠ€æœ¯é™ä½æ¨ç†æˆæœ¬ï¼›3ï¼‰å¤šæ¨¡æ€èåˆï¼Œå®ç°è§†è§‰ã€è¯­è¨€ã€éŸ³é¢‘çš„ç»Ÿä¸€è¡¨ç¤ºï¼›4ï¼‰æŒç»­å­¦ä¹ èƒ½åŠ›ï¼Œè§£å†³ç¾éš¾æ€§é—å¿˜é—®é¢˜ã€‚é¢„è®¡2030å¹´å‰ï¼ŒAGIçš„éƒ¨åˆ†ç‰¹å¾å°†åˆæ­¥å®ç°ã€‚'
        };

        output.innerHTML = `<p style="line-height: 1.8; font-style: ${style === 'poetic' ? 'italic' : 'normal'};">${examples[style]}</p>`;
    }

    // ä¸»é¢˜åˆ‡æ¢
    const themeToggle = document.getElementById('theme-toggle');
    let isDark = true;

    themeToggle.addEventListener('click', () => {
        isDark = !isDark;
        themeToggle.textContent = isDark ? 'ğŸŒ™' : 'â˜€ï¸';
        // å®é™…çš„ä¸»é¢˜åˆ‡æ¢é€»è¾‘å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ 
    });

    // æ·»åŠ åŠ è½½åŠ¨ç”»
    window.addEventListener('load', () => {
        document.body.style.opacity = '0';
        setTimeout(() => {
            document.body.style.transition = 'opacity 0.5s';
            document.body.style.opacity = '1';
        }, 100);
    });

    // è§‚å¯Ÿè€…åŠ¨ç”»
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -100px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '0';
                entry.target.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    entry.target.style.transition = 'all 0.6s ease';
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }, 100);
                observer.unobserve(entry.target);
            }
        });
    }, observerOptions);

    // è§‚å¯Ÿæ‰€æœ‰å¡ç‰‡
    document.querySelectorAll('.info-card, .think-item, .timeline-item').forEach(el => {
        observer.observe(el);
    });
</script>

</body>
</html>