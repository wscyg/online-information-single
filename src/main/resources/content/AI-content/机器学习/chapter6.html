<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬6ç« ï¼šé€»è¾‘å›å½’ - ä»é¢„æµ‹åˆ°å†³ç­–çš„æ™ºæ…§è·¨è¶Š</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* CSS å˜é‡å®šä¹‰ä¸»é¢˜é¢œè‰² */
        :root {
            /* æ·±è‰²ä¸»é¢˜ï¼ˆé»˜è®¤ï¼‰ */
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: rgba(30, 41, 59, 0.8);
            --bg-card-solid: rgba(30, 41, 59, 0.95);
            --bg-code: #1a1a2e;
            --bg-demo: #0f172a;

            --text-primary: #e2e8f0;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --text-dim: #64748b;

            --border-primary: rgba(102, 126, 234, 0.3);
            --border-secondary: rgba(102, 126, 234, 0.2);
            --border-muted: rgba(148, 163, 184, 0.1);

            --grid-color: #2d3748;
            --grid-light: #4a5568;

            --shadow-sm: rgba(0,0,0,0.3);
            --shadow-md: rgba(0,0,0,0.4);
            --shadow-lg: rgba(0,0,0,0.5);

            --gradient-primary: linear-gradient(135deg, #667eea, #764ba2);
            --gradient-bg: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        /* æµ…è‰²ä¸»é¢˜ */
        body.light-theme {
            --bg-primary: #f8fafc;
            --bg-secondary: #e2e8f0;
            --bg-card: rgba(255, 255, 255, 0.9);
            --bg-card-solid: rgba(255, 255, 255, 0.95);
            --bg-code: #f3f4f6;
            --bg-demo: #ffffff;

            --text-primary: #1e293b;
            --text-secondary: #334155;
            --text-muted: #475569;
            --text-dim: #64748b;

            --border-primary: rgba(102, 126, 234, 0.4);
            --border-secondary: rgba(102, 126, 234, 0.3);
            --border-muted: rgba(203, 213, 225, 0.5);

            --grid-color: #e5e7eb;
            --grid-light: #d1d5db;

            --shadow-sm: rgba(0,0,0,0.1);
            --shadow-md: rgba(0,0,0,0.15);
            --shadow-lg: rgba(0,0,0,0.2);

            --gradient-primary: linear-gradient(135deg, #667eea, #764ba2);
            --gradient-bg: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }

        /* ä¸»é¢˜è¿‡æ¸¡åŠ¨ç”» */
        body,
        body * {
            transition: background-color 0.3s ease,
            color 0.3s ease,
            border-color 0.3s ease,
            box-shadow 0.3s ease;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: var(--gradient-bg);
            color: var(--text-primary);
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            transition: all 0.3s ease;
        }

        /* å½“å¯¼èˆªå±•å¼€æ—¶ï¼Œå†…å®¹åŒºå³ç§» */
        body.nav-open .container {
            margin-left: 320px;
        }

        /* åŠ¨æ€èƒŒæ™¯æ•ˆæœ */
        .dynamic-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }

        .bg-gradient {
            position: absolute;
            width: 600px;
            height: 600px;
            border-radius: 50%;
            filter: blur(100px);
            opacity: 0.3;
            animation: float 20s ease-in-out infinite;
        }

        .bg-gradient:nth-child(1) {
            background: linear-gradient(135deg, #667eea, #764ba2);
            top: -200px;
            left: -200px;
            animation-delay: 0s;
        }

        .bg-gradient:nth-child(2) {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            bottom: -200px;
            right: -200px;
            animation-delay: 10s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(50px, 30px) scale(1.1); }
        }

        /* æ™ºèƒ½å¯¼èˆªæ ·å¼ */
        .smart-nav {
            position: fixed;
            left: -300px;
            top: 0;
            width: 300px;
            height: 100vh;
            background: var(--bg-card-solid);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--border-secondary);
            box-shadow: 2px 0 20px var(--shadow-lg);
            z-index: 1000;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        body.nav-open .smart-nav {
            left: 0;
        }

        /* å¯¼èˆªè§¦å‘æŒ‰é’® */
        .nav-trigger {
            position: fixed;
            left: 20px;
            top: 20px;
            width: 50px;
            height: 50px;
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px var(--shadow-sm);
        }

        body.nav-open .nav-trigger {
            left: 250px;
            background: rgba(102, 126, 234, 0.1);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .nav-trigger:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .nav-trigger span {
            display: block;
            width: 24px;
            height: 2px;
            background: #667eea;
            margin: 4px 0;
            transition: all 0.3s ease;
        }

        body.nav-open .nav-trigger span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        body.nav-open .nav-trigger span:nth-child(2) {
            opacity: 0;
        }

        body.nav-open .nav-trigger span:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }

        /* å¯¼èˆªå¤´éƒ¨ */
        .nav-header {
            padding: 30px 25px 20px;
            border-bottom: 1px solid rgba(102, 126, 234, 0.2);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(124, 58, 237, 0.05));
        }

        .nav-header h3 {
            font-size: 1.3rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* è¿›åº¦æ¡ */
        .nav-progress {
            height: 4px;
            background: rgba(102, 126, 234, 0.1);
            position: relative;
            overflow: hidden;
        }

        .nav-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        /* å¯¼èˆªåˆ—è¡¨ */
        .nav-list {
            list-style: none;
            padding: 20px 0;
            max-height: calc(100vh - 250px);
            overflow-y: auto;
            overflow-x: hidden;
        }

        .nav-list::-webkit-scrollbar {
            width: 6px;
        }

        .nav-list::-webkit-scrollbar-track {
            background: rgba(102, 126, 234, 0.05);
        }

        .nav-list::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.3);
            border-radius: 3px;
            transition: background 0.3s ease;
        }

        .nav-list::-webkit-scrollbar-thumb:hover {
            background: rgba(102, 126, 234, 0.5);
        }

        /* å¯¼èˆªé¡¹ */
        .nav-item {
            position: relative;
            margin: 2px 0;
            transition: all 0.3s ease;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: transparent;
            transition: all 0.3s ease;
        }

        .nav-item:hover::before {
            background: #667eea;
        }

        .nav-item.active::before {
            background: var(--gradient-primary);
            width: 4px;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .nav-item a {
            display: flex;
            align-items: center;
            padding: 12px 25px;
            color: var(--text-muted);
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-item:hover a {
            color: var(--text-primary);
            background: rgba(102, 126, 234, 0.05);
            padding-left: 30px;
        }

        .nav-item.active a {
            color: var(--text-primary);
            background: rgba(102, 126, 234, 0.1);
            padding-left: 30px;
        }

        /* å®Œæˆæ ‡è®° */
        .nav-item.completed::after {
            content: 'âœ“';
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            color: #10b981;
            font-weight: bold;
            font-size: 1.1rem;
            animation: checkIn 0.5s ease;
        }

        @keyframes checkIn {
            from {
                transform: translateY(-50%) scale(0);
                opacity: 0;
            }
            to {
                transform: translateY(-50%) scale(1);
                opacity: 1;
            }
        }

        .nav-icon {
            font-size: 1.3rem;
            margin-right: 12px;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .nav-item:hover .nav-icon {
            transform: scale(1.1);
        }

        .nav-item.active .nav-icon {
            animation: pulse 2s ease-in-out infinite;
        }

        .nav-text {
            flex: 1;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .nav-time {
            font-size: 0.75rem;
            color: #64748b;
            margin-left: auto;
            opacity: 0.8;
        }

        /* å¯¼èˆªåº•éƒ¨ */
        .nav-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px 25px;
            background: linear-gradient(to top, rgba(15, 23, 42, 0.98), transparent);
            border-top: 1px solid rgba(102, 126, 234, 0.2);
        }

        .reading-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: #94a3b8;
        }

        .stat-item .icon {
            font-size: 1.1rem;
        }

        .completion-ring {
            width: 60px;
            height: 60px;
            margin: 0 auto;
            position: relative;
        }

        .completion-ring svg {
            transform: rotate(-90deg);
        }

        .completion-ring circle {
            fill: none;
            stroke-width: 4;
        }

        .completion-ring .bg {
            stroke: rgba(102, 126, 234, 0.1);
        }

        .completion-ring .progress {
            stroke: url(#gradient);
            stroke-dasharray: 188.5;
            stroke-dashoffset: 188.5;
            transition: stroke-dashoffset 1s ease;
        }

        .completion-percent {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2rem;
            font-weight: bold;
            color: #667eea;
        }

        /* å¿«æ·é”®æç¤º */
        .nav-shortcuts {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(102, 126, 234, 0.1);
            font-size: 0.75rem;
            color: #64748b;
            text-align: center;
        }

        /* è¿·ä½ åœ°å›¾ */
        .mini-map {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 60px;
            height: 300px;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            padding: 10px;
            z-index: 998;
            opacity: 0;
            transition: opacity 0.3s ease;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        body.nav-open .mini-map {
            opacity: 0.5;
        }

        body.nav-open .mini-map:hover {
            opacity: 1;
        }

        .mini-map-track {
            width: 6px;
            height: 100%;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 3px;
            margin: 0 auto;
            position: relative;
        }

        .mini-map-thumb {
            width: 14px;
            height: 50px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 7px;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            top: 0;
            cursor: grab;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.4);
            transition: height 0.3s ease;
        }

        .mini-map-thumb:active {
            cursor: grabbing;
            height: 60px;
        }

        /* ä¸»æ ‡é¢˜æ ·å¼ */
        .main-header {
            text-align: center;
            margin: 60px 0;
            position: relative;
        }

        .main-title {
            font-size: 4rem;
            font-weight: 900;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #667eea 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-shift 8s ease infinite;
            text-shadow: 0 0 80px rgba(102, 126, 234, 0.5);
            margin-bottom: 20px;
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .subtitle {
            font-size: 1.6rem;
            color: #94a3b8;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        /* ç« èŠ‚å¡ç‰‡æ ·å¼ */
        .section-card {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 40px;
            margin: 30px 0;
            border: 1px solid var(--border-secondary);
            box-shadow: 0 20px 40px var(--shadow-sm);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .section-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #667eea, transparent);
            animation: scan 3s linear infinite;
        }

        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 60px var(--shadow-md);
            border-color: rgba(102, 126, 234, 0.4);
        }

        .section-title {
            font-size: 2.5rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* æ•…äº‹æ¡†æ ·å¼ */
        .story-box {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.05));
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(251, 191, 36, 0.3);
            position: relative;
            overflow: hidden;
        }

        .story-box::after {
            content: 'ğŸ“–';
            position: absolute;
            top: -20px;
            right: 20px;
            font-size: 4rem;
            opacity: 0.1;
        }

        /* æ€è€ƒé¢˜æ¡†æ ·å¼ */
        .thinking-box {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.05));
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(239, 68, 68, 0.3);
            position: relative;
        }

        .thinking-box::before {
            content: 'ğŸ¤”';
            position: absolute;
            top: -15px;
            left: 20px;
            font-size: 2rem;
            background: rgba(30, 41, 59, 0.9);
            padding: 5px 15px;
            border-radius: 50%;
        }

        /* å…¬å¼å®¹å™¨æ ·å¼ */
        .formula-box {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(124, 58, 237, 0.05));
            border-radius: 20px;
            padding: 35px;
            margin: 30px 0;
            text-align: center;
            border: 2px solid rgba(139, 92, 246, 0.3);
            position: relative;
            overflow: hidden;
        }

        .formula-box::before {
            content: 'âˆ‘';
            position: absolute;
            top: -30px;
            right: 30px;
            font-size: 6rem;
            opacity: 0.05;
            transform: rotate(15deg);
        }

        .math-formula {
            font-family: 'Times New Roman', serif;
            font-size: 1.8rem;
            color: #e0e6ed;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        /* é«˜äº®æ ·å¼ */
        .highlight-primary {
            color: #667eea;
            font-weight: bold;
            background: rgba(102, 126, 234, 0.1);
            padding: 2px 8px;
            border-radius: 6px;
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        .highlight-success {
            color: #10b981;
            font-weight: bold;
            background: rgba(16, 185, 129, 0.1);
            padding: 2px 8px;
            border-radius: 6px;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .highlight-warning {
            color: #f59e0b;
            font-weight: bold;
            background: rgba(245, 158, 11, 0.1);
            padding: 2px 8px;
            border-radius: 6px;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .highlight-danger {
            color: #ef4444;
            font-weight: bold;
            background: rgba(239, 68, 68, 0.1);
            padding: 2px 8px;
            border-radius: 6px;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        /* æµ…è‰²ä¸»é¢˜ä¸‹çš„ç‰¹æ®Šæ¡†æ ·å¼ */
        body.light-theme .story-box {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(245, 158, 11, 0.03));
            border-color: rgba(251, 191, 36, 0.4);
        }

        body.light-theme .thinking-box {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.08), rgba(220, 38, 38, 0.03));
            border-color: rgba(239, 68, 68, 0.4);
        }

        body.light-theme .formula-box {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.08), rgba(124, 58, 237, 0.03));
            border-color: rgba(139, 92, 246, 0.4);
        }

        /* æ•°å­¦å…¬å¼æ–‡æœ¬ */
        .math-formula {
            font-family: 'Times New Roman', serif;
            font-size: 1.8rem;
            color: var(--text-primary);
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        /* æµ…è‰²ä¸»é¢˜ä¸‹çš„å¯¼èˆªåº•éƒ¨ */
        body.light-theme .nav-footer {
            background: linear-gradient(to top, rgba(255, 255, 255, 0.98), transparent);
        }

        /* æµ…è‰²ä¸»é¢˜ä¸‹çš„è¿·ä½ åœ°å›¾ */
        body.light-theme .mini-map {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(102, 126, 234, 0.3);
        }

        /* å¯¼èˆªæ–‡æœ¬é¢œè‰² */
        .reading-stats .stat-item,
        .nav-time,
        .nav-shortcuts {
            color: var(--text-dim);
        }

        /* äº¤äº’å¼æ¼”ç¤ºåŒºåŸŸ */
        .demo-container {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }

        .demo-canvas {
            background: #0f172a;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            cursor: crosshair;
        }

        .demo-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .demo-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .demo-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        /* ä»£ç åŒºåŸŸæ ·å¼ */
        .code-block {
            background: #1a1a2e;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            overflow-x: auto;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .code-block::before {
            content: 'Python';
            position: absolute;
            top: -12px;
            left: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .code-block pre {
            color: #f8f8f2;
            font-family: 'Fira Code', 'Consolas', monospace;
            line-height: 1.6;
            margin: 0;
        }

        /* è¯­æ³•é«˜äº® */
        .keyword { color: #ff79c6; }
        .string { color: #f1fa8c; }
        .comment { color: #6272a4; }
        .number { color: #bd93f9; }
        .function { color: #50fa7b; }

        /* è¡¨æ ¼æ ·å¼ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--bg-card);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 30px var(--shadow-sm);
            border: 1px solid var(--border-muted);
        }

        .data-table th {
            background: var(--gradient-primary);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-muted);
            color: var(--text-primary);
        }

        .data-table tr:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        /* è¿›åº¦æŒ‡ç¤ºå™¨ */
        .progress-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-card);
            padding: 15px 25px;
            border-radius: 50px;
            border: 2px solid var(--border-primary);
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px var(--shadow-sm);
        }

        body.nav-open .progress-indicator {
            opacity: 0.3;
        }

        .progress-bar {
            width: 150px;
            height: 6px;
            background: rgba(102, 126, 234, 0.2);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        /* ä¸»é¢˜åˆ‡æ¢æŒ‰é’®ç‰¹æ®Šæ ·å¼ */
        .theme-toggle-btn {
            position: relative;
            overflow: hidden;
        }

        .theme-toggle-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .theme-toggle-btn.animating::after {
            width: 300px;
            height: 300px;
        }

        /* æµ®åŠ¨å·¥å…·æ  */
        .floating-toolbar {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

        .toolbar-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .toolbar-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1400px) {
            body.nav-open .container {
                margin-left: 0;
                padding-left: 320px;
            }
        }

        @media (max-width: 768px) {
            .main-title {
                font-size: 2.5rem;
            }

            .section-title {
                font-size: 1.8rem;
            }

            .section-card {
                padding: 25px;
            }

            .demo-controls {
                flex-direction: column;
            }

            .progress-indicator {
                display: none;
            }

            .smart-nav {
                width: 100%;
                left: -100%;
            }

            body.nav-open .smart-nav {
                left: 0;
            }

            body.nav-open .container {
                margin-left: 0;
                padding-left: 20px;
            }

            body.nav-open .nav-trigger {
                left: auto;
                right: 20px;
            }

            .mini-map {
                display: none;
            }
        }

        /* åŠ¨ç”»æ•ˆæœ */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 0.6s ease forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* è„‰å†²åŠ¨ç”» */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        /* ç‰¹æ®Šæ•ˆæœ */
        .glow {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        /* ç½‘æ ¼èƒŒæ™¯ */
        .grid-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                    linear-gradient(rgba(102, 126, 234, 0.1) 1px, transparent 1px),
                    linear-gradient(90deg, rgba(102, 126, 234, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.3;
            pointer-events: none;
        }

        /* ç« èŠ‚é”šç‚¹åç§» */
        .section-anchor {
            scroll-margin-top: 100px;
        }
    </style>
</head>
<body>
<!-- åŠ¨æ€èƒŒæ™¯ -->
<div class="dynamic-bg">
    <div class="bg-gradient"></div>
    <div class="bg-gradient"></div>
</div>

<!-- å¯¼èˆªè§¦å‘æŒ‰é’® -->
<button class="nav-trigger" onclick="toggleNav()">
    <span></span>
    <span></span>
    <span></span>
</button>

<!-- æ™ºèƒ½å¯¼èˆªç³»ç»Ÿ -->
<nav class="smart-nav">
    <div class="nav-header">
        <h3>ğŸ“š é€»è¾‘å›å½’å­¦ä¹ æŒ‡å—</h3>
    </div>

    <div class="nav-progress">
        <div class="nav-progress-bar" id="navProgressBar"></div>
    </div>

    <ul class="nav-list">
        <li class="nav-item active" data-section="intro">
            <a href="#intro">
                <span class="nav-icon">ğŸ¥</span>
                <span class="nav-text">å¼•è¨€ï¼šåŒ»ç”Ÿçš„å›°å¢ƒ</span>
                <span class="nav-time">3 min</span>
            </a>
        </li>
        <li class="nav-item" data-section="sigmoid">
            <a href="#sigmoid">
                <span class="nav-icon">ğŸ”„</span>
                <span class="nav-text">6.1 ä»çº¿æ€§åˆ°é€»è¾‘</span>
                <span class="nav-time">5 min</span>
            </a>
        </li>
        <li class="nav-item" data-section="loss">
            <a href="#loss">
                <span class="nav-icon">ğŸ“‰</span>
                <span class="nav-text">6.2 æŸå¤±å‡½æ•°</span>
                <span class="nav-time">4 min</span>
            </a>
        </li>
        <li class="nav-item" data-section="boundary">
            <a href="#boundary">
                <span class="nav-icon">ğŸ¨</span>
                <span class="nav-text">6.3 å†³ç­–è¾¹ç•Œ</span>
                <span class="nav-time">4 min</span>
            </a>
        </li>
        <li class="nav-item" data-section="regularization">
            <a href="#regularization">
                <span class="nav-icon">âš–ï¸</span>
                <span class="nav-text">6.4 æ­£åˆ™åŒ–</span>
                <span class="nav-time">3 min</span>
            </a>
        </li>
        <li class="nav-item" data-section="multiclass">
            <a href="#multiclass">
                <span class="nav-icon">ğŸŒˆ</span>
                <span class="nav-text">6.5 å¤šåˆ†ç±»æ‰©å±•</span>
                <span class="nav-time">4 min</span>
            </a>
        </li>
        <li class="nav-item" data-section="heart-case">
            <a href="#heart-case">
                <span class="nav-icon">â¤ï¸</span>
                <span class="nav-text">6.6 å®æˆ˜ï¼šå¿ƒè„ç—…é¢„æµ‹</span>
                <span class="nav-time">6 min</span>
            </a>
        </li>
        <li class="nav-item" data-section="digit-case">
            <a href="#digit-case">
                <span class="nav-icon">âœï¸</span>
                <span class="nav-text">6.7 å®æˆ˜ï¼šæ•°å­—è¯†åˆ«</span>
                <span class="nav-time">6 min</span>
            </a>
        </li>
        <li class="nav-item" data-section="diagnosis">
            <a href="#diagnosis">
                <span class="nav-icon">ğŸ”</span>
                <span class="nav-text">6.8 æ¨¡å‹è¯Šæ–­</span>
                <span class="nav-time">4 min</span>
            </a>
        </li>
        <li class="nav-item" data-section="summary">
            <a href="#summary">
                <span class="nav-icon">ğŸ“</span>
                <span class="nav-text">6.9 æ€»ç»“ä¸æ€è€ƒ</span>
                <span class="nav-time">3 min</span>
            </a>
        </li>
    </ul>

    <div class="nav-footer">
        <div class="reading-stats">
            <div class="stat-item">
                <span class="icon">â±ï¸</span>
                <span>æ€»è®¡ 42 åˆ†é’Ÿ</span>
            </div>
            <div class="stat-item">
                <span class="icon">ğŸ“–</span>
                <span id="sectionsRead">0/10</span>
            </div>
        </div>

        <div class="completion-ring">
            <svg width="60" height="60">
                <defs>
                    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                    </linearGradient>
                </defs>
                <circle cx="30" cy="30" r="25" class="bg"></circle>
                <circle cx="30" cy="30" r="25" class="progress" id="completionRing"></circle>
            </svg>
            <div class="completion-percent" id="completionPercent">0%</div>
        </div>

        <div class="nav-shortcuts">
            <kbd>Alt</kbd> + <kbd>N</kbd> åˆ‡æ¢å¯¼èˆª
        </div>
    </div>
</nav>

<!-- è¿·ä½ åœ°å›¾ -->
<div class="mini-map">
    <div class="mini-map-track">
        <div class="mini-map-thumb" id="miniMapThumb"></div>
    </div>
</div>

<!-- è¿›åº¦æŒ‡ç¤ºå™¨ -->
<div class="progress-indicator">
    <span>å­¦ä¹ è¿›åº¦</span>
    <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
    </div>
    <span id="progressText">0%</span>
</div>

<!-- ä¸»å®¹å™¨ -->
<div class="container">
    <!-- æ ‡é¢˜éƒ¨åˆ† -->
    <div class="main-header fade-in">
        <h1 class="main-title">ç¬¬6ç« ï¼šé€»è¾‘å›å½’</h1>
        <p class="subtitle">ğŸ¯ ä»é¢„æµ‹åˆ°å†³ç­–çš„æ™ºæ…§è·¨è¶Š</p>
    </div>

    <!-- å¼•è¨€ï¼šåŒ»ç”Ÿçš„è¯Šæ–­éš¾é¢˜ -->
    <div id="intro" class="section-card fade-in section-anchor">
        <h2 class="section-title">ğŸ¥ å¼•è¨€ï¼šä¸€ä¸ªåŒ»ç”Ÿçš„å›°å¢ƒ</h2>

        <div class="story-box">
            <h3 style="color: #f59e0b; margin-bottom: 20px;">ğŸ©º æ€¥è¯Šå®¤çš„ä¸€å¤©</h3>
            <p style="font-size: 1.1rem; line-height: 1.8;">
                æ·±å¤œçš„æ€¥è¯Šå®¤ï¼ŒæåŒ»ç”Ÿé¢å¯¹ç€ä¸€ä½èƒ¸ç—›æ‚£è€…çš„æ£€æŸ¥æŠ¥å‘Šã€‚<br><br>
                <span class="highlight-warning">è¡€å‹ï¼š140/90</span>ã€
                <span class="highlight-warning">èƒ†å›ºé†‡ï¼š250mg/dl</span>ã€
                <span class="highlight-warning">å¹´é¾„ï¼š55å²</span>...<br><br>
                è¿™äº›æ•°å­—æ„å‘³ç€ä»€ä¹ˆï¼Ÿæ‚£è€…<span class="highlight-danger">æ˜¯å¦æœ‰å¿ƒè„ç—…é£é™©</span>ï¼Ÿ<br><br>
                å¦‚æœç”¨çº¿æ€§å›å½’ï¼Œé¢„æµ‹å€¼å¯èƒ½æ˜¯ <span class="highlight-primary">1.3</span> æˆ– <span class="highlight-primary">-0.2</span>...<br>
                ä½†å¿ƒè„ç—…åªæœ‰ä¸¤ç§æƒ…å†µï¼š<span class="highlight-success">æœ‰</span> æˆ– <span class="highlight-danger">æ²¡æœ‰</span>ï¼
            </p>
            <div style="background: rgba(239, 68, 68, 0.1); padding: 20px; border-radius: 10px; margin-top: 20px; border: 1px solid rgba(239, 68, 68, 0.3);">
                <p style="text-align: center; font-size: 1.2rem; color: #ef4444;">
                    ğŸ’¡ æˆ‘ä»¬éœ€è¦ä¸€ä¸ªèƒ½è¾“å‡º<strong>æ¦‚ç‡</strong>çš„æ¨¡å‹ï¼<br>
                    å‘Šè¯‰åŒ»ç”Ÿï¼šè¿™ä¸ªæ‚£è€…æœ‰ <strong>85%</strong> çš„æ¦‚ç‡æ‚£æœ‰å¿ƒè„ç—…ã€‚
                </p>
            </div>
        </div>

        <div class="thinking-box">
            <h3>æ€è€ƒï¼šåˆ†ç±»ä¸å›å½’çš„æœ¬è´¨åŒºåˆ«</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 10px;">
                    <h4 style="color: #667eea; margin-bottom: 10px;">ğŸ“ˆ å›å½’é—®é¢˜</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li>âœ“ é¢„æµ‹æˆ¿ä»·ï¼šå¯èƒ½æ˜¯ä»»æ„æ­£æ•°</li>
                        <li>âœ“ é¢„æµ‹æ¸©åº¦ï¼šè¿ç»­çš„æ•°å€¼</li>
                        <li>âœ“ é¢„æµ‹é”€å”®é¢ï¼šæ²¡æœ‰ä¸Šé™</li>
                    </ul>
                </div>
                <div style="background: rgba(239, 68, 68, 0.1); padding: 20px; border-radius: 10px;">
                    <h4 style="color: #ef4444; margin-bottom: 10px;">ğŸ¯ åˆ†ç±»é—®é¢˜</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li>âœ“ ç–¾ç—…è¯Šæ–­ï¼šæœ‰/æ²¡æœ‰</li>
                        <li>âœ“ é‚®ä»¶åˆ†ç±»ï¼šåƒåœ¾/æ­£å¸¸</li>
                        <li>âœ“ å›¾åƒè¯†åˆ«ï¼šçŒ«/ç‹—/é¸Ÿ</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- ä»çº¿æ€§åˆ°é€»è¾‘ï¼šSigmoidçš„è¯ç”Ÿ -->
    <div id="sigmoid" class="section-card fade-in section-anchor">
        <h2 class="section-title">ğŸ”„ 6.1 ä»çº¿æ€§åˆ°é€»è¾‘ï¼šæ™ºæ…§çš„è½¬å˜</h2>

        <div class="thinking-box">
            <h3>çº¿æ€§å›å½’çš„å±€é™</h3>
            <p>çº¿æ€§å›å½’ï¼š<span class="math-formula">y = Î²â‚€ + Î²â‚xâ‚ + Î²â‚‚xâ‚‚ + ... + Î²â‚™xâ‚™</span></p>
            <p>è¾“å‡ºèŒƒå›´ï¼š<span class="highlight-danger">(-âˆ, +âˆ)</span></p>
            <p style="margin-top: 15px;">
                <strong>é—®é¢˜ï¼š</strong>å¦‚ä½•å°†è¿™ä¸ªæ— ç•Œçš„è¾“å‡ºè½¬æ¢åˆ° <span class="highlight-success">[0, 1]</span> åŒºé—´è¡¨ç¤ºæ¦‚ç‡ï¼Ÿ
            </p>
        </div>

        <!-- Sigmoidå‡½æ•°ä»‹ç» -->
        <div class="formula-box">
            <h3 style="color: #8b5cf6; margin-bottom: 20px;">ğŸŒŸ Sigmoidå‡½æ•°ï¼šæ¦‚ç‡çš„æ¡¥æ¢</h3>
            <div class="math-formula">
                Ïƒ(z) = <span style="font-size: 2rem;">1 / (1 + e<sup>-z</sup>)</span>
            </div>
            <div style="margin-top: 20px; color: #cbd5e1;">
                <p>å…¶ä¸­ z = Î²â‚€ + Î²â‚xâ‚ + Î²â‚‚xâ‚‚ + ... + Î²â‚™xâ‚™</p>
            </div>
        </div>

        <!-- Sigmoidå‡½æ•°å¯è§†åŒ– -->
        <div class="demo-container">
            <h3 style="color: #667eea; text-align: center; margin-bottom: 20px;">ğŸ“Š Sigmoidå‡½æ•°äº¤äº’å¼æ¼”ç¤º</h3>
            <canvas id="sigmoidCanvas" class="demo-canvas" width="800" height="400"></canvas>
            <div class="demo-controls">
                <button class="demo-btn" onclick="changeSigmoidParam('steep')">æ›´é™¡å³­</button>
                <button class="demo-btn" onclick="changeSigmoidParam('flat')">æ›´å¹³ç¼“</button>
                <button class="demo-btn" onclick="changeSigmoidParam('shift-left')">å·¦ç§»</button>
                <button class="demo-btn" onclick="changeSigmoidParam('shift-right')">å³ç§»</button>
                <button class="demo-btn" onclick="resetSigmoid()">é‡ç½®</button>
            </div>
            <p style="text-align: center; margin-top: 15px; color: #94a3b8;">
                ğŸ’¡ æ‹–åŠ¨æ»‘å—è§‚å¯Ÿå‚æ•°å¦‚ä½•å½±å“Sigmoidæ›²çº¿å½¢çŠ¶
            </p>
        </div>

        <!-- Sigmoidç‰¹æ€§æ€»ç»“ -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 30px;">
            <div style="background: rgba(16, 185, 129, 0.1); padding: 20px; border-radius: 15px; border: 1px solid rgba(16, 185, 129, 0.3);">
                <h4 style="color: #10b981; margin-bottom: 10px;">âœ… è¾“å‡ºèŒƒå›´</h4>
                <p>ä¸¥æ ¼é™åˆ¶åœ¨ (0, 1) ä¹‹é—´<br>å¤©ç„¶è¡¨ç¤ºæ¦‚ç‡</p>
            </div>
            <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; border: 1px solid rgba(102, 126, 234, 0.3);">
                <h4 style="color: #667eea; margin-bottom: 10px;">ğŸ“ˆ å•è°ƒé€’å¢</h4>
                <p>è¾“å…¥è¶Šå¤§ï¼Œè¾“å‡ºè¶Šæ¥è¿‘1<br>ä¿æŒçº¿æ€§æ¨¡å‹çš„å•è°ƒæ€§</p>
            </div>
            <div style="background: rgba(245, 158, 11, 0.1); padding: 20px; border-radius: 15px; border: 1px solid rgba(245, 158, 11, 0.3);">
                <h4 style="color: #f59e0b; margin-bottom: 10px;">ğŸ¯ ä¸­å¿ƒå¯¹ç§°</h4>
                <p>Ïƒ(0) = 0.5<br>å…³äºç‚¹(0, 0.5)ä¸­å¿ƒå¯¹ç§°</p>
            </div>
            <div style="background: rgba(239, 68, 68, 0.1); padding: 20px; border-radius: 15px; border: 1px solid rgba(239, 68, 68, 0.3);">
                <h4 style="color: #ef4444; margin-bottom: 10px;">ğŸ”„ å¯¼æ•°æ€§è´¨</h4>
                <p>Ïƒ'(z) = Ïƒ(z)(1 - Ïƒ(z))<br>ä¾¿äºæ¢¯åº¦è®¡ç®—</p>
            </div>
        </div>
    </div>

    <!-- æŸå¤±å‡½æ•°ï¼šäº¤å‰ç†µ -->
    <div id="loss" class="section-card fade-in section-anchor">
        <h2 class="section-title">ğŸ“‰ 6.2 æŸå¤±å‡½æ•°ï¼šæœ€å¤§ä¼¼ç„¶çš„æ™ºæ…§</h2>

        <div class="thinking-box">
            <h3>ä¸ºä»€ä¹ˆä¸ç”¨MSEï¼Ÿ</h3>
            <p>è€ƒè™‘ä¸€ä¸ªæç«¯æƒ…å†µï¼š</p>
            <ul style="margin: 15px 0; padding-left: 30px;">
                <li>çœŸå®æ ‡ç­¾ï¼šy = 1ï¼ˆæ‚£ç—…ï¼‰</li>
                <li>æ¨¡å‹é¢„æµ‹ï¼šp = 0.01ï¼ˆ1%æ¦‚ç‡æ‚£ç—…ï¼‰</li>
                <li>MSE = (1 - 0.01)Â² = 0.98</li>
            </ul>
            <p><span class="highlight-danger">é—®é¢˜ï¼š</span>MSEå¯¹äºæ¦‚ç‡çš„æƒ©ç½šä¸å¤Ÿ"ç‹ "ï¼</p>
        </div>

        <!-- äº¤å‰ç†µæŸå¤±å‡½æ•° -->
        <div class="formula-box">
            <h3 style="color: #8b5cf6; margin-bottom: 20px;">ğŸ¯ äºŒå…ƒäº¤å‰ç†µæŸå¤±</h3>
            <div class="math-formula" style="font-size: 1.6rem;">
                L = -[yÂ·log(p) + (1-y)Â·log(1-p)]
            </div>
            <div style="margin-top: 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div style="background: rgba(16, 185, 129, 0.1); padding: 15px; border-radius: 10px;">
                    <p style="color: #10b981;"><strong>å½“ y = 1 æ—¶ï¼š</strong></p>
                    <p>L = -log(p)</p>
                    <p style="font-size: 0.9rem; margin-top: 5px;">pâ†’0æ—¶ï¼ŒLâ†’âˆ (ä¸¥é‡æƒ©ç½š)</p>
                </div>
                <div style="background: rgba(239, 68, 68, 0.1); padding: 15px; border-radius: 10px;">
                    <p style="color: #ef4444;"><strong>å½“ y = 0 æ—¶ï¼š</strong></p>
                    <p>L = -log(1-p)</p>
                    <p style="font-size: 0.9rem; margin-top: 5px;">pâ†’1æ—¶ï¼ŒLâ†’âˆ (ä¸¥é‡æƒ©ç½š)</p>
                </div>
            </div>
        </div>

        <!-- æŸå¤±å‡½æ•°å¯è§†åŒ– -->
        <div class="demo-container">
            <h3 style="color: #667eea; text-align: center; margin-bottom: 20px;">ğŸ“Š æŸå¤±å‡½æ•°å¯¹æ¯”æ¼”ç¤º</h3>
            <canvas id="lossCanvas" class="demo-canvas" width="800" height="400"></canvas>
            <div class="demo-controls">
                <button class="demo-btn" onclick="showLoss('cross-entropy')">äº¤å‰ç†µæŸå¤±</button>
                <button class="demo-btn" onclick="showLoss('mse')">MSEæŸå¤±</button>
                <button class="demo-btn" onclick="showLoss('compare')">å¯¹æ¯”è§†å›¾</button>
            </div>
            <p style="text-align: center; margin-top: 15px; color: #94a3b8;">
                ğŸ’¡ è§‚å¯Ÿä¸åŒæŸå¤±å‡½æ•°å¯¹é”™è¯¯é¢„æµ‹çš„æƒ©ç½šç¨‹åº¦
            </p>
        </div>
    </div>

    <!-- å†³ç­–è¾¹ç•Œ -->
    <div id="boundary" class="section-card fade-in section-anchor">
        <h2 class="section-title">ğŸ¨ 6.3 å†³ç­–è¾¹ç•Œï¼šåˆ†ç±»çš„è‰ºæœ¯</h2>

        <div class="story-box">
            <h3 style="color: #f59e0b;">ğŸ¯ ç›´è§‰ç†è§£</h3>
            <p>
                æƒ³è±¡ä½ æ˜¯ä¸€ä¸ªå›­ä¸ï¼Œè¦åœ¨èŠ±å›­é‡Œåˆ’åˆ†ä¸¤ç§èŠ±çš„åŒºåŸŸã€‚<br>
                <span class="highlight-primary">å†³ç­–è¾¹ç•Œ</span>å°±æ˜¯ä½ ç”»çš„é‚£æ¡åˆ†ç•Œçº¿ï¼<br><br>
                â€¢ çº¿æ€§å†³ç­–è¾¹ç•Œï¼šä¸€æ¡ç›´çº¿<br>
                â€¢ éçº¿æ€§å†³ç­–è¾¹ç•Œï¼šæ›²çº¿ï¼ˆé€šè¿‡ç‰¹å¾å·¥ç¨‹å®ç°ï¼‰
            </p>
        </div>

        <!-- å†³ç­–è¾¹ç•Œäº¤äº’æ¼”ç¤º -->
        <div class="demo-container">
            <h3 style="color: #667eea; text-align: center; margin-bottom: 20px;">ğŸ¨ å†³ç­–è¾¹ç•Œäº¤äº’å¼æ¼”ç¤º</h3>
            <canvas id="boundaryCanvas" class="demo-canvas" width="800" height="500"></canvas>
            <div class="demo-controls">
                <button class="demo-btn" onclick="addPoint(0)">æ·»åŠ çº¢ç‚¹</button>
                <button class="demo-btn" onclick="addPoint(1)">æ·»åŠ è“ç‚¹</button>
                <button class="demo-btn" onclick="trainBoundary()">è®­ç»ƒæ¨¡å‹</button>
                <button class="demo-btn" onclick="clearBoundary()">æ¸…é™¤ç”»å¸ƒ</button>
            </div>
            <div style="margin-top: 20px; text-align: center;">
                <label style="color: #94a3b8;">æ­£åˆ™åŒ–å¼ºåº¦ C: </label>
                <input type="range" id="cParam" min="0.01" max="10" step="0.01" value="1"
                       oninput="updateCParam(this.value)" style="width: 200px;">
                <span id="cValue" style="color: #667eea; margin-left: 10px;">1.00</span>
            </div>
            <p style="text-align: center; margin-top: 15px; color: #94a3b8;">
                ğŸ’¡ ç‚¹å‡»ç”»å¸ƒæ·»åŠ æ•°æ®ç‚¹ï¼Œè§‚å¯Ÿå†³ç­–è¾¹ç•Œå¦‚ä½•å˜åŒ–
            </p>
        </div>
    </div>

    <!-- æ­£åˆ™åŒ–ä¸è¿‡æ‹Ÿåˆ -->
    <div id="regularization" class="section-card fade-in section-anchor">
        <h2 class="section-title">âš–ï¸ 6.4 æ­£åˆ™åŒ–ï¼šå¹³è¡¡çš„è‰ºæœ¯</h2>

        <div class="thinking-box">
            <h3>è¿‡æ‹Ÿåˆçš„å±é™©</h3>
            <p>æ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°å®Œç¾ï¼Œä½†åœ¨æ–°æ•°æ®ä¸Šè¡¨ç°å¾ˆå·®ã€‚<br>
                å°±åƒä¸€ä¸ªå­¦ç”Ÿæ­»è®°ç¡¬èƒŒäº†æ‰€æœ‰é¢˜ç›®ï¼Œä½†ä¸ä¼šä¸¾ä¸€åä¸‰ã€‚</p>
        </div>

        <!-- æ­£åˆ™åŒ–ç±»å‹ -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 30px;">
            <div style="background: rgba(102, 126, 234, 0.1); padding: 25px; border-radius: 15px; border: 2px solid rgba(102, 126, 234, 0.3);">
                <h4 style="color: #667eea; margin-bottom: 15px;">ğŸ“ L1æ­£åˆ™åŒ–ï¼ˆLassoï¼‰</h4>
                <div class="math-formula" style="font-size: 1.2rem; margin: 15px 0;">
                    Loss = -LogLikelihood + Î»âˆ‘|Î²áµ¢|
                </div>
                <ul style="list-style: none; padding: 0;">
                    <li>âœ“ äº§ç”Ÿç¨€ç–è§£ï¼ˆæŸäº›ç³»æ•°å˜ä¸º0ï¼‰</li>
                    <li>âœ“ è‡ªåŠ¨ç‰¹å¾é€‰æ‹©</li>
                    <li>âœ“ é€‚åˆé«˜ç»´æ•°æ®</li>
                </ul>
            </div>
            <div style="background: rgba(16, 185, 129, 0.1); padding: 25px; border-radius: 15px; border: 2px solid rgba(16, 185, 129, 0.3);">
                <h4 style="color: #10b981; margin-bottom: 15px;">ğŸ“ L2æ­£åˆ™åŒ–ï¼ˆRidgeï¼‰</h4>
                <div class="math-formula" style="font-size: 1.2rem; margin: 15px 0;">
                    Loss = -LogLikelihood + Î»âˆ‘Î²áµ¢Â²
                </div>
                <ul style="list-style: none; padding: 0;">
                    <li>âœ“ ç³»æ•°è¶‹å‘äºå°å€¼</li>
                    <li>âœ“ ä¸ä¼šäº§ç”Ÿç¨€ç–è§£</li>
                    <li>âœ“ å¤„ç†å…±çº¿æ€§æ›´å¥½</li>
                </ul>
            </div>
        </div>

        <!-- Cå‚æ•°è¯´æ˜ -->
        <div style="background: rgba(245, 158, 11, 0.1); padding: 25px; border-radius: 15px; margin-top: 20px; border: 2px solid rgba(245, 158, 11, 0.3);">
            <h4 style="color: #f59e0b;">âš¡ sklearnä¸­çš„Cå‚æ•°</h4>
            <p style="margin-top: 10px;">
                C = 1/Î»ï¼Œæ˜¯æ­£åˆ™åŒ–å¼ºåº¦çš„<span class="highlight-warning">å€’æ•°</span><br>
                â€¢ Cè¶Šå¤§ â†’ æ­£åˆ™åŒ–è¶Šå¼± â†’ æ¨¡å‹è¶Šå¤æ‚ â†’ å¯èƒ½è¿‡æ‹Ÿåˆ<br>
                â€¢ Cè¶Šå° â†’ æ­£åˆ™åŒ–è¶Šå¼º â†’ æ¨¡å‹è¶Šç®€å• â†’ å¯èƒ½æ¬ æ‹Ÿåˆ
            </p>
        </div>
    </div>

    <!-- å¤šåˆ†ç±»æ‰©å±• -->
    <div id="multiclass" class="section-card fade-in section-anchor">
        <h2 class="section-title">ğŸŒˆ 6.5 å¤šåˆ†ç±»ï¼šä»äºŒå…ƒåˆ°å¤šå…ƒ</h2>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
            <!-- One-vs-Rest -->
            <div style="background: rgba(102, 126, 234, 0.1); padding: 25px; border-radius: 15px; border: 2px solid rgba(102, 126, 234, 0.3);">
                <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ¯ One-vs-Rest (OvR)</h3>
                <div style="text-align: center; margin: 20px 0;">
                    <div style="background: #1e293b; padding: 20px; border-radius: 10px;">
                        <p style="margin: 5px;">ç±»åˆ«A vs (B+C+D)</p>
                        <p style="margin: 5px;">ç±»åˆ«B vs (A+C+D)</p>
                        <p style="margin: 5px;">ç±»åˆ«C vs (A+B+D)</p>
                        <p style="margin: 5px;">ç±»åˆ«D vs (A+B+C)</p>
                    </div>
                </div>
                <ul style="list-style: none; padding: 0; margin-top: 20px;">
                    <li>âœ… è®­ç»ƒKä¸ªåˆ†ç±»å™¨ï¼ˆK=ç±»åˆ«æ•°ï¼‰</li>
                    <li>âœ… ç®€å•ç›´è§‚ï¼Œæ˜“äºå¹¶è¡Œ</li>
                    <li>âŒ ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜</li>
                </ul>
            </div>

            <!-- Softmax -->
            <div style="background: rgba(16, 185, 129, 0.1); padding: 25px; border-radius: 15px; border: 2px solid rgba(16, 185, 129, 0.3);">
                <h3 style="color: #10b981; margin-bottom: 15px;">ğŸ”„ Softmaxå›å½’</h3>
                <div class="math-formula" style="font-size: 1.2rem; margin: 20px 0;">
                    P(y=k|x) = e^(zâ‚–) / Î£e^(záµ¢)
                </div>
                <ul style="list-style: none; padding: 0; margin-top: 20px;">
                    <li>âœ… ä¸€ä¸ªç»Ÿä¸€çš„å¤šç±»æ¨¡å‹</li>
                    <li>âœ… è¾“å‡ºæ¦‚ç‡å’Œä¸º1</li>
                    <li>âœ… æ›´å¥½çš„æ¦‚ç‡æ ¡å‡†</li>
                    <li>âŒ è®¡ç®—æˆæœ¬è¾ƒé«˜</li>
                </ul>
            </div>
        </div>

        <!-- æ‰‹å†™æ•°å­—è¯†åˆ«é¢„è§ˆ -->
        <div class="demo-container" style="margin-top: 30px;">
            <h3 style="color: #667eea; text-align: center; margin-bottom: 20px;">âœï¸ æ‰‹å†™æ•°å­—è¯†åˆ«æ¼”ç¤º</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div>
                    <canvas id="digitCanvas" class="demo-canvas" width="280" height="280" style="background: white;"></canvas>
                    <div class="demo-controls" style="margin-top: 10px;">
                        <button class="demo-btn" onclick="clearDigit()">æ¸…é™¤</button>
                        <button class="demo-btn" onclick="predictDigit()">è¯†åˆ«</button>
                    </div>
                </div>
                <div style="background: rgba(30, 41, 59, 0.5); padding: 20px; border-radius: 10px;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">é¢„æµ‹æ¦‚ç‡åˆ†å¸ƒ</h4>
                    <div id="digitPrediction" style="min-height: 200px;">
                        <p style="color: #94a3b8; text-align: center;">åœ¨å·¦ä¾§ç”»å¸ƒä¸Šå†™ä¸€ä¸ªæ•°å­—...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å®æˆ˜æ¡ˆä¾‹1ï¼šå¿ƒè„ç—…é¢„æµ‹ -->
    <div id="heart-case" class="section-card fade-in section-anchor">
        <h2 class="section-title">â¤ï¸ 6.6 å®æˆ˜æ¡ˆä¾‹ä¸€ï¼šå¿ƒè„ç—…é¢„æµ‹ç³»ç»Ÿ</h2>

        <div class="story-box">
            <h3 style="color: #f59e0b;">ğŸ¥ å›åˆ°æ€¥è¯Šå®¤</h3>
            <p>
                ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨é€»è¾‘å›å½’å¸®åŠ©æåŒ»ç”Ÿå»ºç«‹ä¸€ä¸ª<span class="highlight-primary">å¿ƒè„ç—…é¢„æµ‹ç³»ç»Ÿ</span>ï¼<br>
                åŸºäºæ‚£è€…çš„æ£€æŸ¥æ•°æ®ï¼Œå¿«é€Ÿè¯„ä¼°å¿ƒè„ç—…é£é™©ã€‚
            </p>
        </div>

        <!-- æ•°æ®é›†è¯´æ˜ -->
        <div style="background: rgba(102, 126, 234, 0.1); padding: 25px; border-radius: 15px; margin: 20px 0;">
            <h4 style="color: #667eea;">ğŸ“Š æ•°æ®é›†ç‰¹å¾ï¼ˆ14ä¸ªæŒ‡æ ‡ï¼‰</h4>
            <table class="data-table" style="margin-top: 15px;">
                <thead>
                <tr>
                    <th>ç‰¹å¾å</th>
                    <th>æè¿°</th>
                    <th>ç±»å‹</th>
                    <th>å–å€¼èŒƒå›´</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>å¹´é¾„</td>
                    <td>æ‚£è€…å¹´é¾„</td>
                    <td>è¿ç»­</td>
                    <td>29-77å²</td>
                </tr>
                <tr>
                    <td>æ€§åˆ«</td>
                    <td>æ‚£è€…æ€§åˆ«</td>
                    <td>äºŒå…ƒ</td>
                    <td>0=å¥³, 1=ç”·</td>
                </tr>
                <tr>
                    <td>èƒ¸ç—›ç±»å‹</td>
                    <td>èƒ¸ç—›ç—‡çŠ¶åˆ†ç±»</td>
                    <td>åˆ†ç±»</td>
                    <td>1-4ï¼ˆ4ç§ç±»å‹ï¼‰</td>
                </tr>
                <tr>
                    <td>é™æ¯è¡€å‹</td>
                    <td>é™æ¯çŠ¶æ€è¡€å‹</td>
                    <td>è¿ç»­</td>
                    <td>94-200 mmHg</td>
                </tr>
                <tr>
                    <td>èƒ†å›ºé†‡</td>
                    <td>è¡€æ¸…èƒ†å›ºé†‡</td>
                    <td>è¿ç»­</td>
                    <td>126-564 mg/dl</td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- å®Œæ•´ä»£ç å®ç° -->
        <div class="code-block">
                <pre><code><span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split, GridSearchCV
<span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler, OneHotEncoder
<span class="keyword">from</span> sklearn.compose <span class="keyword">import</span> ColumnTransformer
<span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression
<span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, confusion_matrix, classification_report
<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt
<span class="keyword">import</span> seaborn <span class="keyword">as</span> sns

<span class="comment"># 1. æ•°æ®åŠ è½½ä¸æ¢ç´¢</span>
heart_disease = pd.read_csv(<span class="string">"data/heart_disease.csv"</span>)
print(<span class="string">f"æ•°æ®é›†å½¢çŠ¶: {heart_disease.shape}"</span>)
print(<span class="string">f"ç¼ºå¤±å€¼ç»Ÿè®¡:\n{heart_disease.isnull().sum()}"</span>)

<span class="comment"># 2. ç‰¹å¾å·¥ç¨‹</span>
<span class="comment"># å®šä¹‰ç‰¹å¾ç±»å‹</span>
numerical_features = [<span class="string">"å¹´é¾„"</span>, <span class="string">"é™æ¯è¡€å‹"</span>, <span class="string">"èƒ†å›ºé†‡"</span>,
                     <span class="string">"æœ€å¤§å¿ƒç‡"</span>, <span class="string">"è¿åŠ¨åçš„STä¸‹é™"</span>, <span class="string">"ä¸»è¡€ç®¡æ•°é‡"</span>]
categorical_features = [<span class="string">"èƒ¸ç—›ç±»å‹"</span>, <span class="string">"é™æ¯å¿ƒç”µå›¾ç»“æœ"</span>,
                       <span class="string">"å³°å€¼STæ®µçš„æ–œç‡"</span>, <span class="string">"åœ°ä¸­æµ·è´«è¡€"</span>]
binary_features = [<span class="string">"æ€§åˆ«"</span>, <span class="string">"ç©ºè…¹è¡€ç³–"</span>, <span class="string">"è¿åŠ¨æ€§å¿ƒç»ç—›"</span>]

<span class="comment"># åˆ›å»ºé¢„å¤„ç†ç®¡é“</span>
preprocessor = ColumnTransformer(
    transformers=[
        (<span class="string">"num"</span>, StandardScaler(), numerical_features),
        (<span class="string">"cat"</span>, OneHotEncoder(drop=<span class="string">"first"</span>), categorical_features),
        (<span class="string">"binary"</span>, <span class="string">"passthrough"</span>, binary_features),
    ]
)

<span class="comment"># 3. æ•°æ®åˆ’åˆ†</span>
X = heart_disease.drop(<span class="string">"æ˜¯å¦æ‚£æœ‰å¿ƒè„ç—…"</span>, axis=<span class="number">1</span>)
y = heart_disease[<span class="string">"æ˜¯å¦æ‚£æœ‰å¿ƒè„ç—…"</span>]
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=<span class="number">0.3</span>, random_state=<span class="number">42</span>, stratify=y
)

<span class="comment"># 4. æ•°æ®é¢„å¤„ç†</span>
X_train_processed = preprocessor.fit_transform(X_train)
X_test_processed = preprocessor.transform(X_test)

<span class="comment"># 5. æ¨¡å‹è®­ç»ƒä¸è°ƒå‚</span>
<span class="comment"># ç½‘æ ¼æœç´¢æœ€ä½³å‚æ•°</span>
param_grid = {
    <span class="string">'C'</span>: [<span class="number">0.001</span>, <span class="number">0.01</span>, <span class="number">0.1</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">100</span>],
    <span class="string">'penalty'</span>: [<span class="string">'l1'</span>, <span class="string">'l2'</span>],
    <span class="string">'solver'</span>: [<span class="string">'liblinear'</span>]
}

grid_search = GridSearchCV(
    LogisticRegression(random_state=<span class="number">42</span>, max_iter=<span class="number">1000</span>),
    param_grid,
    cv=<span class="number">5</span>,
    scoring=<span class="string">'roc_auc'</span>,
    n_jobs=<span class="number">-1</span>
)

grid_search.fit(X_train_processed, y_train)
print(<span class="string">f"æœ€ä½³å‚æ•°: {grid_search.best_params_}"</span>)
print(<span class="string">f"æœ€ä½³AUCåˆ†æ•°: {grid_search.best_score_:.4f}"</span>)

<span class="comment"># 6. æ¨¡å‹è¯„ä¼°</span>
best_model = grid_search.best_estimator_
y_pred = best_model.predict(X_test_processed)
y_pred_proba = best_model.predict_proba(X_test_processed)[:, <span class="number">1</span>]

<span class="comment"># æ··æ·†çŸ©é˜µå¯è§†åŒ–</span>
plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))
cm = confusion_matrix(y_test, y_pred)
sns.heatmap(cm, annot=<span class="keyword">True</span>, fmt=<span class="string">'d'</span>, cmap=<span class="string">'Blues'</span>)
plt.title(<span class="string">'å¿ƒè„ç—…é¢„æµ‹æ··æ·†çŸ©é˜µ'</span>)
plt.ylabel(<span class="string">'çœŸå®æ ‡ç­¾'</span>)
plt.xlabel(<span class="string">'é¢„æµ‹æ ‡ç­¾'</span>)
plt.show()

<span class="comment"># 7. ç‰¹å¾é‡è¦æ€§åˆ†æ</span>
feature_importance = pd.DataFrame({
    <span class="string">'feature'</span>: preprocessor.get_feature_names_out(),
    <span class="string">'coefficient'</span>: best_model.coef_[<span class="number">0</span>]
})
feature_importance = feature_importance.sort_values(<span class="string">'coefficient'</span>,
                                                  key=abs,
                                                  ascending=<span class="keyword">False</span>)
print(<span class="string">"\nå‰10ä¸ªé‡è¦ç‰¹å¾:"</span>)
print(feature_importance.head(<span class="number">10</span>))

<span class="comment"># 8. å®é™…åº”ç”¨ï¼šé£é™©è¯„ä¼°å‡½æ•°</span>
<span class="keyword">def</span> <span class="function">assess_heart_disease_risk</span>(patient_data, model, preprocessor):
    <span class="string">"""è¯„ä¼°å•ä¸ªæ‚£è€…çš„å¿ƒè„ç—…é£é™©"""</span>
    <span class="comment"># é¢„å¤„ç†æ•°æ®</span>
    patient_processed = preprocessor.transform([patient_data])

    <span class="comment"># é¢„æµ‹æ¦‚ç‡</span>
    risk_probability = model.predict_proba(patient_processed)[<span class="number">0</span>, <span class="number">1</span>]

    <span class="comment"># é£é™©åˆ†çº§</span>
    <span class="keyword">if</span> risk_probability < <span class="number">0.3</span>:
        risk_level = <span class="string">"ä½é£é™©"</span>
        color = <span class="string">"green"</span>
    <span class="keyword">elif</span> risk_probability < <span class="number">0.7</span>:
        risk_level = <span class="string">"ä¸­ç­‰é£é™©"</span>
        color = <span class="string">"orange"</span>
    <span class="keyword">else</span>:
        risk_level = <span class="string">"é«˜é£é™©"</span>
        color = <span class="string">"red"</span>

    <span class="keyword">return</span> {
        <span class="string">'probability'</span>: risk_probability,
        <span class="string">'risk_level'</span>: risk_level,
        <span class="string">'color'</span>: color
    }</code></pre>
        </div>

        <!-- æ¨¡å‹æ€§èƒ½å±•ç¤º -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 30px;">
            <div style="background: rgba(16, 185, 129, 0.1); padding: 20px; border-radius: 15px; text-align: center; border: 2px solid rgba(16, 185, 129, 0.3);">
                <h4 style="color: #10b981;">å‡†ç¡®ç‡</h4>
                <p style="font-size: 2rem; margin: 10px 0;">87.9%</p>
            </div>
            <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; text-align: center; border: 2px solid rgba(102, 126, 234, 0.3);">
                <h4 style="color: #667eea;">ç²¾ç¡®ç‡</h4>
                <p style="font-size: 2rem; margin: 10px 0;">89.2%</p>
            </div>
            <div style="background: rgba(245, 158, 11, 0.1); padding: 20px; border-radius: 15px; text-align: center; border: 2px solid rgba(245, 158, 11, 0.3);">
                <h4 style="color: #f59e0b;">å¬å›ç‡</h4>
                <p style="font-size: 2rem; margin: 10px 0;">85.7%</p>
            </div>
            <div style="background: rgba(239, 68, 68, 0.1); padding: 20px; border-radius: 15px; text-align: center; border: 2px solid rgba(239, 68, 68, 0.3);">
                <h4 style="color: #ef4444;">AUCåˆ†æ•°</h4>
                <p style="font-size: 2rem; margin: 10px 0;">0.926</p>
            </div>
        </div>
    </div>

    <!-- å®æˆ˜æ¡ˆä¾‹2ï¼šæ‰‹å†™æ•°å­—è¯†åˆ« -->
    <div id="digit-case" class="section-card fade-in section-anchor">
        <h2 class="section-title">âœï¸ 6.7 å®æˆ˜æ¡ˆä¾‹äºŒï¼šæ‰‹å†™æ•°å­—è¯†åˆ«</h2>

        <div class="story-box">
            <h3 style="color: #f59e0b;">ğŸ“® é‚®æ”¿ç¼–ç çš„æ™ºèƒ½è¯†åˆ«</h3>
            <p>
                é‚®å±€æ¯å¤©å¤„ç†æ•°ç™¾ä¸‡å°ä¿¡ä»¶ï¼Œæ‰‹å·¥è¯†åˆ«é‚®ç¼–æ•ˆç‡ä½ä¸‹ã€‚<br>
                è®©æˆ‘ä»¬ç”¨é€»è¾‘å›å½’æ„å»ºä¸€ä¸ª<span class="highlight-primary">æ‰‹å†™æ•°å­—è¯†åˆ«ç³»ç»Ÿ</span>ï¼
            </p>
        </div>

        <!-- MNISTæ•°æ®é›†å±•ç¤º -->
        <div class="demo-container">
            <h3 style="color: #667eea; text-align: center; margin-bottom: 20px;">ğŸ“Š MNISTæ•°æ®é›†æ ·æœ¬å±•ç¤º</h3>
            <div id="mnistSamples" style="display: grid; grid-template-columns: repeat(10, 1fr); gap: 10px; padding: 20px;">
                <!-- è¿™é‡Œä¼šåŠ¨æ€åŠ è½½MNISTæ ·æœ¬ -->
            </div>
            <button class="demo-btn" onclick="loadNewSamples()" style="margin: 20px auto; display: block;">
                åˆ·æ–°æ ·æœ¬
            </button>
        </div>

        <!-- æ‰‹å†™æ•°å­—è¯†åˆ«ä»£ç  -->
        <div class="code-block">
                <pre><code><span class="keyword">import</span> pandas <span class="keyword">as</span> pd
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split
<span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler
<span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression
<span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, confusion_matrix
<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt

<span class="comment"># 1. åŠ è½½MNISTæ•°æ®é›†</span>
digit_data = pd.read_csv(<span class="string">"data/train.csv"</span>)
print(<span class="string">f"æ•°æ®é›†å¤§å°: {digit_data.shape}"</span>)

<span class="comment"># 2. æ•°æ®å¯è§†åŒ–</span>
<span class="keyword">def</span> <span class="function">visualize_digit</span>(data, index):
    <span class="string">"""å¯è§†åŒ–å•ä¸ªæ•°å­—"""</span>
    digit = data.iloc[index, <span class="number">1</span>:].values.reshape(<span class="number">28</span>, <span class="number">28</span>)
    label = data.iloc[index, <span class="number">0</span>]

    plt.figure(figsize=(<span class="number">3</span>, <span class="number">3</span>))
    plt.imshow(digit, cmap=<span class="string">'gray'</span>)
    plt.title(<span class="string">f'æ ‡ç­¾: {label}'</span>)
    plt.axis(<span class="string">'off'</span>)
    plt.show()

<span class="comment"># æ˜¾ç¤ºä¸€äº›æ ·æœ¬</span>
fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">5</span>, figsize=(<span class="number">12</span>, <span class="number">5</span>))
<span class="keyword">for</span> i, ax <span class="keyword">in</span> enumerate(axes.flat):
    digit = digit_data.iloc[i, <span class="number">1</span>:].values.reshape(<span class="number">28</span>, <span class="number">28</span>)
    label = digit_data.iloc[i, <span class="number">0</span>]
    ax.imshow(digit, cmap=<span class="string">'gray'</span>)
    ax.set_title(<span class="string">f'Label: {label}'</span>)
    ax.axis(<span class="string">'off'</span>)
plt.tight_layout()
plt.show()

<span class="comment"># 3. æ•°æ®é¢„å¤„ç†</span>
X = digit_data.drop(<span class="string">"label"</span>, axis=<span class="number">1</span>)
y = digit_data[<span class="string">"label"</span>]

<span class="comment"># å½’ä¸€åŒ–åˆ°[0,1]</span>
scaler = MinMaxScaler()
X_normalized = scaler.fit_transform(X)

<span class="comment"># æ•°æ®åˆ’åˆ†</span>
X_train, X_test, y_train, y_test = train_test_split(
    X_normalized, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>, stratify=y
)

<span class="comment"># 4. æ¨¡å‹è®­ç»ƒï¼ˆå¤šåˆ†ç±»ï¼‰</span>
<span class="comment"># ä½¿ç”¨sagaæ±‚è§£å™¨æ”¯æŒå¤šåˆ†ç±»</span>
model = LogisticRegression(
    multi_class=<span class="string">'multinomial'</span>,  <span class="comment"># Softmaxå›å½’</span>
    solver=<span class="string">'saga'</span>,              <span class="comment"># æ”¯æŒL1æ­£åˆ™åŒ–</span>
    penalty=<span class="string">'l1'</span>,               <span class="comment"># L1æ­£åˆ™åŒ–äº§ç”Ÿç¨€ç–è§£</span>
    C=<span class="number">0.1</span>,                      <span class="comment"># æ­£åˆ™åŒ–å¼ºåº¦</span>
    max_iter=<span class="number">200</span>,               <span class="comment"># æœ€å¤§è¿­ä»£æ¬¡æ•°</span>
    random_state=<span class="number">42</span>,
    n_jobs=<span class="number">-1</span>                   <span class="comment"># å¹¶è¡Œè®¡ç®—</span>
)

<span class="comment"># è®­ç»ƒæ¨¡å‹</span>
print(<span class="string">"å¼€å§‹è®­ç»ƒæ¨¡å‹..."</span>)
model.fit(X_train, y_train)
print(<span class="string">"è®­ç»ƒå®Œæˆ!"</span>)

<span class="comment"># 5. æ¨¡å‹è¯„ä¼°</span>
train_accuracy = model.score(X_train, y_train)
test_accuracy = model.score(X_test, y_test)
print(<span class="string">f"\nè®­ç»ƒé›†å‡†ç¡®ç‡: {train_accuracy:.4f}"</span>)
print(<span class="string">f"æµ‹è¯•é›†å‡†ç¡®ç‡: {test_accuracy:.4f}"</span>)

<span class="comment"># 6. æ··æ·†çŸ©é˜µåˆ†æ</span>
y_pred = model.predict(X_test)
cm = confusion_matrix(y_test, y_pred)

plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))
sns.heatmap(cm, annot=<span class="keyword">True</span>, fmt=<span class="string">'d'</span>, cmap=<span class="string">'Blues'</span>,
            xticklabels=range(<span class="number">10</span>), yticklabels=range(<span class="number">10</span>))
plt.title(<span class="string">'æ‰‹å†™æ•°å­—è¯†åˆ«æ··æ·†çŸ©é˜µ'</span>)
plt.ylabel(<span class="string">'çœŸå®æ•°å­—'</span>)
plt.xlabel(<span class="string">'é¢„æµ‹æ•°å­—'</span>)
plt.show()

<span class="comment"># 7. é”™è¯¯æ¡ˆä¾‹åˆ†æ</span>
<span class="keyword">def</span> <span class="function">show_misclassified</span>(X_test, y_test, y_pred, n_samples=<span class="number">10</span>):
    <span class="string">"""æ˜¾ç¤ºåˆ†ç±»é”™è¯¯çš„æ ·æœ¬"""</span>
    misclassified_idx = np.where(y_test != y_pred)[<span class="number">0</span>]

    fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">5</span>, figsize=(<span class="number">12</span>, <span class="number">5</span>))
    <span class="keyword">for</span> i, ax <span class="keyword">in</span> enumerate(axes.flat):
        <span class="keyword">if</span> i < len(misclassified_idx):
            idx = misclassified_idx[i]
            digit = X_test[idx].reshape(<span class="number">28</span>, <span class="number">28</span>)
            ax.imshow(digit, cmap=<span class="string">'gray'</span>)
            ax.set_title(<span class="string">f'çœŸå®: {y_test.iloc[idx]}, é¢„æµ‹: {y_pred[idx]}'</span>,
                        color=<span class="string">'red'</span>)
            ax.axis(<span class="string">'off'</span>)
    plt.suptitle(<span class="string">'åˆ†ç±»é”™è¯¯çš„æ ·æœ¬'</span>)
    plt.tight_layout()
    plt.show()

show_misclassified(X_test, y_test, y_pred)

<span class="comment"># 8. ç‰¹å¾å¯è§†åŒ–ï¼ˆæŸ¥çœ‹æ¯ä¸ªæ•°å­—çš„"å¹³å‡å½¢è±¡"ï¼‰</span>
fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">5</span>, figsize=(<span class="number">12</span>, <span class="number">5</span>))
<span class="keyword">for</span> digit, ax <span class="keyword">in</span> enumerate(axes.flat):
    <span class="comment"># è·å–è¯¥æ•°å­—ç±»åˆ«çš„æƒé‡</span>
    weights = model.coef_[digit].reshape(<span class="number">28</span>, <span class="number">28</span>)

    <span class="comment"># å¯è§†åŒ–æƒé‡</span>
    im = ax.imshow(weights, cmap=<span class="string">'RdBu'</span>, vmin=-np.max(np.abs(weights)),
                   vmax=np.max(np.abs(weights)))
    ax.set_title(<span class="string">f'æ•°å­— {digit} çš„ç‰¹å¾æƒé‡'</span>)
    ax.axis(<span class="string">'off'</span>)

plt.suptitle(<span class="string">'é€»è¾‘å›å½’å­¦åˆ°çš„æ•°å­—ç‰¹å¾'</span>)
plt.tight_layout()
plt.show()

<span class="comment"># 9. å®æ—¶é¢„æµ‹å‡½æ•°</span>
<span class="keyword">def</span> <span class="function">predict_digit</span>(image_array, model, scaler):
    <span class="string">"""é¢„æµ‹å•ä¸ªæ‰‹å†™æ•°å­—"""</span>
    <span class="comment"># ç¡®ä¿è¾“å…¥æ˜¯784ç»´å‘é‡</span>
    image_flat = image_array.reshape(<span class="number">1</span>, <span class="number">-1</span>)

    <span class="comment"># å½’ä¸€åŒ–</span>
    image_normalized = scaler.transform(image_flat)

    <span class="comment"># é¢„æµ‹</span>
    prediction = model.predict(image_normalized)[<span class="number">0</span>]
    probabilities = model.predict_proba(image_normalized)[<span class="number">0</span>]

    <span class="keyword">return</span> {
        <span class="string">'prediction'</span>: prediction,
        <span class="string">'probabilities'</span>: probabilities,
        <span class="string">'confidence'</span>: np.max(probabilities)
    }</code></pre>
        </div>

        <!-- æ€§èƒ½å¯¹æ¯” -->
        <div style="background: rgba(102, 126, 234, 0.1); padding: 25px; border-radius: 15px; margin-top: 30px;">
            <h4 style="color: #667eea;">ğŸ† ä¸åŒé…ç½®çš„æ€§èƒ½å¯¹æ¯”</h4>
            <table class="data-table" style="margin-top: 15px;">
                <thead>
                <tr>
                    <th>é…ç½®</th>
                    <th>æ±‚è§£å™¨</th>
                    <th>æ­£åˆ™åŒ–</th>
                    <th>è®­ç»ƒæ—¶é—´</th>
                    <th>æµ‹è¯•å‡†ç¡®ç‡</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>OvR + L2</td>
                    <td>lbfgs</td>
                    <td>L2 (C=1)</td>
                    <td>45.2s</td>
                    <td>91.8%</td>
                </tr>
                <tr>
                    <td>Softmax + L2</td>
                    <td>saga</td>
                    <td>L2 (C=1)</td>
                    <td>38.7s</td>
                    <td>92.5%</td>
                </tr>
                <tr>
                    <td>Softmax + L1</td>
                    <td>saga</td>
                    <td>L1 (C=0.1)</td>
                    <td>52.3s</td>
                    <td>92.1%</td>
                </tr>
                <tr>
                    <td>Softmax + Elastic</td>
                    <td>saga</td>
                    <td>ElasticNet</td>
                    <td>56.8s</td>
                    <td>92.7%</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- æ¨¡å‹è¯Šæ–­ä¸ä¼˜åŒ– -->
    <div id="diagnosis" class="section-card fade-in section-anchor">
        <h2 class="section-title">ğŸ” 6.8 æ¨¡å‹è¯Šæ–­ä¸ä¼˜åŒ–</h2>

        <!-- å­¦ä¹ æ›²çº¿ -->
        <div class="demo-container">
            <h3 style="color: #667eea; text-align: center; margin-bottom: 20px;">ğŸ“ˆ å­¦ä¹ æ›²çº¿åˆ†æ</h3>
            <canvas id="learningCurveCanvas" class="demo-canvas" width="800" height="400"></canvas>
            <div class="demo-controls">
                <button class="demo-btn" onclick="showLearningCurve('bias')">é«˜åå·®</button>
                <button class="demo-btn" onclick="showLearningCurve('variance')">é«˜æ–¹å·®</button>
                <button class="demo-btn" onclick="showLearningCurve('good')">è‰¯å¥½æ‹Ÿåˆ</button>
            </div>
        </div>

        <!-- è¯Šæ–­æŠ€å·§ -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 30px;">
            <div style="background: rgba(239, 68, 68, 0.1); padding: 25px; border-radius: 15px; border: 2px solid rgba(239, 68, 68, 0.3);">
                <h4 style="color: #ef4444;">ğŸ”´ æ¬ æ‹Ÿåˆè¯Šæ–­</h4>
                <ul style="list-style: none; padding: 0; margin-top: 15px;">
                    <li>â€¢ è®­ç»ƒé›†å‡†ç¡®ç‡ä½</li>
                    <li>â€¢ éªŒè¯é›†å‡†ç¡®ç‡ä¹Ÿä½</li>
                    <li>â€¢ å­¦ä¹ æ›²çº¿æ”¶æ•›ä½†æ€§èƒ½å·®</li>
                </ul>
                <p style="margin-top: 15px;"><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
                <ul style="list-style: none; padding: 0;">
                    <li>âœ“ å¢åŠ ç‰¹å¾</li>
                    <li>âœ“ å¢åŠ å¤šé¡¹å¼ç‰¹å¾</li>
                    <li>âœ“ å‡å°æ­£åˆ™åŒ–å¼ºåº¦</li>
                </ul>
            </div>

            <div style="background: rgba(245, 158, 11, 0.1); padding: 25px; border-radius: 15px; border: 2px solid rgba(245, 158, 11, 0.3);">
                <h4 style="color: #f59e0b;">ğŸŸ¡ è¿‡æ‹Ÿåˆè¯Šæ–­</h4>
                <ul style="list-style: none; padding: 0; margin-top: 15px;">
                    <li>â€¢ è®­ç»ƒé›†å‡†ç¡®ç‡å¾ˆé«˜</li>
                    <li>â€¢ éªŒè¯é›†å‡†ç¡®ç‡æ˜æ˜¾è¾ƒä½</li>
                    <li>â€¢ å­¦ä¹ æ›²çº¿æœ‰è¾ƒå¤§é—´éš™</li>
                </ul>
                <p style="margin-top: 15px;"><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
                <ul style="list-style: none; padding: 0;">
                    <li>âœ“ å¢åŠ è®­ç»ƒæ•°æ®</li>
                    <li>âœ“ å¢å¼ºæ­£åˆ™åŒ–</li>
                    <li>âœ“ ç‰¹å¾é€‰æ‹©</li>
                </ul>
            </div>

            <div style="background: rgba(16, 185, 129, 0.1); padding: 25px; border-radius: 15px; border: 2px solid rgba(16, 185, 129, 0.3);">
                <h4 style="color: #10b981;">ğŸŸ¢ è‰¯å¥½æ‹Ÿåˆ</h4>
                <ul style="list-style: none; padding: 0; margin-top: 15px;">
                    <li>â€¢ è®­ç»ƒé›†å‡†ç¡®ç‡é«˜</li>
                    <li>â€¢ éªŒè¯é›†å‡†ç¡®ç‡æ¥è¿‘</li>
                    <li>â€¢ å­¦ä¹ æ›²çº¿æ”¶æ•›ä¸”é—´éš™å°</li>
                </ul>
                <p style="margin-top: 15px;"><strong>ç»§ç»­ä¼˜åŒ–ï¼š</strong></p>
                <ul style="list-style: none; padding: 0;">
                    <li>âœ“ é›†æˆå­¦ä¹ </li>
                    <li>âœ“ ç‰¹å¾å·¥ç¨‹</li>
                    <li>âœ“ è¶…å‚æ•°å¾®è°ƒ</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- æ€»ç»“ä¸æ€è€ƒ -->
    <div id="summary" class="section-card fade-in section-anchor">
        <h2 class="section-title">ğŸ“ 6.9 æ€»ç»“ä¸æ·±åº¦æ€è€ƒ</h2>

        <div class="thinking-box">
            <h3>å›é¡¾ï¼šä»çº¿æ€§åˆ°é€»è¾‘çš„æ—…ç¨‹</h3>
            <div style="margin-top: 20px;">
                <p>1ï¸âƒ£ <span class="highlight-primary">é—®é¢˜èµ·æº</span>ï¼šçº¿æ€§å›å½’æ— æ³•ç›´æ¥ç”¨äºåˆ†ç±»</p>
                <p>2ï¸âƒ£ <span class="highlight-success">Sigmoidå˜æ¢</span>ï¼šå°†çº¿æ€§è¾“å‡ºæ˜ å°„åˆ°æ¦‚ç‡ç©ºé—´</p>
                <p>3ï¸âƒ£ <span class="highlight-warning">æŸå¤±å‡½æ•°</span>ï¼šä»MSEåˆ°äº¤å‰ç†µçš„è½¬å˜</p>
                <p>4ï¸âƒ£ <span class="highlight-danger">æ­£åˆ™åŒ–</span>ï¼šé˜²æ­¢è¿‡æ‹Ÿåˆçš„å…³é”®</p>
                <p>5ï¸âƒ£ <span class="highlight-primary">å¤šåˆ†ç±»æ‰©å±•</span>ï¼šOvRå’ŒSoftmaxä¸¤ç§ç­–ç•¥</p>
            </div>
        </div>

        <!-- æ ¸å¿ƒè¦ç‚¹æ€»ç»“ -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 30px 0;">
            <div class="pulse" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(124, 58, 237, 0.1)); padding: 25px; border-radius: 15px; border: 2px solid rgba(102, 126, 234, 0.4); text-align: center;">
                <h4 style="color: #667eea; margin-bottom: 15px;">ğŸ§® æ•°å­¦åŸºç¡€</h4>
                <p>Sigmoidå‡½æ•°<br>äº¤å‰ç†µæŸå¤±<br>æ¢¯åº¦ä¸‹é™ä¼˜åŒ–</p>
            </div>
            <div class="pulse" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.1)); padding: 25px; border-radius: 15px; border: 2px solid rgba(16, 185, 129, 0.4); text-align: center; animation-delay: 0.3s;">
                <h4 style="color: #10b981; margin-bottom: 15px;">ğŸ› ï¸ å®è·µæŠ€å·§</h4>
                <p>ç‰¹å¾ç¼©æ”¾å¿…é¡»<br>æ­£åˆ™åŒ–é˜²è¿‡æ‹Ÿåˆ<br>ç±»åˆ«å¹³è¡¡å¤„ç†</p>
            </div>
            <div class="pulse" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(217, 119, 6, 0.1)); padding: 25px; border-radius: 15px; border: 2px solid rgba(245, 158, 11, 0.4); text-align: center; animation-delay: 0.6s;">
                <h4 style="color: #f59e0b; margin-bottom: 15px;">ğŸ¯ åº”ç”¨åœºæ™¯</h4>
                <p>åŒ»ç–—è¯Šæ–­<br>åƒåœ¾é‚®ä»¶è¿‡æ»¤<br>ä¿¡ç”¨è¯„åˆ†</p>
            </div>
            <div class="pulse" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(220, 38, 38, 0.1)); padding: 25px; border-radius: 15px; border: 2px solid rgba(239, 68, 68, 0.4); text-align: center; animation-delay: 0.9s;">
                <h4 style="color: #ef4444; margin-bottom: 15px;">âš¡ ä¼˜åŒ–è¦ç‚¹</h4>
                <p>å­¦ä¹ æ›²çº¿è¯Šæ–­<br>è¶…å‚æ•°è°ƒä¼˜<br>æ¨¡å‹é›†æˆ</p>
            </div>
        </div>

        <!-- æ·±åº¦æ€è€ƒé¢˜ -->
        <div style="background: rgba(139, 92, 246, 0.1); padding: 30px; border-radius: 20px; margin: 30px 0; border: 2px solid rgba(139, 92, 246, 0.3);">
            <h3 style="color: #8b5cf6; margin-bottom: 20px;">ğŸ¤” æ·±åº¦æ€è€ƒé¢˜</h3>
            <ol style="line-height: 2; padding-left: 20px;">
                <li><strong>çº¿æ€§å¯åˆ†æ€§ï¼š</strong>é€»è¾‘å›å½’å‡è®¾æ•°æ®æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œå¦‚æœä¸æ˜¯ä¼šæ€æ ·ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</li>
                <li><strong>æ¦‚ç‡æ ¡å‡†ï¼š</strong>é€»è¾‘å›å½’è¾“å‡ºçš„æ¦‚ç‡æ˜¯å¦çœŸçš„å¯é ï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦æ¦‚ç‡æ ¡å‡†ï¼Ÿ</li>
                <li><strong>ç‰¹å¾å·¥ç¨‹ï¼š</strong>å¦‚ä½•é€šè¿‡ç‰¹å¾å·¥ç¨‹è®©é€»è¾‘å›å½’å¤„ç†éçº¿æ€§é—®é¢˜ï¼Ÿå¤šé¡¹å¼ç‰¹å¾çš„åº¦æ•°å¦‚ä½•é€‰æ‹©ï¼Ÿ</li>
                <li><strong>ç±»åˆ«ä¸å¹³è¡¡ï¼š</strong>å½“æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ä¸º1:100æ—¶ï¼Œé€»è¾‘å›å½’ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿæœ‰å“ªäº›è§£å†³æ–¹æ¡ˆï¼Ÿ</li>
                <li><strong>ä¸å…¶ä»–ç®—æ³•å¯¹æ¯”ï¼š</strong>é€»è¾‘å›å½’ã€SVMã€å†³ç­–æ ‘å„è‡ªçš„ä¼˜åŠ£æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€‰æ‹©ï¼Ÿ</li>
            </ol>
        </div>

        <!-- ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®® -->
        <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05)); padding: 30px; border-radius: 20px; border: 2px solid rgba(16, 185, 129, 0.3);">
            <h3 style="color: #10b981; margin-bottom: 20px;">ğŸ“š å»¶ä¼¸å­¦ä¹ è·¯å¾„</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <h4 style="color: #667eea;">ç†è®ºæ·±åŒ–</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li>ğŸ“– å¹¿ä¹‰çº¿æ€§æ¨¡å‹(GLM)</li>
                        <li>ğŸ“Š æœ€å¤§ç†µæ¨¡å‹</li>
                        <li>ğŸ§® è´å¶æ–¯é€»è¾‘å›å½’</li>
                        <li>ğŸ”¬ æ ¸é€»è¾‘å›å½’</li>
                    </ul>
                </div>
                <div>
                    <h4 style="color: #f59e0b;">å®è·µè¿›é˜¶</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li>âš¡ åœ¨çº¿å­¦ä¹ ç®—æ³•</li>
                        <li>ğŸ—ï¸ å¤§è§„æ¨¡é€»è¾‘å›å½’</li>
                        <li>ğŸ¤– æ·±åº¦å­¦ä¹ ä¸­çš„Sigmoid</li>
                        <li>ğŸ“± æ¨¡å‹éƒ¨ç½²ä¼˜åŒ–</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- ç»“è¯­ -->
    <div class="section-card fade-in" style="text-align: center; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(124, 58, 237, 0.05)); border: 3px solid rgba(102, 126, 234, 0.4);">
        <h2 style="font-size: 3rem; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 30px;">
            ğŸ‰ æ­å–œå®Œæˆé€»è¾‘å›å½’å­¦ä¹ ï¼
        </h2>
        <p style="font-size: 1.3rem; color: #cbd5e1; line-height: 1.8; margin-bottom: 40px;">
            ä»åŒ»ç”Ÿçš„è¯Šæ–­å›°å¢ƒåˆ°æ™ºèƒ½è¯†åˆ«ç³»ç»Ÿ<br>
            ä½ å·²ç»æŒæ¡äº†åˆ†ç±»é—®é¢˜çš„æ ¸å¿ƒç®—æ³•<br>
            é€»è¾‘å›å½’â€”â€”è¿æ¥çº¿æ€§ä¸éçº¿æ€§ä¸–ç•Œçš„æ¡¥æ¢
        </p>
        <div class="demo-controls">
            <button class="demo-btn" onclick="downloadNotes()" style="font-size: 1.1rem; padding: 15px 30px;">
                ğŸ“¥ ä¸‹è½½å­¦ä¹ ç¬”è®°
            </button>
            <button class="demo-btn" onclick="startQuiz()" style="font-size: 1.1rem; padding: 15px 30px;">
                ğŸ§  å¼€å§‹çŸ¥è¯†æµ‹éªŒ
            </button>
            <button class="demo-btn" onclick="shareAchievement()" style="font-size: 1.1rem; padding: 15px 30px;">
                ğŸŠ åˆ†äº«å­¦ä¹ æˆå°±
            </button>
        </div>
    </div>
</div>

<!-- æµ®åŠ¨å·¥å…·æ  -->
<div class="floating-toolbar">
    <button class="toolbar-btn theme-toggle-btn" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">
        <span class="theme-icon">ğŸŒ“</span>
    </button>
    <button class="toolbar-btn" onclick="scrollToTop()" title="å›åˆ°é¡¶éƒ¨">â¬†ï¸</button>
    <button class="toolbar-btn" onclick="toggleHelp()" title="å¸®åŠ©">â“</button>
</div>

<script>
    // å¯¼èˆªç³»ç»ŸåŠŸèƒ½
    let navOpen = false;
    let sectionsRead = new Set();
    let totalSections = 10;

    // åˆ‡æ¢å¯¼èˆª
    function toggleNav() {
        navOpen = !navOpen;
        document.body.classList.toggle('nav-open', navOpen);
    }

    // é”®ç›˜å¿«æ·é”®æ”¯æŒ
    document.addEventListener('keydown', function(e) {
        // Alt + N åˆ‡æ¢å¯¼èˆª
        if (e.altKey && e.key === 'n') {
            e.preventDefault();
            toggleNav();
        }

        // Ctrl/Cmd + S: ä¿å­˜ç¬”è®°
        if ((e.ctrlKey || e.metaKey) && e.key === 's') {
            e.preventDefault();
            downloadNotes();
        }

        // Ctrl/Cmd + Q: å¼€å§‹æµ‹éªŒ
        if ((e.ctrlKey || e.metaKey) && e.key === 'q') {
            e.preventDefault();
            startQuiz();
        }

        // ESC: è¿”å›é¡¶éƒ¨
        if (e.key === 'Escape') {
            scrollToTop();
        }
    });

    // åˆå§‹åŒ–å¯¼èˆªç›‘å¬
    function initNavigation() {
        // å¯¼èˆªé¡¹ç‚¹å‡»äº‹ä»¶
        const navItems = document.querySelectorAll('.nav-item a');
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);

                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });

                    // æ›´æ–°æ´»åŠ¨çŠ¶æ€
                    document.querySelectorAll('.nav-item').forEach(ni => ni.classList.remove('active'));
                    this.parentElement.classList.add('active');
                }
            });
        });

        // æ»šåŠ¨ç›‘å¬
        updateNavigationOnScroll();
    }

    // æ›´æ–°å¯¼èˆªçŠ¶æ€
    function updateNavigationOnScroll() {
        const sections = document.querySelectorAll('.section-anchor');
        const navItems = document.querySelectorAll('.nav-item');

        let scrollTimeout;

        window.addEventListener('scroll', function() {
            if (scrollTimeout) clearTimeout(scrollTimeout);

            scrollTimeout = setTimeout(() => {
                const scrollPosition = window.scrollY + 150;

                // æ›´æ–°è¿›åº¦
                updateProgress();

                // æ›´æ–°å½“å‰ç« èŠ‚
                sections.forEach((section, index) => {
                    const sectionTop = section.offsetTop;
                    const sectionBottom = sectionTop + section.offsetHeight;

                    if (scrollPosition >= sectionTop && scrollPosition < sectionBottom) {
                        // æ›´æ–°å¯¼èˆªæ´»åŠ¨çŠ¶æ€
                        navItems.forEach(item => item.classList.remove('active'));
                        if (navItems[index]) {
                            navItems[index].classList.add('active');

                            // æ ‡è®°ä¸ºå·²è¯»
                            const sectionId = section.id;
                            if (!sectionsRead.has(sectionId)) {
                                sectionsRead.add(sectionId);
                                navItems[index].classList.add('completed');
                                updateReadingStats();
                            }
                        }
                    }
                });

                // æ›´æ–°è¿·ä½ åœ°å›¾
                updateMiniMap();
            }, 50);
        });
    }

    // æ›´æ–°é˜…è¯»ç»Ÿè®¡
    function updateReadingStats() {
        const sectionsReadCount = sectionsRead.size;
        document.getElementById('sectionsRead').textContent = `${sectionsReadCount}/${totalSections}`;

        // æ›´æ–°å®Œæˆç™¾åˆ†æ¯”
        const percentage = Math.round((sectionsReadCount / totalSections) * 100);
        document.getElementById('completionPercent').textContent = percentage + '%';

        // æ›´æ–°å®Œæˆç¯
        const circumference = 2 * Math.PI * 25;
        const offset = circumference - (percentage / 100) * circumference;
        document.getElementById('completionRing').style.strokeDashoffset = offset;

        // æ›´æ–°å¯¼èˆªè¿›åº¦æ¡
        document.getElementById('navProgressBar').style.width = percentage + '%';
    }

    // æ›´æ–°è¿·ä½ åœ°å›¾
    function updateMiniMap() {
        const scrolled = window.scrollY;
        const total = document.documentElement.scrollHeight - window.innerHeight;
        const progress = (scrolled / total) * 100;

        const miniMapThumb = document.getElementById('miniMapThumb');
        if (miniMapThumb) {
            const mapHeight = 300 - 60; // æ€»é«˜åº¦å‡å»thumbé«˜åº¦
            const thumbPosition = (progress / 100) * mapHeight;
            miniMapThumb.style.top = thumbPosition + 'px';
        }
    }

    // è¿·ä½ åœ°å›¾æ‹–åŠ¨åŠŸèƒ½
    function initMiniMap() {
        const miniMapThumb = document.getElementById('miniMapThumb');
        const miniMapTrack = document.querySelector('.mini-map-track');
        let isDragging = false;

        if (!miniMapThumb || !miniMapTrack) return;

        miniMapThumb.addEventListener('mousedown', function(e) {
            isDragging = true;
            e.preventDefault();
        });

        document.addEventListener('mousemove', function(e) {
            if (!isDragging) return;

            const rect = miniMapTrack.getBoundingClientRect();
            const y = e.clientY - rect.top;
            const percentage = Math.max(0, Math.min(1, y / rect.height));

            const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
            window.scrollTo({
                top: percentage * scrollHeight,
                behavior: 'smooth'
            });
        });

        document.addEventListener('mouseup', function() {
            isDragging = false;
        });
    }

    // é¡µé¢åŠ è½½åŠ¨ç”»
    document.addEventListener('DOMContentLoaded', function() {
        // åˆå§‹åŒ–ä¸»é¢˜
        initTheme();

        // åˆå§‹åŒ–å¯¼èˆª
        initNavigation();
        initMiniMap();

        // æ¸å…¥åŠ¨ç”»
        const cards = document.querySelectorAll('.fade-in');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry, index) => {
                if (entry.isIntersecting) {
                    setTimeout(() => {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }, index * 100);
                }
            });
        });

        cards.forEach(card => {
            observer.observe(card);
        });

        // åˆå§‹åŒ–æ‰€æœ‰æ¼”ç¤º
        initSigmoidDemo();
        initLossDemo();
        initBoundaryDemo();
        initDigitDemo();
        initLearningCurve();
        updateProgress();
    });

    // è¿›åº¦è¿½è¸ª
    function updateProgress() {
        const scrolled = window.scrollY;
        const total = document.documentElement.scrollHeight - window.innerHeight;
        const progress = Math.min((scrolled / total) * 100, 100);

        document.getElementById('progressFill').style.width = progress + '%';
        document.getElementById('progressText').textContent = Math.round(progress) + '%';
    }

    // Sigmoidå‡½æ•°æ¼”ç¤º
    let sigmoidCanvas, sigmoidCtx;
    let sigmoidParams = { a: 1, b: 0 }; // aæ§åˆ¶é™¡å³­åº¦ï¼Œbæ§åˆ¶æ°´å¹³ä½ç§»

    function initSigmoidDemo() {
        sigmoidCanvas = document.getElementById('sigmoidCanvas');
        if (!sigmoidCanvas) return;

        sigmoidCtx = sigmoidCanvas.getContext('2d');
        drawSigmoid();
    }

    function sigmoid(x, a = 1, b = 0) {
        return 1 / (1 + Math.exp(-a * (x - b)));
    }

    function drawSigmoid() {
        if (!sigmoidCtx) return;

        const colors = getCanvasColors();

        // æ¸…é™¤ç”»å¸ƒå¹¶è®¾ç½®èƒŒæ™¯
        sigmoidCtx.fillStyle = colors.background;
        sigmoidCtx.fillRect(0, 0, sigmoidCanvas.width, sigmoidCanvas.height);

        // ç»˜åˆ¶åæ ‡è½´
        sigmoidCtx.strokeStyle = colors.axis;
        sigmoidCtx.lineWidth = 2;

        // Xè½´
        sigmoidCtx.beginPath();
        sigmoidCtx.moveTo(50, sigmoidCanvas.height / 2);
        sigmoidCtx.lineTo(sigmoidCanvas.width - 50, sigmoidCanvas.height / 2);
        sigmoidCtx.stroke();

        // Yè½´
        sigmoidCtx.beginPath();
        sigmoidCtx.moveTo(sigmoidCanvas.width / 2, 50);
        sigmoidCtx.lineTo(sigmoidCanvas.width / 2, sigmoidCanvas.height - 50);
        sigmoidCtx.stroke();

        // ç»˜åˆ¶ç½‘æ ¼
        sigmoidCtx.strokeStyle = colors.grid;
        sigmoidCtx.lineWidth = 0.5;
        for (let i = 0; i <= 10; i++) {
            const x = 50 + (sigmoidCanvas.width - 100) * i / 10;
            sigmoidCtx.beginPath();
            sigmoidCtx.moveTo(x, 50);
            sigmoidCtx.lineTo(x, sigmoidCanvas.height - 50);
            sigmoidCtx.stroke();

            const y = 50 + (sigmoidCanvas.height - 100) * i / 10;
            sigmoidCtx.beginPath();
            sigmoidCtx.moveTo(50, y);
            sigmoidCtx.lineTo(sigmoidCanvas.width - 50, y);
            sigmoidCtx.stroke();
        }

        // ç»˜åˆ¶Sigmoidæ›²çº¿
        sigmoidCtx.strokeStyle = colors.primary;
        sigmoidCtx.lineWidth = 3;
        sigmoidCtx.beginPath();

        const xMin = -10;
        const xMax = 10;
        const steps = 200;
        const xScale = (sigmoidCanvas.width - 100) / (xMax - xMin);
        const yScale = (sigmoidCanvas.height - 100);

        for (let i = 0; i <= steps; i++) {
            const x = xMin + (xMax - xMin) * i / steps;
            const y = sigmoid(x, sigmoidParams.a, sigmoidParams.b);

            const canvasX = 50 + (x - xMin) * xScale;
            const canvasY = sigmoidCanvas.height - 50 - y * yScale;

            if (i === 0) {
                sigmoidCtx.moveTo(canvasX, canvasY);
            } else {
                sigmoidCtx.lineTo(canvasX, canvasY);
            }
        }

        sigmoidCtx.stroke();

        // ç»˜åˆ¶å‚è€ƒçº¿ y=0.5
        sigmoidCtx.strokeStyle = colors.danger;
        sigmoidCtx.lineWidth = 1;
        sigmoidCtx.setLineDash([5, 5]);
        sigmoidCtx.beginPath();
        sigmoidCtx.moveTo(50, sigmoidCanvas.height / 2);
        sigmoidCtx.lineTo(sigmoidCanvas.width - 50, sigmoidCanvas.height / 2);
        sigmoidCtx.stroke();
        sigmoidCtx.setLineDash([]);

        // ç»˜åˆ¶æ ‡ç­¾
        sigmoidCtx.fillStyle = colors.text;
        sigmoidCtx.font = '14px Arial';
        sigmoidCtx.fillText('1.0', 10, 55);
        sigmoidCtx.fillText('0.5', 10, sigmoidCanvas.height / 2 + 5);
        sigmoidCtx.fillText('0.0', 10, sigmoidCanvas.height - 45);
        sigmoidCtx.fillText('-10', 45, sigmoidCanvas.height - 25);
        sigmoidCtx.fillText('0', sigmoidCanvas.width / 2 - 5, sigmoidCanvas.height - 25);
        sigmoidCtx.fillText('10', sigmoidCanvas.width - 60, sigmoidCanvas.height - 25);

        // æ˜¾ç¤ºå½“å‰å‚æ•°
        sigmoidCtx.fillStyle = colors.primary;
        sigmoidCtx.font = '16px Arial';
        sigmoidCtx.fillText(`Ïƒ(x) = 1 / (1 + e^(-${sigmoidParams.a.toFixed(1)}(x - ${sigmoidParams.b.toFixed(1)})))`, 60, 30);
    }

    function changeSigmoidParam(action) {
        switch(action) {
            case 'steep':
                sigmoidParams.a = Math.min(sigmoidParams.a + 0.5, 5);
                break;
            case 'flat':
                sigmoidParams.a = Math.max(sigmoidParams.a - 0.5, 0.2);
                break;
            case 'shift-left':
                sigmoidParams.b = Math.max(sigmoidParams.b - 1, -5);
                break;
            case 'shift-right':
                sigmoidParams.b = Math.min(sigmoidParams.b + 1, 5);
                break;
        }
        drawSigmoid();
    }

    function resetSigmoid() {
        sigmoidParams = { a: 1, b: 0 };
        drawSigmoid();
    }

    // æŸå¤±å‡½æ•°æ¼”ç¤º
    let lossCanvas, lossCtx;
    let currentLossType = 'cross-entropy';

    function initLossDemo() {
        lossCanvas = document.getElementById('lossCanvas');
        if (!lossCanvas) return;

        lossCtx = lossCanvas.getContext('2d');
        drawLoss();
    }

    function crossEntropyLoss(y, p) {
        if (y === 1) {
            return -Math.log(Math.max(p, 1e-7));
        } else {
            return -Math.log(Math.max(1 - p, 1e-7));
        }
    }

    function mseLoss(y, p) {
        return Math.pow(y - p, 2);
    }

    function drawLoss() {
        if (!lossCtx) return;

        const colors = getCanvasColors();

        // æ¸…é™¤ç”»å¸ƒå¹¶è®¾ç½®èƒŒæ™¯
        lossCtx.fillStyle = colors.background;
        lossCtx.fillRect(0, 0, lossCanvas.width, lossCanvas.height);

        // ç»˜åˆ¶åæ ‡è½´
        lossCtx.strokeStyle = colors.axis;
        lossCtx.lineWidth = 2;

        // Xè½´
        lossCtx.beginPath();
        lossCtx.moveTo(50, lossCanvas.height - 50);
        lossCtx.lineTo(lossCanvas.width - 50, lossCanvas.height - 50);
        lossCtx.stroke();

        // Yè½´
        lossCtx.beginPath();
        lossCtx.moveTo(50, 50);
        lossCtx.lineTo(50, lossCanvas.height - 50);
        lossCtx.stroke();

        const steps = 100;
        const xScale = (lossCanvas.width - 100) / 1;
        const yScale = (lossCanvas.height - 100) / 5;

        // ç»˜åˆ¶y=1çš„æƒ…å†µ
        if (currentLossType === 'cross-entropy' || currentLossType === 'compare') {
            lossCtx.strokeStyle = colors.success;
            lossCtx.lineWidth = 3;
            lossCtx.beginPath();

            for (let i = 1; i <= steps; i++) {
                const p = i / steps;
                const loss = crossEntropyLoss(1, p);

                const canvasX = 50 + p * xScale;
                const canvasY = lossCanvas.height - 50 - Math.min(loss, 5) * yScale;

                if (i === 1) {
                    lossCtx.moveTo(canvasX, canvasY);
                } else {
                    lossCtx.lineTo(canvasX, canvasY);
                }
            }
            lossCtx.stroke();
        }

        // ç»˜åˆ¶MSE
        if (currentLossType === 'mse' || currentLossType === 'compare') {
            lossCtx.strokeStyle = colors.danger;
            lossCtx.lineWidth = 3;
            lossCtx.beginPath();

            for (let i = 0; i <= steps; i++) {
                const p = i / steps;
                const loss = mseLoss(1, p);

                const canvasX = 50 + p * xScale;
                const canvasY = lossCanvas.height - 50 - loss * yScale;

                if (i === 0) {
                    lossCtx.moveTo(canvasX, canvasY);
                } else {
                    lossCtx.lineTo(canvasX, canvasY);
                }
            }
            lossCtx.stroke();
        }

        // ç»˜åˆ¶æ ‡ç­¾
        lossCtx.fillStyle = colors.text;
        lossCtx.font = '14px Arial';
        lossCtx.fillText('Loss', 5, 30);
        lossCtx.fillText('0', 45, lossCanvas.height - 35);
        lossCtx.fillText('0.5', lossCanvas.width / 2 - 10, lossCanvas.height - 35);
        lossCtx.fillText('1.0', lossCanvas.width - 60, lossCanvas.height - 35);
        lossCtx.fillText('Predicted Probability (p)', lossCanvas.width / 2 - 80, lossCanvas.height - 10);

        // å›¾ä¾‹
        if (currentLossType === 'compare') {
            lossCtx.fillStyle = colors.success;
            lossCtx.fillRect(lossCanvas.width - 200, 60, 20, 3);
            lossCtx.fillText('äº¤å‰ç†µ (y=1)', lossCanvas.width - 170, 65);

            lossCtx.fillStyle = colors.danger;
            lossCtx.fillRect(lossCanvas.width - 200, 80, 20, 3);
            lossCtx.fillText('MSE (y=1)', lossCanvas.width - 170, 85);
        }
    }

    function showLoss(type) {
        currentLossType = type;
        drawLoss();
    }

    // å†³ç­–è¾¹ç•Œæ¼”ç¤º
    let boundaryCanvas, boundaryCtx;
    let boundaryPoints = [];
    let currentClass = 0;
    let decisionBoundary = null;

    function initBoundaryDemo() {
        boundaryCanvas = document.getElementById('boundaryCanvas');
        if (!boundaryCanvas) return;

        boundaryCtx = boundaryCanvas.getContext('2d');

        // åˆå§‹åŒ–ä¸€äº›ç¤ºä¾‹æ•°æ®
        generateSampleData();

        boundaryCanvas.addEventListener('click', function(e) {
            const rect = boundaryCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            boundaryPoints.push({
                x: x,
                y: y,
                class: currentClass
            });

            drawBoundary();
        });
    }

    function generateSampleData() {
        boundaryPoints = [];

        // ç”Ÿæˆä¸¤ç±»æ•°æ®
        for (let i = 0; i < 30; i++) {
            // ç±»åˆ«0 - å·¦ä¸Šè§’
            boundaryPoints.push({
                x: Math.random() * 300 + 50,
                y: Math.random() * 200 + 50,
                class: 0
            });

            // ç±»åˆ«1 - å³ä¸‹è§’
            boundaryPoints.push({
                x: Math.random() * 300 + 450,
                y: Math.random() * 200 + 250,
                class: 1
            });
        }

        drawBoundary();
    }

    function drawBoundary() {
        if (!boundaryCtx) return;

        const colors = getCanvasColors();

        // æ¸…é™¤ç”»å¸ƒå¹¶è®¾ç½®èƒŒæ™¯
        boundaryCtx.fillStyle = colors.background;
        boundaryCtx.fillRect(0, 0, boundaryCanvas.width, boundaryCanvas.height);

        // ç»˜åˆ¶ç½‘æ ¼èƒŒæ™¯
        boundaryCtx.strokeStyle = colors.grid;
        boundaryCtx.lineWidth = 0.5;
        for (let i = 0; i <= boundaryCanvas.width; i += 50) {
            boundaryCtx.beginPath();
            boundaryCtx.moveTo(i, 0);
            boundaryCtx.lineTo(i, boundaryCanvas.height);
            boundaryCtx.stroke();
        }
        for (let i = 0; i <= boundaryCanvas.height; i += 50) {
            boundaryCtx.beginPath();
            boundaryCtx.moveTo(0, i);
            boundaryCtx.lineTo(boundaryCanvas.width, i);
            boundaryCtx.stroke();
        }

        // ç»˜åˆ¶æ•°æ®ç‚¹
        boundaryPoints.forEach(point => {
            boundaryCtx.fillStyle = point.class === 0 ? colors.danger : '#3b82f6';
            boundaryCtx.beginPath();
            boundaryCtx.arc(point.x, point.y, 8, 0, 2 * Math.PI);
            boundaryCtx.fill();

            boundaryCtx.strokeStyle = colors.background;
            boundaryCtx.lineWidth = 2;
            boundaryCtx.stroke();
        });

        // ç»˜åˆ¶å†³ç­–è¾¹ç•Œ
        if (decisionBoundary) {
            boundaryCtx.strokeStyle = colors.success;
            boundaryCtx.lineWidth = 3;
            boundaryCtx.beginPath();
            boundaryCtx.moveTo(0, decisionBoundary.getY(0));
            boundaryCtx.lineTo(boundaryCanvas.width, decisionBoundary.getY(boundaryCanvas.width));
            boundaryCtx.stroke();
        }
    }

    function addPoint(classLabel) {
        currentClass = classLabel;
    }

    function trainBoundary() {
        if (boundaryPoints.length < 2) return;

        // ç®€åŒ–çš„çº¿æ€§è¾¹ç•Œè®¡ç®—
        const class0 = boundaryPoints.filter(p => p.class === 0);
        const class1 = boundaryPoints.filter(p => p.class === 1);

        if (class0.length === 0 || class1.length === 0) return;

        // è®¡ç®—ä¸¤ç±»çš„ä¸­å¿ƒç‚¹
        const center0 = {
            x: class0.reduce((sum, p) => sum + p.x, 0) / class0.length,
            y: class0.reduce((sum, p) => sum + p.y, 0) / class0.length
        };

        const center1 = {
            x: class1.reduce((sum, p) => sum + p.x, 0) / class1.length,
            y: class1.reduce((sum, p) => sum + p.y, 0) / class1.length
        };

        // è®¡ç®—å‚ç›´å¹³åˆ†çº¿
        const midpoint = {
            x: (center0.x + center1.x) / 2,
            y: (center0.y + center1.y) / 2
        };

        const dx = center1.x - center0.x;
        const dy = center1.y - center0.y;

        // å‚ç›´çº¿çš„æ–œç‡
        const slope = dx !== 0 ? -dy / dx : Infinity;

        decisionBoundary = {
            getY: function(x) {
                if (slope === Infinity) {
                    return boundaryCanvas.height / 2;
                }
                return midpoint.y + slope * (x - midpoint.x);
            }
        };

        drawBoundary();
    }

    function clearBoundary() {
        boundaryPoints = [];
        decisionBoundary = null;
        drawBoundary();
    }

    function updateCParam(value) {
        document.getElementById('cValue').textContent = parseFloat(value).toFixed(2);
    }

    // æ‰‹å†™æ•°å­—æ¼”ç¤º
    let digitCanvas, digitCtx;
    let isDrawing = false;

    function initDigitDemo() {
        digitCanvas = document.getElementById('digitCanvas');
        if (!digitCanvas) return;

        digitCtx = digitCanvas.getContext('2d');
        const isLight = document.body.classList.contains('light-theme');
        digitCtx.fillStyle = isLight ? '#f3f4f6' : 'white';
        digitCtx.fillRect(0, 0, digitCanvas.width, digitCanvas.height);

        digitCanvas.addEventListener('mousedown', startDrawing);
        digitCanvas.addEventListener('mousemove', draw);
        digitCanvas.addEventListener('mouseup', stopDrawing);
        digitCanvas.addEventListener('mouseout', stopDrawing);

        // è§¦æ‘¸æ”¯æŒ
        digitCanvas.addEventListener('touchstart', handleTouch);
        digitCanvas.addEventListener('touchmove', handleTouch);
        digitCanvas.addEventListener('touchend', stopDrawing);
    }

    function startDrawing(e) {
        isDrawing = true;
        draw(e);
    }

    function draw(e) {
        if (!isDrawing) return;

        const rect = digitCanvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        digitCtx.fillStyle = 'black';
        digitCtx.beginPath();
        digitCtx.arc(x, y, 8, 0, 2 * Math.PI);
        digitCtx.fill();
    }

    function stopDrawing() {
        isDrawing = false;
    }

    function handleTouch(e) {
        e.preventDefault();
        const touch = e.touches[0];
        const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' :
            e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
            clientX: touch.clientX,
            clientY: touch.clientY
        });
        digitCanvas.dispatchEvent(mouseEvent);
    }

    function clearDigit() {
        digitCtx.fillStyle = 'white';
        digitCtx.fillRect(0, 0, digitCanvas.width, digitCanvas.height);
        document.getElementById('digitPrediction').innerHTML =
            '<p style="color: #94a3b8; text-align: center;">åœ¨å·¦ä¾§ç”»å¸ƒä¸Šå†™ä¸€ä¸ªæ•°å­—...</p>';
    }

    function predictDigit() {
        // æ¨¡æ‹Ÿé¢„æµ‹ç»“æœ
        const predictions = [
            { digit: 0, prob: Math.random() * 0.1 },
            { digit: 1, prob: Math.random() * 0.1 },
            { digit: 2, prob: Math.random() * 0.3 },
            { digit: 3, prob: Math.random() * 0.1 },
            { digit: 4, prob: Math.random() * 0.1 },
            { digit: 5, prob: Math.random() * 0.1 },
            { digit: 6, prob: Math.random() * 0.1 },
            { digit: 7, prob: Math.random() * 0.7 },
            { digit: 8, prob: Math.random() * 0.2 },
            { digit: 9, prob: Math.random() * 0.1 }
        ];

        // å½’ä¸€åŒ–æ¦‚ç‡
        const total = predictions.reduce((sum, p) => sum + p.prob, 0);
        predictions.forEach(p => p.prob = p.prob / total);

        // æ’åº
        predictions.sort((a, b) => b.prob - a.prob);

        let html = '';
        predictions.forEach((p, i) => {
            const barWidth = p.prob * 100;
            const color = i === 0 ? '#10b981' : '#4a5568';
            html += `
                    <div style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>æ•°å­— ${p.digit}</span>
                            <span>${(p.prob * 100).toFixed(1)}%</span>
                        </div>
                        <div style="background: #2d3748; height: 20px; border-radius: 10px; overflow: hidden;">
                            <div style="background: ${color}; height: 100%; width: ${barWidth}%; transition: width 0.5s ease;"></div>
                        </div>
                    </div>
                `;
        });

        document.getElementById('digitPrediction').innerHTML = html;
    }

    // å­¦ä¹ æ›²çº¿æ¼”ç¤º
    let learningCurveCanvas, learningCurveCtx;
    let currentLearningCurveType = 'good';

    function initLearningCurve() {
        learningCurveCanvas = document.getElementById('learningCurveCanvas');
        if (!learningCurveCanvas) return;

        learningCurveCtx = learningCurveCanvas.getContext('2d');
        showLearningCurve('good');
    }

    function showLearningCurve(type) {
        if (!learningCurveCtx) return;

        currentLearningCurveType = type;
        const colors = getCanvasColors();

        // æ¸…é™¤ç”»å¸ƒå¹¶è®¾ç½®èƒŒæ™¯
        learningCurveCtx.fillStyle = colors.background;
        learningCurveCtx.fillRect(0, 0, learningCurveCanvas.width, learningCurveCanvas.height);

        // ç»˜åˆ¶åæ ‡è½´
        learningCurveCtx.strokeStyle = colors.axis;
        learningCurveCtx.lineWidth = 2;

        // Xè½´
        learningCurveCtx.beginPath();
        learningCurveCtx.moveTo(50, learningCurveCanvas.height - 50);
        learningCurveCtx.lineTo(learningCurveCanvas.width - 50, learningCurveCanvas.height - 50);
        learningCurveCtx.stroke();

        // Yè½´
        learningCurveCtx.beginPath();
        learningCurveCtx.moveTo(50, 50);
        learningCurveCtx.lineTo(50, learningCurveCanvas.height - 50);
        learningCurveCtx.stroke();

        const steps = 50;
        const xScale = (learningCurveCanvas.width - 100) / steps;
        const yScale = (learningCurveCanvas.height - 100);

        // æ ¹æ®ç±»å‹ç»˜åˆ¶ä¸åŒçš„æ›²çº¿
        if (type === 'bias') {
            // é«˜åå·®ï¼šè®­ç»ƒå’ŒéªŒè¯è¯¯å·®éƒ½é«˜
            drawCurve(i => 0.7 - 0.1 * Math.log(i + 1) / Math.log(steps), colors.danger, 'è®­ç»ƒè¯¯å·®');
            drawCurve(i => 0.75 - 0.08 * Math.log(i + 1) / Math.log(steps), colors.warning, 'éªŒè¯è¯¯å·®');
        } else if (type === 'variance') {
            // é«˜æ–¹å·®ï¼šè®­ç»ƒè¯¯å·®ä½ï¼ŒéªŒè¯è¯¯å·®é«˜
            drawCurve(i => 0.9 - 0.7 * Math.log(i + 1) / Math.log(steps), colors.success, 'è®­ç»ƒè¯¯å·®');
            drawCurve(i => 0.9 - 0.3 * Math.log(i + 1) / Math.log(steps), colors.danger, 'éªŒè¯è¯¯å·®');
        } else {
            // è‰¯å¥½æ‹Ÿåˆ
            drawCurve(i => 0.9 - 0.5 * Math.log(i + 1) / Math.log(steps), colors.success, 'è®­ç»ƒè¯¯å·®');
            drawCurve(i => 0.9 - 0.45 * Math.log(i + 1) / Math.log(steps), '#3b82f6', 'éªŒè¯è¯¯å·®');
        }

        function drawCurve(errorFunc, color, label) {
            learningCurveCtx.strokeStyle = color;
            learningCurveCtx.lineWidth = 3;
            learningCurveCtx.beginPath();

            for (let i = 0; i <= steps; i++) {
                const error = errorFunc(i);
                const x = 50 + i * xScale;
                const y = 50 + (1 - error) * yScale;

                if (i === 0) {
                    learningCurveCtx.moveTo(x, y);
                } else {
                    learningCurveCtx.lineTo(x, y);
                }
            }
            learningCurveCtx.stroke();
        }

        // æ ‡ç­¾
        learningCurveCtx.fillStyle = colors.text;
        learningCurveCtx.font = '14px Arial';
        learningCurveCtx.fillText('å‡†ç¡®ç‡', 5, 30);
        learningCurveCtx.fillText('è®­ç»ƒæ ·æœ¬æ•°', learningCurveCanvas.width / 2 - 40, learningCurveCanvas.height - 10);
    }

    // MNISTæ ·æœ¬å±•ç¤º
    function loadNewSamples() {
        const container = document.getElementById('mnistSamples');
        if (!container) return;

        container.innerHTML = '';

        // æ¨¡æ‹ŸMNISTæ•°æ®
        for (let i = 0; i < 10; i++) {
            const canvas = document.createElement('canvas');
            canvas.width = 28;
            canvas.height = 28;
            canvas.style.width = '56px';
            canvas.style.height = '56px';
            canvas.style.imageRendering = 'pixelated';
            canvas.style.border = '1px solid #4a5568';
            canvas.style.borderRadius = '4px';

            const ctx = canvas.getContext('2d');

            // ç”Ÿæˆéšæœºçš„æ•°å­—æ ·å¼
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, 28, 28);

            ctx.fillStyle = 'white';
            ctx.font = 'bold 20px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(i.toString(), 14, 14);

            container.appendChild(canvas);
        }
    }

    // å·¥å…·å‡½æ•°
    function scrollToTop() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
    function initTheme() {
        // ä»localStorageè¯»å–ä¸»é¢˜åå¥½
        const savedTheme = localStorage.getItem('theme') || 'dark';
        if (savedTheme === 'light') {
            document.body.classList.add('light-theme');
            updateThemeIcon('light');
        }
    }

    function toggleTheme() {
        const themeBtn = document.querySelector('.theme-toggle-btn');
        const isLight = document.body.classList.contains('light-theme');

        // æ·»åŠ åŠ¨ç”»æ•ˆæœ
        themeBtn.classList.add('animating');

        // åˆ‡æ¢ä¸»é¢˜
        if (isLight) {
            document.body.classList.remove('light-theme');
            localStorage.setItem('theme', 'dark');
            updateThemeIcon('dark');
            showToast('å·²åˆ‡æ¢åˆ°æ·±è‰²ä¸»é¢˜ ğŸŒ™');
        } else {
            document.body.classList.add('light-theme');
            localStorage.setItem('theme', 'light');
            updateThemeIcon('light');
            showToast('å·²åˆ‡æ¢åˆ°æµ…è‰²ä¸»é¢˜ â˜€ï¸');
        }

        // ç§»é™¤åŠ¨ç”»ç±»
        setTimeout(() => {
            themeBtn.classList.remove('animating');
        }, 600);

        // æ›´æ–°Canvasç»˜å›¾é¢œè‰²
        updateCanvasColors();
    }

    function updateThemeIcon(theme) {
        const icon = document.querySelector('.theme-icon');
        if (icon) {
            icon.textContent = theme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        }
    }

    function updateCanvasColors() {
        // æ ¹æ®ä¸»é¢˜æ›´æ–°æ‰€æœ‰Canvasçš„é¢œè‰²
        const isLight = document.body.classList.contains('light-theme');

        // æ›´æ–°Sigmoidæ¼”ç¤º
        if (typeof drawSigmoid === 'function') {
            drawSigmoid();
        }

        // æ›´æ–°æŸå¤±å‡½æ•°æ¼”ç¤º
        if (typeof drawLoss === 'function') {
            drawLoss();
        }

        // æ›´æ–°å†³ç­–è¾¹ç•Œæ¼”ç¤º
        if (typeof drawBoundary === 'function') {
            drawBoundary();
        }

        // æ›´æ–°å­¦ä¹ æ›²çº¿
        if (typeof showLearningCurve === 'function' && learningCurveCanvas) {
            const currentType = window.currentLearningCurveType || 'good';
            showLearningCurve(currentType);
        }
    }

    // Canvasç»˜å›¾æ—¶çš„é¢œè‰²è·å–å‡½æ•°
    function getCanvasColors() {
        const isLight = document.body.classList.contains('light-theme');
        return {
            background: isLight ? '#ffffff' : '#0f172a',
            grid: isLight ? '#e5e7eb' : '#2d3748',
            gridLight: isLight ? '#d1d5db' : '#4a5568',
            text: isLight ? '#1e293b' : '#cbd5e1',
            axis: isLight ? '#64748b' : '#4a5568',
            primary: '#667eea',
            success: '#10b981',
            warning: '#f59e0b',
            danger: '#ef4444'
        };
    }

    function toggleHelp() {
        alert('ä½¿ç”¨æç¤ºï¼š\n1. ç‚¹å‡»æ¼”ç¤ºåŒºåŸŸè¿›è¡Œäº¤äº’\n2. æ‹–åŠ¨æ»‘å—è°ƒæ•´å‚æ•°\n3. ä½¿ç”¨åº•éƒ¨æŒ‰é’®ä¸‹è½½ç¬”è®°æˆ–æµ‹è¯•çŸ¥è¯†\n4. Alt+N åˆ‡æ¢å¯¼èˆªæ \n5. ç‚¹å‡»ğŸŒ“æŒ‰é’®åˆ‡æ¢æ·±è‰²/æµ…è‰²ä¸»é¢˜\n6. ä¸»é¢˜åå¥½ä¼šè‡ªåŠ¨ä¿å­˜');
    }

    function downloadNotes() {
        const notes = `
ç¬¬6ç« ï¼šé€»è¾‘å›å½’å­¦ä¹ ç¬”è®°

ä¸€ã€æ ¸å¿ƒæ¦‚å¿µ
1. é€»è¾‘å›å½’æ˜¯ç”¨äºåˆ†ç±»çš„ç®—æ³•ï¼Œä¸æ˜¯å›å½’ç®—æ³•
2. é€šè¿‡Sigmoidå‡½æ•°å°†çº¿æ€§è¾“å‡ºæ˜ å°„åˆ°[0,1]æ¦‚ç‡ç©ºé—´
3. ä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°è€Œä¸æ˜¯MSE

äºŒã€Sigmoidå‡½æ•°
- å…¬å¼ï¼šÏƒ(z) = 1/(1+e^(-z))
- ç‰¹æ€§ï¼šè¾“å‡ºèŒƒå›´(0,1)ã€å•è°ƒé€’å¢ã€ä¸­å¿ƒå¯¹ç§°
- å¯¼æ•°ï¼šÏƒ'(z) = Ïƒ(z)(1-Ïƒ(z))

ä¸‰ã€æŸå¤±å‡½æ•°
- äºŒå…ƒäº¤å‰ç†µï¼šL = -[yÂ·log(p) + (1-y)Â·log(1-p)]
- æ¥æºäºæœ€å¤§ä¼¼ç„¶ä¼°è®¡
- å¯¹é”™è¯¯é¢„æµ‹çš„æƒ©ç½šæ›´ä¸¥å‰

å››ã€æ­£åˆ™åŒ–
- L1æ­£åˆ™åŒ–ï¼šäº§ç”Ÿç¨€ç–è§£ï¼Œè‡ªåŠ¨ç‰¹å¾é€‰æ‹©
- L2æ­£åˆ™åŒ–ï¼šé˜²æ­¢ç³»æ•°è¿‡å¤§ï¼Œå¤„ç†å…±çº¿æ€§
- Cå‚æ•°ï¼šæ­£åˆ™åŒ–å¼ºåº¦çš„å€’æ•°

äº”ã€å¤šåˆ†ç±»æ‰©å±•
- One-vs-Restï¼šè®­ç»ƒKä¸ªäºŒåˆ†ç±»å™¨
- Softmaxå›å½’ï¼šç›´æ¥å¤šåˆ†ç±»ï¼Œè¾“å‡ºæ¦‚ç‡å’Œä¸º1

å…­ã€å®è·µè¦ç‚¹
1. ç‰¹å¾ç¼©æ”¾å¿…ä¸å¯å°‘
2. å¤„ç†ç±»åˆ«ä¸å¹³è¡¡ï¼šclass_weight='balanced'
3. é€‰æ‹©åˆé€‚çš„æ±‚è§£å™¨ï¼šliblinearé€‚åˆå°æ•°æ®ï¼Œsagaæ”¯æŒL1
4. ä½¿ç”¨ç½‘æ ¼æœç´¢è°ƒä¼˜è¶…å‚æ•°

ä¸ƒã€åº”ç”¨åœºæ™¯
- åŒ»ç–—è¯Šæ–­ï¼ˆå¿ƒè„ç—…é¢„æµ‹ï¼‰
- å›¾åƒè¯†åˆ«ï¼ˆæ‰‹å†™æ•°å­—ï¼‰
- åƒåœ¾é‚®ä»¶æ£€æµ‹
- ä¿¡ç”¨è¯„åˆ†

å­¦ä¹ è¿›åº¦ï¼š${document.getElementById('completionPercent').textContent}
å­¦ä¹ æ—¶é—´ï¼š${new Date().toLocaleString()}
            `;

        const blob = new Blob([notes], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'é€»è¾‘å›å½’å­¦ä¹ ç¬”è®°.txt';
        a.click();
        URL.revokeObjectURL(url);
    }

    function startQuiz() {
        const questions = [
            {
                question: "é€»è¾‘å›å½’ä¸»è¦ç”¨äºä»€ä¹ˆç±»å‹çš„ä»»åŠ¡ï¼Ÿ",
                options: ["å›å½’", "åˆ†ç±»", "èšç±»", "é™ç»´"],
                correct: 1,
                explanation: "è™½ç„¶åç§°ä¸­æœ‰'å›å½’'ï¼Œä½†é€»è¾‘å›å½’ä¸»è¦ç”¨äºåˆ†ç±»ä»»åŠ¡"
            },
            {
                question: "Sigmoidå‡½æ•°çš„è¾“å‡ºèŒƒå›´æ˜¯ï¼Ÿ",
                options: ["(-âˆ, +âˆ)", "[-1, 1]", "[0, 1]", "[0, +âˆ)"],
                correct: 2,
                explanation: "Sigmoidå‡½æ•°å°†ä»»æ„å®æ•°æ˜ å°„åˆ°(0,1)åŒºé—´ï¼Œè¡¨ç¤ºæ¦‚ç‡"
            },
            {
                question: "é€»è¾‘å›å½’ä½¿ç”¨ä»€ä¹ˆæŸå¤±å‡½æ•°ï¼Ÿ",
                options: ["å‡æ–¹è¯¯å·®", "äº¤å‰ç†µ", "é“°é“¾æŸå¤±", "0-1æŸå¤±"],
                correct: 1,
                explanation: "äº¤å‰ç†µæŸå¤±å‡½æ•°æ¥æºäºæœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œé€‚åˆæ¦‚ç‡è¾“å‡º"
            },
            {
                question: "sklearnä¸­çš„Cå‚æ•°è¡¨ç¤ºä»€ä¹ˆï¼Ÿ",
                options: ["æ­£åˆ™åŒ–å¼ºåº¦", "æ­£åˆ™åŒ–å¼ºåº¦çš„å€’æ•°", "å­¦ä¹ ç‡", "è¿­ä»£æ¬¡æ•°"],
                correct: 1,
                explanation: "C = 1/Î»ï¼ŒCè¶Šå¤§æ­£åˆ™åŒ–è¶Šå¼±ï¼Œæ¨¡å‹è¶Šå¤æ‚"
            },
            {
                question: "å¤„ç†å¤šåˆ†ç±»é—®é¢˜æ—¶ï¼ŒSoftmaxå›å½’çš„ä¼˜åŠ¿æ˜¯ï¼Ÿ",
                options: ["è®­ç»ƒé€Ÿåº¦å¿«", "åªéœ€ä¸€ä¸ªæ¨¡å‹", "å‡†ç¡®ç‡æ›´é«˜", "ä¸éœ€è¦å½’ä¸€åŒ–"],
                correct: 1,
                explanation: "Softmaxç›´æ¥è®­ç»ƒä¸€ä¸ªå¤šåˆ†ç±»æ¨¡å‹ï¼Œè€ŒOvRéœ€è¦è®­ç»ƒKä¸ªäºŒåˆ†ç±»å™¨"
            }
        ];

        let score = 0;
        let currentQuestion = 0;

        function showQuestion() {
            if (currentQuestion >= questions.length) {
                showResult();
                return;
            }

            const q = questions[currentQuestion];
            const html = `
                    <div style="background: rgba(30, 41, 59, 0.9); padding: 30px; border-radius: 20px; max-width: 600px; margin: 50px auto;">
                        <h3 style="color: #667eea; margin-bottom: 20px;">é—®é¢˜ ${currentQuestion + 1}/${questions.length}</h3>
                        <p style="font-size: 1.2rem; margin-bottom: 20px;">${q.question}</p>
                        <div style="display: grid; gap: 10px;">
                            ${q.options.map((opt, i) => `
                                <button onclick="selectAnswer(${i})" style="background: rgba(102, 126, 234, 0.1); border: 2px solid rgba(102, 126, 234, 0.3); color: #e2e8f0; padding: 15px; border-radius: 10px; cursor: pointer; text-align: left; transition: all 0.3s;">
                                    ${String.fromCharCode(65 + i)}. ${opt}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;

            document.body.insertAdjacentHTML('beforeend', `<div id="quizModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center;">${html}</div>`);
        }

        window.selectAnswer = function(index) {
            const q = questions[currentQuestion];
            if (index === q.correct) {
                score++;
                alert('âœ… æ­£ç¡®ï¼\n\n' + q.explanation);
            } else {
                alert('âŒ é”™è¯¯ï¼\n\næ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š' + q.options[q.correct] + '\n\n' + q.explanation);
            }
            currentQuestion++;
            document.getElementById('quizModal').remove();
            showQuestion();
        };

        function showResult() {
            const percentage = (score / questions.length * 100).toFixed(0);
            const html = `
                    <div style="background: rgba(30, 41, 59, 0.9); padding: 40px; border-radius: 20px; max-width: 600px; margin: 50px auto; text-align: center;">
                        <h2 style="color: #667eea; margin-bottom: 30px;">æµ‹éªŒå®Œæˆï¼</h2>
                        <div style="font-size: 4rem; margin-bottom: 20px;">
                            ${percentage >= 80 ? 'ğŸ‰' : percentage >= 60 ? 'ğŸ‘' : 'ğŸ’ª'}
                        </div>
                        <p style="font-size: 2rem; color: #10b981; margin-bottom: 10px;">
                            å¾—åˆ†ï¼š${score}/${questions.length}
                        </p>
                        <p style="font-size: 1.5rem; color: #94a3b8; margin-bottom: 30px;">
                            æ­£ç¡®ç‡ï¼š${percentage}%
                        </p>
                        <p style="color: #cbd5e1; margin-bottom: 30px;">
                            ${percentage >= 80 ? 'å¤ªæ£’äº†ï¼ä½ å·²ç»å¾ˆå¥½åœ°æŒæ¡äº†é€»è¾‘å›å½’ï¼' :
                percentage >= 60 ? 'ä¸é”™ï¼å»ºè®®å†å¤ä¹ ä¸€ä¸‹è–„å¼±ç¯èŠ‚ã€‚' :
                    'ç»§ç»­åŠªåŠ›ï¼å»ºè®®é‡æ–°å­¦ä¹ æœ¬ç« å†…å®¹ã€‚'}
                        </p>
                        <button onclick="document.getElementById('quizModal').remove()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-size: 1.1rem;">
                            å…³é—­
                        </button>
                    </div>
                `;

            document.getElementById('quizModal').innerHTML = html;
        }

        showQuestion();
    }

    function shareAchievement() {
        const text = `ğŸ‰ æˆ‘åˆšåˆšå®Œæˆäº†é€»è¾‘å›å½’çš„å­¦ä¹ ï¼

ğŸ“š å­¦ä¹ å†…å®¹ï¼š
- Sigmoidå‡½æ•°ä¸æ¦‚ç‡æ˜ å°„
- äº¤å‰ç†µæŸå¤±å‡½æ•°
- æ­£åˆ™åŒ–ä¸è¿‡æ‹Ÿåˆæ§åˆ¶
- å¤šåˆ†ç±»é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ
- å®æˆ˜æ¡ˆä¾‹ï¼šå¿ƒè„ç—…é¢„æµ‹ & æ‰‹å†™æ•°å­—è¯†åˆ«

å­¦ä¹ è¿›åº¦ï¼š${document.getElementById('completionPercent').textContent}
å·²å®Œæˆç« èŠ‚ï¼š${document.getElementById('sectionsRead').textContent}

ä»çº¿æ€§åˆ°éçº¿æ€§ï¼Œä»é¢„æµ‹åˆ°å†³ç­–ï¼Œé€»è¾‘å›å½’å±•ç°äº†æœºå™¨å­¦ä¹ çš„ä¼˜é›…ï¼

#æœºå™¨å­¦ä¹  #é€»è¾‘å›å½’ #æ•°æ®ç§‘å­¦ #AIå­¦ä¹ `;

        if (navigator.share) {
            navigator.share({
                title: 'é€»è¾‘å›å½’å­¦ä¹ æˆå°±',
                text: text,
                url: window.location.href
            }).catch(err => console.log('åˆ†äº«å–æ¶ˆ'));
        } else {
            // å¤åˆ¶åˆ°å‰ªè´´æ¿
            navigator.clipboard.writeText(text).then(() => {
                // æ˜¾ç¤ºæˆåŠŸæç¤º
                showToast('å­¦ä¹ æˆå°±å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }).catch(() => {
                alert('åˆ†äº«æ–‡æœ¬ï¼š\n\n' + text);
            });
        }
    }

    // Toastæç¤ºåŠŸèƒ½
    function showToast(message) {
        const toast = document.createElement('div');
        toast.style.cssText = `
                position: fixed;
                bottom: 30px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #667eea, #764ba2);
                color: white;
                padding: 15px 30px;
                border-radius: 25px;
                box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
                z-index: 10000;
                animation: slideUp 0.3s ease-out;
            `;
        toast.textContent = message;

        document.body.appendChild(toast);

        setTimeout(() => {
            toast.style.animation = 'slideDown 0.3s ease-out';
            setTimeout(() => toast.remove(), 300);
        }, 3000);
    }

    // åŠ¨ç”»å…³é”®å¸§
    const style = document.createElement('style');
    style.textContent = `
            @keyframes slideUp {
                from {
                    transform: translateX(-50%) translateY(100px);
                    opacity: 0;
                }
                to {
                    transform: translateX(-50%) translateY(0);
                    opacity: 1;
                }
            }

            @keyframes slideDown {
                from {
                    transform: translateX(-50%) translateY(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(-50%) translateY(100px);
                    opacity: 0;
                }
            }
        `;
    document.head.appendChild(style);

    // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–MNISTæ ·æœ¬
    loadNewSamples();

    // å¹³æ»‘æ»šåŠ¨åˆ°é”šç‚¹
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // ä»£ç é«˜äº®å¢å¼º
    document.querySelectorAll('.code-block pre code').forEach(block => {
        // æ·»åŠ è¡Œå·
        const lines = block.innerHTML.split('\n');
        const numberedLines = lines.map((line, index) => {
            return `<span style="color: #4a5568; margin-right: 20px; user-select: none;">${String(index + 1).padStart(3, ' ')}</span>${line}`;
        }).join('\n');
        block.innerHTML = numberedLines;
    });

    // å›¾ç‰‡æ‡’åŠ è½½
    const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const img = entry.target;
                img.src = img.dataset.src;
                observer.unobserve(img);
            }
        });
    });

    document.querySelectorAll('img[data-src]').forEach(img => {
        imageObserver.observe(img);
    });

    // æ€§èƒ½ä¼˜åŒ–ï¼šé˜²æŠ–æ»šåŠ¨äº‹ä»¶
    let scrollTimeout;
    window.addEventListener('scroll', function() {
        if (scrollTimeout) {
            clearTimeout(scrollTimeout);
        }
        scrollTimeout = setTimeout(function() {
            // æ›´æ–°è¿›åº¦æ¡ç­‰æ»šåŠ¨ç›¸å…³æ“ä½œ
            const scrolled = window.scrollY;
            const total = document.documentElement.scrollHeight - window.innerHeight;
            const progress = Math.min((scrolled / total) * 100, 100);

            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = Math.round(progress) + '%';
        }, 10);
    });

    // æ‰“å°ä¼˜åŒ–
    window.addEventListener('beforeprint', function() {
        document.body.classList.add('print-mode');
    });

    window.addEventListener('afterprint', function() {
        document.body.classList.remove('print-mode');
    });

    // æ·»åŠ æ‰“å°æ ·å¼
    const printStyle = document.createElement('style');
    printStyle.textContent = `
            @media print {
                .print-mode {
                    background: white !important;
                    color: black !important;
                }

                .print-mode .section-card {
                    background: white !important;
                    border: 1px solid #000 !important;
                    box-shadow: none !important;
                    page-break-inside: avoid;
                }

                .print-mode .dynamic-bg,
                .print-mode .progress-indicator,
                .print-mode .floating-toolbar,
                .print-mode .demo-controls,
                .print-mode canvas,
                .print-mode .smart-nav,
                .print-mode .nav-trigger,
                .print-mode .mini-map {
                    display: none !important;
                }

                .print-mode .code-block {
                    background: #f5f5f5 !important;
                    border: 1px solid #ddd !important;
                }

                .print-mode .highlight-primary,
                .print-mode .highlight-success,
                .print-mode .highlight-warning,
                .print-mode .highlight-danger {
                    background: none !important;
                    border: none !important;
                    font-weight: bold !important;
                    text-decoration: underline !important;
                }
            }
        `;
    document.head.appendChild(printStyle);

    // æ§åˆ¶å°å½©è›‹
    console.log('%cğŸ¯ é€»è¾‘å›å½’å­¦ä¹ ç³»ç»Ÿå·²åŠ è½½ï¼', 'color: #667eea; font-size: 20px; font-weight: bold;');
    console.log('%cæ¬¢è¿æ¥åˆ°æœºå™¨å­¦ä¹ çš„ä¸–ç•Œï¼', 'color: #10b981; font-size: 16px;');
    console.log('%cæç¤ºï¼šä½¿ç”¨ Alt+N åˆ‡æ¢å¯¼èˆªï¼ŒCtrl+S ä¿å­˜ç¬”è®°ï¼ŒCtrl+Q å¼€å§‹æµ‹éªŒ', 'color: #f59e0b; font-size: 14px;');
    console.log('%cå½“å‰ä¸»é¢˜ï¼š' + (document.body.classList.contains('light-theme') ? 'æµ…è‰²ä¸»é¢˜ â˜€ï¸' : 'æ·±è‰²ä¸»é¢˜ ğŸŒ™'), 'color: #8b5cf6; font-size: 14px;');
</script>
</body>
</html>