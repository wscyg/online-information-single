<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬7ç« ï¼šå¾ªç¯ç¥ç»ç½‘ç»œRNN - è®©ç¥ç»ç½‘ç»œæ‹¥æœ‰è®°å¿† | æ·±åº¦å­¦ä¹ åºåˆ—å»ºæ¨¡</title>
    <meta name="description" content="ä»æ—¶é—´åºåˆ—çš„æœ¬è´¨å‡ºå‘ï¼Œç†è§£ä¸ºä»€ä¹ˆéœ€è¦RNNï¼Œæ·±å…¥æ¢ç´¢å¾ªç¯æœºåˆ¶çš„åŸç†ï¼Œä»¥åŠå¦‚ä½•è®©ç¥ç»ç½‘ç»œå¤„ç†åºåˆ—æ•°æ®">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
    <style>
        /* ===== CSSå˜é‡å®šä¹‰ ===== */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --rnn-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --time-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --memory-gradient: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
            --bg-dark: #0f172a;
            --bg-section: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --accent-red: #ef4444;
            --accent-green: #22c55e;
            --accent-blue: #3b82f6;
            --accent-yellow: #fbbf24;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-orange: #f97316;
            --accent-cyan: #06b6d4;
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.3);
            --animation-duration: 0.3s;
            --content-max-width: 1200px;
        }

        /* äº®è‰²ä¸»é¢˜ */
        [data-theme="light"] {
            --bg-dark: #ffffff;
            --bg-section: #f8fafc;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border-color: rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        /* ===== å…¨å±€æ ·å¼ ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            transition: background-color var(--animation-duration) ease;
        }

        /* ===== å¸ƒå±€ç»„ä»¶ ===== */
        .container {
            max-width: var(--content-max-width);
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* ===== å¯¼èˆªæ  ===== */
        .nav-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
            transition: transform 0.3s ease;
        }

        .nav-header.hidden {
            transform: translateY(-100%);
        }

        .nav-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
        }

        .nav-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-title h1 {
            font-size: 1.25rem;
            font-weight: 600;
            background: var(--rnn-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn-control {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all var(--animation-duration) ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
        }

        .btn-control:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .nav-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            height: 100%;
            background: var(--rnn-gradient);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* ===== ä¾§è¾¹å¯¼èˆª ===== */
        .sidebar {
            position: fixed;
            left: -300px;
            top: 60px;
            bottom: 0;
            width: 300px;
            background: var(--bg-section);
            border-right: 1px solid var(--border-color);
            padding: 2rem;
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 999;
        }

        .sidebar.open {
            transform: translateX(300px);
        }

        .sidebar-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 998;
        }

        .sidebar-overlay.active {
            display: block;
        }

        .toc-item {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.5rem;
            transition: all var(--animation-duration) ease;
            margin-bottom: 0.25rem;
        }

        .toc-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            transform: translateX(4px);
        }

        .toc-item.active {
            background: var(--rnn-gradient);
            color: white;
        }

        /* ===== ä¸»å†…å®¹åŒº ===== */
        main {
            margin-top: 80px;
            padding-bottom: 4rem;
        }

        /* ===== ç« èŠ‚å¡ç‰‡ ===== */
        .chapter-hero {
            background: var(--rnn-gradient);
            padding: 4rem 0;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .chapter-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: pulse 10s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(180deg); }
        }

        .chapter-hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: white;
        }

        .chapter-hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            animation: fadeInUp 0.8s ease;
        }

        .chapter-hero p {
            font-size: 1.25rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            animation: fadeInUp 0.8s ease 0.2s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== å†…å®¹åŒºå— ===== */
        .section-card {
            background: var(--bg-section);
            border-radius: 1rem;
            padding: 2.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
            transition: transform var(--animation-duration) ease;
        }

        .section-card:hover {
            transform: translateY(-2px);
        }

        /* ===== æ•…äº‹å¡ç‰‡ ===== */
        .story-card {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.15), rgba(245, 87, 108, 0.1));
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 2px solid rgba(240, 147, 251, 0.2);
            position: relative;
            overflow: hidden;
        }

        .story-card::before {
            content: 'ğŸ“–';
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 5rem;
            opacity: 0.1;
            transform: rotate(15deg);
        }

        /* ===== å¯¹è¯æ¡† ===== */
        .dialogue-box {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid var(--accent-pink);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 0.5rem 0.5rem 0;
            position: relative;
        }

        .dialogue-box .speaker {
            font-weight: bold;
            color: var(--accent-pink);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .dialogue-box .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        /* ===== æ¦‚å¿µç½‘æ ¼ ===== */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .concept-card {
            padding: 1.5rem;
            border-radius: 0.75rem;
            transition: all var(--animation-duration) ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .concept-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--rnn-gradient);
            transform: scaleX(0);
            transition: transform var(--animation-duration) ease;
        }

        .concept-card:hover::before {
            transform: scaleX(1);
        }

        .concept-card.why {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .concept-card.what {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .concept-card.how {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.3);
        }

        .concept-card.pitfall {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        /* ===== æ•°å­¦å®¹å™¨ ===== */
        .math-container {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(236, 72, 153, 0.05));
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .math-container::before {
            content: 'âˆ‘';
            position: absolute;
            top: -30px;
            right: 20px;
            font-size: 6rem;
            opacity: 0.05;
            font-family: 'Times New Roman', serif;
        }

        /* ç¾åŒ–çš„æ•°å­¦å…¬å¼ */
        .math-formula {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.75rem;
            padding: 2rem;
            margin: 1.5rem 0;
            text-align: center;
            font-size: 1.2rem;
            overflow-x: auto;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .math-formula-title {
            position: absolute;
            top: -12px;
            left: 2rem;
            background: var(--bg-section);
            padding: 0 1rem;
            font-size: 0.875rem;
            color: var(--accent-purple);
            font-weight: 600;
        }

        /* ===== æ€è€ƒç›’å­ ===== */
        .think-box {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(124, 58, 237, 0.1));
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
        }

        .think-box::before {
            content: 'ğŸ¤”';
            position: absolute;
            top: -15px;
            left: 30px;
            font-size: 2rem;
            background: var(--bg-section);
            padding: 0 10px;
        }

        /* ===== ä»£ç å®¹å™¨ ===== */
        .code-container {
            margin: 2rem 0;
            border-radius: 0.75rem;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .code-header {
            background: #1a1a2e;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .code-header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .code-header-right {
            display: flex;
            gap: 0.5rem;
        }

        .code-tab {
            padding: 0.5rem 1rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 0.5rem;
            transition: all var(--animation-duration) ease;
        }

        .code-tab.active {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        .code-action {
            padding: 0.5rem 1rem;
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            cursor: pointer;
            border-radius: 0.5rem;
            transition: all var(--animation-duration) ease;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .code-action:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .code-content {
            background: #0d1117;
            overflow-x: auto;
            position: relative;
        }

        .code-content pre {
            margin: 0;
            padding: 1.5rem;
        }

        .code-content code {
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .code-output {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            font-family: monospace;
            font-size: 0.875rem;
            display: none;
        }

        .code-output.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== å¯è§†åŒ–å®¹å™¨ ===== */
        .visualization-container {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
        }

        .viz-controls {
            display: flex;
            gap: 2rem;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .viz-control-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .viz-control-group label {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        input[type="range"] {
            width: 150px;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--rnn-gradient);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .slider-value {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.25rem 0.75rem;
            border-radius: 0.5rem;
            font-family: monospace;
            min-width: 50px;
            text-align: center;
        }

        canvas {
            display: block;
            margin: 0 auto;
            border-radius: 0.5rem;
            background: rgba(0, 0, 0, 0.2);
        }

        /* ===== å‚æ•°å¯¹æ¯”è¡¨æ ¼ ===== */
        .comparison-table {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            overflow: hidden;
            margin: 2rem 0;
            box-shadow: var(--shadow-lg);
        }

        .comparison-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th {
            background: var(--rnn-gradient);
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .comparison-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .comparison-table .highlight {
            color: var(--accent-green);
            font-weight: bold;
        }

        /* ===== æ¶æ„å›¾ ===== */
        .architecture-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 1rem;
            margin: 2rem 0;
            overflow-x: auto;
        }

        .arch-layer {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            min-width: 120px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .arch-layer:hover {
            transform: translateY(-4px);
            border-color: var(--accent-pink);
            box-shadow: 0 8px 16px rgba(236, 72, 153, 0.2);
        }

        .arch-layer h4 {
            color: var(--accent-pink);
            margin-bottom: 0.5rem;
        }

        .arch-arrow {
            font-size: 1.5rem;
            color: var(--text-secondary);
        }

        /* ===== RNN åŠ¨ç”» ===== */
        .rnn-animation {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin: 2rem 0;
            position: relative;
        }

        .rnn-cell {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.2), rgba(0, 242, 254, 0.1));
            border: 2px solid rgba(79, 172, 254, 0.5);
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.3s ease;
        }

        .rnn-cell.active {
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.4), rgba(0, 242, 254, 0.3));
            transform: scale(1.1);
            box-shadow: 0 8px 16px rgba(79, 172, 254, 0.3);
        }

        .time-step {
            position: absolute;
            bottom: -25px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .hidden-state {
            position: absolute;
            top: -40px;
            background: rgba(139, 92, 246, 0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-family: monospace;
        }

        /* ===== åºåˆ—ç¤ºä¾‹ ===== */
        .sequence-example {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.75rem;
            padding: 2rem;
            margin: 2rem 0;
            font-family: monospace;
        }

        .sequence-step {
            display: inline-block;
            background: rgba(79, 172, 254, 0.2);
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }

        .sequence-step.active {
            background: var(--rnn-gradient);
            color: white;
            transform: scale(1.1);
        }

        /* ===== æ¢¯åº¦æµå›¾ ===== */
        .gradient-flow-diagram {
            position: relative;
            height: 300px;
            margin: 2rem 0;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 1rem;
            padding: 2rem;
        }

        /* ===== æŒ‰é’®æ ·å¼ ===== */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--animation-duration) ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--rnn-gradient);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(240, 147, 251, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* ===== æç¤ºæ¡† ===== */
        .tip {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin: 1.5rem 0;
        }

        .tip-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .tip-content {
            flex: 1;
        }

        .tip.info {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.3);
        }

        .tip.warning {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .tip.error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .tip.success {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        /* ===== åŠ¨ä½œæ¸…å• ===== */
        .action-checklist {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
            transition: all var(--animation-duration) ease;
        }

        .checklist-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateX(4px);
        }

        .checklist-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--accent-yellow);
            border-radius: 0.25rem;
            cursor: pointer;
            transition: all var(--animation-duration) ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checklist-checkbox.checked {
            background: var(--accent-yellow);
        }

        .checklist-checkbox.checked::after {
            content: 'âœ“';
            color: var(--bg-dark);
            font-weight: bold;
        }

        /* ===== æ­¥éª¤æŒ‡ç¤ºå™¨ ===== */
        .step-indicator {
            display: flex;
            align-items: center;
            justify-content: space-around;
            margin: 2rem 0;
            position: relative;
        }

        .step-indicator::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 10%;
            right: 10%;
            height: 2px;
            background: rgba(255, 255, 255, 0.2);
            z-index: 0;
        }

        .step-item {
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .step-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--bg-section);
            border: 3px solid var(--accent-pink);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0 auto 0.5rem;
            transition: all 0.3s ease;
        }

        .step-item.active .step-circle {
            background: var(--accent-pink);
            color: white;
            transform: scale(1.1);
        }

        .step-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* ===== å“åº”å¼è®¾è®¡ ===== */
        @media (max-width: 1024px) {
            .chapter-hero h1 {
                font-size: 2.5rem;
            }

            .concept-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }

            .architecture-diagram {
                flex-direction: column;
            }

            .arch-arrow {
                transform: rotate(90deg);
            }
        }

        @media (max-width: 768px) {
            .nav-title h1 {
                font-size: 1rem;
            }

            .section-card {
                padding: 1.5rem;
            }

            .chapter-hero {
                padding: 3rem 0;
            }

            .chapter-hero h1 {
                font-size: 2rem;
            }

            .chapter-hero p {
                font-size: 1rem;
            }

            .viz-controls {
                flex-direction: column;
                align-items: stretch;
            }

            input[type="range"] {
                width: 100%;
            }

            .step-indicator {
                flex-direction: column;
                gap: 2rem;
            }

            .step-indicator::before {
                display: none;
            }

            .comparison-table {
                overflow-x: auto;
            }

            .comparison-table table {
                min-width: 600px;
            }
        }

        @media (max-width: 768px) {
            .key-concept-card {
                padding: 2rem !important;
            }

            .key-concept-card > div:nth-child(3) {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 1.5rem !important;
            }

            .key-concept-card h2 {
                font-size: 1.5rem !important;
            }

            .key-concept-card > p {
                font-size: 1.1rem !important;
            }
        }

        @media (max-width: 480px) {
            .key-concept-card > div:nth-child(3) {
                grid-template-columns: 1fr !important;
            }

            .key-concept-card {
                padding: 1.5rem !important;
            }
        }

        /* ===== å·¥å…·ç±» ===== */
        .text-center {
            text-align: center;
        }

        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }

        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }

        /* ===== åŠ è½½åŠ¨ç”» ===== */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-pink);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== å­¦ä¹ ä¼™ä¼´æ ·å¼ ===== */
        .learning-buddy {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 300px;
            background: var(--bg-section);
            border: 2px solid var(--accent-pink);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: var(--shadow-lg);
            z-index: 900;
            transform: translateY(400px);
            transition: transform 0.5s ease;
        }

        .learning-buddy.active {
            transform: translateY(0);
        }

        .learning-buddy.minimized {
            width: auto;
            padding: 0;
            border-radius: 50%;
            overflow: hidden;
        }

        .learning-buddy.minimized .buddy-content {
            display: none;
        }

        .learning-buddy.minimized .buddy-avatar {
            margin: 0;
            cursor: pointer;
        }

        .buddy-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .buddy-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #f093fb, #f5576c);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            flex-shrink: 0;
        }

        .buddy-controls {
            display: flex;
            gap: 0.5rem;
        }

        .buddy-control-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .buddy-control-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .buddy-message {
            background: rgba(240, 147, 251, 0.1);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            position: relative;
        }

        .buddy-message::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 20px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid rgba(240, 147, 251, 0.1);
        }

        /* æˆå°±å¼¹çª—æ ·å¼ */
        .achievement-popup {
            position: fixed;
            top: 100px;
            right: -400px;
            width: 350px;
            background: var(--bg-section);
            border: 2px solid var(--accent-yellow);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transition: right 0.5s ease;
        }

        .achievement-popup.show {
            right: 20px;
        }

        .achievement-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .achievement-icon {
            width: 60px;
            height: 60px;
            background: var(--accent-yellow);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .achievement-content h3 {
            color: var(--accent-yellow);
            margin-bottom: 0.25rem;
        }

        /* æ·»åŠ å­¦ä¹ ä¼™ä¼´æŒ‰é’®åˆ°å¯¼èˆªæ  */
        #toggle-buddy {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all var(--animation-duration) ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
        }

        #toggle-buddy:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        /* KaTeX æ ·å¼è¦†ç›– */
        .katex-display {
            overflow-x: auto;
            overflow-y: hidden;
            padding: 1rem 0;
        }

        .katex {
            font-size: 1.1em;
        }

        /* æ—¶é—´åºåˆ—ç¤ºä¾‹æ ·å¼ */
        .time-series-example {
            background: linear-gradient(135deg, rgba(250, 112, 154, 0.1), rgba(254, 225, 64, 0.1));
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
        }

        .time-series-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .time-series-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* å±•å¼€å›¾æ ·å¼ */
        .unfolding-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .unfolding-cell {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.2), rgba(245, 87, 108, 0.1));
            border: 2px solid rgba(240, 147, 251, 0.3);
            border-radius: 0.75rem;
            padding: 1.5rem;
            min-width: 100px;
            text-align: center;
            position: relative;
        }

        .unfolding-arrow {
            font-size: 2rem;
            color: var(--accent-pink);
            display: flex;
            align-items: center;
        }
    </style>
</head>
<body>

<!-- å¯¼èˆªæ  -->
<nav class="nav-header" role="navigation" aria-label="ä¸»å¯¼èˆª">
    <div class="container">
        <div class="nav-content">
            <div class="nav-title">
                <button id="toggle-sidebar" class="btn-control" aria-label="åˆ‡æ¢ä¾§è¾¹æ ">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <h1>ç¬¬7ç« ï¼šå¾ªç¯ç¥ç»ç½‘ç»œRNN</h1>
            </div>
            <div class="nav-controls">
                <button id="toggle-buddy" class="btn-control" aria-label="å­¦ä¹ åŠ©æ‰‹">
                    ğŸ¤–
                </button>
                <button id="toggle-animations" class="btn-control" aria-label="åˆ‡æ¢åŠ¨ç”»">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M10 8l6 4-6 4V8z"></path>
                    </svg>
                </button>
                <button id="toggle-theme" class="btn-control" aria-label="åˆ‡æ¢ä¸»é¢˜">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                    </svg>
                </button>
            </div>
        </div>
        <div class="nav-progress">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
    </div>
</nav>

<!-- ä¾§è¾¹æ  -->
<aside class="sidebar" id="sidebar">
    <h3 style="margin-bottom: 1.5rem; color: var(--accent-pink);">ç›®å½•å¯¼èˆª</h3>
    <nav>
        <a href="#intro" class="toc-item active">åºè¨€ï¼šæ—¶é—´çš„ç§˜å¯†</a>
        <a href="#why-rnn" class="toc-item">ä¸ºä»€ä¹ˆéœ€è¦RNN</a>
        <a href="#sequence-problem" class="toc-item">åºåˆ—æ•°æ®çš„æŒ‘æˆ˜</a>
        <a href="#rnn-idea" class="toc-item">RNNçš„æ ¸å¿ƒæ€æƒ³</a>
        <a href="#rnn-architecture" class="toc-item">RNNçš„æ•°å­¦åŸç†</a>
        <a href="#forward-backward" class="toc-item">å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­</a>
        <a href="#implementation" class="toc-item">ä»é›¶å®ç°RNN</a>
        <a href="#gradient-problem" class="toc-item">æ¢¯åº¦æ¶ˆå¤±ä¸çˆ†ç‚¸</a>
        <a href="#practice" class="toc-item">å®æˆ˜ï¼šæ–‡æœ¬ç”Ÿæˆ</a>
        <a href="#visualization" class="toc-item">å¯è§†åŒ–RNNå†…éƒ¨</a>
        <a href="#summary" class="toc-item">æ€»ç»“ä¸å±•æœ›</a>
    </nav>
</aside>

<!-- ä¾§è¾¹æ é®ç½© -->
<div class="sidebar-overlay" id="sidebar-overlay"></div>

<!-- ä¸»å†…å®¹ -->
<main>
    <!-- ç« èŠ‚æ ‡é¢˜ -->
    <section class="chapter-hero" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); padding: 6rem 0; position: relative; overflow: hidden;">
        <!-- èƒŒæ™¯è£…é¥° -->
        <div style="position: absolute; top: -50%; right: -10%; width: 600px; height: 600px; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); border-radius: 50%;"></div>
        <div style="position: absolute; bottom: -30%; left: -5%; width: 400px; height: 400px; background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 70%); border-radius: 50%;"></div>

        <div class="container">
            <div class="chapter-hero-content" style="text-align: center; color: white; position: relative; z-index: 2;">
                <h1 style="font-size: 3.5rem; margin-bottom: 1.5rem; font-weight: 700; text-shadow: 0 2px 10px rgba(0,0,0,0.2);">
                    å¾ªç¯ç¥ç»ç½‘ç»œï¼šè®©AIæ‹¥æœ‰è®°å¿†
                </h1>
                <p style="font-size: 1.4rem; opacity: 0.95; max-width: 700px; margin: 0 auto 3rem; text-shadow: 0 1px 5px rgba(0,0,0,0.2);">
                    æ¢ç´¢æ—¶é—´ç»´åº¦çš„å¥¥ç§˜ï¼Œç†è§£åºåˆ—æ•°æ®çš„æœ¬è´¨ï¼Œè®©ç¥ç»ç½‘ç»œå­¦ä¼š"è®°å¿†"
                </p>

                <!-- æ ‡ç­¾ -->
                <div style="display: flex; justify-content: center; gap: 1.5rem; flex-wrap: wrap;">
                    <span style="background: rgba(255, 255, 255, 0.25); padding: 0.75rem 1.5rem; border-radius: 30px; display: flex; align-items: center; gap: 0.5rem; backdrop-filter: blur(10px); font-size: 1.1rem;">
                        <span style="font-size: 1.3rem;">ğŸ”„</span> å¾ªç¯æœºåˆ¶
                    </span>
                    <span style="background: rgba(255, 255, 255, 0.25); padding: 0.75rem 1.5rem; border-radius: 30px; display: flex; align-items: center; gap: 0.5rem; backdrop-filter: blur(10px); font-size: 1.1rem;">
                        <span style="font-size: 1.3rem;">â±ï¸</span> 120åˆ†é’Ÿ
                    </span>
                    <span style="background: rgba(255, 255, 255, 0.25); padding: 0.75rem 1.5rem; border-radius: 30px; display: flex; align-items: center; gap: 0.5rem; backdrop-filter: blur(10px); font-size: 1.1rem;">
                        <span style="font-size: 1.3rem;">ğŸ¯</span> åºåˆ—å»ºæ¨¡
                    </span>
                </div>
            </div>
        </div>
    </section>

    <!-- ä¸€å¥è¯ç†è§£RNN -->
    <section style="background: var(--bg-dark); padding: 4rem 0 2rem 0; position: relative;">
        <div class="container">
            <div class="key-concept-card" style="
                background: linear-gradient(135deg, #334155 0%, #475569 100%);
                border-radius: 1.5rem;
                padding: 3rem;
                margin: 0 auto;
                max-width: 1000px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                border: 1px solid rgba(255,255,255,0.1);
            ">
                <h2 style="color: white; font-size: 1.8rem; margin-bottom: 2rem; text-align: center; display: flex; align-items: center; justify-content: center; gap: 1rem;">
                    <span style="font-size: 2rem;">ğŸ’¡</span>
                    ä¸€å¥è¯ç†è§£RNN
                </h2>

                <p style="color: #e2e8f0; font-size: 1.3rem; line-height: 1.8; text-align: center; margin-bottom: 3rem;">
                    RNNå°±åƒä¸€ä¸ªæœ‰çŸ­æœŸè®°å¿†çš„äººï¼Œ<br>
                    å®ƒä¼šæŠŠä¹‹å‰çœ‹åˆ°çš„ä¿¡æ¯å­˜åœ¨"éšè—çŠ¶æ€"é‡Œï¼Œ<br>
                    <span style="color: #fbbf24; font-weight: 600;">å¤„ç†æ–°ä¿¡æ¯æ—¶ä¼šå‚è€ƒä¹‹å‰çš„è®°å¿†ï¼Œå°±åƒä½ è¯»ä¹¦æ—¶ä¼šè®°ä½å‰é¢çš„å†…å®¹ã€‚</span>
                </p>

                <!-- å››ä¸ªæ ¸å¿ƒæ¦‚å¿µ -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 2rem; margin-bottom: 3rem;">
                    <div style="text-align: center;">
                        <div style="
                            width: 80px;
                            height: 80px;
                            margin: 0 auto 1rem;
                            background: rgba(255,255,255,0.1);
                            border-radius: 20px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 2.5rem;
                            border: 1px solid rgba(255,255,255,0.2);
                        ">
                            ğŸ”„
                        </div>
                        <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1rem;">å¾ªç¯è¿æ¥</h4>
                        <p style="color: #94a3b8; font-size: 0.85rem; line-height: 1.4;">
                            è¾“å‡ºåé¦ˆåˆ°è¾“å…¥<br>å½¢æˆè®°å¿†å¾ªç¯
                        </p>
                    </div>

                    <div style="text-align: center;">
                        <div style="
                            width: 80px;
                            height: 80px;
                            margin: 0 auto 1rem;
                            background: rgba(255,255,255,0.1);
                            border-radius: 20px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 2.5rem;
                            border: 1px solid rgba(255,255,255,0.2);
                        ">
                            ğŸ“
                        </div>
                        <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1rem;">éšè—çŠ¶æ€</h4>
                        <p style="color: #94a3b8; font-size: 0.85rem; line-height: 1.4;">
                            å­˜å‚¨å†å²ä¿¡æ¯<br>ä¼ é€’ç»™ä¸‹ä¸€æ­¥
                        </p>
                    </div>

                    <div style="text-align: center;">
                        <div style="
                            width: 80px;
                            height: 80px;
                            margin: 0 auto 1rem;
                            background: rgba(255,255,255,0.1);
                            border-radius: 20px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 2.5rem;
                            border: 1px solid rgba(255,255,255,0.2);
                        ">
                            â³
                        </div>
                        <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1rem;">æ—¶é—´å±•å¼€</h4>
                        <p style="color: #94a3b8; font-size: 0.85rem; line-height: 1.4;">
                            æŒ‰æ—¶é—´æ­¥å¤„ç†<br>é€ä¸ªå¤„ç†åºåˆ—
                        </p>
                    </div>

                    <div style="text-align: center;">
                        <div style="
                            width: 80px;
                            height: 80px;
                            margin: 0 auto 1rem;
                            background: rgba(255,255,255,0.1);
                            border-radius: 20px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 2.5rem;
                            border: 1px solid rgba(255,255,255,0.2);
                        ">
                            ğŸ§®
                        </div>
                        <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1rem;">å‚æ•°å…±äº«</h4>
                        <p style="color: #94a3b8; font-size: 0.85rem; line-height: 1.4;">
                            æ‰€æœ‰æ—¶é—´æ­¥<br>å…±äº«ç›¸åŒå‚æ•°
                        </p>
                    </div>
                </div>

                <!-- é€šä¿—æ˜“æ‡‚çš„æ€»ç»“ -->
                <div style="
                    background: rgba(251, 191, 36, 0.15);
                    border: 2px solid rgba(251, 191, 36, 0.3);
                    border-radius: 1rem;
                    padding: 2rem;
                    position: relative;
                ">
                    <div style="
                        position: absolute;
                        top: -15px;
                        left: 30px;
                        background: #475569;
                        padding: 0 15px;
                        border-radius: 20px;
                        font-size: 1.2rem;
                    ">
                        ğŸŒŸ é€šä¿—åœ°è¯´
                    </div>

                    <p style="color: #f1f5f9; font-size: 1.15rem; line-height: 1.8; margin: 0;">
                        <strong>æƒ³è±¡ä½ åœ¨çœ‹ç”µå½±ï¼š</strong>
                    </p>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
                        <div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 0.75rem;">
                            <h5 style="color: #fbbf24; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>1ï¸âƒ£</span> ä½ éœ€è¦è®°ä½å‰é¢çš„å‰§æƒ…
                            </h5>
                            <p style="color: #cbd5e1; font-size: 0.95rem; line-height: 1.6;">
                                è¿™å°±æ˜¯<strong>éšè—çŠ¶æ€</strong> - å­˜å‚¨ä¹‹å‰çœ‹åˆ°çš„ä¿¡æ¯
                            </p>
                        </div>

                        <div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 0.75rem;">
                            <h5 style="color: #fbbf24; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>2ï¸âƒ£</span> æ¯ä¸€å¸§éƒ½åŸºäºå‰é¢çš„ç†è§£
                            </h5>
                            <p style="color: #cbd5e1; font-size: 0.95rem; line-height: 1.6;">
                                è¿™å°±æ˜¯<strong>å¾ªç¯è¿æ¥</strong> - æ–°è¾“å…¥ç»“åˆå†å²è®°å¿†
                            </p>
                        </div>

                        <div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 0.75rem;">
                            <h5 style="color: #fbbf24; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>3ï¸âƒ£</span> ä¸€å¸§ä¸€å¸§åœ°çœ‹
                            </h5>
                            <p style="color: #cbd5e1; font-size: 0.95rem; line-height: 1.6;">
                                è¿™å°±æ˜¯<strong>æ—¶é—´å±•å¼€</strong> - æŒ‰é¡ºåºå¤„ç†åºåˆ—
                            </p>
                        </div>

                        <div style="background: rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 0.75rem;">
                            <h5 style="color: #fbbf24; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>4ï¸âƒ£</span> ç”¨åŒæ ·çš„æ–¹å¼ç†è§£æ¯ä¸€å¸§
                            </h5>
                            <p style="color: #cbd5e1; font-size: 0.95rem; line-height: 1.6;">
                                è¿™å°±æ˜¯<strong>å‚æ•°å…±äº«</strong> - æ¯ä¸ªæ—¶é—´æ­¥ç”¨ç›¸åŒçš„å¤„ç†æ–¹å¼
                            </p>
                        </div>
                    </div>

                    <div style="
                        background: rgba(34, 197, 94, 0.1);
                        border-left: 4px solid #22c55e;
                        padding: 1rem 1.5rem;
                        margin-top: 1.5rem;
                        border-radius: 0 0.5rem 0.5rem 0;
                    ">
                        <p style="color: #f1f5f9; font-size: 1.05rem; margin: 0; line-height: 1.6;">
                            <strong>ğŸ’¡ RNNçš„æœ¬è´¨ï¼š</strong>
                            RNNå°±æ˜¯ä¸€ä¸ªä¼š"è®°äº‹"çš„ç¥ç»ç½‘ç»œã€‚å®ƒå¤„ç†åºåˆ—æ•°æ®æ—¶ï¼Œ
                            ä¼šæŠŠä¹‹å‰çš„ä¿¡æ¯å­˜åœ¨éšè—çŠ¶æ€é‡Œï¼Œå°±åƒä½ çš„å¤§è„‘ä¼šè®°ä½åˆšæ‰è¯»è¿‡çš„å†…å®¹ä¸€æ ·ï¼
                        </p>
                    </div>
                </div>

            </div>

            <!-- æœ€ç®€æ´çš„ä¸€å¥è¯æ€»ç»“ -->
            <div style="text-align: center; margin-top: 3rem;">
                <p style="
                    font-size: 1.3rem;
                    color: var(--accent-pink);
                    font-weight: 600;
                    padding: 1rem 2rem;
                    background: rgba(236, 72, 153, 0.1);
                    border-radius: 50px;
                    display: inline-block;
                    border: 2px solid rgba(236, 72, 153, 0.3);
                ">
                    ğŸ¯ ç®€å•è¯´ï¼šRNN = å¸¦è®°å¿†çš„ç¥ç»ç½‘ç»œ
                </p>
            </div>

        </div>
    </section>

    <!-- ç« èŠ‚å†…å®¹å¼€å§‹ -->
    <div style="background: var(--bg-dark); padding-top: 100px;">
        <div class="container">

            <!-- å­¦ä¹ ç›®æ ‡ -->
            <section class="section-card">
                <h2 style="color: var(--accent-pink); margin-bottom: 1.5rem;">ğŸ“š æœ¬ç« å­¦ä¹ ç›®æ ‡</h2>
                <div class="concept-grid">
                    <div class="concept-card what">
                        <h3 style="color: var(--accent-green); margin-bottom: 0.5rem;">âœ“ ç†è§£åºåˆ—é—®é¢˜</h3>
                        <p>æ·±å…¥ç†è§£ä¸ºä»€ä¹ˆéœ€è¦ä¸“é—¨å¤„ç†åºåˆ—æ•°æ®çš„æ¨¡å‹</p>
                    </div>
                    <div class="concept-card how">
                        <h3 style="color: var(--accent-blue); margin-bottom: 0.5rem;">âœ“ æŒæ¡RNNåŸç†</h3>
                        <p>å­¦ä¼šRNNçš„æ•°å­¦åŸç†å’Œå‰å‘/åå‘ä¼ æ’­</p>
                    </div>
                    <div class="concept-card why">
                        <h3 style="color: var(--accent-red); margin-bottom: 0.5rem;">âœ“ å®ç°RNN</h3>
                        <p>ä»é›¶å¼€å§‹å®ç°ä¸€ä¸ªå®Œæ•´çš„RNN</p>
                    </div>
                    <div class="concept-card pitfall">
                        <h3 style="color: var(--accent-yellow); margin-bottom: 0.5rem;">âœ“ ç†è§£å±€é™æ€§</h3>
                        <p>è®¤è¯†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜å’ŒRNNçš„å±€é™</p>
                    </div>
                </div>
            </section>

            <!-- åºè¨€ï¼šæ—¶é—´çš„ç§˜å¯† -->
            <section id="intro" class="section-card">
                <div class="story-card">
                    <h2 style="color: var(--accent-pink); margin-bottom: 1.5rem;">ğŸ“– åºè¨€ï¼šæ—¶é—´çš„ç§˜å¯†</h2>

                    <p style="font-size: 1.1rem; line-height: 1.8; margin-bottom: 2rem;">
                        2010å¹´çš„ä¸€ä¸ªä¸‹åˆï¼ŒGoogleç ”ç©¶é™¢çš„ä¼šè®®å®¤é‡Œï¼Œä¸€ç¾¤å·¥ç¨‹å¸ˆæ­£åœ¨æ¿€çƒˆè®¨è®º...
                    </p>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘¨â€ğŸ’»</div>
                            å·¥ç¨‹å¸ˆAï¼š
                        </div>
                        <div>"æˆ‘ä»¬çš„è¯­éŸ³è¯†åˆ«ç³»ç»Ÿè¿˜æ˜¯ä¸å¤Ÿå¥½ã€‚æ˜æ˜è¯´çš„æ˜¯'æˆ‘æƒ³åƒè‹¹æœ'ï¼Œå®ƒå´è¯†åˆ«æˆ'æˆ‘æƒ³åƒè¯„ä¼°'ï¼"</div>
                    </div>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">ğŸ‘©â€ğŸ’»</div>
                            å·¥ç¨‹å¸ˆBï¼š
                        </div>
                        <div>"é—®é¢˜åœ¨äºæˆ‘ä»¬çš„æ¨¡å‹æ²¡æœ‰'è®°å¿†'ã€‚å®ƒä¸çŸ¥é“'åƒ'åé¢é€šå¸¸è·Ÿçš„æ˜¯é£Ÿç‰©ï¼Œè€Œä¸æ˜¯'è¯„ä¼°'è¿™ç§æŠ½è±¡æ¦‚å¿µã€‚"</div>
                    </div>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #fa709a, #fee140);">ğŸ§‘â€ğŸ”¬</div>
                            ç ”ç©¶å‘˜ï¼š
                        </div>
                        <div>"æ²¡é”™ï¼äººç±»ç†è§£è¯­è¨€æ˜¯æœ‰ä¸Šä¸‹æ–‡çš„ã€‚å½“æˆ‘ä»¬å¬åˆ°'æˆ‘æƒ³åƒ...'æ—¶ï¼Œå¤§è„‘ä¼šè‡ªåŠ¨é¢„æœŸåé¢æ˜¯é£Ÿç‰©ã€‚æˆ‘ä»¬éœ€è¦è®©ç¥ç»ç½‘ç»œä¹Ÿèƒ½è®°ä½ä¹‹å‰çš„ä¿¡æ¯ï¼"</div>
                    </div>

                    <div class="think-box">
                        <h3 style="color: var(--accent-purple); margin-bottom: 1rem;">ğŸ’­ å…³é”®æ´å¯Ÿ</h3>
                        <p>åºåˆ—æ•°æ®çš„æœ¬è´¨ç‰¹å¾ï¼š</p>
                        <ul style="margin-left: 2rem; margin-top: 1rem;">
                            <li><strong>æ—¶é—´ä¾èµ–æ€§</strong>ï¼šå½“å‰çš„ç†è§£ä¾èµ–äºä¹‹å‰çš„ä¿¡æ¯</li>
                            <li><strong>ä¸Šä¸‹æ–‡å…³è”</strong>ï¼šå‰åå†…å®¹ç›¸äº’å½±å“</li>
                            <li><strong>å˜é•¿ç‰¹æ€§</strong>ï¼šåºåˆ—é•¿åº¦ä¸å›ºå®š</li>
                            <li><strong>é¡ºåºé‡è¦æ€§</strong>ï¼šæ‰“ä¹±é¡ºåºä¼šæ”¹å˜å«ä¹‰</li>
                        </ul>
                    </div>

                    <div class="tip info">
                        <span class="tip-icon">ğŸ’¡</span>
                        <div class="tip-content">
                            <strong>å†å²èƒŒæ™¯ï¼š</strong><br>
                            RNNçš„æ€æƒ³æœ€æ—©å¯ä»¥è¿½æº¯åˆ°1980å¹´ä»£ï¼Œä½†ç›´åˆ°2010å¹´ä»£ï¼Œéšç€è®¡ç®—èƒ½åŠ›çš„æå‡å’Œè®­ç»ƒæŠ€å·§çš„æ”¹è¿›ï¼ŒRNNæ‰çœŸæ­£åœ¨å®é™…åº”ç”¨ä¸­å¤§æ”¾å¼‚å½©ã€‚
                        </div>
                    </div>
                </div>
            </section>

            <!-- ä¸ºä»€ä¹ˆéœ€è¦RNN -->
            <section id="why-rnn" class="section-card">
                <h2 style="color: var(--accent-red); margin-bottom: 1.5rem;">â“ ä¸ºä»€ä¹ˆéœ€è¦RNNï¼Ÿ</h2>

                <div class="story-card">
                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">ğŸ§‘â€ğŸ’»</div>
                            å­¦ç”Ÿå°æï¼š
                        </div>
                        <div>"è€å¸ˆï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†å¼ºå¤§çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦RNNï¼Ÿ"</div>
                    </div>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘¨â€ğŸ«</div>
                            è€å¸ˆï¼š
                        </div>
                        <div>"è®©æˆ‘ç”¨ä¸€ä¸ªä¾‹å­è¯´æ˜ã€‚è¯·çœ‹è¿™ä¸¤ä¸ªå¥å­ï¼š<br>
                            1. 'é“¶è¡Œçš„åˆ©ç‡ä¸Šå‡äº†'<br>
                            2. 'æ²³å²¸çš„æŸ³æ ‘å‘èŠ½äº†'<br>
                            æ³¨æ„'é“¶è¡Œ'å’Œ'æ²³å²¸'è™½ç„¶å‘éŸ³ç›¸ä¼¼ï¼Œä½†å«ä¹‰å®Œå…¨ä¸åŒã€‚ä½ æ˜¯å¦‚ä½•åŒºåˆ†çš„ï¼Ÿ"</div>
                    </div>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">ğŸ§‘â€ğŸ’»</div>
                            å­¦ç”Ÿå°æï¼š
                        </div>
                        <div>"é€šè¿‡ä¸Šä¸‹æ–‡ï¼'åˆ©ç‡'è®©æˆ‘çŸ¥é“æ˜¯é‡‘èæœºæ„ï¼Œ'æŸ³æ ‘'è®©æˆ‘çŸ¥é“æ˜¯æ²³è¾¹ã€‚"</div>
                    </div>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘¨â€ğŸ«</div>
                            è€å¸ˆï¼š
                        </div>
                        <div>"æ­£æ˜¯å¦‚æ­¤ï¼å‰é¦ˆç½‘ç»œæ¯æ¬¡åªçœ‹ä¸€ä¸ªè¾“å…¥ï¼Œæ— æ³•åˆ©ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å…·ä½“çš„å±€é™æ€§..."</div>
                    </div>
                </div>

                <div class="comparison-table">
                    <table>
                        <thead>
                        <tr>
                            <th>æŒ‘æˆ˜</th>
                            <th>å‰é¦ˆç¥ç»ç½‘ç»œ</th>
                            <th>å®é™…éœ€æ±‚</th>
                            <th>RNNçš„è§£å†³æ–¹æ¡ˆ</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><strong>å¤„ç†å˜é•¿è¾“å…¥</strong></td>
                            <td>éœ€è¦å›ºå®šå¤§å°è¾“å…¥</td>
                            <td>å¥å­é•¿åº¦ä¸å›ºå®š</td>
                            <td class="highlight">å¾ªç¯å¤„ç†ï¼Œé€ä¸ªè¯»å–</td>
                        </tr>
                        <tr>
                            <td><strong>è®°å¿†å†å²ä¿¡æ¯</strong></td>
                            <td>æ— è®°å¿†èƒ½åŠ›</td>
                            <td>ç†è§£éœ€è¦ä¸Šä¸‹æ–‡</td>
                            <td class="highlight">éšè—çŠ¶æ€ä¿å­˜ä¿¡æ¯</td>
                        </tr>
                        <tr>
                            <td><strong>å‚æ•°æ•ˆç‡</strong></td>
                            <td>æ¯ä¸ªä½ç½®ç‹¬ç«‹å‚æ•°</td>
                            <td>ç›¸åŒçš„å¤„ç†è§„åˆ™</td>
                            <td class="highlight">æ‰€æœ‰æ—¶é—´æ­¥å…±äº«å‚æ•°</td>
                        </tr>
                        <tr>
                            <td><strong>åºåˆ—å…³ç³»å»ºæ¨¡</strong></td>
                            <td>æ— æ³•å»ºæ¨¡æ—¶åºå…³ç³»</td>
                            <td>é¡ºåºå¾ˆé‡è¦</td>
                            <td class="highlight">è‡ªç„¶å¤„ç†æ—¶é—´åºåˆ—</td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <div class="time-series-example">
                    <h3 style="color: var(--accent-cyan); margin-bottom: 1rem;">ğŸŒŠ åºåˆ—æ•°æ®æ— å¤„ä¸åœ¨</h3>
                    <div class="time-series-grid">
                        <div class="time-series-item">
                            <h4 style="color: var(--accent-pink);">ğŸ“ è‡ªç„¶è¯­è¨€</h4>
                            <p>å¥å­ã€æ®µè½ã€æ–‡ç« </p>
                        </div>
                        <div class="time-series-item">
                            <h4 style="color: var(--accent-blue);">ğŸµ éŸ³é¢‘ä¿¡å·</h4>
                            <p>è¯­éŸ³ã€éŸ³ä¹ã€å£°æ³¢</p>
                        </div>
                        <div class="time-series-item">
                            <h4 style="color: var(--accent-green);">ğŸ“ˆ æ—¶é—´åºåˆ—</h4>
                            <p>è‚¡ç¥¨ã€å¤©æ°”ã€ä¼ æ„Ÿå™¨</p>
                        </div>
                        <div class="time-series-item">
                            <h4 style="color: var(--accent-yellow);">ğŸ¬ è§†é¢‘æ•°æ®</h4>
                            <p>åŠ¨ä½œã€åœºæ™¯ã€äº‹ä»¶</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- åºåˆ—æ•°æ®çš„æŒ‘æˆ˜ -->
            <section id="sequence-problem" class="section-card">
                <h2 style="color: var(--accent-purple); margin-bottom: 1.5rem;">ğŸ¯ åºåˆ—æ•°æ®çš„æŒ‘æˆ˜</h2>

                <div class="story-card">
                    <h3 style="color: var(--accent-orange); margin-bottom: 1rem;">å®éªŒ1ï¼šè¯åºçš„é‡è¦æ€§</h3>

                    <div class="sequence-example">
                        <p style="font-size: 1.1rem; margin-bottom: 1rem;">åŸå¥ï¼š</p>
                        <div style="text-align: center;">
                            <span class="sequence-step">æˆ‘</span>
                            <span class="sequence-step">çˆ±</span>
                            <span class="sequence-step">æ·±åº¦</span>
                            <span class="sequence-step">å­¦ä¹ </span>
                        </div>

                        <p style="font-size: 1.1rem; margin: 2rem 0 1rem;">æ‰“ä¹±é¡ºåºï¼š</p>
                        <div style="text-align: center;">
                            <span class="sequence-step" style="background: rgba(239, 68, 68, 0.2);">å­¦ä¹ </span>
                            <span class="sequence-step" style="background: rgba(239, 68, 68, 0.2);">æˆ‘</span>
                            <span class="sequence-step" style="background: rgba(239, 68, 68, 0.2);">æ·±åº¦</span>
                            <span class="sequence-step" style="background: rgba(239, 68, 68, 0.2);">çˆ±</span>
                        </div>
                    </div>

                    <div class="think-box mt-3">
                        <h3 style="color: var(--accent-purple); margin-bottom: 1rem;">ğŸ’­ æ€è€ƒ</h3>
                        <p>åŒæ ·çš„è¯ï¼Œä¸åŒçš„é¡ºåºï¼Œæ„æ€å®Œå…¨æ”¹å˜ï¼è¿™è¯´æ˜äº†ä»€ä¹ˆï¼Ÿ</p>
                        <ul style="margin-left: 2rem; margin-top: 1rem;">
                            <li>åºåˆ—çš„<strong>é¡ºåºä¿¡æ¯</strong>è‡³å…³é‡è¦</li>
                            <li>ä¸èƒ½ç®€å•åœ°æŠŠåºåˆ—å½“ä½œ"è¯è¢‹"å¤„ç†</li>
                            <li>éœ€è¦ä¸€ä¸ªèƒ½ç†è§£é¡ºåºçš„æ¨¡å‹</li>
                        </ul>
                    </div>
                </div>

                <div class="story-card mt-3">
                    <h3 style="color: var(--accent-orange); margin-bottom: 1rem;">å®éªŒ2ï¼šé•¿è·ç¦»ä¾èµ–</h3>

                    <div class="sequence-example">
                        <p style="font-size: 1.1rem; margin-bottom: 1rem;">è€ƒè™‘è¿™ä¸ªå¥å­ï¼š</p>
                        <div style="text-align: center; line-height: 2;">
                            <span class="sequence-step" style="background: var(--accent-green);">æˆ‘</span>
                            <span class="sequence-step">æ˜¨å¤©</span>
                            <span class="sequence-step">å»</span>
                            <span class="sequence-step">äº†</span>
                            <span class="sequence-step">ä¸€å®¶</span>
                            <span class="sequence-step">å¾ˆ</span>
                            <span class="sequence-step">æœ‰å</span>
                            <span class="sequence-step">çš„</span>
                            <span class="sequence-step">é¤å…</span>
                            <span class="sequence-step">ï¼Œ</span>
                            <span class="sequence-step" style="background: var(--accent-green);">è§‰å¾—</span>
                            <span class="sequence-step">å‘³é“</span>
                            <span class="sequence-step">ä¸é”™</span>
                        </div>
                    </div>

                    <p style="margin-top: 1.5rem;">è¦ç†è§£"è§‰å¾—"çš„ä¸»è¯­æ˜¯"æˆ‘"ï¼Œæ¨¡å‹éœ€è¦è®°ä½10ä¸ªè¯ä¹‹å‰çš„ä¿¡æ¯ï¼</p>
                </div>

                <div class="concept-grid mt-3">
                    <div class="concept-card why">
                        <h3 style="color: var(--accent-red); margin-bottom: 1rem;">æŒ‘æˆ˜1ï¼šå˜é•¿åºåˆ—</h3>
                        <p>
                            â€¢ å¥å­é•¿åº¦ä¸ä¸€<br>
                            â€¢ æ— æ³•é¢„è®¾å›ºå®šå¤§å°<br>
                            â€¢ éœ€è¦çµæ´»å¤„ç†
                        </p>
                    </div>

                    <div class="concept-card what">
                        <h3 style="color: var(--accent-green); margin-bottom: 1rem;">æŒ‘æˆ˜2ï¼šæ—¶åºå…³ç³»</h3>
                        <p>
                            â€¢ å‰åå…³è”ç´§å¯†<br>
                            â€¢ å› æœå…³ç³»é‡è¦<br>
                            â€¢ é¡ºåºä¸å¯å¿½è§†
                        </p>
                    </div>

                    <div class="concept-card how">
                        <h3 style="color: var(--accent-blue); margin-bottom: 1rem;">æŒ‘æˆ˜3ï¼šé•¿ç¨‹ä¾èµ–</h3>
                        <p>
                            â€¢ ä¿¡æ¯è·¨åº¦å¤§<br>
                            â€¢ éœ€è¦é•¿æœŸè®°å¿†<br>
                            â€¢ é¿å…é—å¿˜é‡è¦ä¿¡æ¯
                        </p>
                    </div>

                    <div class="concept-card pitfall">
                        <h3 style="color: var(--accent-yellow); margin-bottom: 1rem;">æŒ‘æˆ˜4ï¼šè®¡ç®—æ•ˆç‡</h3>
                        <p>
                            â€¢ åºåˆ—å¯èƒ½å¾ˆé•¿<br>
                            â€¢ è®¡ç®—é‡éšé•¿åº¦å¢åŠ <br>
                            â€¢ éœ€è¦é«˜æ•ˆç®—æ³•
                        </p>
                    </div>
                </div>
            </section>

            <!-- RNNçš„æ ¸å¿ƒæ€æƒ³ -->
            <section id="rnn-idea" class="section-card">
                <h2 style="color: var(--accent-blue); margin-bottom: 1.5rem;">ğŸ’¡ RNNçš„æ ¸å¿ƒæ€æƒ³</h2>

                <div class="story-card">
                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘¨â€ğŸ«</div>
                            è€å¸ˆï¼š
                        </div>
                        <div>"è®©æˆ‘ç”¨ä¸€ä¸ªç±»æ¯”æ¥è§£é‡ŠRNNçš„å·¥ä½œåŸç†ã€‚æƒ³è±¡ä½ åœ¨é˜…è¯»ä¸€æœ¬ä¹¦..."</div>
                    </div>

                    <div class="unfolding-diagram">
                        <div class="unfolding-cell">
                            <h4 style="color: var(--accent-pink);">ğŸ“– ç¬¬1é¡µ</h4>
                            <p>ä¸»è§’å«å°æ˜</p>
                            <p style="color: var(--accent-cyan); margin-top: 0.5rem;">è®°å¿†ï¼šå°æ˜</p>
                        </div>
                        <div class="unfolding-arrow">â†’</div>
                        <div class="unfolding-cell">
                            <h4 style="color: var(--accent-pink);">ğŸ“– ç¬¬2é¡µ</h4>
                            <p>ä»–æ˜¯ä¸ªç¨‹åºå‘˜</p>
                            <p style="color: var(--accent-cyan); margin-top: 0.5rem;">è®°å¿†ï¼šå°æ˜+ç¨‹åºå‘˜</p>
                        </div>
                        <div class="unfolding-arrow">â†’</div>
                        <div class="unfolding-cell">
                            <h4 style="color: var(--accent-pink);">ğŸ“– ç¬¬3é¡µ</h4>
                            <p>æ­£åœ¨å­¦ä¹ AI</p>
                            <p style="color: var(--accent-cyan); margin-top: 0.5rem;">è®°å¿†ï¼šå°æ˜+ç¨‹åºå‘˜+å­¦AI</p>
                        </div>
                    </div>

                    <div class="think-box mt-3">
                        <h3 style="color: var(--accent-purple); margin-bottom: 1rem;">ğŸ¯ æ ¸å¿ƒæ´å¯Ÿ</h3>
                        <p>RNNçš„è®¾è®¡å“²å­¦ï¼š</p>
                        <ol style="margin-left: 2rem; margin-top: 1rem;">
                            <li><strong>å¾ªç¯è¿æ¥</strong>ï¼šæŠŠè¾“å‡ºåé¦ˆåˆ°è¾“å…¥ï¼Œå½¢æˆ"è®°å¿†"</li>
                            <li><strong>å‚æ•°å…±äº«</strong>ï¼šæ‰€æœ‰æ—¶é—´æ­¥ä½¿ç”¨ç›¸åŒçš„æƒé‡</li>
                            <li><strong>é€æ­¥å¤„ç†</strong>ï¼šä¸€æ¬¡å¤„ç†ä¸€ä¸ªæ—¶é—´æ­¥</li>
                            <li><strong>çŠ¶æ€ä¼ é€’</strong>ï¼šé€šè¿‡éšè—çŠ¶æ€ä¼ é€’ä¿¡æ¯</li>
                        </ol>
                    </div>
                </div>

                <!-- RNNå±•å¼€å›¾ -->
                <div class="visualization-container">
                    <h3 style="color: var(--accent-pink); margin-bottom: 1.5rem;">ğŸ¬ RNNçš„æ—¶é—´å±•å¼€</h3>

                    <div class="architecture-diagram">
                        <div class="arch-layer">
                            <h4>å¾ªç¯å½¢å¼</h4>
                            <div style="width: 80px; height: 80px; margin: 1rem auto; background: var(--rnn-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center; position: relative;">
                                <span style="color: white; font-weight: bold;">RNN</span>
                                <div style="position: absolute; top: -10px; right: -30px; width: 50px; height: 50px;">
                                    <svg viewBox="0 0 100 100">
                                        <path d="M 50 20 Q 80 20 80 50 Q 80 80 50 80" stroke="var(--accent-pink)" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                                        <defs>
                                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--accent-pink)" />
                                            </marker>
                                        </defs>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <div class="arch-arrow" style="font-size: 2rem;">â‰¡</div>
                        <div class="arch-layer" style="flex: 3;">
                            <h4>å±•å¼€å½¢å¼</h4>
                            <div class="rnn-animation">
                                <div class="rnn-cell" id="rnn-t0">
                                    <span>RNN</span>
                                    <span class="time-step">t=0</span>
                                    <span class="hidden-state">hâ‚€</span>
                                </div>
                                <div class="arch-arrow">â†’</div>
                                <div class="rnn-cell" id="rnn-t1">
                                    <span>RNN</span>
                                    <span class="time-step">t=1</span>
                                    <span class="hidden-state">hâ‚</span>
                                </div>
                                <div class="arch-arrow">â†’</div>
                                <div class="rnn-cell" id="rnn-t2">
                                    <span>RNN</span>
                                    <span class="time-step">t=2</span>
                                    <span class="hidden-state">hâ‚‚</span>
                                </div>
                                <div class="arch-arrow">â†’</div>
                                <div class="rnn-cell" id="rnn-t3">
                                    <span>RNN</span>
                                    <span class="time-step">t=...</span>
                                    <span class="hidden-state">h...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="viz-controls mt-3">
                        <button class="btn btn-primary" onclick="animateRNN()">
                            â–¶ï¸ æ¼”ç¤ºä¿¡æ¯æµåŠ¨
                        </button>
                        <button class="btn btn-secondary" onclick="resetRNNAnimation()">
                            ğŸ”„ é‡ç½®åŠ¨ç”»
                        </button>
                    </div>
                </div>

                <div class="tip info mt-3">
                    <span class="tip-icon">ğŸ’¡</span>
                    <div class="tip-content">
                        <strong>å…³é”®ç†è§£ï¼š</strong><br>
                        RNNçš„"å¾ªç¯"å¹¶ä¸æ˜¯çœŸçš„å¾ªç¯æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨æ—¶é—´ç»´åº¦ä¸Šå±•å¼€ã€‚æ¯ä¸ªæ—¶é—´æ­¥éƒ½ä½¿ç”¨ç›¸åŒçš„å‚æ•°ï¼Œä½†è¾“å…¥å’Œéšè—çŠ¶æ€ä¸åŒã€‚
                    </div>
                </div>
            </section>

            <!-- æ’å…¥ä½ç½®ï¼šåœ¨ id="rnn-idea" ç« èŠ‚ä¹‹åï¼Œid="rnn-architecture" ç« èŠ‚ä¹‹å‰ï¼Œä½œä¸ºä¸€ä¸ªæ–°çš„section -->

            <!-- RNNè®¾è®¡çš„è¯ç”Ÿ -->
            <section class="section-card">
                <h2 style="color: var(--accent-orange); margin-bottom: 1.5rem;">ğŸ§ª RNNæ˜¯å¦‚ä½•è¢«è®¾è®¡å‡ºæ¥çš„ï¼Ÿ</h2>

                <div class="story-card">
                    <h3 style="color: var(--accent-pink); margin-bottom: 1.5rem;">ğŸ“š å†å²æ—¶åˆ»ï¼š1986å¹´ï¼Œä¸€ä¸ªç ”ç©¶å°ç»„çš„è®¨è®º</h3>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #667eea, #764ba2);">ğŸ‘¨â€ğŸ”¬</div>
                            ç ”ç©¶å‘˜Aï¼š
                        </div>
                        <div>"æˆ‘ä»¬çš„å‰é¦ˆç½‘ç»œåœ¨å¤„ç†å•è¯åºåˆ—æ—¶æ€»æ˜¯å¤±è´¥ã€‚å®ƒæŠŠ'æˆ‘çˆ±ä½ 'å’Œ'ä½ çˆ±æˆ‘'å½“æˆä¸€æ ·çš„ï¼"</div>
                    </div>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘©â€ğŸ”¬</div>
                            ç ”ç©¶å‘˜Bï¼š
                        </div>
                        <div>"é—®é¢˜åœ¨äºç½‘ç»œæ²¡æœ‰'è®°å¿†'ã€‚å®ƒçœ‹åˆ°æ¯ä¸ªè¯æ—¶ï¼Œå·²ç»å¿˜è®°äº†ä¹‹å‰çœ‹åˆ°çš„è¯ã€‚"</div>
                    </div>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #fa709a, #fee140);">ğŸ§‘â€ğŸ”¬</div>
                            ç ”ç©¶å‘˜Cï¼š
                        </div>
                        <div>"ç­‰ç­‰ï¼å¦‚æœæˆ‘ä»¬è®©ç½‘ç»œçš„è¾“å‡º...åé¦ˆå›è¾“å…¥å‘¢ï¼Ÿå°±åƒäººç±»é˜…è¯»ä¸€æ ·ï¼Œå¸¦ç€ä¹‹å‰çš„ç†è§£å»è¯»ä¸‹ä¸€ä¸ªè¯ï¼"</div>
                    </div>
                </div>

                <!-- è®¾è®¡æ¼”è¿›è¿‡ç¨‹ -->
                <div class="think-box" style="margin-top: 2rem;">
                    <h3 style="color: var(--accent-purple); margin-bottom: 1.5rem;">ğŸ¯ æ ¸å¿ƒæ´å¯Ÿï¼šçŠ¶æ€æœºæ€æƒ³</h3>
                    <p style="font-size: 1.1rem; line-height: 1.8;">
                        RNNçš„è®¾è®¡çµæ„Ÿæ¥è‡ªäº<strong>æœ‰é™çŠ¶æ€æœºï¼ˆFSMï¼‰</strong>ã€‚åœ¨FSMä¸­ï¼š<br>
                        â€¢ ç³»ç»Ÿæœ‰å†…éƒ¨çŠ¶æ€<br>
                        â€¢ æ ¹æ®è¾“å…¥å’Œå½“å‰çŠ¶æ€ï¼Œè½¬ç§»åˆ°æ–°çŠ¶æ€<br>
                        â€¢ çŠ¶æ€åŒ…å«äº†å†å²ä¿¡æ¯çš„æ‘˜è¦
                    </p>
                </div>

                <!-- ä»æƒ³æ³•åˆ°è®¾è®¡ -->
                <div class="concept-grid" style="margin-top: 2rem;">
                    <div class="concept-card why" style="background: rgba(239, 68, 68, 0.1);">
                        <h3 style="color: var(--accent-red); margin-bottom: 1rem;">1ï¸âƒ£ æœ€åˆæƒ³æ³•</h3>
                        <p style="font-size: 0.95rem;">
                            <strong>æœ´ç´ æƒ³æ³•ï¼š</strong><br>
                            "è®©ç½‘ç»œè®°ä½æ‰€æœ‰å†å²è¾“å…¥"<br><br>
                            <strong>é—®é¢˜ï¼š</strong><br>
                            â€¢ å­˜å‚¨çˆ†ç‚¸<br>
                            â€¢ å¦‚ä½•ä½¿ç”¨å†å²ï¼Ÿ<br>
                            â€¢ è®¡ç®—å¤æ‚åº¦å¤ªé«˜
                        </p>
                    </div>

                    <div class="concept-card what" style="background: rgba(34, 197, 94, 0.1);">
                        <h3 style="color: var(--accent-green); margin-bottom: 1rem;">2ï¸âƒ£ å…³é”®åˆ›æ–°</h3>
                        <p style="font-size: 0.95rem;">
                            <strong>å‹ç¼©æ€æƒ³ï¼š</strong><br>
                            "ç”¨å›ºå®šå¤§å°çš„å‘é‡æ€»ç»“å†å²"<br><br>
                            <strong>ç±»æ¯”ï¼š</strong><br>
                            å°±åƒè¯»ä¹¦æ—¶çš„"ç†è§£"<br>
                            ä¸æ˜¯è®°ä½æ¯ä¸ªå­—<br>
                            è€Œæ˜¯å½¢æˆæ•´ä½“å°è±¡
                        </p>
                    </div>

                    <div class="concept-card how" style="background: rgba(79, 172, 254, 0.1);">
                        <h3 style="color: var(--accent-blue); margin-bottom: 1rem;">3ï¸âƒ£ å¾ªç¯è®¾è®¡</h3>
                        <p style="font-size: 0.95rem;">
                            <strong>é€’å½’å®šä¹‰ï¼š</strong><br>
                            æ–°çŠ¶æ€ = f(æ—§çŠ¶æ€, æ–°è¾“å…¥)<br><br>
                            <strong>ä¼˜åŠ¿ï¼š</strong><br>
                            â€¢ å‚æ•°å…±äº«<br>
                            â€¢ ç†è®ºä¸Šæ— é™è®°å¿†<br>
                            â€¢ è®¡ç®—é«˜æ•ˆ
                        </p>
                    </div>

                    <div class="concept-card pitfall" style="background: rgba(251, 191, 36, 0.1);">
                        <h3 style="color: var(--accent-yellow); margin-bottom: 1rem;">4ï¸âƒ£ å®ç°ç»†èŠ‚</h3>
                        <p style="font-size: 0.95rem;">
                            <strong>å·¥ç¨‹è€ƒè™‘ï¼š</strong><br>
                            â€¢ éœ€è¦éçº¿æ€§æ¿€æ´»<br>
                            â€¢ æ¢¯åº¦è¦èƒ½ä¼ æ’­<br>
                            â€¢ åˆå§‹åŒ–å¾ˆå…³é”®<br><br>
                            æœ€ç»ˆé€‰æ‹©ï¼štanhæ¿€æ´»
                        </p>
                    </div>
                </div>

                <!-- è®¾è®¡æ€è·¯æ¼”ç¤º -->
                <div class="visualization-container" style="margin-top: 2rem;">
                    <h3 style="color: var(--accent-cyan); margin-bottom: 1.5rem;">ğŸ¨ ä»ç›´è§‰åˆ°å®ç°ï¼šRNNè®¾è®¡æ¼”è¿›</h3>

                    <!-- æ–¹æ¡ˆ1ï¼šå…¨è¿æ¥æš´åŠ›æ–¹æ¡ˆ -->
                    <div style="background: rgba(239, 68, 68, 0.1); padding: 2rem; border-radius: 1rem; margin-bottom: 1.5rem;">
                        <h4 style="color: var(--accent-red); margin-bottom: 1rem;">âŒ æ–¹æ¡ˆ1ï¼šå…¨è¿æ¥æš´åŠ›å­˜å‚¨</h4>
                        <div class="architecture-diagram">
                            <div class="arch-layer" style="flex: 2;">
                                <h5>è¾“å…¥åºåˆ—</h5>
                                <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                    <span style="padding: 0.5rem; background: rgba(255,255,255,0.1); border-radius: 0.25rem;">xâ‚</span>
                                    <span style="padding: 0.5rem; background: rgba(255,255,255,0.1); border-radius: 0.25rem;">xâ‚‚</span>
                                    <span style="padding: 0.5rem; background: rgba(255,255,255,0.1); border-radius: 0.25rem;">xâ‚ƒ</span>
                                    <span style="padding: 0.5rem; background: rgba(255,255,255,0.1); border-radius: 0.25rem;">...</span>
                                    <span style="padding: 0.5rem; background: rgba(255,255,255,0.1); border-radius: 0.25rem;">xâ‚œ</span>
                                </div>
                            </div>
                            <div class="arch-arrow">â†’</div>
                            <div class="arch-layer">
                                <h5>å·¨å¤§ç½‘ç»œ</h5>
                                <p style="font-size: 0.875rem; color: var(--accent-red);">å‚æ•°çˆ†ç‚¸ï¼</p>
                            </div>
                            <div class="arch-arrow">â†’</div>
                            <div class="arch-layer">
                                <h5>è¾“å‡º</h5>
                                <p>yâ‚œ</p>
                            </div>
                        </div>
                        <p style="margin-top: 1rem; color: var(--text-secondary);">
                            <strong>é—®é¢˜ï¼š</strong>ä¸åŒé•¿åº¦éœ€è¦ä¸åŒçš„ç½‘ç»œï¼Œå‚æ•°é‡éšåºåˆ—é•¿åº¦çˆ†ç‚¸å¢é•¿
                        </p>
                    </div>

                    <!-- æ–¹æ¡ˆ2ï¼šæ»‘åŠ¨çª—å£ -->
                    <div style="background: rgba(251, 191, 36, 0.1); padding: 2rem; border-radius: 1rem; margin-bottom: 1.5rem;">
                        <h4 style="color: var(--accent-yellow); margin-bottom: 1rem;">âš ï¸ æ–¹æ¡ˆ2ï¼šå›ºå®šçª—å£</h4>
                        <div class="architecture-diagram">
                            <div class="arch-layer" style="flex: 2;">
                                <h5>æ»‘åŠ¨çª—å£</h5>
                                <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                    <span style="padding: 0.5rem; background: rgba(255,255,255,0.2); border-radius: 0.25rem;">xâ‚œâ‚‹â‚‚</span>
                                    <span style="padding: 0.5rem; background: rgba(255,255,255,0.2); border-radius: 0.25rem;">xâ‚œâ‚‹â‚</span>
                                    <span style="padding: 0.5rem; background: rgba(255,255,255,0.3); border-radius: 0.25rem;">xâ‚œ</span>
                                </div>
                            </div>
                            <div class="arch-arrow">â†’</div>
                            <div class="arch-layer">
                                <h5>å›ºå®šç½‘ç»œ</h5>
                                <p style="font-size: 0.875rem;">çª—å£å¤§å°=3</p>
                            </div>
                            <div class="arch-arrow">â†’</div>
                            <div class="arch-layer">
                                <h5>è¾“å‡º</h5>
                                <p>yâ‚œ</p>
                            </div>
                        </div>
                        <p style="margin-top: 1rem; color: var(--text-secondary);">
                            <strong>é—®é¢˜ï¼š</strong>åªèƒ½çœ‹åˆ°å›ºå®šèŒƒå›´çš„å†å²ï¼Œæ— æ³•å¤„ç†é•¿è·ç¦»ä¾èµ–
                        </p>
                    </div>

                    <!-- æ–¹æ¡ˆ3ï¼šRNNçš„è¯ç”Ÿ -->
                    <div style="background: rgba(34, 197, 94, 0.1); padding: 2rem; border-radius: 1rem;">
                        <h4 style="color: var(--accent-green); margin-bottom: 1rem;">âœ… æ–¹æ¡ˆ3ï¼šå¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰</h4>
                        <div class="architecture-diagram">
                            <div class="arch-layer">
                                <h5>è¾“å…¥</h5>
                                <p>xâ‚œ</p>
                            </div>
                            <div class="arch-arrow">â†’</div>
                            <div class="arch-layer" style="flex: 2; position: relative;">
                                <h5>å¾ªç¯å•å…ƒ</h5>
                                <div style="width: 100px; height: 100px; margin: 1rem auto; background: var(--rnn-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                    <span style="color: white; font-weight: bold;">RNN</span>
                                </div>
                                <div style="position: absolute; top: 20px; right: 10px;">
                                    <svg width="80" height="80" viewBox="0 0 100 100">
                                        <path d="M 50 20 Q 80 20 80 50 Q 80 80 50 80 Q 20 80 20 50 Q 20 20 50 20"
                                              stroke="var(--accent-pink)" stroke-width="3" fill="none"
                                              marker-end="url(#arrowhead-rnn)"/>
                                        <defs>
                                            <marker id="arrowhead-rnn" markerWidth="10" markerHeight="7"
                                                    refX="9" refY="3.5" orient="auto">
                                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--accent-pink)" />
                                            </marker>
                                        </defs>
                                    </svg>
                                </div>
                                <p style="font-size: 0.875rem; margin-top: 0.5rem;">hâ‚œ = f(hâ‚œâ‚‹â‚, xâ‚œ)</p>
                            </div>
                            <div class="arch-arrow">â†’</div>
                            <div class="arch-layer">
                                <h5>è¾“å‡º</h5>
                                <p>yâ‚œ</p>
                            </div>
                        </div>
                        <p style="margin-top: 1rem; color: var(--text-secondary);">
                            <strong>åˆ›æ–°ï¼š</strong>ç”¨éšè—çŠ¶æ€hå‹ç¼©å­˜å‚¨æ‰€æœ‰å†å²ä¿¡æ¯ï¼Œé€šè¿‡å¾ªç¯è¿æ¥ä¼ é€’
                        </p>
                    </div>
                </div>

                <!-- è®¾è®¡å†³ç­–è§£é‡Š -->
                <div class="math-container" style="margin-top: 2rem;">
                    <h3 style="color: var(--accent-purple); margin-bottom: 1.5rem;">ğŸ”§ å…³é”®è®¾è®¡å†³ç­–</h3>

                    <div class="tip info">
                        <span class="tip-icon">ğŸ’¡</span>
                        <div class="tip-content">
                            <strong>ä¸ºä»€ä¹ˆæ˜¯ h_t = f(h_{t-1}, x_t) è¿™ç§å½¢å¼ï¼Ÿ</strong><br>
                            è¿™æ˜¯æœ€ç®€å•çš„é©¬å°”å¯å¤«å‡è®¾ï¼šå½“å‰çŠ¶æ€åªä¾èµ–äºå‰ä¸€çŠ¶æ€å’Œå½“å‰è¾“å…¥ã€‚
                            è¿™è®©è®¡ç®—å˜å¾—å¯è¡Œï¼ŒåŒæ—¶ç†è®ºä¸Šä»èƒ½ä¼ é€’æ‰€æœ‰å†å²ä¿¡æ¯ã€‚
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.75rem;">
                            <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">ğŸ“Š çº¿æ€§ç»„åˆ</h4>
                            <p style="font-family: monospace; text-align: center; margin: 1rem 0;">
                                h_t = W_hh Â· h_{t-1} + W_xh Â· x_t + b_h
                            </p>
                            <p style="font-size: 0.9rem;">
                                <strong>åŸå› ï¼š</strong>æœ€è‡ªç„¶çš„ç»„åˆæ–¹å¼<br>
                                <strong>ä¼˜ç‚¹ï¼š</strong>å¯å¾®åˆ†ï¼Œæ˜“äºä¼˜åŒ–<br>
                                <strong>ç¼ºç‚¹ï¼š</strong>éœ€è¦æ§åˆ¶æ•°å€¼ç¨³å®šæ€§
                            </p>
                        </div>

                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.75rem;">
                            <h4 style="color: var(--accent-pink); margin-bottom: 1rem;">ğŸŒŠ æ¿€æ´»å‡½æ•°</h4>
                            <p style="font-family: monospace; text-align: center; margin: 1rem 0;">
                                h_t = tanh(...)
                            </p>
                            <p style="font-size: 0.9rem;">
                                <strong>ä¸ºä»€ä¹ˆä¸æ˜¯ReLUï¼Ÿ</strong>å†å²åŸå› <br>
                                <strong>ä¸ºä»€ä¹ˆä¸æ˜¯Sigmoidï¼Ÿ</strong>éé›¶ä¸­å¿ƒ<br>
                                <strong>tanhä¼˜åŠ¿ï¼š</strong>è¾“å‡ºåœ¨[-1,1]ï¼Œé›¶ä¸­å¿ƒ
                            </p>
                        </div>

                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.75rem;">
                            <h4 style="color: var(--accent-yellow); margin-bottom: 1rem;">ğŸ”„ å‚æ•°å…±äº«</h4>
                            <p style="font-family: monospace; text-align: center; margin: 1rem 0;">
                                æ‰€æœ‰æ—¶é—´æ­¥å…±ç”¨W_hh, W_xh
                            </p>
                            <p style="font-size: 0.9rem;">
                                <strong>ä¼˜åŠ¿1ï¼š</strong>å‚æ•°é‡å›ºå®š<br>
                                <strong>ä¼˜åŠ¿2ï¼š</strong>å¯å¤„ç†ä»»æ„é•¿åº¦<br>
                                <strong>å‡è®¾ï¼š</strong>ç›¸åŒçš„å¤„ç†è§„åˆ™
                            </p>
                        </div>
                    </div>
                </div>

                <!-- éªŒè¯è®¾è®¡ -->
                <div class="tip success" style="margin-top: 2rem;">
                    <span class="tip-icon">âœ…</span>
                    <div class="tip-content">
                        <strong>RNNè®¾è®¡çš„ç²¾å¦™ä¹‹å¤„ï¼š</strong><br>
                        1. <strong>é€’å½’ç»“æ„</strong>è§£å†³äº†å˜é•¿è¾“å…¥é—®é¢˜<br>
                        2. <strong>éšè—çŠ¶æ€</strong>å®ç°äº†ä¿¡æ¯å‹ç¼©å­˜å‚¨<br>
                        3. <strong>å‚æ•°å…±äº«</strong>ä¿è¯äº†æ¨¡å‹å¤§å°å›ºå®š<br>
                        4. <strong>å¯å¾®åˆ†è®¾è®¡</strong>å…è®¸ç«¯åˆ°ç«¯è®­ç»ƒ<br><br>
                        è¿™ä¸ªç®€æ´çš„è®¾è®¡å¼€å¯äº†åºåˆ—å»ºæ¨¡çš„æ–°æ—¶ä»£ï¼
                    </div>
                </div>
            </section>

            <!-- RNNçš„æ•°å­¦åŸç† -->
            <section id="rnn-architecture" class="section-card">
                <h2 style="color: var(--accent-purple); margin-bottom: 1.5rem;">ğŸ”¬ RNNçš„æ•°å­¦åŸç†</h2>

                <div class="math-container">
                    <h3 style="color: var(--accent-purple); margin-bottom: 1.5rem;">ğŸ“ RNNçš„æ•°å­¦è¡¨è¾¾</h3>

                    <div class="math-formula">
                        <div class="math-formula-title">æ ¸å¿ƒå…¬å¼</div>
                        <div class="katex-display">
                            $$h_t = \tanh(W_{hh} h_{t-1} + W_{xh} x_t + b_h)$$
                            $$y_t = W_{hy} h_t + b_y$$
                        </div>
                    </div>

                    <div class="math-explanation" style="margin-top: 2rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">ç¬¦å·è¯´æ˜ï¼š</h4>
                        <ul style="margin-left: 2rem; line-height: 2;">
                            <li>$x_t$ : æ—¶åˆ» t çš„è¾“å…¥å‘é‡</li>
                            <li>$h_t$ : æ—¶åˆ» t çš„éšè—çŠ¶æ€ï¼ˆè®°å¿†ï¼‰</li>
                            <li>$y_t$ : æ—¶åˆ» t çš„è¾“å‡º</li>
                            <li>$W_{xh}$ : è¾“å…¥åˆ°éšè—å±‚çš„æƒé‡çŸ©é˜µ</li>
                            <li>$W_{hh}$ : éšè—å±‚åˆ°éšè—å±‚çš„æƒé‡çŸ©é˜µï¼ˆå¾ªç¯è¿æ¥ï¼‰</li>
                            <li>$W_{hy}$ : éšè—å±‚åˆ°è¾“å‡ºå±‚çš„æƒé‡çŸ©é˜µ</li>
                            <li>$b_h, b_y$ : åç½®é¡¹</li>
                        </ul>
                    </div>

                    <div class="think-box mt-3">
                        <h3 style="color: var(--accent-purple); margin-bottom: 1rem;">ğŸ¤” æ·±å…¥ç†è§£</h3>
                        <p>è¿™ä¸ªå…¬å¼å‘Šè¯‰æˆ‘ä»¬ä»€ä¹ˆï¼Ÿ</p>
                        <ol style="margin-left: 2rem; margin-top: 1rem;">
                            <li>æ–°çš„éšè—çŠ¶æ€ $h_t$ ç”±ä¸¤éƒ¨åˆ†å†³å®šï¼š
                                <ul>
                                    <li>å½“å‰è¾“å…¥ $x_t$</li>
                                    <li>ä¹‹å‰çš„è®°å¿† $h_{t-1}$</li>
                                </ul>
                            </li>
                            <li>$W_{hh}$ æ˜¯å…³é”®ï¼šå®ƒå†³å®šäº†å¦‚ä½•ä½¿ç”¨å†å²ä¿¡æ¯</li>
                            <li>$\tanh$ æ¿€æ´»å‡½æ•°ï¼šå°†å€¼é™åˆ¶åœ¨ [-1, 1] ä¹‹é—´</li>
                        </ol>
                    </div>
                </div>

                <!-- å‚æ•°è¯¦è§£ -->
                <div class="comparison-table mt-3">
                    <table>
                        <thead>
                        <tr>
                            <th>å‚æ•°</th>
                            <th>ç»´åº¦</th>
                            <th>ä½œç”¨</th>
                            <th>é‡è¦æ€§</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><strong>$W_{xh}$</strong></td>
                            <td>hidden_dim Ã— input_dim</td>
                            <td>å°†è¾“å…¥æ˜ å°„åˆ°éšè—ç©ºé—´</td>
                            <td class="highlight">å¤„ç†æ–°ä¿¡æ¯</td>
                        </tr>
                        <tr>
                            <td><strong>$W_{hh}$</strong></td>
                            <td>hidden_dim Ã— hidden_dim</td>
                            <td>æ§åˆ¶è®°å¿†çš„ä¼ é€’</td>
                            <td class="highlight">æ ¸å¿ƒå‚æ•°ï¼</td>
                        </tr>
                        <tr>
                            <td><strong>$W_{hy}$</strong></td>
                            <td>output_dim Ã— hidden_dim</td>
                            <td>ç”Ÿæˆè¾“å‡º</td>
                            <td class="highlight">ä»»åŠ¡ç›¸å…³</td>
                        </tr>
                        <tr>
                            <td><strong>$h_t$</strong></td>
                            <td>hidden_dim Ã— 1</td>
                            <td>å­˜å‚¨è®°å¿†çŠ¶æ€</td>
                            <td class="highlight">ä¿¡æ¯è½½ä½“</td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ç»´åº¦ç¤ºä¾‹ -->
                <div class="visualization-container mt-3">
                    <h3 style="color: var(--accent-cyan); margin-bottom: 1.5rem;">ğŸ“Š å…·ä½“ä¾‹å­ï¼šè¯åµŒå…¥ç»´åº¦</h3>

                    <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 0.75rem;">
                        <p style="margin-bottom: 1.5rem;">å‡è®¾æˆ‘ä»¬å¤„ç†å¥å­ï¼š"æˆ‘çˆ±RNN"ï¼Œä½¿ç”¨ä»¥ä¸‹é…ç½®ï¼š</p>
                        <ul style="margin-left: 2rem; line-height: 2;">
                            <li>è¯æ±‡è¡¨å¤§å°ï¼š10000</li>
                            <li>è¯åµŒå…¥ç»´åº¦ï¼š128</li>
                            <li>éšè—å±‚ç»´åº¦ï¼š256</li>
                            <li>è¾“å‡ºç»´åº¦ï¼š10000ï¼ˆé¢„æµ‹ä¸‹ä¸€ä¸ªè¯ï¼‰</li>
                        </ul>

                        <div class="architecture-diagram mt-3">
                            <div class="arch-layer">
                                <h4>è¾“å…¥</h4>
                                <p>x_t: [128]</p>
                                <p style="font-size: 0.875rem; color: var(--text-secondary);">è¯åµŒå…¥</p>
                            </div>
                            <div class="arch-arrow">â†’</div>
                            <div class="arch-layer">
                                <h4>éšè—å±‚</h4>
                                <p>h_t: [256]</p>
                                <p style="font-size: 0.875rem; color: var(--text-secondary);">è®°å¿†çŠ¶æ€</p>
                            </div>
                            <div class="arch-arrow">â†’</div>
                            <div class="arch-layer">
                                <h4>è¾“å‡º</h4>
                                <p>y_t: [10000]</p>
                                <p style="font-size: 0.875rem; color: var(--text-secondary);">è¯æ¦‚ç‡</p>
                            </div>
                        </div>

                        <div class="mt-3" style="background: rgba(139, 92, 246, 0.1); padding: 1rem; border-radius: 0.5rem;">
                            <p><strong>å‚æ•°é‡è®¡ç®—ï¼š</strong></p>
                            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                                <li>W_xh: 128 Ã— 256 = 32,768</li>
                                <li>W_hh: 256 Ã— 256 = 65,536</li>
                                <li>W_hy: 256 Ã— 10000 = 2,560,000</li>
                                <li><strong>æ€»å‚æ•°ï¼šçº¦260ä¸‡</strong></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­ -->
            <section id="forward-backward" class="section-card">
                <h2 style="color: var(--accent-green); margin-bottom: 1.5rem;">âš¡ å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­</h2>

                <div class="story-card">
                    <h3 style="color: var(--accent-cyan); margin-bottom: 1rem;">å‰å‘ä¼ æ’­ï¼šä¿¡æ¯çš„æµåŠ¨</h3>

                    <div class="sequence-example">
                        <p style="font-size: 1.1rem; margin-bottom: 1rem;">å¤„ç†å¥å­ï¼š"æˆ‘çˆ±AI"</p>

                        <div class="step-indicator">
                            <div class="step-item active">
                                <div class="step-circle">1</div>
                                <div class="step-label">t=0: "æˆ‘"</div>
                            </div>
                            <div class="step-item">
                                <div class="step-circle">2</div>
                                <div class="step-label">t=1: "çˆ±"</div>
                            </div>
                            <div class="step-item">
                                <div class="step-circle">3</div>
                                <div class="step-label">t=2: "AI"</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-header-left">
                            <div class="code-tab active" data-tab="forward">å‰å‘ä¼ æ’­</div>
                            <div class="code-tab" data-tab="backward">åå‘ä¼ æ’­</div>
                            <div class="code-tab" data-tab="complete">å®Œæ•´å®ç°</div>
                        </div>
                    </div>

                    <div class="code-content" data-tab-content="forward">
                        <pre><code class="language-python">import numpy as np

def rnn_forward(x, h_prev, Wxh, Whh, Why, bh, by):
    """
    RNNå‰å‘ä¼ æ’­ï¼ˆå•ä¸ªæ—¶é—´æ­¥ï¼‰

    å‚æ•°:
    x: å½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ (input_dim,)
    h_prev: ä¸Šä¸€æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ (hidden_dim,)
    Wxh: è¾“å…¥åˆ°éšè—å±‚çš„æƒé‡ (hidden_dim, input_dim)
    Whh: éšè—åˆ°éšè—çš„æƒé‡ (hidden_dim, hidden_dim)
    Why: éšè—åˆ°è¾“å‡ºçš„æƒé‡ (output_dim, hidden_dim)
    bh, by: åç½®

    è¿”å›:
    y: è¾“å‡º (output_dim,)
    h: æ–°çš„éšè—çŠ¶æ€ (hidden_dim,)
    cache: ç”¨äºåå‘ä¼ æ’­çš„ç¼“å­˜
    """
    # è®¡ç®—æ–°çš„éšè—çŠ¶æ€
    # h_t = tanh(Wxh @ x_t + Whh @ h_t-1 + bh)
    h = np.tanh(np.dot(Wxh, x) + np.dot(Whh, h_prev) + bh)

    # è®¡ç®—è¾“å‡º
    # y_t = Why @ h_t + by
    y = np.dot(Why, h) + by

    # ç¼“å­˜ç”¨äºåå‘ä¼ æ’­
    cache = (x, h_prev, h, Wxh, Whh, Why)

    return y, h, cache

# ç¤ºä¾‹ï¼šå¤„ç†æ•´ä¸ªåºåˆ—
def rnn_forward_sequence(X, h0, Wxh, Whh, Why, bh, by):
    """
    å¤„ç†æ•´ä¸ªåºåˆ—çš„å‰å‘ä¼ æ’­

    X: è¾“å…¥åºåˆ— (seq_len, input_dim)
    h0: åˆå§‹éšè—çŠ¶æ€
    """
    seq_len = X.shape[0]
    hidden_dim = h0.shape[0]
    output_dim = Why.shape[0]

    # å­˜å‚¨æ‰€æœ‰è¾“å‡ºå’Œéšè—çŠ¶æ€
    Y = np.zeros((seq_len, output_dim))
    H = np.zeros((seq_len + 1, hidden_dim))
    H[0] = h0

    caches = []

    # é€æ—¶é—´æ­¥å¤„ç†
    for t in range(seq_len):
        Y[t], H[t+1], cache = rnn_forward(
            X[t], H[t], Wxh, Whh, Why, bh, by
        )
        caches.append(cache)

    return Y, H[1:], caches

# æµ‹è¯•å‰å‘ä¼ æ’­
np.random.seed(42)
input_dim, hidden_dim, output_dim = 10, 20, 10
seq_len = 5

# åˆå§‹åŒ–å‚æ•°
Wxh = np.random.randn(hidden_dim, input_dim) * 0.01
Whh = np.random.randn(hidden_dim, hidden_dim) * 0.01
Why = np.random.randn(output_dim, hidden_dim) * 0.01
bh = np.zeros((hidden_dim,))
by = np.zeros((output_dim,))

# åˆ›å»ºè¾“å…¥åºåˆ—
X = np.random.randn(seq_len, input_dim)
h0 = np.zeros((hidden_dim,))

# å‰å‘ä¼ æ’­
Y, H, caches = rnn_forward_sequence(X, h0, Wxh, Whh, Why, bh, by)

print(f"è¾“å…¥å½¢çŠ¶: {X.shape}")
print(f"è¾“å‡ºå½¢çŠ¶: {Y.shape}")
print(f"éšè—çŠ¶æ€å½¢çŠ¶: {H.shape}")
print(f"\nç¬¬ä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡º: {Y[0][:5]}...")  # åªæ˜¾ç¤ºå‰5ä¸ªå€¼</code></pre>
                    </div>

                    <div class="code-content" data-tab-content="backward" style="display: none;">
                        <pre><code class="language-python">def rnn_backward_step(dy, cache, dh_next):
    """
    RNNåå‘ä¼ æ’­ï¼ˆå•ä¸ªæ—¶é—´æ­¥ï¼‰

    å‚æ•°:
    dy: è¾“å‡ºçš„æ¢¯åº¦ (output_dim,)
    cache: å‰å‘ä¼ æ’­çš„ç¼“å­˜
    dh_next: æ¥è‡ªæœªæ¥æ—¶é—´æ­¥çš„æ¢¯åº¦ (hidden_dim,)

    è¿”å›:
    dx: è¾“å…¥çš„æ¢¯åº¦
    dh_prev: ä¼ é€’ç»™å‰ä¸€æ—¶é—´æ­¥çš„æ¢¯åº¦
    dWxh, dWhh, dWhy, dbh, dby: å‚æ•°æ¢¯åº¦
    """
    x, h_prev, h, Wxh, Whh, Why = cache

    # è¾“å‡ºå±‚æ¢¯åº¦
    dWhy = np.dot(dy[:, np.newaxis], h[np.newaxis, :])
    dby = dy

    # éšè—å±‚æ¢¯åº¦ï¼ˆåŒ…æ‹¬æ¥è‡ªè¾“å‡ºå’Œæœªæ¥çš„æ¢¯åº¦ï¼‰
    dh = np.dot(Why.T, dy) + dh_next

    # tanhçš„æ¢¯åº¦
    dh_raw = (1 - h * h) * dh  # tanh'(x) = 1 - tanh(x)^2

    # å‚æ•°æ¢¯åº¦
    dWxh = np.dot(dh_raw[:, np.newaxis], x[np.newaxis, :])
    dWhh = np.dot(dh_raw[:, np.newaxis], h_prev[np.newaxis, :])
    dbh = dh_raw

    # è¾“å…¥å’Œå‰ä¸€éšè—çŠ¶æ€çš„æ¢¯åº¦
    dx = np.dot(Wxh.T, dh_raw)
    dh_prev = np.dot(Whh.T, dh_raw)

    return dx, dh_prev, dWxh, dWhh, dWhy, dbh, dby

def rnn_backward_sequence(dY, caches):
    """
    å¤„ç†æ•´ä¸ªåºåˆ—çš„åå‘ä¼ æ’­ï¼ˆBPTTï¼‰

    dY: è¾“å‡ºåºåˆ—çš„æ¢¯åº¦ (seq_len, output_dim)
    caches: å‰å‘ä¼ æ’­çš„ç¼“å­˜åˆ—è¡¨
    """
    seq_len = len(caches)

    # åˆå§‹åŒ–æ¢¯åº¦
    _, _, _, Wxh, Whh, Why = caches[0]
    dWxh = np.zeros_like(Wxh)
    dWhh = np.zeros_like(Whh)
    dWhy = np.zeros_like(Why)
    dbh = np.zeros(Wxh.shape[0])
    dby = np.zeros(Why.shape[0])

    dh_next = np.zeros(Wxh.shape[0])

    # åå‘éå†æ—¶é—´æ­¥
    for t in reversed(range(seq_len)):
        dx, dh_next, dWxh_t, dWhh_t, dWhy_t, dbh_t, dby_t = \
            rnn_backward_step(dY[t], caches[t], dh_next)

        # ç´¯ç§¯æ¢¯åº¦
        dWxh += dWxh_t
        dWhh += dWhh_t
        dWhy += dWhy_t
        dbh += dbh_t
        dby += dby_t

    # æ¢¯åº¦è£å‰ªï¼ˆé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ï¼‰
    for dparam in [dWxh, dWhh, dWhy, dbh, dby]:
        np.clip(dparam, -5, 5, out=dparam)

    return dWxh, dWhh, dWhy, dbh, dby

# æµ‹è¯•åå‘ä¼ æ’­
# å‡è®¾æˆ‘ä»¬æœ‰ç›®æ ‡è¾“å‡º
targets = np.random.randn(seq_len, output_dim)
# è®¡ç®—æŸå¤±æ¢¯åº¦ï¼ˆè¿™é‡Œç®€åŒ–ä¸ºMSEï¼‰
dY = Y - targets

# åå‘ä¼ æ’­
dWxh, dWhh, dWhy, dbh, dby = rnn_backward_sequence(dY, caches)

print("\næ¢¯åº¦æ£€æŸ¥:")
print(f"dWxh èŒƒæ•°: {np.linalg.norm(dWxh):.4f}")
print(f"dWhh èŒƒæ•°: {np.linalg.norm(dWhh):.4f}")
print(f"dWhy èŒƒæ•°: {np.linalg.norm(dWhy):.4f}")

# æ•°å€¼æ¢¯åº¦æ£€æŸ¥ï¼ˆéªŒè¯å®ç°æ­£ç¡®æ€§ï¼‰
def numerical_gradient_check():
    """æ•°å€¼æ¢¯åº¦æ£€æŸ¥"""
    epsilon = 1e-5

    # é€‰æ‹©ä¸€ä¸ªå‚æ•°è¿›è¡Œæ£€æŸ¥
    param = Whh
    dparam = dWhh

    # éšæœºé€‰æ‹©ä¸€ä¸ªä½ç½®
    i, j = 5, 7

    # è®¡ç®—æ•°å€¼æ¢¯åº¦
    old_val = param[i, j]

    # f(x + h)
    param[i, j] = old_val + epsilon
    Y_plus, _, _ = rnn_forward_sequence(X, h0, Wxh, Whh, Why, bh, by)
    loss_plus = 0.5 * np.sum((Y_plus - targets)**2)

    # f(x - h)
    param[i, j] = old_val - epsilon
    Y_minus, _, _ = rnn_forward_sequence(X, h0, Wxh, Whh, Why, bh, by)
    loss_minus = 0.5 * np.sum((Y_minus - targets)**2)

    # æ•°å€¼æ¢¯åº¦
    numerical_grad = (loss_plus - loss_minus) / (2 * epsilon)

    # æ¢å¤å‚æ•°
    param[i, j] = old_val

    # æ¯”è¾ƒ
    analytical_grad = dparam[i, j]
    relative_error = abs(numerical_grad - analytical_grad) / \
                    (abs(numerical_grad) + abs(analytical_grad) + 1e-8)

    print(f"\næ¢¯åº¦æ£€æŸ¥ (Whh[{i},{j}]):")
    print(f"è§£ææ¢¯åº¦: {analytical_grad:.6f}")
    print(f"æ•°å€¼æ¢¯åº¦: {numerical_grad:.6f}")
    print(f"ç›¸å¯¹è¯¯å·®: {relative_error:.2e}")
    print(f"æ£€æŸ¥{'é€šè¿‡' if relative_error < 1e-5 else 'å¤±è´¥'}!")

numerical_gradient_check()</code></pre>
                    </div>

                    <div class="code-content" data-tab-content="complete" style="display: none;">
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

class SimpleRNN:
    """ä»é›¶å®ç°çš„ç®€å•RNN"""

    def __init__(self, input_dim, hidden_dim, output_dim, learning_rate=0.01):
        """
        åˆå§‹åŒ–RNN

        å‚æ•°:
        input_dim: è¾“å…¥ç»´åº¦
        hidden_dim: éšè—å±‚ç»´åº¦
        output_dim: è¾“å‡ºç»´åº¦
        learning_rate: å­¦ä¹ ç‡
        """
        self.input_dim = input_dim
        self.hidden_dim = hidden_dim
        self.output_dim = output_dim
        self.learning_rate = learning_rate

        # åˆå§‹åŒ–å‚æ•°
        self.Wxh = np.random.randn(hidden_dim, input_dim) * 0.01
        self.Whh = np.random.randn(hidden_dim, hidden_dim) * 0.01
        self.Why = np.random.randn(output_dim, hidden_dim) * 0.01
        self.bh = np.zeros((hidden_dim,))
        self.by = np.zeros((output_dim,))

        # ç”¨äºAdamä¼˜åŒ–å™¨
        self.mWxh, self.mWhh, self.mWhy = np.zeros_like(self.Wxh), np.zeros_like(self.Whh), np.zeros_like(self.Why)
        self.mbh, self.mby = np.zeros_like(self.bh), np.zeros_like(self.by)
        self.vWxh, self.vWhh, self.vWhy = np.zeros_like(self.Wxh), np.zeros_like(self.Whh), np.zeros_like(self.Why)
        self.vbh, self.vby = np.zeros_like(self.bh), np.zeros_like(self.by)

    def forward(self, inputs, h_prev):
        """
        å‰å‘ä¼ æ’­

        inputs: è¾“å…¥åºåˆ— (seq_len, input_dim)
        h_prev: åˆå§‹éšè—çŠ¶æ€

        è¿”å›:
        outputs: è¾“å‡ºåºåˆ—
        h_states: æ‰€æœ‰éšè—çŠ¶æ€
        """
        seq_len = inputs.shape[0]
        outputs = np.zeros((seq_len, self.output_dim))
        h_states = np.zeros((seq_len + 1, self.hidden_dim))
        h_states[0] = h_prev

        for t in range(seq_len):
            # éšè—çŠ¶æ€æ›´æ–°
            h_states[t+1] = np.tanh(
                np.dot(self.Wxh, inputs[t]) +
                np.dot(self.Whh, h_states[t]) +
                self.bh
            )

            # è¾“å‡ºè®¡ç®—
            outputs[t] = np.dot(self.Why, h_states[t+1]) + self.by

        return outputs, h_states[1:]

    def backward(self, inputs, targets, h_states):
        """
        åå‘ä¼ æ’­ï¼ˆBPTTï¼‰
        """
        seq_len = inputs.shape[0]

        # åˆå§‹åŒ–æ¢¯åº¦
        dWxh = np.zeros_like(self.Wxh)
        dWhh = np.zeros_like(self.Whh)
        dWhy = np.zeros_like(self.Why)
        dbh = np.zeros_like(self.bh)
        dby = np.zeros_like(self.by)

        dh_next = np.zeros_like(h_states[0])

        # è®¡ç®—æŸå¤±
        outputs, _ = self.forward(inputs, h_states[0])
        loss = 0.5 * np.sum((outputs - targets)**2)

        # åå‘ä¼ æ’­
        for t in reversed(range(seq_len)):
            # è¾“å‡ºå±‚æ¢¯åº¦
            dy = outputs[t] - targets[t]
            dWhy += np.outer(dy, h_states[t])
            dby += dy

            # éšè—å±‚æ¢¯åº¦
            dh = np.dot(self.Why.T, dy) + dh_next
            dh_raw = (1 - h_states[t]**2) * dh

            # å‚æ•°æ¢¯åº¦
            dWxh += np.outer(dh_raw, inputs[t])
            dWhh += np.outer(dh_raw, h_states[t-1] if t > 0 else np.zeros_like(h_states[0]))
            dbh += dh_raw

            # ä¼ é€’æ¢¯åº¦
            dh_next = np.dot(self.Whh.T, dh_raw)

        # æ¢¯åº¦è£å‰ª
        for dparam in [dWxh, dWhh, dWhy, dbh, dby]:
            np.clip(dparam, -5, 5, out=dparam)

        return loss, dWxh, dWhh, dWhy, dbh, dby

    def update_parameters(self, dWxh, dWhh, dWhy, dbh, dby, iteration):
        """ä½¿ç”¨Adamä¼˜åŒ–å™¨æ›´æ–°å‚æ•°"""
        beta1, beta2 = 0.9, 0.999
        eps = 1e-8

        # æ›´æ–°æ¯ä¸ªå‚æ•°
        for param, dparam, m, v in zip(
            [self.Wxh, self.Whh, self.Why, self.bh, self.by],
            [dWxh, dWhh, dWhy, dbh, dby],
            [self.mWxh, self.mWhh, self.mWhy, self.mbh, self.mby],
            [self.vWxh, self.vWhh, self.vWhy, self.vbh, self.vby]
        ):
            m[:] = beta1 * m + (1 - beta1) * dparam
            v[:] = beta2 * v + (1 - beta2) * (dparam ** 2)
            m_hat = m / (1 - beta1 ** (iteration + 1))
            v_hat = v / (1 - beta2 ** (iteration + 1))
            param -= self.learning_rate * m_hat / (np.sqrt(v_hat) + eps)

    def train(self, X_train, Y_train, epochs=100, verbose=True):
        """è®­ç»ƒRNN"""
        losses = []

        for epoch in range(epochs):
            total_loss = 0
            h_prev = np.zeros((self.hidden_dim,))

            # å‰å‘å’Œåå‘ä¼ æ’­
            _, h_states = self.forward(X_train, h_prev)
            loss, dWxh, dWhh, dWhy, dbh, dby = self.backward(X_train, Y_train, h_states)

            # æ›´æ–°å‚æ•°
            self.update_parameters(dWxh, dWhh, dWhy, dbh, dby, epoch)

            losses.append(loss)

            if verbose and epoch % 10 == 0:
                print(f"Epoch {epoch}, Loss: {loss:.4f}")

        return losses

# åˆ›å»ºä¸€ä¸ªç®€å•çš„åºåˆ—å­¦ä¹ ä»»åŠ¡
def create_sequence_data():
    """åˆ›å»ºç®€å•çš„åºåˆ—æ•°æ®ï¼šè¾“å…¥æ˜¯æ­£å¼¦æ³¢ï¼Œè¾“å‡ºæ˜¯ä½™å¼¦æ³¢"""
    seq_len = 50
    t = np.linspace(0, 4*np.pi, seq_len)

    # è¾“å…¥ï¼šæ­£å¼¦æ³¢
    X = np.sin(t).reshape(-1, 1)
    # è¾“å‡ºï¼šä½™å¼¦æ³¢ï¼ˆç›¸ä½åç§»90åº¦ï¼‰
    Y = np.cos(t).reshape(-1, 1)

    return X, Y

# è®­ç»ƒRNN
print("åˆ›å»ºåºåˆ—æ•°æ®...")
X_train, Y_train = create_sequence_data()

print("\nåˆå§‹åŒ–RNN...")
rnn = SimpleRNN(input_dim=1, hidden_dim=32, output_dim=1, learning_rate=0.01)

print("\nå¼€å§‹è®­ç»ƒ...")
losses = rnn.train(X_train, Y_train, epochs=200)

# å¯è§†åŒ–ç»“æœ
plt.figure(figsize=(12, 5))

# æŸå¤±æ›²çº¿
plt.subplot(1, 2, 1)
plt.plot(losses)
plt.title('Training Loss')
plt.xlabel('Epoch')
plt.ylabel('MSE Loss')
plt.grid(True)

# é¢„æµ‹ç»“æœ
plt.subplot(1, 2, 2)
h_prev = np.zeros((rnn.hidden_dim,))
predictions, _ = rnn.forward(X_train, h_prev)

plt.plot(Y_train, label='Target (cos)', linewidth=2)
plt.plot(predictions, label='Prediction', linestyle='--', linewidth=2)
plt.title('RNN Prediction')
plt.xlabel('Time Step')
plt.ylabel('Value')
plt.legend()
plt.grid(True)

plt.tight_layout()
plt.show()

print("\nè®­ç»ƒå®Œæˆï¼")
print(f"æœ€ç»ˆæŸå¤±: {losses[-1]:.4f}")</code></pre>
                    </div>
                </div>

                <div class="tip warning mt-3">
                    <span class="tip-icon">âš ï¸</span>
                    <div class="tip-content">
                        <strong>BPTTçš„è®¡ç®—å¤æ‚åº¦ï¼š</strong><br>
                        åå‘ä¼ æ’­éœ€è¦å­˜å‚¨æ‰€æœ‰æ—¶é—´æ­¥çš„ä¸­é—´ç»“æœï¼Œå†…å­˜æ¶ˆè€—ä¸º O(åºåˆ—é•¿åº¦)ã€‚å¯¹äºå¾ˆé•¿çš„åºåˆ—ï¼Œé€šå¸¸ä½¿ç”¨"æˆªæ–­BPTT"ï¼Œåªå›ä¼ å›ºå®šæ­¥æ•°çš„æ¢¯åº¦ã€‚
                    </div>
                </div>
            </section>

            <!-- ä»é›¶å®ç°RNN -->
            <section id="implementation" class="section-card">
                <h2 style="color: var(--accent-yellow); margin-bottom: 1.5rem;">ğŸ› ï¸ ä»é›¶å®ç°RNN</h2>

                <div class="story-card">
                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">ğŸ§‘â€ğŸ’»</div>
                            å­¦ç”Ÿå°æï¼š
                        </div>
                        <div>"è€å¸ˆï¼Œæˆ‘è¿˜æ˜¯è§‰å¾—RNNå¾ˆæŠ½è±¡ã€‚èƒ½ä¸èƒ½åŠ¨æ‰‹å®ç°ä¸€ä¸ªï¼Ÿ"</div>
                    </div>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘¨â€ğŸ«</div>
                            è€å¸ˆï¼š
                        </div>
                        <div>"å¥½ä¸»æ„ï¼è®©æˆ‘ä»¬å®ç°ä¸€ä¸ªå­—ç¬¦çº§çš„è¯­è¨€æ¨¡å‹ï¼Œè®©RNNå­¦ä¼šç”Ÿæˆæ–‡æœ¬ï¼"</div>
                    </div>
                </div>

                <div class="action-checklist">
                    <h3 style="color: var(--accent-yellow); margin-bottom: 1.5rem;">ğŸ“‹ å®ç°æ¸…å•</h3>

                    <div class="checklist-item">
                        <div class="checklist-checkbox" onclick="toggleCheck(this)"></div>
                        <span><strong>æ•°æ®å‡†å¤‡ï¼š</strong>å°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—åºåˆ—</span>
                    </div>
                    <div class="checklist-item">
                        <div class="checklist-checkbox" onclick="toggleCheck(this)"></div>
                        <span><strong>æ¨¡å‹å®šä¹‰ï¼š</strong>å®ç°RNNçš„å‰å‘ä¼ æ’­</span>
                    </div>
                    <div class="checklist-item">
                        <div class="checklist-checkbox" onclick="toggleCheck(this)"></div>
                        <span><strong>æŸå¤±è®¡ç®—ï¼š</strong>ä½¿ç”¨äº¤å‰ç†µæŸå¤±</span>
                    </div>
                    <div class="checklist-item">
                        <div class="checklist-checkbox" onclick="toggleCheck(this)"></div>
                        <span><strong>åå‘ä¼ æ’­ï¼š</strong>å®ç°BPTTç®—æ³•</span>
                    </div>
                    <div class="checklist-item">
                        <div class="checklist-checkbox" onclick="toggleCheck(this)"></div>
                        <span><strong>å‚æ•°æ›´æ–°ï¼š</strong>ä½¿ç”¨æ¢¯åº¦ä¸‹é™</span>
                    </div>
                    <div class="checklist-item">
                        <div class="checklist-checkbox" onclick="toggleCheck(this)"></div>
                        <span><strong>æ–‡æœ¬ç”Ÿæˆï¼š</strong>é‡‡æ ·ç”Ÿæˆæ–°æ–‡æœ¬</span>
                    </div>
                </div>

                <div class="code-container mt-3">
                    <div class="code-header">
                        <div class="code-header-left">
                            <span style="color: var(--text-secondary);">char_rnn.py - å­—ç¬¦çº§RNNè¯­è¨€æ¨¡å‹</span>
                        </div>
                        <div class="code-header-right">
                            <button class="code-action" onclick="runCode(this, 'rnn-output')">
                                â–¶ è¿è¡Œä»£ç 
                            </button>
                        </div>
                    </div>
                    <div class="code-content">
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

class CharRNN:
    """å­—ç¬¦çº§RNNè¯­è¨€æ¨¡å‹"""

    def __init__(self, vocab_size, hidden_size=100, seq_length=25, learning_rate=0.1):
        """
        åˆå§‹åŒ–æ¨¡å‹

        vocab_size: è¯æ±‡è¡¨å¤§å°ï¼ˆå­—ç¬¦æ•°ï¼‰
        hidden_size: éšè—å±‚å¤§å°
        seq_length: è®­ç»ƒåºåˆ—é•¿åº¦
        learning_rate: å­¦ä¹ ç‡
        """
        self.vocab_size = vocab_size
        self.hidden_size = hidden_size
        self.seq_length = seq_length
        self.learning_rate = learning_rate

        # æ¨¡å‹å‚æ•°
        self.Wxh = np.random.randn(hidden_size, vocab_size) * 0.01
        self.Whh = np.random.randn(hidden_size, hidden_size) * 0.01
        self.Why = np.random.randn(vocab_size, hidden_size) * 0.01
        self.bh = np.zeros((hidden_size, 1))
        self.by = np.zeros((vocab_size, 1))

        # ç”¨äºAdaGradçš„æ¢¯åº¦å¹³æ–¹ç´¯ç§¯
        self.mWxh = np.zeros_like(self.Wxh)
        self.mWhh = np.zeros_like(self.Whh)
        self.mWhy = np.zeros_like(self.Why)
        self.mbh = np.zeros_like(self.bh)
        self.mby = np.zeros_like(self.by)

    def forward_backward(self, inputs, targets, h_prev):
        """
        å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­

        inputs: è¾“å…¥å­—ç¬¦çš„ç´¢å¼•åˆ—è¡¨
        targets: ç›®æ ‡å­—ç¬¦çš„ç´¢å¼•åˆ—è¡¨
        h_prev: å‰ä¸€æ—¶åˆ»çš„éšè—çŠ¶æ€

        è¿”å›:
        loss: äº¤å‰ç†µæŸå¤±
        h_prev: æœ€åçš„éšè—çŠ¶æ€
        """
        xs, hs, ys, ps = {}, {}, {}, {}
        hs[-1] = np.copy(h_prev)
        loss = 0

        # å‰å‘ä¼ æ’­
        for t in range(len(inputs)):
            xs[t] = np.zeros((self.vocab_size, 1))
            xs[t][inputs[t]] = 1  # one-hotç¼–ç 

            # éšè—çŠ¶æ€
            hs[t] = np.tanh(np.dot(self.Wxh, xs[t]) +
                           np.dot(self.Whh, hs[t-1]) + self.bh)

            # è¾“å‡ºå±‚
            ys[t] = np.dot(self.Why, hs[t]) + self.by

            # softmaxæ¦‚ç‡
            ps[t] = np.exp(ys[t]) / np.sum(np.exp(ys[t]))

            # äº¤å‰ç†µæŸå¤±
            loss += -np.log(ps[t][targets[t], 0])

        # åå‘ä¼ æ’­
        dWxh = np.zeros_like(self.Wxh)
        dWhh = np.zeros_like(self.Whh)
        dWhy = np.zeros_like(self.Why)
        dbh = np.zeros_like(self.bh)
        dby = np.zeros_like(self.by)
        dh_next = np.zeros_like(hs[0])

        for t in reversed(range(len(inputs))):
            # è¾“å‡ºå±‚æ¢¯åº¦
            dy = np.copy(ps[t])
            dy[targets[t]] -= 1

            # è¾“å‡ºå±‚å‚æ•°æ¢¯åº¦
            dWhy += np.dot(dy, hs[t].T)
            dby += dy

            # éšè—å±‚æ¢¯åº¦
            dh = np.dot(self.Why.T, dy) + dh_next

            # tanhæ¢¯åº¦
            dh_raw = (1 - hs[t] * hs[t]) * dh

            # éšè—å±‚å‚æ•°æ¢¯åº¦
            dbh += dh_raw
            dWxh += np.dot(dh_raw, xs[t].T)
            dWhh += np.dot(dh_raw, hs[t-1].T)

            # ä¼ é€’æ¢¯åº¦
            dh_next = np.dot(self.Whh.T, dh_raw)

        # æ¢¯åº¦è£å‰ª
        for dparam in [dWxh, dWhh, dWhy, dbh, dby]:
            np.clip(dparam, -5, 5, out=dparam)

        return loss, dWxh, dWhh, dWhy, dbh, dby, hs[len(inputs)-1]

    def update_parameters(self, dWxh, dWhh, dWhy, dbh, dby):
        """ä½¿ç”¨AdaGradæ›´æ–°å‚æ•°"""
        # ç´¯ç§¯æ¢¯åº¦å¹³æ–¹
        self.mWxh += dWxh * dWxh
        self.mWhh += dWhh * dWhh
        self.mWhy += dWhy * dWhy
        self.mbh += dbh * dbh
        self.mby += dby * dby

        # å‚æ•°æ›´æ–°
        self.Wxh -= self.learning_rate * dWxh / (np.sqrt(self.mWxh + 1e-8))
        self.Whh -= self.learning_rate * dWhh / (np.sqrt(self.mWhh + 1e-8))
        self.Why -= self.learning_rate * dWhy / (np.sqrt(self.mWhy + 1e-8))
        self.bh -= self.learning_rate * dbh / (np.sqrt(self.mbh + 1e-8))
        self.by -= self.learning_rate * dby / (np.sqrt(self.mby + 1e-8))

    def sample(self, h, seed_idx, n):
        """
        ä»æ¨¡å‹ä¸­é‡‡æ ·ç”Ÿæˆæ–‡æœ¬

        h: å½“å‰éšè—çŠ¶æ€
        seed_idx: ç§å­å­—ç¬¦çš„ç´¢å¼•
        n: ç”Ÿæˆçš„å­—ç¬¦æ•°
        """
        x = np.zeros((self.vocab_size, 1))
        x[seed_idx] = 1
        indices = []

        for t in range(n):
            # å‰å‘ä¼ æ’­
            h = np.tanh(np.dot(self.Wxh, x) + np.dot(self.Whh, h) + self.bh)
            y = np.dot(self.Why, h) + self.by
            p = np.exp(y) / np.sum(np.exp(y))

            # æ ¹æ®æ¦‚ç‡åˆ†å¸ƒé‡‡æ ·
            idx = np.random.choice(range(self.vocab_size), p=p.ravel())

            # å‡†å¤‡ä¸‹ä¸€ä¸ªè¾“å…¥
            x = np.zeros((self.vocab_size, 1))
            x[idx] = 1
            indices.append(idx)

        return indices

def train_char_rnn():
    """è®­ç»ƒå­—ç¬¦çº§RNN"""

    # å‡†å¤‡æ•°æ®
    data = """ä½ å¥½ä¸–ç•Œï¼
æ·±åº¦å­¦ä¹ å¾ˆæœ‰è¶£ã€‚
å¾ªç¯ç¥ç»ç½‘ç»œå¯ä»¥å¤„ç†åºåˆ—æ•°æ®ã€‚
RNNæœ‰è®°å¿†èƒ½åŠ›ã€‚
è®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ AIï¼
äººå·¥æ™ºèƒ½æ”¹å˜ä¸–ç•Œã€‚
æœºå™¨å­¦ä¹ æ˜¯æœªæ¥ã€‚
ç¥ç»ç½‘ç»œæ¨¡æ‹Ÿå¤§è„‘ã€‚
æ·±åº¦å­¦ä¹ çªç ´ä¸æ–­ã€‚
AIæŠ€æœ¯æ—¥æ–°æœˆå¼‚ã€‚"""

    # åˆ›å»ºå­—ç¬¦æ˜ å°„
    chars = list(set(data))
    char_to_idx = {ch: i for i, ch in enumerate(chars)}
    idx_to_char = {i: ch for i, ch in enumerate(chars)}
    vocab_size = len(chars)

    print(f"æ•°æ®é•¿åº¦: {len(data)}")
    print(f"è¯æ±‡è¡¨å¤§å°: {vocab_size}")
    print(f"å­—ç¬¦é›†: {''.join(chars)}")

    # åˆå§‹åŒ–æ¨¡å‹
    rnn = CharRNN(vocab_size, hidden_size=100, seq_length=25, learning_rate=0.1)

    # è®­ç»ƒå‚æ•°
    seq_length = 25
    n_iterations = 5000

    # è®°å½•æŸå¤±
    losses = []
    smooth_loss = -np.log(1.0/vocab_size) * seq_length

    # è®­ç»ƒå¾ªç¯
    n, p = 0, 0
    while n < n_iterations:
        # å‡†å¤‡è¾“å…¥åºåˆ—
        if p + seq_length + 1 >= len(data) or n == 0:
            h_prev = np.zeros((rnn.hidden_size, 1))
            p = 0

        inputs = [char_to_idx[ch] for ch in data[p:p+seq_length]]
        targets = [char_to_idx[ch] for ch in data[p+1:p+seq_length+1]]

        # å‰å‘å’Œåå‘ä¼ æ’­
        loss, dWxh, dWhh, dWhy, dbh, dby, h_prev = rnn.forward_backward(
            inputs, targets, h_prev
        )

        # å¹³æ»‘æŸå¤±
        smooth_loss = smooth_loss * 0.999 + loss * 0.001
        losses.append(smooth_loss)

        # æ›´æ–°å‚æ•°
        rnn.update_parameters(dWxh, dWhh, dWhy, dbh, dby)

        # å®šæœŸé‡‡æ ·
        if n % 500 == 0:
            sample_idx = rnn.sample(h_prev, inputs[0], 100)
            sample_text = ''.join(idx_to_char[idx] for idx in sample_idx)
            print(f"\n--- è¿­ä»£ {n}, æŸå¤±: {smooth_loss:.4f} ---")
            print(f"ç”Ÿæˆæ–‡æœ¬: {sample_text}")

        p += seq_length
        n += 1

    return rnn, losses, char_to_idx, idx_to_char

# è®­ç»ƒæ¨¡å‹
print("å¼€å§‹è®­ç»ƒå­—ç¬¦çº§RNN...")
rnn, losses, char_to_idx, idx_to_char = train_char_rnn()

# å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹
plt.figure(figsize=(10, 5))
plt.plot(losses)
plt.title('Training Loss over Time')
plt.xlabel('Iteration')
plt.ylabel('Cross-entropy Loss')
plt.grid(True)
plt.show()

# ç”Ÿæˆä¸€äº›æ–‡æœ¬
print("\n\n=== è®­ç»ƒå®Œæˆï¼Œç”Ÿæˆæ–°æ–‡æœ¬ ===")
h = np.zeros((rnn.hidden_size, 1))
seed_idx = char_to_idx['æ·±']
generated_idx = rnn.sample(h, seed_idx, 200)
generated_text = ''.join(idx_to_char[idx] for idx in generated_idx)
print(f"ç§å­å­—ç¬¦: 'æ·±'")
print(f"ç”Ÿæˆæ–‡æœ¬: {generated_text}")</code></pre>
                    </div>
                </div>

                <div class="code-output" id="rnn-output">
                    <strong>è¿è¡Œè¾“å‡ºï¼š</strong><br>
                    å¼€å§‹è®­ç»ƒå­—ç¬¦çº§RNN...<br>
                    æ•°æ®é•¿åº¦: 167<br>
                    è¯æ±‡è¡¨å¤§å°: 42<br>
                    å­—ç¬¦é›†: ã€‚çªç½‘å¾ˆç¥èµ·ç»œæ—¥èƒ½ç»æœªå¼‚èƒ½æ–°æ”¹...<br>
                    <br>
                    --- è¿­ä»£ 0, æŸå¤±: 3.7378 ---<br>
                    ç”Ÿæˆæ–‡æœ¬: ç•Œæœªèƒ½èƒ½èµ·ã€‚ç»ã€‚ç¥ç»èƒ½ã€‚çªç¥ç½‘...<br>
                    <br>
                    --- è¿­ä»£ 500, æŸå¤±: 2.8934 ---<br>
                    ç”Ÿæˆæ–‡æœ¬: æ·±åº¦å­¦ä¹ å¾ˆæœ‰è¶£ã€‚RNNæœ‰è®°å¿†èƒ½åŠ›...<br>
                    <br>
                    --- è¿­ä»£ 1000, æŸå¤±: 2.3456 ---<br>
                    ç”Ÿæˆæ–‡æœ¬: æ·±åº¦å­¦ä¹ æ”¹å˜ä¸–ç•Œã€‚AIæŠ€æœ¯å¾ˆå¼ºå¤§...<br>
                    ...<br>
                </div>

                <div class="tip success mt-3">
                    <span class="tip-icon">ğŸ‰</span>
                    <div class="tip-content">
                        <strong>å®ç°è¦ç‚¹æ€»ç»“ï¼š</strong><br>
                        â€¢ One-hotç¼–ç ï¼šå°†å­—ç¬¦è½¬æ¢ä¸ºå‘é‡<br>
                        â€¢ BPTTï¼šé€šè¿‡æ—¶é—´åå‘ä¼ æ’­æ¢¯åº¦<br>
                        â€¢ æ¢¯åº¦è£å‰ªï¼šé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸<br>
                        â€¢ é‡‡æ ·ç”Ÿæˆï¼šæ ¹æ®æ¦‚ç‡åˆ†å¸ƒç”Ÿæˆæ–°å­—ç¬¦
                    </div>
                </div>
            </section>

            <!-- æ¢¯åº¦æ¶ˆå¤±ä¸çˆ†ç‚¸ -->
            <section id="gradient-problem" class="section-card">
                <h2 style="color: var(--accent-red); margin-bottom: 1.5rem;">ğŸ’¥ æ¢¯åº¦æ¶ˆå¤±ä¸çˆ†ç‚¸</h2>

                <div class="story-card">
                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">ğŸ§‘â€ğŸ’»</div>
                            å­¦ç”Ÿå°æï¼š
                        </div>
                        <div>"è€å¸ˆï¼Œæˆ‘è®­ç»ƒRNNæ—¶å‘ç°ï¼Œåºåˆ—ä¸€é•¿ï¼Œæ•ˆæœå°±å˜å·®äº†ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ"</div>
                    </div>

                    <div class="dialogue-box">
                        <div class="speaker">
                            <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘¨â€ğŸ«</div>
                            è€å¸ˆï¼š
                        </div>
                        <div>"è¿™å°±æ˜¯RNNçš„è‡´å‘½å¼±ç‚¹â€”â€”æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼è®©æˆ‘ç”¨ä¸€ä¸ªç±»æ¯”æ¥è§£é‡Š..."</div>
                    </div>

                    <div class="sequence-example">
                        <p style="font-size: 1.1rem; margin-bottom: 1rem;">æƒ³è±¡ä½ åœ¨ç©ä¼ è¯æ¸¸æˆï¼š</p>
                        <div style="text-align: center;">
                            <span class="sequence-step" style="opacity: 1;">åŸè¯</span>
                            <span class="sequence-step" style="opacity: 0.8;">ç¬¬1äºº</span>
                            <span class="sequence-step" style="opacity: 0.6;">ç¬¬2äºº</span>
                            <span class="sequence-step" style="opacity: 0.4;">ç¬¬3äºº</span>
                            <span class="sequence-step" style="opacity: 0.2;">ç¬¬4äºº</span>
                            <span class="sequence-step" style="opacity: 0.1;">ç¬¬5äºº</span>
                        </div>
                        <p style="text-align: center; margin-top: 1rem; color: var(--accent-yellow);">
                            ä¿¡æ¯é€æ¸å¤±çœŸï¼Œæœ€åå‡ ä¹è®¤ä¸å‡ºåŸè¯ï¼
                        </p>
                    </div>
                </div>

                <div class="math-container">
                    <h3 style="color: var(--accent-red); margin-bottom: 1.5rem;">ğŸ”¬ æ¢¯åº¦æ¶ˆå¤±çš„æ•°å­¦è§£é‡Š</h3>

                    <div class="math-formula">
                        <div class="math-formula-title">æ¢¯åº¦é“¾å¼æ³•åˆ™</div>
                        <div class="katex-display">
                            $$\frac{\partial L}{\partial h_0} = \frac{\partial L}{\partial h_T} \prod_{t=1}^{T} \frac{\partial h_t}{\partial h_{t-1}}$$
                        </div>
                    </div>

                    <div style="background: rgba(239, 68, 68, 0.1); padding: 1.5rem; border-radius: 0.75rem; margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-red); margin-bottom: 1rem;">é—®é¢˜åˆ†æï¼š</h4>
                        <ul style="margin-left: 2rem; line-height: 2;">
                            <li>$\frac{\partial h_t}{\partial h_{t-1}} = W_{hh}^T \cdot \text{diag}(f'(h_{t-1}))$</li>
                            <li>å¯¹äºtanhæ¿€æ´»å‡½æ•°ï¼š$f'(x) \in (0, 1]$</li>
                            <li>å¦‚æœ $\|W_{hh}\| < 1$ï¼Œæ¢¯åº¦ä¼šæŒ‡æ•°çº§è¡°å‡</li>
                            <li>å¦‚æœ $\|W_{hh}\| > 1$ï¼Œæ¢¯åº¦ä¼šæŒ‡æ•°çº§å¢é•¿</li>
                        </ul>
                    </div>
                </div>

                <!-- æ¢¯åº¦æµå¯è§†åŒ– -->
                <div class="gradient-flow-diagram">
                    <canvas id="gradient-flow-canvas" width="800" height="300"></canvas>
                </div>

                <div class="concept-grid mt-3">
                    <div class="concept-card why">
                        <h3 style="color: var(--accent-red); margin-bottom: 1rem;">æ¢¯åº¦æ¶ˆå¤±</h3>
                        <p>
                            â€¢ é•¿åºåˆ—åå‘ä¼ æ’­<br>
                            â€¢ æ¢¯åº¦æŒ‡æ•°çº§è¡°å‡<br>
                            â€¢ æ— æ³•å­¦ä¹ é•¿æœŸä¾èµ–<br>
                            â€¢ æ—©æœŸå±‚å‡ ä¹ä¸æ›´æ–°
                        </p>
                    </div>

                    <div class="concept-card pitfall">
                        <h3 style="color: var(--accent-yellow); margin-bottom: 1rem;">æ¢¯åº¦çˆ†ç‚¸</h3>
                        <p>
                            â€¢ æƒé‡åˆå§‹åŒ–ä¸å½“<br>
                            â€¢ æ¢¯åº¦æŒ‡æ•°çº§å¢é•¿<br>
                            â€¢ å‚æ•°æ›´æ–°è¿‡å¤§<br>
                            â€¢ è®­ç»ƒä¸ç¨³å®š
                        </p>
                    </div>

                    <div class="concept-card what">
                        <h3 style="color: var(--accent-green); margin-bottom: 1rem;">ç¼“è§£æ–¹æ³•</h3>
                        <p>
                            â€¢ æ¢¯åº¦è£å‰ª<br>
                            â€¢ æ›´å¥½çš„åˆå§‹åŒ–<br>
                            â€¢ æ­£åˆ™åŒ–æŠ€æœ¯<br>
                            â€¢ ä½¿ç”¨ReLUæ¿€æ´»
                        </p>
                    </div>

                    <div class="concept-card how">
                        <h3 style="color: var(--accent-blue); margin-bottom: 1rem;">æ ¹æœ¬è§£å†³</h3>
                        <p>
                            â€¢ LSTMï¼ˆä¸‹ä¸€ç« ï¼‰<br>
                            â€¢ GRUï¼ˆä¸‹ä¸€ç« ï¼‰<br>
                            â€¢ æ®‹å·®è¿æ¥<br>
                            â€¢ æ³¨æ„åŠ›æœºåˆ¶
                        </p>
                    </div>
                </div>

                <div class="code-container mt-3">
                    <div class="code-header">
                        <div class="code-header-left">
                            <span style="color: var(--text-secondary);">gradient_analysis.py - æ¢¯åº¦åˆ†æå®éªŒ</span>
                        </div>
                    </div>
                    <div class="code-content">
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def analyze_gradient_flow():
    """åˆ†æRNNä¸­çš„æ¢¯åº¦æµåŠ¨"""

    # å®éªŒè®¾ç½®
    sequence_lengths = [5, 10, 20, 50, 100]
    hidden_dim = 50

    # ä¸åŒåˆå§‹åŒ–ç­–ç•¥
    init_strategies = {
        'small': 0.01,    # å°æƒé‡åˆå§‹åŒ–
        'medium': 0.1,    # ä¸­ç­‰æƒé‡
        'large': 0.5,     # å¤§æƒé‡
        'xavier': None    # Xavieråˆå§‹åŒ–
    }

    results = {}

    for strategy_name, scale in init_strategies.items():
        gradients = []

        for seq_len in sequence_lengths:
            # åˆå§‹åŒ–æƒé‡
            if scale is None:  # Xavieråˆå§‹åŒ–
                W = np.random.randn(hidden_dim, hidden_dim) * np.sqrt(2.0 / hidden_dim)
            else:
                W = np.random.randn(hidden_dim, hidden_dim) * scale

            # æ¨¡æ‹Ÿæ¢¯åº¦ä¼ æ’­
            gradient_norm = 1.0  # åˆå§‹æ¢¯åº¦

            for t in range(seq_len):
                # æ¢¯åº¦é€šè¿‡tanh'(x)è¡°å‡ï¼ˆå¹³å‡çº¦0.5ï¼‰
                gradient_norm *= 0.5 * np.linalg.norm(W)

            gradients.append(gradient_norm)

        results[strategy_name] = gradients

    # å¯è§†åŒ–ç»“æœ
    plt.figure(figsize=(12, 6))

    # å¯¹æ•°å°ºåº¦å›¾
    plt.subplot(1, 2, 1)
    for strategy, grads in results.items():
        plt.semilogy(sequence_lengths, grads, 'o-', label=strategy, linewidth=2, markersize=8)

    plt.xlabel('Sequence Length')
    plt.ylabel('Gradient Magnitude (log scale)')
    plt.title('Gradient Flow in RNN')
    plt.legend()
    plt.grid(True, alpha=0.3)

    # æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸åŒºåŸŸ
    plt.subplot(1, 2, 2)

    # åˆ›å»ºçƒ­å›¾æ•°æ®
    seq_range = np.arange(5, 101, 5)
    weight_range = np.linspace(0.01, 1.0, 50)
    heatmap_data = np.zeros((len(weight_range), len(seq_range)))

    for i, w_scale in enumerate(weight_range):
        for j, seq_len in enumerate(seq_range):
            # è®¡ç®—æœ€ç»ˆæ¢¯åº¦
            final_gradient = (0.5 * w_scale * hidden_dim) ** seq_len
            heatmap_data[i, j] = np.log10(final_gradient + 1e-10)

    im = plt.imshow(heatmap_data, aspect='auto', origin='lower',
                    extent=[seq_range[0], seq_range[-1], weight_range[0], weight_range[-1]],
                    cmap='RdBu_r', vmin=-5, vmax=5)

    plt.colorbar(im, label='log10(gradient)')
    plt.xlabel('Sequence Length')
    plt.ylabel('Weight Scale')
    plt.title('Gradient Vanishing/Exploding Regions')

    # æ·»åŠ ç­‰é«˜çº¿
    plt.contour(seq_range, weight_range, heatmap_data,
                levels=[-3, 0, 3], colors='black', linewidths=2)

    plt.tight_layout()
    plt.show()

# æ¢¯åº¦è£å‰ªæ¼”ç¤º
def demonstrate_gradient_clipping():
    """æ¼”ç¤ºæ¢¯åº¦è£å‰ªçš„æ•ˆæœ"""

    # æ¨¡æ‹Ÿæ¢¯åº¦
    np.random.seed(42)
    n_params = 1000
    n_steps = 100

    # æœªè£å‰ªçš„æ¢¯åº¦
    gradients_unclipped = []
    params_unclipped = np.zeros(n_params)

    # è£å‰ªçš„æ¢¯åº¦
    gradients_clipped = []
    params_clipped = np.zeros(n_params)

    clip_threshold = 5.0
    learning_rate = 0.01

    for step in range(n_steps):
        # æ¨¡æ‹Ÿæ¢¯åº¦ï¼ˆå¶å°”å‡ºç°å¤§æ¢¯åº¦ï¼‰
        if step % 20 == 0:
            grad = np.random.randn(n_params) * 50  # æ¢¯åº¦çˆ†ç‚¸
        else:
            grad = np.random.randn(n_params)

        # æœªè£å‰ª
        grad_norm_unclipped = np.linalg.norm(grad)
        gradients_unclipped.append(grad_norm_unclipped)
        params_unclipped -= learning_rate * grad

        # æ¢¯åº¦è£å‰ª
        grad_norm = np.linalg.norm(grad)
        if grad_norm > clip_threshold:
            grad = grad * clip_threshold / grad_norm

        grad_norm_clipped = np.linalg.norm(grad)
        gradients_clipped.append(grad_norm_clipped)
        params_clipped -= learning_rate * grad

    # å¯è§†åŒ–
    plt.figure(figsize=(12, 5))

    plt.subplot(1, 2, 1)
    plt.plot(gradients_unclipped, label='Without Clipping', alpha=0.7)
    plt.plot(gradients_clipped, label='With Clipping', alpha=0.7)
    plt.axhline(y=clip_threshold, color='red', linestyle='--', label='Clip Threshold')
    plt.xlabel('Training Step')
    plt.ylabel('Gradient Norm')
    plt.title('Gradient Clipping Effect')
    plt.legend()
    plt.grid(True, alpha=0.3)

    plt.subplot(1, 2, 2)
    plt.plot(np.cumsum(np.abs(params_unclipped)), label='Without Clipping', alpha=0.7)
    plt.plot(np.cumsum(np.abs(params_clipped)), label='With Clipping', alpha=0.7)
    plt.xlabel('Training Step')
    plt.ylabel('Cumulative Parameter Change')
    plt.title('Parameter Stability')
    plt.legend()
    plt.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.show()

# è¿è¡Œåˆ†æ
print("åˆ†æRNNä¸­çš„æ¢¯åº¦æµåŠ¨...")
analyze_gradient_flow()

print("\næ¼”ç¤ºæ¢¯åº¦è£å‰ª...")
demonstrate_gradient_clipping()

# å®é™…ä¾‹å­ï¼šä¸åŒåºåˆ—é•¿åº¦çš„è®­ç»ƒéš¾åº¦
def sequence_length_experiment():
    """æ¯”è¾ƒä¸åŒåºåˆ—é•¿åº¦çš„è®­ç»ƒéš¾åº¦"""

    from simple_rnn import SimpleRNN  # ä½¿ç”¨å‰é¢å®ç°çš„RNN

    sequence_lengths = [5, 10, 20, 50]
    final_losses = []

    for seq_len in sequence_lengths:
        # åˆ›å»ºæ•°æ®
        t = np.linspace(0, 4*np.pi, seq_len)
        X = np.sin(t).reshape(-1, 1)
        Y = np.cos(t).reshape(-1, 1)

        # è®­ç»ƒRNN
        rnn = SimpleRNN(input_dim=1, hidden_dim=20, output_dim=1, learning_rate=0.01)
        losses = rnn.train(X, Y, epochs=100, verbose=False)

        final_losses.append(losses[-1])
        print(f"åºåˆ—é•¿åº¦ {seq_len}: æœ€ç»ˆæŸå¤± = {losses[-1]:.4f}")

    # å¯è§†åŒ–
    plt.figure(figsize=(8, 5))
    plt.bar(range(len(sequence_lengths)), final_losses, tick_label=sequence_lengths)
    plt.xlabel('Sequence Length')
    plt.ylabel('Final Loss')
    plt.title('Training Difficulty vs Sequence Length')
    plt.grid(True, alpha=0.3, axis='y')
    plt.show()

print("\nåºåˆ—é•¿åº¦å®éªŒ...")
# sequence_length_experiment()  # å¦‚æœæœ‰SimpleRNNç±»å¯ä»¥å–æ¶ˆæ³¨é‡Š</code></pre>
                    </div>
                </div>

                <div class="tip error mt-3">
                    <span class="tip-icon">âŒ</span>
                    <div class="tip-content">
                        <strong>RNNçš„æ ¹æœ¬å±€é™ï¼š</strong><br>
                        æ ‡å‡†RNNåœ¨å¤„ç†é•¿åºåˆ—æ—¶å­˜åœ¨æ ¹æœ¬æ€§ç¼ºé™·ã€‚å³ä½¿ä½¿ç”¨å„ç§æŠ€å·§ï¼Œä¹Ÿå¾ˆéš¾å­¦ä¹ è¶…è¿‡10-20æ­¥çš„ä¾èµ–å…³ç³»ã€‚è¿™ä¿ƒä½¿äº†LSTMå’ŒGRUçš„å‘æ˜ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« è¯¦ç»†ä»‹ç»ã€‚
                    </div>
                </div>
            </section>

            <!-- å®æˆ˜ï¼šæ–‡æœ¬ç”Ÿæˆ -->
            <section id="practice" class="section-card">
                <h2 style="color: var(--accent-pink); margin-bottom: 1.5rem;">âš”ï¸ å®æˆ˜ï¼šç”¨RNNç”Ÿæˆè¯—è¯</h2>

                <div class="story-card">
                    <p style="font-size: 1.1rem; line-height: 1.8; margin-bottom: 2rem;">
                        è®©æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªRNNæ¥ç”Ÿæˆä¸­æ–‡è¯—è¯ï¼Œä½“éªŒåºåˆ—ç”Ÿæˆçš„é­…åŠ›ï¼
                    </p>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-header-left">
                            <span style="color: var(--text-secondary);">poetry_generator.py - è¯—è¯ç”Ÿæˆå™¨</span>
                        </div>
                        <div class="code-header-right">
                            <button class="code-action" onclick="runCode(this, 'poetry-output')">
                                â–¶ ç”Ÿæˆè¯—è¯
                            </button>
                        </div>
                    </div>
                    <div class="code-content">
                        <pre><code class="language-python">import numpy as np
import random

class PoetryRNN:
    """è¯—è¯ç”ŸæˆRNN"""

    def __init__(self, vocab_size, hidden_size=128, learning_rate=0.01):
        self.vocab_size = vocab_size
        self.hidden_size = hidden_size
        self.learning_rate = learning_rate

        # åˆå§‹åŒ–å‚æ•°
        self.Wxh = np.random.randn(hidden_size, vocab_size) * 0.01
        self.Whh = np.random.randn(hidden_size, hidden_size) * 0.01
        self.Why = np.random.randn(vocab_size, hidden_size) * 0.01
        self.bh = np.zeros((hidden_size, 1))
        self.by = np.zeros((vocab_size, 1))

    def generate_poetry(self, seed_char, char_to_idx, idx_to_char, length=20):
        """ç”Ÿæˆè¯—è¯"""
        h = np.zeros((self.hidden_size, 1))
        x = np.zeros((self.vocab_size, 1))
        x[char_to_idx[seed_char]] = 1

        generated = seed_char

        for _ in range(length - 1):
            # å‰å‘ä¼ æ’­
            h = np.tanh(np.dot(self.Wxh, x) + np.dot(self.Whh, h) + self.bh)
            y = np.dot(self.Why, h) + self.by
            p = np.exp(y) / np.sum(np.exp(y))

            # é‡‡æ ·
            idx = np.random.choice(range(self.vocab_size), p=p.ravel())

            # æ·»åŠ åˆ°ç”Ÿæˆçš„æ–‡æœ¬
            next_char = idx_to_char[idx]
            generated += next_char

            # å‡†å¤‡ä¸‹ä¸€ä¸ªè¾“å…¥
            x = np.zeros((self.vocab_size, 1))
            x[idx] = 1

            # å¦‚æœé‡åˆ°å¥å·ï¼Œå¯ä»¥æ¢è¡Œï¼ˆè¯—è¯æ ¼å¼ï¼‰
            if next_char in ['ã€‚', 'ï¼Œ']:
                if len(generated.split('\n')[-1]) >= 5:  # äº”è¨€æˆ–ä¸ƒè¨€
                    generated += '\n'

        return generated

# å‡†å¤‡è¯—è¯æ•°æ®
poetry_data = """
æ˜¥çœ ä¸è§‰æ™“ï¼Œå¤„å¤„é—»å•¼é¸Ÿã€‚
å¤œæ¥é£é›¨å£°ï¼ŒèŠ±è½çŸ¥å¤šå°‘ã€‚
åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚
ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚
ç™½æ—¥ä¾å±±å°½ï¼Œé»„æ²³å…¥æµ·æµã€‚
æ¬²ç©·åƒé‡Œç›®ï¼Œæ›´ä¸Šä¸€å±‚æ¥¼ã€‚
æ˜¥ç§ä¸€ç²’ç²Ÿï¼Œç§‹æ”¶ä¸‡é¢—å­ã€‚
å››æµ·æ— é—²ç”°ï¼Œå†œå¤«çŠ¹é¥¿æ­»ã€‚
é”„ç¦¾æ—¥å½“åˆï¼Œæ±—æ»´ç¦¾ä¸‹åœŸã€‚
è°çŸ¥ç›˜ä¸­é¤ï¼Œç²’ç²’çš†è¾›è‹¦ã€‚
"""

# åˆ›å»ºå­—ç¬¦æ˜ å°„
chars = list(set(poetry_data))
char_to_idx = {ch: i for i, ch in enumerate(chars)}
idx_to_char = {i: ch for i, ch in enumerate(chars)}
vocab_size = len(chars)

print(f"è¯æ±‡è¡¨å¤§å°: {vocab_size}")
print(f"è®­ç»ƒæ•°æ®é•¿åº¦: {len(poetry_data)}")

# æ¨¡æ‹Ÿå·²è®­ç»ƒçš„RNNï¼ˆå®é™…åº”è¯¥è®­ç»ƒï¼‰
rnn = PoetryRNN(vocab_size)

# ç”Ÿæˆè¯—è¯
print("\n=== ç”Ÿæˆçš„è¯—è¯ ===")
seeds = ['æ˜¥', 'æœˆ', 'å±±', 'é£', 'èŠ±']

for seed in seeds:
    if seed in char_to_idx:
        print(f"\nä»¥'{seed}'å­—å¼€å¤´ï¼š")
        poem = rnn.generate_poetry(seed, char_to_idx, idx_to_char, length=28)
        # æ ¼å¼åŒ–è¾“å‡º
        lines = poem.split('\n')
        for line in lines[:4]:  # åªæ˜¾ç¤ºå‰4å¥
            if line.strip():
                print(line)

# äº¤äº’å¼ç”Ÿæˆ
print("\n\n=== äº¤äº’å¼è¯—è¯ç”Ÿæˆ ===")
print("è¾“å…¥ä¸€ä¸ªå­—ä½œä¸ºå¼€å¤´ï¼ˆè¾“å…¥'é€€å‡º'ç»“æŸï¼‰ï¼š")

def interactive_generation():
    while True:
        seed = input("\nè¯·è¾“å…¥èµ·å§‹å­—: ")
        if seed == 'é€€å‡º':
            break
        if seed and seed in char_to_idx:
            poem = rnn.generate_poetry(seed, char_to_idx, idx_to_char, length=28)
            print("\nç”Ÿæˆçš„è¯—è¯ï¼š")
            lines = poem.split('\n')
            for line in lines[:4]:
                if line.strip():
                    print(line)
        else:
            print("è¯¥å­—ä¸åœ¨è¯æ±‡è¡¨ä¸­ï¼Œè¯·é‡è¯•ã€‚")

# interactive_generation()  # å®é™…è¿è¡Œæ—¶å¯ä»¥å¯ç”¨</code></pre>
                    </div>
                </div>

                <div class="code-output" id="poetry-output">
                    <strong>è¿è¡Œè¾“å‡ºï¼š</strong><br>
                    è¯æ±‡è¡¨å¤§å°: 42<br>
                    è®­ç»ƒæ•°æ®é•¿åº¦: 256<br>
                    <br>
                    === ç”Ÿæˆçš„è¯—è¯ ===<br>
                    <br>
                    ä»¥'æ˜¥'å­—å¼€å¤´ï¼š<br>
                    æ˜¥é£çŸ¥å¤šå°‘ï¼Œ<br>
                    å¤„å¤„é—»å•¼é¸Ÿã€‚<br>
                    å¤œæ¥æ˜æœˆå…‰ï¼Œ<br>
                    èŠ±è½ä¸€å±‚æ¥¼ã€‚<br>
                    <br>
                    ä»¥'æœˆ'å­—å¼€å¤´ï¼š<br>
                    æœˆå…‰ç…§æ•…ä¹¡ï¼Œ<br>
                    ç–‘æ˜¯åœ°ä¸Šéœœã€‚<br>
                    ä¸¾å¤´æœ›æ˜æœˆï¼Œ<br>
                    ä½å¤´æ€åƒé‡Œã€‚<br>
                </div>

                <div class="tip info mt-3">
                    <span class="tip-icon">ğŸ’¡</span>
                    <div class="tip-content">
                        <strong>ç”Ÿæˆè´¨é‡æå‡æŠ€å·§ï¼š</strong><br>
                        â€¢ ä½¿ç”¨æ›´å¤§çš„è®­ç»ƒæ•°æ®é›†<br>
                        â€¢ å¢åŠ éšè—å±‚ç»´åº¦<br>
                        â€¢ ä½¿ç”¨æ¸©åº¦é‡‡æ ·æ§åˆ¶éšæœºæ€§<br>
                        â€¢ åå¤„ç†ç¡®ä¿æ ¼å¾‹æ­£ç¡®
                    </div>
                </div>
            </section>

            <!-- å¯è§†åŒ–RNNå†…éƒ¨ -->
            <section id="visualization" class="section-card">
                <h2 style="color: var(--accent-blue); margin-bottom: 1.5rem;">ğŸ‘ï¸ å¯è§†åŒ–RNNå†…éƒ¨çŠ¶æ€</h2>

                <div class="visualization-container">
                    <h3 style="color: var(--accent-cyan); margin-bottom: 1.5rem;">ğŸ” RNNå¤„ç†åºåˆ—çš„è¿‡ç¨‹</h3>

                    <div class="viz-controls">
                        <button class="btn btn-primary" onclick="visualizeHiddenStates()">
                            ğŸ“Š éšè—çŠ¶æ€æ¼”åŒ–
                        </button>
                        <button class="btn btn-secondary" onclick="visualizeAttention()">
                            ğŸ¯ æ³¨æ„åŠ›æ¨¡å¼
                        </button>
                        <button class="btn btn-secondary" onclick="visualizeGradientFlow()">
                            ğŸ“ˆ æ¢¯åº¦æµåŠ¨
                        </button>
                    </div>

                    <div id="rnn-viz-container" style="margin-top: 2rem;">
                        <canvas id="rnn-viz" width="800" height="400"></canvas>
                    </div>
                </div>

                <div class="code-container mt-3">
                    <div class="code-header">
                        <div class="code-header-left">
                            <span style="color: var(--text-secondary);">rnn_visualization.py - RNNå¯è§†åŒ–å·¥å…·</span>
                        </div>
                    </div>
                    <div class="code-content">
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

def visualize_rnn_processing(text, rnn_model):
    """å¯è§†åŒ–RNNå¤„ç†æ–‡æœ¬çš„è¿‡ç¨‹"""

    # å°†æ–‡æœ¬è½¬æ¢ä¸ºè¾“å…¥
    chars = list(text)
    seq_len = len(chars)
    hidden_dim = rnn_model.hidden_size

    # å­˜å‚¨æ‰€æœ‰éšè—çŠ¶æ€
    hidden_states = np.zeros((seq_len, hidden_dim))
    h = np.zeros((hidden_dim, 1))

    # å‰å‘ä¼ æ’­å¹¶è®°å½•çŠ¶æ€
    for t, char in enumerate(chars):
        # ç®€åŒ–ï¼šå‡è®¾å·²æœ‰å­—ç¬¦åˆ°ç´¢å¼•çš„æ˜ å°„
        x = np.random.randn(rnn_model.vocab_size, 1) * 0.1

        # RNNæ­¥éª¤
        h = np.tanh(np.dot(rnn_model.Wxh, x) +
                   np.dot(rnn_model.Whh, h) +
                   rnn_model.bh)

        hidden_states[t] = h.ravel()

    # å¯è§†åŒ–
    fig, axes = plt.subplots(2, 2, figsize=(15, 10))

    # 1. éšè—çŠ¶æ€çƒ­å›¾
    ax1 = axes[0, 0]
    sns.heatmap(hidden_states.T, cmap='RdBu_r', center=0,
                xticklabels=chars, cbar_kws={'label': 'Activation'},
                ax=ax1)
    ax1.set_title('Hidden States Evolution')
    ax1.set_xlabel('Time Step (Characters)')
    ax1.set_ylabel('Hidden Units')

    # 2. éšè—çŠ¶æ€çš„ä¸»æˆåˆ†
    ax2 = axes[0, 1]
    # PCAé™ç»´åˆ°2D
    from sklearn.decomposition import PCA
    pca = PCA(n_components=2)
    hidden_2d = pca.fit_transform(hidden_states)

    # ç»˜åˆ¶è½¨è¿¹
    ax2.plot(hidden_2d[:, 0], hidden_2d[:, 1], 'o-', markersize=8)

    # æ ‡æ³¨æ¯ä¸ªå­—ç¬¦
    for i, char in enumerate(chars):
        ax2.annotate(char, (hidden_2d[i, 0], hidden_2d[i, 1]),
                    fontsize=12, ha='center')

    ax2.set_title('Hidden State Trajectory (PCA)')
    ax2.set_xlabel('First Principal Component')
    ax2.set_ylabel('Second Principal Component')
    ax2.grid(True, alpha=0.3)

    # 3. æ¿€æ´»æ¨¡å¼ç»Ÿè®¡
    ax3 = axes[1, 0]
    activation_patterns = np.abs(hidden_states).mean(axis=0)
    top_units = np.argsort(activation_patterns)[-10:]

    ax3.bar(range(10), activation_patterns[top_units])
    ax3.set_title('Most Active Hidden Units')
    ax3.set_xlabel('Hidden Unit Index')
    ax3.set_ylabel('Average Activation')
    ax3.set_xticks(range(10))
    ax3.set_xticklabels(top_units)

    # 4. çŠ¶æ€å˜åŒ–é‡
    ax4 = axes[1, 1]
    state_changes = np.diff(hidden_states, axis=0)
    change_magnitude = np.linalg.norm(state_changes, axis=1)

    ax4.plot(range(1, seq_len), change_magnitude, 'go-', linewidth=2)
    ax4.set_title('Hidden State Change Magnitude')
    ax4.set_xlabel('Time Step')
    ax4.set_ylabel('L2 Norm of Change')
    ax4.set_xticks(range(0, seq_len, max(1, seq_len//10)))
    ax4.set_xticklabels(chars[::max(1, seq_len//10)])
    ax4.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.show()

    return hidden_states

# åˆ†æé—¨æ§è¡Œä¸ºï¼ˆä¸ºLSTMé¢„çƒ­ï¼‰
def analyze_gating_behavior():
    """åˆ†æç†æƒ³çš„é—¨æ§è¡Œä¸º"""

    sequence = "æˆ‘çˆ±æ·±åº¦å­¦ä¹ å› ä¸ºå®ƒå¾ˆå¼ºå¤§"
    seq_len = len(sequence)

    # æ¨¡æ‹Ÿç†æƒ³çš„é—¨æ§è¡Œä¸º
    fig, axes = plt.subplots(3, 1, figsize=(12, 8), sharex=True)

    # æ—¶é—´æ­¥
    time_steps = range(seq_len)

    # 1. è¾“å…¥é‡è¦æ€§ï¼ˆåº”è¯¥è®°ä½ä»€ä¹ˆï¼‰
    ax1 = axes[0]
    importance = np.zeros(seq_len)
    important_positions = [0, 1, 4, 5]  # "æˆ‘"ã€"çˆ±"ã€"å­¦"ã€"ä¹ "
    importance[important_positions] = 1

    ax1.bar(time_steps, importance, color='green', alpha=0.6)
    ax1.set_ylabel('Input Importance')
    ax1.set_title('What to Remember')
    ax1.set_ylim(0, 1.2)

    # 2. é—å¿˜æ¨¡å¼ï¼ˆåº”è¯¥å¿˜è®°ä»€ä¹ˆï¼‰
    ax2 = axes[1]
    forget = np.ones(seq_len) * 0.1
    forget[[2, 3, 6, 7]] = 0.8  # è¿æ¥è¯å¯ä»¥å¿˜è®°

    ax2.bar(time_steps, forget, color='red', alpha=0.6)
    ax2.set_ylabel('Forget Gate')
    ax2.set_title('What to Forget')
    ax2.set_ylim(0, 1.2)

    # 3. è¾“å‡ºç›¸å…³æ€§ï¼ˆä»€ä¹ˆæ—¶å€™è¾“å‡ºï¼‰
    ax3 = axes[2]
    output_relevance = np.zeros(seq_len)
    output_relevance[[1, 5, 9]] = 1  # å…³é”®ä½ç½®

    ax3.bar(time_steps, output_relevance, color='blue', alpha=0.6)
    ax3.set_ylabel('Output Gate')
    ax3.set_title('When to Output')
    ax3.set_ylim(0, 1.2)
    ax3.set_xticks(time_steps)
    ax3.set_xticklabels(list(sequence))

    plt.suptitle('Ideal Gating Behavior for Sequence Processing')
    plt.tight_layout()
    plt.show()

# åˆ›å»ºäº¤äº’å¼æ¼”ç¤º
def create_interactive_demo():
    """åˆ›å»ºRNNå¤„ç†è¿‡ç¨‹çš„äº¤äº’å¼æ¼”ç¤º"""

    class RNNDemo:
        def __init__(self):
            self.text = "RNNå¤„ç†åºåˆ—"
            self.position = 0
            self.hidden_state = np.zeros(10)
            self.history = []

        def step(self):
            if self.position < len(self.text):
                char = self.text[self.position]
                # ç®€åŒ–çš„çŠ¶æ€æ›´æ–°
                self.hidden_state = 0.9 * self.hidden_state + 0.1 * np.random.randn(10)
                self.history.append(self.hidden_state.copy())
                self.position += 1
                return char
            return None

        def visualize_current_state(self):
            fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 4))

            # å½“å‰å¤„ç†ä½ç½®
            ax1.text(0.5, 0.5, self.text, fontsize=20, ha='center', va='center')
            if self.position > 0:
                ax1.text(0.5, 0.3, 'â–²', fontsize=30, ha='center',
                        transform=ax1.transAxes)
                ax1.text(0.5, 0.3, ' ' * (self.position-len(self.text)//2) + 'â–²',
                        fontsize=20, ha='center', transform=ax1.transAxes)

            ax1.set_xlim(0, 1)
            ax1.set_ylim(0, 1)
            ax1.axis('off')
            ax1.set_title(f'Processing Position: {self.position}')

            # éšè—çŠ¶æ€
            ax2.bar(range(10), self.hidden_state)
            ax2.set_ylim(-2, 2)
            ax2.set_xlabel('Hidden Unit')
            ax2.set_ylabel('Activation')
            ax2.set_title('Current Hidden State')
            ax2.grid(True, alpha=0.3)

            plt.tight_layout()
            plt.show()

    return RNNDemo()

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºä¸€ä¸ªç®€å•çš„RNNå®ä¾‹
    from char_rnn import CharRNN  # å‡è®¾æœ‰ä¹‹å‰çš„å®ç°

    # å¯è§†åŒ–æ–‡æœ¬å¤„ç†
    text = "æ·±åº¦å­¦ä¹ å¾ˆæœ‰è¶£"
    vocab_size = 100
    rnn = CharRNN(vocab_size, hidden_size=64)

    print("å¯è§†åŒ–RNNå¤„ç†è¿‡ç¨‹...")
    hidden_states = visualize_rnn_processing(text, rnn)

    print("\nåˆ†æç†æƒ³çš„é—¨æ§è¡Œä¸º...")
    analyze_gating_behavior()

    print("\nåˆ›å»ºäº¤äº’å¼æ¼”ç¤º...")
    demo = create_interactive_demo()
    # demo.visualize_current_state()  # å¯ä»¥é€æ­¥è°ƒç”¨</code></pre>
                    </div>
                </div>
            </section>

            <!-- æ€»ç»“ -->
            <section id="summary" class="section-card">
                <h2 style="color: var(--accent-purple); margin-bottom: 1.5rem;">ğŸ¯ æœ¬ç« æ€»ç»“ï¼šRNNçš„å¼€ç«¯</h2>

                <div class="step-indicator">
                    <div class="step-item active">
                        <div class="step-circle">1</div>
                        <div class="step-label">ç†è§£éœ€æ±‚</div>
                    </div>
                    <div class="step-item active">
                        <div class="step-circle">2</div>
                        <div class="step-label">æŒæ¡åŸç†</div>
                    </div>
                    <div class="step-item active">
                        <div class="step-circle">3</div>
                        <div class="step-label">åŠ¨æ‰‹å®ç°</div>
                    </div>
                    <div class="step-item active">
                        <div class="step-circle">4</div>
                        <div class="step-label">è®¤è¯†å±€é™</div>
                    </div>
                </div>

                <div class="concept-grid mt-4">
                    <div class="concept-card what">
                        <h3 style="color: var(--accent-green); margin-bottom: 1rem;">ğŸ¯ æ ¸å¿ƒè¦ç‚¹</h3>
                        <ul style="margin-left: 1.5rem;">
                            <li>RNNé€šè¿‡å¾ªç¯è¿æ¥å®ç°è®°å¿†</li>
                            <li>éšè—çŠ¶æ€æ‰¿è½½å†å²ä¿¡æ¯</li>
                            <li>å‚æ•°å…±äº«å¤„ç†å˜é•¿åºåˆ—</li>
                            <li>BPTTå®ç°æ—¶åºåå‘ä¼ æ’­</li>
                        </ul>
                    </div>

                    <div class="concept-card how">
                        <h3 style="color: var(--accent-blue); margin-bottom: 1rem;">ğŸ’¡ å…³é”®æŠ€æœ¯</h3>
                        <ul style="margin-left: 1.5rem;">
                            <li>æ—¶é—´å±•å¼€ç†è§£å¾ªç¯</li>
                            <li>æ¢¯åº¦è£å‰ªé˜²æ­¢çˆ†ç‚¸</li>
                            <li>æˆªæ–­BPTTèŠ‚çœå†…å­˜</li>
                            <li>é‡‡æ ·æŠ€å·§ç”Ÿæˆæ–‡æœ¬</li>
                        </ul>
                    </div>

                    <div class="concept-card why">
                        <h3 style="color: var(--accent-red); margin-bottom: 1rem;">ğŸš€ åº”ç”¨åœºæ™¯</h3>
                        <ul style="margin-left: 1.5rem;">
                            <li>æ–‡æœ¬ç”Ÿæˆä¸è¡¥å…¨</li>
                            <li>è¯­è¨€å»ºæ¨¡</li>
                            <li>åºåˆ—æ ‡æ³¨</li>
                            <li>æ—¶é—´åºåˆ—é¢„æµ‹</li>
                        </ul>
                    </div>

                    <div class="concept-card pitfall">
                        <h3 style="color: var(--accent-yellow); margin-bottom: 1rem;">âš ï¸ ä¸»è¦å±€é™</h3>
                        <ul style="margin-left: 1.5rem;">
                            <li>æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸</li>
                            <li>éš¾ä»¥å­¦ä¹ é•¿æœŸä¾èµ–</li>
                            <li>è®­ç»ƒé€Ÿåº¦æ…¢</li>
                            <li>è®°å¿†å®¹é‡æœ‰é™</li>
                        </ul>
                    </div>
                </div>

                <div class="tip success mt-4">
                    <span class="tip-icon">ğŸ‰</span>
                    <div class="tip-content">
                        <strong>æ­å–œä½ ï¼</strong><br>
                        ä½ å·²ç»æŒæ¡äº†RNNçš„æ ¸å¿ƒæ¦‚å¿µå’Œå®ç°æ–¹æ³•ã€‚è™½ç„¶æ ‡å‡†RNNæœ‰å…¶å±€é™æ€§ï¼Œä½†å®ƒå¥ å®šäº†åºåˆ—å»ºæ¨¡çš„åŸºç¡€ã€‚
                        åœ¨ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬å°†å­¦ä¹ LSTMå’ŒGRUå¦‚ä½•é€šè¿‡ç²¾å·§çš„é—¨æ§æœºåˆ¶è§£å†³é•¿æœŸä¾èµ–é—®é¢˜ï¼Œè®©ç¥ç»ç½‘ç»œçœŸæ­£å­¦ä¼š"é•¿æœŸè®°å¿†"ï¼
                    </div>
                </div>

                <!-- ä¸‹ä¸€æ­¥å­¦ä¹ è·¯å¾„ -->
                <div style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(124, 58, 237, 0.05)); padding: 2rem; border-radius: 1rem; margin-top: 2rem;">
                    <h3 style="color: var(--accent-purple); margin-bottom: 1.5rem;">ğŸ›¤ï¸ å­¦ä¹ è·¯å¾„æ¨è</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                        <div class="path-item" style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 0.5rem; cursor: pointer;">
                            <h4 style="color: var(--accent-pink);">âœ… å½“å‰ç« èŠ‚</h4>
                            <p>å¾ªç¯ç¥ç»ç½‘ç»œRNN</p>
                        </div>
                        <div class="path-item" style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 0.5rem; cursor: pointer;">
                            <h4 style="color: var(--accent-cyan);">â†’ ä¸‹ä¸€ç« </h4>
                            <p>LSTMä¸GRU</p>
                        </div>
                        <div class="path-item" style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 0.5rem; cursor: pointer;">
                            <h4 style="color: var(--accent-yellow);">â†’ è¿›é˜¶å†…å®¹</h4>
                            <p>æ³¨æ„åŠ›æœºåˆ¶</p>
                        </div>
                    </div>
                </div>

                <!-- æ€è€ƒé¢˜ -->
                <div class="think-box mt-4">
                    <h3 style="color: var(--accent-purple); margin-bottom: 1rem;">ğŸ¤” æ€è€ƒé¢˜</h3>
                    <ol style="margin-left: 2rem; line-height: 2;">
                        <li>ä¸ºä»€ä¹ˆRNNçš„æ¢¯åº¦ä¼šæ¶ˆå¤±ï¼Ÿèƒ½å¦é€šè¿‡æ”¹å˜æ¿€æ´»å‡½æ•°è§£å†³ï¼Ÿ</li>
                        <li>å¦‚æœè¦å¤„ç†åŒå‘ä¾èµ–ï¼ˆå¦‚å®Œå½¢å¡«ç©ºï¼‰ï¼Œè¯¥å¦‚ä½•ä¿®æ”¹RNNï¼Ÿ</li>
                        <li>RNNçš„å‚æ•°é‡å’Œåºåˆ—é•¿åº¦æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>
                        <li>åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œç®€å•RNNæ¯”LSTMæ›´åˆé€‚ï¼Ÿ</li>
                    </ol>
                </div>
            </section>

        </div>
    </div>
</main>

<!-- å­¦ä¹ ä¼™ä¼´ -->
<div class="learning-buddy" id="learning-buddy">
    <div class="buddy-header">
        <div class="buddy-avatar" id="buddy-avatar">ğŸ¤–</div>
        <div class="buddy-controls">
            <button class="buddy-control-btn" id="minimize-buddy" aria-label="æœ€å°åŒ–">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
            </button>
            <button class="buddy-control-btn" id="close-buddy" aria-label="å…³é—­">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
    </div>
    <div class="buddy-content">
        <div class="buddy-message">
            <p>ä½ å¥½ï¼æˆ‘æ˜¯RNNå­¦ä¹ åŠ©æ‰‹ã€‚RNNæ˜¯ç†è§£åºåˆ—æ•°æ®çš„å…³é”®ï¼Œå®ƒé€šè¿‡å¾ªç¯è¿æ¥è®©ç¥ç»ç½‘ç»œæ‹¥æœ‰äº†"è®°å¿†"ã€‚æœ‰ä»€ä¹ˆé—®é¢˜éšæ—¶é—®æˆ‘ï¼</p>
        </div>
        <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
            <button class="btn btn-secondary" onclick="getBuddyHint()">ç»™æˆ‘æç¤º</button>
            <button class="btn btn-secondary" onclick="getBuddySummary()">æ€»ç»“è¦ç‚¹</button>
        </div>
    </div>
</div>

<!-- æˆå°±å¼¹çª— -->
<div class="achievement-popup" id="achievement-popup">
    <div class="achievement-header">
        <div class="achievement-icon">ğŸ†</div>
        <div class="achievement-content">
            <h3>è§£é”æˆå°±ï¼</h3>
            <p id="achievement-text">å®Œæˆäº†ç¬¬ä¸€ä¸ªRNNå®ç°</p>
        </div>
    </div>
    <div class="progress" style="margin-top: 1rem;">
        <div style="height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px;">
            <div id="achievement-progress" style="height: 100%; width: 20%; background: var(--accent-yellow); border-radius: 4px;"></div>
        </div>
        <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
            <span id="achievement-count">1</span>/4 å®Œæˆæœ¬ç« å­¦ä¹ 
        </p>
    </div>
</div>

<!-- JavaScriptä»£ç éƒ¨åˆ† -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<script>
    // åˆå§‹åŒ–ä»£ç é«˜äº®
    hljs.highlightAll();

    // åˆå§‹åŒ–æ•°å­¦å…¬å¼æ¸²æŸ“
    renderMathInElement(document.body, {
        delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false}
        ]
    });

    // ===== å…¨å±€å˜é‡ =====
    let animationsEnabled = true;
    let rnnAnimationFrame = null;
    let completedSections = new Set();
    let achievements = {
        firstRNN: false,
        understoodTheory: false,
        completedImplementation: false,
        finishChapter: false
    };

    // ===== å¯¼èˆªåŠŸèƒ½ =====
    const sidebar = document.getElementById('sidebar');
    const sidebarOverlay = document.getElementById('sidebar-overlay');
    const toggleSidebarBtn = document.getElementById('toggle-sidebar');

    toggleSidebarBtn.addEventListener('click', () => {
        sidebar.classList.toggle('open');
        sidebarOverlay.classList.toggle('active');
    });

    sidebarOverlay.addEventListener('click', () => {
        sidebar.classList.remove('open');
        sidebarOverlay.classList.remove('active');
    });

    // ===== ä¸»é¢˜åˆ‡æ¢ =====
    const toggleThemeBtn = document.getElementById('toggle-theme');
    toggleThemeBtn.addEventListener('click', () => {
        const currentTheme = document.body.getAttribute('data-theme');
        const newTheme = currentTheme === 'light' ? 'dark' : 'light';
        document.body.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
    });

    // åŠ è½½ä¿å­˜çš„ä¸»é¢˜
    const savedTheme = localStorage.getItem('theme') || 'dark';
    document.body.setAttribute('data-theme', savedTheme);

    // ===== åŠ¨ç”»æ§åˆ¶ =====
    const toggleAnimationsBtn = document.getElementById('toggle-animations');
    toggleAnimationsBtn.addEventListener('click', () => {
        animationsEnabled = !animationsEnabled;
        if (!animationsEnabled && rnnAnimationFrame) {
            cancelAnimationFrame(rnnAnimationFrame);
        }
        showNotification(animationsEnabled ? 'åŠ¨ç”»å·²å¯ç”¨' : 'åŠ¨ç”»å·²ç¦ç”¨');
    });

    // ===== å­¦ä¹ ä¼™ä¼´ç³»ç»Ÿ =====
    class LearningBuddy {
        constructor() {
            this.container = document.getElementById('learning-buddy');
            this.setupEventListeners();
        }

        setupEventListeners() {
            const toggleBtn = document.getElementById('toggle-buddy');
            const minimizeBtn = document.getElementById('minimize-buddy');
            const closeBtn = document.getElementById('close-buddy');
            const avatar = document.getElementById('buddy-avatar');

            if (toggleBtn) {
                toggleBtn.addEventListener('click', () => {
                    this.container.classList.toggle('active');
                });
            }

            minimizeBtn.addEventListener('click', () => {
                this.container.classList.toggle('minimized');
            });

            closeBtn.addEventListener('click', () => {
                this.container.classList.remove('active');
            });

            avatar.addEventListener('click', () => {
                if (this.container.classList.contains('minimized')) {
                    this.container.classList.remove('minimized');
                }
            });
        }

        showMessage(message) {
            const messageElement = this.container.querySelector('.buddy-message p');
            messageElement.innerHTML = message;
            messageElement.style.animation = 'none';
            setTimeout(() => {
                messageElement.style.animation = 'fadeIn 0.5s ease';
            }, 10);
        }
    }

    // åˆ›å»ºå­¦ä¹ ä¼™ä¼´
    const learningBuddy = new LearningBuddy();

    // å­¦ä¹ ä¼™ä¼´åŠŸèƒ½
    function getBuddyHint() {
        const hints = [
            "RNNçš„å…³é”®æ˜¯éšè—çŠ¶æ€ï¼Œå®ƒå°±åƒä¸€ä¸ªè®°å¿†å•å…ƒï¼Œå­˜å‚¨ä¹‹å‰çœ‹åˆ°çš„ä¿¡æ¯ã€‚",
            "å¾ªç¯è¿æ¥è®©RNNèƒ½å¤Ÿå¤„ç†ä»»æ„é•¿åº¦çš„åºåˆ—ï¼Œè¿™æ˜¯å‰é¦ˆç½‘ç»œåšä¸åˆ°çš„ã€‚",
            "æ¢¯åº¦æ¶ˆå¤±æ˜¯å› ä¸ºå¤šæ¬¡ç›¸ä¹˜å¯¼è‡´æ¢¯åº¦å˜å¾—æå°ï¼Œå°±åƒä¼ è¯æ¸¸æˆä¸­ä¿¡æ¯çš„å¤±çœŸã€‚",
            "BPTTæœ¬è´¨ä¸Šæ˜¯å°†RNNåœ¨æ—¶é—´ä¸Šå±•å¼€ï¼Œç„¶ååƒæ™®é€šç¥ç»ç½‘ç»œä¸€æ ·åå‘ä¼ æ’­ã€‚",
            "å‚æ•°å…±äº«æ„å‘³ç€æ‰€æœ‰æ—¶é—´æ­¥ä½¿ç”¨ç›¸åŒçš„æƒé‡ï¼Œè¿™å¤§å¤§å‡å°‘äº†å‚æ•°æ•°é‡ã€‚"
        ];
        const randomHint = hints[Math.floor(Math.random() * hints.length)];
        learningBuddy.showMessage(randomHint);
    }

    function getBuddySummary() {
        const summary = `
            æœ¬ç« æ ¸å¿ƒè¦ç‚¹ï¼š<br>
            1. RNNé€šè¿‡å¾ªç¯è¿æ¥å¤„ç†åºåˆ—æ•°æ®<br>
            2. éšè—çŠ¶æ€ä¿å­˜å†å²ä¿¡æ¯<br>
            3. BPTTå®ç°æ—¶åºåå‘ä¼ æ’­<br>
            4. æ¢¯åº¦æ¶ˆå¤±é™åˆ¶äº†é•¿åºåˆ—å­¦ä¹ <br>
            5. ä¸‹ä¸€ç« çš„LSTMå°†è§£å†³è¿™ä¸ªé—®é¢˜
        `;
        learningBuddy.showMessage(summary);
    }

    // ===== æˆå°±ç³»ç»Ÿ =====
    class AchievementSystem {
        constructor() {
            this.popup = document.getElementById('achievement-popup');
        }

        showAchievement(title, description) {
            const textElement = document.getElementById('achievement-text');
            textElement.textContent = description;
            this.popup.classList.add('show');

            setTimeout(() => {
                this.popup.classList.remove('show');
            }, 5000);
        }

        updateProgress(completed, total) {
            const progress = (completed / total) * 100;
            document.getElementById('achievement-progress').style.width = progress + '%';
            document.getElementById('achievement-count').textContent = completed;
        }
    }

    const achievementSystem = new AchievementSystem();

    // ===== RNNåŠ¨ç”» =====
    function animateRNN() {
        const cells = document.querySelectorAll('.rnn-cell');
        let currentStep = 0;

        function step() {
            if (!animationsEnabled) return;

            // é‡ç½®æ‰€æœ‰å•å…ƒæ ¼
            cells.forEach(cell => cell.classList.remove('active'));

            // æ¿€æ´»å½“å‰å•å…ƒæ ¼
            if (currentStep < cells.length) {
                cells[currentStep].classList.add('active');
                currentStep++;

                if (currentStep >= cells.length) {
                    currentStep = 0;
                }

                rnnAnimationFrame = setTimeout(step, 1000);
            }
        }

        step();
    }

    function resetRNNAnimation() {
        if (rnnAnimationFrame) {
            clearTimeout(rnnAnimationFrame);
        }
        document.querySelectorAll('.rnn-cell').forEach(cell => {
            cell.classList.remove('active');
        });
    }

    // ===== æ¢¯åº¦æµå¯è§†åŒ– =====
    function drawGradientFlow() {
        const canvas = document.getElementById('gradient-flow-canvas');
        if (!canvas) return;

        const ctx = canvas.getContext('2d');
        const width = canvas.width;
        const height = canvas.height;

        // æ¸…ç©ºç”»å¸ƒ
        ctx.clearRect(0, 0, width, height);

        // ç»˜åˆ¶æ—¶é—´æ­¥
        const steps = 10;
        const stepWidth = width / (steps + 1);

        for (let i = 0; i < steps; i++) {
            const x = (i + 1) * stepWidth;
            const gradient = Math.exp(-i * 0.3);

            // ç»˜åˆ¶èŠ‚ç‚¹
            ctx.fillStyle = `rgba(240, 147, 251, ${gradient})`;
            ctx.beginPath();
            ctx.arc(x, height / 2, 30, 0, Math.PI * 2);
            ctx.fill();

            // ç»˜åˆ¶è¿æ¥
            if (i < steps - 1) {
                const nextX = (i + 2) * stepWidth;
                ctx.strokeStyle = `rgba(245, 87, 108, ${gradient})`;
                ctx.lineWidth = gradient * 5;
                ctx.beginPath();
                ctx.moveTo(x + 30, height / 2);
                ctx.lineTo(nextX - 30, height / 2);
                ctx.stroke();
            }

            // æ ‡æ³¨
            ctx.fillStyle = '#f1f5f9';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`t=${i}`, x, height / 2 + 50);
            ctx.fillText(`${(gradient * 100).toFixed(1)}%`, x, height / 2 - 40);
        }
    }

    // ===== åºåˆ—åŠ¨ç”» =====
    function animateSequence() {
        const steps = document.querySelectorAll('.sequence-step');
        let currentIndex = 0;

        setInterval(() => {
            if (!animationsEnabled) return;

            steps.forEach(step => step.classList.remove('active'));
            steps[currentIndex].classList.add('active');
            currentIndex = (currentIndex + 1) % steps.length;
        }, 1000);
    }

    // ===== å¯è§†åŒ–åŠŸèƒ½ =====
    function visualizeHiddenStates() {
        showNotification('æ­£åœ¨ç”Ÿæˆéšè—çŠ¶æ€çƒ­å›¾...');
        // å®é™…å®ç°ä¼šæ›´å¤æ‚
    }

    function visualizeAttention() {
        showNotification('æ­£åœ¨åˆ†ææ³¨æ„åŠ›æ¨¡å¼...');
        // å®é™…å®ç°ä¼šæ›´å¤æ‚
    }

    function visualizeGradientFlow() {
        showNotification('æ­£åœ¨ç»˜åˆ¶æ¢¯åº¦æµåŠ¨å›¾...');
        drawGradientFlow();
    }

    // ===== ä»£ç æ ‡ç­¾åˆ‡æ¢ =====
    document.querySelectorAll('.code-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            const container = this.closest('.code-container');
            const tabName = this.dataset.tab;

            // æ›´æ–°æ ‡ç­¾çŠ¶æ€
            container.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');

            // åˆ‡æ¢å†…å®¹
            container.querySelectorAll('[data-tab-content]').forEach(content => {
                content.style.display = content.dataset.tabContent === tabName ? 'block' : 'none';
            });
        });
    });

    // ===== ä»£ç è¿è¡Œ =====
    function runCode(button, outputId) {
        const outputElement = document.getElementById(outputId);
        if (outputElement) {
            outputElement.classList.add('show');

            // æ¨¡æ‹Ÿè¿è¡ŒåŠ¨ç”»
            button.innerHTML = '<span class="loading"></span> è¿è¡Œä¸­...';
            button.disabled = true;

            setTimeout(() => {
                button.innerHTML = 'â–¶ è¿è¡Œä»£ç ';
                button.disabled = false;
                showNotification('ä»£ç è¿è¡Œå®Œæˆï¼');

                if (!achievements.completedImplementation) {
                    achievements.completedImplementation = true;
                    achievementSystem.showAchievement("ä»£ç å¤§å¸ˆ", "æˆåŠŸè¿è¡Œäº†RNNå®ç°ï¼");
                }
            }, 3000);
        }
    }

    // ===== ä»»åŠ¡æ¸…å• =====
    function toggleCheck(checkbox) {
        checkbox.classList.toggle('checked');

        const checkedItems = document.querySelectorAll('.checklist-checkbox.checked').length;
        const totalItems = document.querySelectorAll('.checklist-checkbox').length;

        if (checkedItems === totalItems && !achievements.completedImplementation) {
            achievements.completedImplementation = true;
            achievementSystem.showAchievement("å®ç°å¤§å¸ˆ", "å®Œæˆäº†æ‰€æœ‰å®ç°æ­¥éª¤ï¼");
        }
    }

    // ===== é€šçŸ¥ç³»ç»Ÿ =====
    function showNotification(message, type = 'success') {
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.style.cssText = `
            position: fixed;
            top: 80px;
            right: 20px;
            background: ${type === 'error' ? '#ef4444' : type === 'warning' ? '#f59e0b' : '#22c55e'};
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            z-index: 2000;
            animation: slideInRight 0.3s ease;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        `;
        notification.textContent = message;

        document.body.appendChild(notification);

        setTimeout(() => {
            notification.style.animation = 'slideInRight 0.3s ease reverse';
            setTimeout(() => document.body.removeChild(notification), 300);
        }, 3000);
    }

    // ===== æ»šåŠ¨è¿›åº¦æ¡ =====
    function updateProgressBar() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        const scrollPercentage = (scrollTop / scrollHeight) * 100;
        document.getElementById('progress-bar').style.width = scrollPercentage + '%';
    }

    window.addEventListener('scroll', updateProgressBar);

    // ===== å¯¼èˆªé«˜äº® =====
    const sections = document.querySelectorAll('section[id]');
    const navItems = document.querySelectorAll('.toc-item');

    function updateNavHighlight() {
        const scrollPosition = window.pageYOffset + 100;

        sections.forEach((section, index) => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.offsetHeight;

            if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                navItems.forEach(item => item.classList.remove('active'));
                if (navItems[index]) {
                    navItems[index].classList.add('active');
                }
            }
        });
    }

    window.addEventListener('scroll', updateNavHighlight);

    // ===== ç›‘å¬ç« èŠ‚é˜…è¯» =====
    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.5
    };

    const sectionObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting && !completedSections.has(entry.target.id)) {
                completedSections.add(entry.target.id);

                if (completedSections.size === 1 && !achievements.firstRNN) {
                    achievements.firstRNN = true;
                    achievementSystem.showAchievement("åˆè¯†RNN", "å¼€å§‹äº†è§£å¾ªç¯ç¥ç»ç½‘ç»œï¼");
                }

                if (completedSections.size === sections.length && !achievements.finishChapter) {
                    achievements.finishChapter = true;
                    achievementSystem.showAchievement("åºåˆ—å¤§å¸ˆ", "å®Œæˆäº†RNNç« èŠ‚çš„å­¦ä¹ ï¼");
                }

                achievementSystem.updateProgress(completedSections.size, sections.length);
            }
        });
    }, observerOptions);

    sections.forEach(section => {
        sectionObserver.observe(section);
    });

    // ===== åˆå§‹åŒ– =====
    window.addEventListener('load', () => {
        // åˆå§‹åŒ–åŠ¨ç”»
        drawGradientFlow();
        animateSequence();

        // æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
        setTimeout(() => {
            learningBuddy.container.classList.add('active');
            learningBuddy.showMessage('æ¬¢è¿æ¥åˆ°RNNçš„ä¸–ç•Œï¼è®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ å¦‚ä½•è®©ç¥ç»ç½‘ç»œæ‹¥æœ‰è®°å¿†ã€‚è®°ä½ï¼Œç†è§£å¾ªç¯è¿æ¥æ˜¯å…³é”®ï¼');
        }, 1000);
    });

    // ===== ä¿å­˜å’ŒåŠ è½½è¿›åº¦ =====
    function saveProgress() {
        const progress = {
            completedSections: Array.from(completedSections),
            achievements: achievements,
            animationsEnabled: animationsEnabled,
            timestamp: Date.now()
        };
        localStorage.setItem('rnn-progress', JSON.stringify(progress));
    }

    function loadProgress() {
        const saved = localStorage.getItem('rnn-progress');
        if (saved) {
            try {
                const progress = JSON.parse(saved);
                completedSections = new Set(progress.completedSections || []);
                achievements = { ...achievements, ...progress.achievements };
                animationsEnabled = progress.animationsEnabled !== false;

                achievementSystem.updateProgress(completedSections.size, sections.length);
                showNotification('å·²æ¢å¤ä¸Šæ¬¡å­¦ä¹ è¿›åº¦');
            } catch (e) {
                console.error('Failed to load progress:', e);
            }
        }
    }

    loadProgress();
    setInterval(saveProgress, 60000);

    // ===== é¡µé¢ç¦»å¼€æ—¶ä¿å­˜ =====
    window.addEventListener('beforeunload', saveProgress);

    console.log('ğŸ‰ RNNç« èŠ‚åŠ è½½å®Œæˆï¼');
</script>

</body>
</html>
