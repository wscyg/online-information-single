<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬8ç« ï¼šé•¿çŸ­æœŸè®°å¿†ç½‘ç»œLSTM - è®©ç¥ç»ç½‘ç»œå­¦ä¼šé—å¿˜ä¸è®°å¿† | æ·±åº¦å­¦ä¹ åºåˆ—å»ºæ¨¡</title>
    <meta name="description" content="é€šè¿‡äº¤äº’å¼å¯è§†åŒ–æ·±å…¥ç†è§£LSTMçš„ç²¾å¦™è®¾è®¡ï¼Œä¸€æ­¥æ­¥æ¨å¯¼é—¨æ§æœºåˆ¶çš„æ•°å­¦åŸç†">

    <!-- å¤–éƒ¨ä¾èµ– -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">

    <style>
        /* ===== CSSå˜é‡å®šä¹‰ ===== */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --lstm-gradient: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            --forget-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --input-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --output-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --cell-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --bg-dark: #0f172a;
            --bg-section: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --accent-red: #ef4444;
            --accent-green: #22c55e;
            --accent-blue: #3b82f6;
            --accent-yellow: #fbbf24;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-orange: #f97316;
            --accent-cyan: #06b6d4;
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.3);
            --animation-duration: 0.3s;
            --content-max-width: 1400px;
        }

        /* ===== å…¨å±€æ ·å¼ ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }

        /* ===== èƒŒæ™¯åŠ¨ç”» ===== */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            z-index: -1;
        }

        .bg-particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(168, 237, 234, 0.5);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            from {
                transform: translateY(100vh) translateX(0);
            }
            to {
                transform: translateY(-100px) translateX(100px);
            }
        }

        /* ===== å¸ƒå±€ç»„ä»¶ ===== */
        .container {
            max-width: var(--content-max-width);
            margin: 0 auto;
            padding: 0 1rem;
            position: relative;
        }

        /* ===== å¯¼èˆªæ  ===== */
        .nav-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
            transition: transform 0.3s ease;
        }

        .nav-header.hidden {
            transform: translateY(-100%);
        }

        .nav-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
        }

        .nav-title h1 {
            font-size: 1.25rem;
            font-weight: 600;
            background: var(--lstm-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            height: 100%;
            background: var(--lstm-gradient);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* ===== ä¾§è¾¹å¯¼èˆª ===== */
        .sidebar {
            position: fixed;
            left: -300px;
            top: 60px;
            bottom: 0;
            width: 300px;
            background: var(--bg-section);
            border-right: 1px solid var(--border-color);
            padding: 2rem;
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 999;
        }

        .sidebar.open {
            transform: translateX(300px);
        }

        .toc-item {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.5rem;
            transition: all var(--animation-duration) ease;
            margin-bottom: 0.25rem;
        }

        .toc-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            transform: translateX(4px);
        }

        .toc-item.active {
            background: var(--lstm-gradient);
            color: #0f172a;
        }

        /* ===== ä¸»å†…å®¹ ===== */
        main {
            margin-top: 80px;
            padding-bottom: 4rem;
        }

        /* ===== ç« èŠ‚æ ‡é¢˜ ===== */
        .chapter-hero {
            background: var(--lstm-gradient);
            padding: 6rem 0;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .chapter-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, transparent 70%);
            animation: pulse 10s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(180deg); }
        }

        .chapter-hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: #0f172a;
        }

        .chapter-hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            animation: fadeInUp 0.8s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== ä¸‰æ å…¬å¼è§£é‡Šå¸ƒå±€ ===== */
        .formula-explainer {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr;
            gap: 2rem;
            background: var(--bg-section);
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .formula-explainer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--lstm-gradient);
        }

        .formula-column {
            position: relative;
        }

        .formula-column h4 {
            color: var(--accent-cyan);
            margin-bottom: 1rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* å…¬å¼åˆ— */
        .formula-math {
            font-size: 1.3rem;
            text-align: center;
            padding: 2rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .formula-math::before {
            content: 'âˆ‘';
            position: absolute;
            top: -20px;
            right: -10px;
            font-size: 4rem;
            opacity: 0.05;
            font-family: 'Times New Roman', serif;
        }

        /* çŸ©é˜µå¯è§†åŒ–åˆ— */
        .matrix-visual {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .matrix-visual svg {
            filter: drop-shadow(0 4px 15px rgba(0, 0, 0, 0.3));
        }

        /* é‡Šä¹‰åˆ— */
        .formula-meaning {
            padding: 1rem;
            font-size: 0.95rem;
            line-height: 1.8;
        }

        .meaning-item {
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .meaning-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--border-color);
        }

        /* é«˜äº®äº¤äº’æ ·å¼ */
        .highlight-target {
            transition: all 0.3s ease;
            cursor: pointer;
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            position: relative;
        }

        .highlight-target:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .highlight-active {
            background: rgba(79, 172, 254, 0.3) !important;
            color: var(--accent-blue) !important;
            font-weight: bold;
            box-shadow: 0 0 20px rgba(79, 172, 254, 0.5);
        }

        /* ===== äº¤äº’å¼çŸ©é˜µå¯è§†åŒ– ===== */
        .matrix-container {
            position: relative;
            display: inline-block;
            margin: 1rem;
            transition: all 0.3s ease;
        }

        .matrix-bracket {
            position: absolute;
            width: 10px;
            height: 100%;
            border: 2px solid var(--text-secondary);
        }

        .matrix-bracket.left {
            left: -10px;
            border-right: none;
            border-radius: 5px 0 0 5px;
        }

        .matrix-bracket.right {
            right: -10px;
            border-left: none;
            border-radius: 0 5px 5px 0;
        }

        .matrix-grid {
            display: grid;
            gap: 0.5rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 0.5rem;
        }

        .matrix-cell {
            width: 3.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 0.25rem;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .matrix-cell::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(79, 172, 254, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.5s ease;
        }

        .matrix-cell:hover {
            background: rgba(79, 172, 254, 0.2);
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 0 20px rgba(79, 172, 254, 0.5);
        }

        .matrix-cell:hover::before {
            width: 100px;
            height: 100px;
        }

        /* ===== äº¤äº’å¼LSTMå•å…ƒå›¾ ===== */
        .lstm-unit-interactive {
            width: 100%;
            max-width: 1000px;
            margin: 3rem auto;
            position: relative;
            background: linear-gradient(135deg, rgba(168, 237, 234, 0.1), rgba(254, 214, 227, 0.05));
            border-radius: 2rem;
            padding: 3rem;
            border: 2px solid var(--border-color);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        #lstmCanvas {
            width: 100%;
            height: 500px;
            cursor: grab;
        }

        #lstmCanvas:active {
            cursor: grabbing;
        }

        /* ===== æ€è€ƒå¼•å¯¼å¡ç‰‡ ===== */
        .think-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(236, 72, 153, 0.1));
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .think-card::before {
            content: 'ğŸ¤”';
            position: absolute;
            top: -20px;
            right: 20px;
            font-size: 5rem;
            opacity: 0.1;
            transform: rotate(15deg);
        }

        .think-card h3 {
            color: var(--accent-purple);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .think-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .think-option {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .think-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.3);
            border-color: var(--accent-purple);
        }

        .think-option.selected {
            background: rgba(139, 92, 246, 0.2);
            border-color: var(--accent-purple);
        }

        .think-feedback {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: 0.5rem;
            display: none;
        }

        .think-feedback.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== å®æ—¶è®¡ç®—æ¼”ç¤º ===== */
        .live-demo {
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(59, 130, 246, 0.05));
            border-radius: 1.5rem;
            padding: 3rem;
            margin: 2rem 0;
            border: 2px solid var(--accent-cyan);
            position: relative;
            overflow: hidden;
        }

        .live-demo::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(6, 182, 212, 0.2), transparent);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .live-demo-content {
            position: relative;
            z-index: 2;
        }

        .input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .live-demo-input {
            flex: 1;
            padding: 1rem 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border-color);
            border-radius: 0.75rem;
            color: var(--text-primary);
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .live-demo-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 30px rgba(6, 182, 212, 0.3);
        }

        .analyze-btn {
            padding: 1rem 2rem;
            background: var(--accent-cyan);
            color: white;
            border: none;
            border-radius: 0.75rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .analyze-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.6s ease;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(6, 182, 212, 0.4);
        }

        .analyze-btn:active::before {
            width: 300px;
            height: 300px;
        }

        .live-demo-output {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .demo-result-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 2rem;
            border-radius: 1rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .demo-result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--lstm-gradient);
            transform: scaleX(0);
            transition: transform 0.5s ease;
        }

        .demo-result-card:hover::before {
            transform: scaleX(1);
        }

        /* ===== æ­¥è¿›åŠ¨ç”»æ§åˆ¶ ===== */
        .step-animation {
            background: var(--bg-section);
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--text-muted);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .step-dot.active {
            width: 30px;
            border-radius: 6px;
            background: var(--accent-cyan);
        }

        .step-content {
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .step-visual {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.5s ease;
        }

        .step-visual.active {
            opacity: 1;
            transform: translateX(0);
        }

        /* ===== ä»£ç åˆ†å±‚å±•ç¤º ===== */
        .code-layers {
            margin: 2rem 0;
            background: var(--bg-section);
            border-radius: 1rem;
            overflow: hidden;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
        }

        .code-layer-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.02);
            border-bottom: 2px solid var(--border-color);
        }

        .code-layer-tab {
            flex: 1;
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
        }

        .code-layer-tab::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-blue);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .code-layer-tab.active {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .code-layer-tab.active::after {
            transform: scaleX(1);
        }

        .code-layer-content {
            display: none;
            padding: 2rem;
            max-height: 600px;
            overflow-y: auto;
        }

        .code-layer-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* ===== æ¯”è¾ƒè¡¨æ ¼ ===== */
        .comparison-table {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            overflow: hidden;
            margin: 2rem 0;
            box-shadow: var(--shadow-lg);
        }

        .comparison-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th {
            background: var(--lstm-gradient);
            color: #0f172a;
            padding: 1.25rem;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .comparison-table tr:hover td {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(5px);
        }

        /* ===== æ•°å­¦æ¨å¯¼åŠ¨ç”» ===== */
        .math-derivation {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(236, 72, 153, 0.05));
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .derivation-step {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid var(--accent-cyan);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 0.5rem 0.5rem 0;
            position: relative;
            opacity: 0;
            transform: translateX(-20px);
            animation: slideIn 0.5s ease forwards;
        }

        .derivation-step:nth-child(1) { animation-delay: 0.1s; }
        .derivation-step:nth-child(2) { animation-delay: 0.2s; }
        .derivation-step:nth-child(3) { animation-delay: 0.3s; }
        .derivation-step:nth-child(4) { animation-delay: 0.4s; }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .derivation-step-number {
            position: absolute;
            left: -20px;
            top: 1.5rem;
            width: 40px;
            height: 40px;
            background: var(--accent-cyan);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4);
        }

        /* ===== å®è·µç»ƒä¹  ===== */
        .practice-section {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.05));
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
            border: 2px solid rgba(251, 191, 36, 0.3);
        }

        .practice-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .practice-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(251, 191, 36, 0.3);
        }

        .practice-solution {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
            margin-top: 1rem;
        }

        .practice-item.open .practice-solution {
            max-height: 1000px;
        }

        /* ===== å¯è§†åŒ–å›¾è¡¨ ===== */
        .visualization-container {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .viz-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        /* ===== æŒ‰é’®æ ·å¼ ===== */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--animation-duration) ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.6s ease;
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: var(--lstm-gradient);
            color: #0f172a;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(168, 237, 234, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent-cyan);
        }

        /* ===== æç¤ºæ¡† ===== */
        .tip {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin: 1.5rem 0;
            position: relative;
            overflow: hidden;
        }

        .tip::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 4px;
        }

        .tip.info {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.3);
        }

        .tip.info::before {
            background: var(--accent-blue);
        }

        .tip.warning {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .tip.warning::before {
            background: var(--accent-yellow);
        }

        .tip.success {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .tip.success::before {
            background: var(--accent-green);
        }

        /* ===== æœ¯è¯­æç¤º ===== */
        .term-tooltip {
            position: relative;
            border-bottom: 2px dotted var(--accent-cyan);
            cursor: help;
            display: inline-block;
        }

        .term-tooltip .tooltip-content {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-dark);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem 1.5rem;
            font-size: 0.9rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            margin-bottom: 0.5rem;
        }

        .term-tooltip:hover .tooltip-content {
            opacity: 1;
            transform: translateX(-50%) translateY(-5px);
        }

        /* ===== æŠ˜å å†…å®¹ ===== */
        .collapsible {
            margin: 1rem 0;
        }

        .collapsible-header {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            user-select: none;
        }

        .collapsible-header:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .collapsible.open .collapsible-content {
            max-height: 2000px;
            padding: 1rem 1.5rem;
        }

        .collapsible-icon {
            transition: transform 0.3s ease;
        }

        .collapsible.open .collapsible-icon {
            transform: rotate(180deg);
        }

        /* ===== å¡ç‰‡æ ·å¼ ===== */
        .section-card {
            background: var(--bg-section);
            border-radius: 1rem;
            padding: 3rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .section-card::before {
            content: '';
            position: absolute;
            top: -100px;
            right: -100px;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(168, 237, 234, 0.1), transparent);
            border-radius: 50%;
        }

        /* ===== æ•…äº‹å¡ç‰‡ ===== */
        .story-card {
            background: linear-gradient(135deg, rgba(168, 237, 234, 0.15), rgba(254, 214, 227, 0.1));
            border-radius: 1rem;
            padding: 2.5rem;
            margin-bottom: 2rem;
            border: 2px solid rgba(168, 237, 234, 0.2);
            position: relative;
            overflow: hidden;
        }

        .story-card::before {
            content: 'ğŸ“–';
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 5rem;
            opacity: 0.1;
            transform: rotate(15deg);
        }

        /* ===== å¯¹è¯æ¡† ===== */
        .dialogue-box {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid var(--accent-pink);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 0.5rem 0.5rem 0;
            position: relative;
            opacity: 0;
            transform: translateX(-20px);
            animation: slideInLeft 0.5s ease forwards;
        }

        .dialogue-box:nth-child(1) { animation-delay: 0.1s; }
        .dialogue-box:nth-child(2) { animation-delay: 0.3s; }
        .dialogue-box:nth-child(3) { animation-delay: 0.5s; }

        @keyframes slideInLeft {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .dialogue-box .speaker {
            font-weight: bold;
            color: var(--accent-pink);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .dialogue-box .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        /* ===== æ¦‚å¿µç½‘æ ¼ ===== */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .concept-card {
            padding: 2rem;
            border-radius: 0.75rem;
            transition: all var(--animation-duration) ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .concept-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            transform: scaleX(0);
            transition: transform var(--animation-duration) ease;
        }

        .concept-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .concept-card:hover::before {
            transform: scaleX(1);
        }

        .concept-card.forget {
            background: rgba(240, 147, 251, 0.1);
            border: 1px solid rgba(240, 147, 251, 0.3);
        }

        .concept-card.forget::before {
            background: var(--forget-gradient);
        }

        .concept-card.input {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.3);
        }

        .concept-card.input::before {
            background: var(--input-gradient);
        }

        .concept-card.output {
            background: rgba(67, 233, 123, 0.1);
            border: 1px solid rgba(67, 233, 123, 0.3);
        }

        .concept-card.output::before {
            background: var(--output-gradient);
        }

        .concept-card.cell {
            background: rgba(250, 112, 154, 0.1);
            border: 1px solid rgba(250, 112, 154, 0.3);
        }

        .concept-card.cell::before {
            background: var(--cell-gradient);
        }

        /* ===== æ—¶é—´çº¿ ===== */
        .timeline {
            position: relative;
            padding: 2rem 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border-color);
        }

        .timeline-item {
            position: relative;
            margin: 2rem 0;
            padding: 0 2rem;
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }

        .timeline-item:nth-child(1) { animation-delay: 0.1s; }
        .timeline-item:nth-child(2) { animation-delay: 0.2s; }
        .timeline-item:nth-child(3) { animation-delay: 0.3s; }
        .timeline-item:nth-child(4) { animation-delay: 0.4s; }

        .timeline-item:nth-child(odd) {
            text-align: right;
            padding-right: 50%;
        }

        .timeline-item:nth-child(even) {
            padding-left: 50%;
        }

        .timeline-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: var(--lstm-gradient);
            border-radius: 50%;
            z-index: 1;
            box-shadow: 0 0 20px rgba(168, 237, 234, 0.5);
        }

        /* ===== å“åº”å¼è®¾è®¡ ===== */
        @media (max-width: 1024px) {
            .formula-explainer {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .live-demo-output {
                grid-template-columns: 1fr;
            }

            .concept-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .chapter-hero h1 {
                font-size: 2.5rem;
            }

            .section-card {
                padding: 2rem;
            }

            .timeline-item:nth-child(odd),
            .timeline-item:nth-child(even) {
                padding-left: 3rem;
                padding-right: 1rem;
                text-align: left;
            }

            .timeline::before {
                left: 20px;
            }

            .timeline-dot {
                left: 20px;
            }

            .code-layer-tabs {
                flex-direction: column;
            }

            .code-layer-tab {
                border-bottom: 1px solid var(--border-color);
            }
        }

        /* ===== åŠ è½½åŠ¨ç”» ===== */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-pink);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== æ»šåŠ¨æ¡ç¾åŒ– ===== */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-muted);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        /* ===== æ‰“å°æ ·å¼ ===== */
        @media print {
            body {
                background: white;
                color: black;
            }

            .nav-header,
            .sidebar,
            .btn,
            .viz-controls {
                display: none;
            }
        }
    </style>
</head>
<body>

<!-- èƒŒæ™¯åŠ¨ç”» -->
<div class="bg-animation" id="bgAnimation"></div>

<!-- å¯¼èˆªæ  -->
<nav class="nav-header" role="navigation" aria-label="ä¸»å¯¼èˆª">
    <div class="container">
        <div class="nav-content">
            <div class="nav-title">
                <button id="toggle-sidebar" class="btn btn-secondary" style="margin-right: 1rem;" aria-label="åˆ‡æ¢ä¾§è¾¹æ ">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <h1>ç¬¬8ç« ï¼šé•¿çŸ­æœŸè®°å¿†ç½‘ç»œLSTM</h1>
            </div>
            <div style="display: flex; gap: 1rem;">
                <button id="toggle-animations" class="btn btn-secondary" aria-label="åˆ‡æ¢åŠ¨ç”»">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M10 8l6 4-6 4V8z"></path>
                    </svg>
                </button>
                <button id="toggle-theme" class="btn btn-secondary" aria-label="åˆ‡æ¢ä¸»é¢˜">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                    </svg>
                </button>
            </div>
        </div>
        <div class="nav-progress">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
    </div>
</nav>

<!-- ä¾§è¾¹æ  -->
<aside class="sidebar" id="sidebar">
    <h3 style="margin-bottom: 1.5rem; color: var(--accent-pink);">ğŸ“š ç›®å½•å¯¼èˆª</h3>
    <nav>
        <a href="#intro" class="toc-item active">åºè¨€ï¼šè®°å¿†çš„è‰ºæœ¯</a>
        <a href="#problem" class="toc-item">RNNçš„å›°å¢ƒ</a>
        <a href="#solution" class="toc-item">è§£å†³æ€è·¯æ¨å¯¼</a>
        <a href="#forget-gate" class="toc-item">é—å¿˜é—¨çš„è¯ç”Ÿ</a>
        <a href="#input-gate" class="toc-item">è¾“å…¥é—¨çš„è®¾è®¡</a>
        <a href="#cell-state" class="toc-item">ç»†èƒçŠ¶æ€æ›´æ–°</a>
        <a href="#output-gate" class="toc-item">è¾“å‡ºé—¨çš„æ§åˆ¶</a>
        <a href="#complete-lstm" class="toc-item">LSTMå®Œæ•´ç»“æ„</a>
        <a href="#math-proof" class="toc-item">æ•°å­¦è¯æ˜</a>
        <a href="#implementation" class="toc-item">ä»é›¶å®ç°LSTM</a>
        <a href="#visualization" class="toc-item">å¯è§†åŒ–ç†è§£</a>
        <a href="#practice" class="toc-item">å®æˆ˜åº”ç”¨</a>
        <a href="#exercises" class="toc-item">ç»ƒä¹ ä¸æ€è€ƒ</a>
        <a href="#summary" class="toc-item">æ€»ç»“ä¸å±•æœ›</a>
    </nav>
</aside>

<!-- ä¸»å†…å®¹ -->
<main>
    <!-- ç« èŠ‚æ ‡é¢˜ -->
    <section class="chapter-hero">
        <div class="container">
            <div class="chapter-hero-content">
                <h1>é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼šè®©AIå­¦ä¼šé—å¿˜ä¸è®°å¿†</h1>
                <p style="font-size: 1.5rem; margin-bottom: 2rem;">æ·±å…¥ç†è§£LSTMçš„ç²¾å¦™è®¾è®¡ï¼Œä¸€æ­¥æ­¥æ¨å¯¼é—¨æ§æœºåˆ¶çš„æ•°å­¦åŸç†</p>
                <div style="display: flex; justify-content: center; gap: 1.5rem; flex-wrap: wrap;">
                    <span style="background: rgba(0, 0, 0, 0.1); padding: 0.75rem 1.5rem; border-radius: 30px; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.3rem;">ğŸšª</span> é—¨æ§æœºåˆ¶
                    </span>
                    <span style="background: rgba(0, 0, 0, 0.1); padding: 0.75rem 1.5rem; border-radius: 30px; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.3rem;">ğŸ§ </span> é•¿æœŸè®°å¿†
                    </span>
                    <span style="background: rgba(0, 0, 0, 0.1); padding: 0.75rem 1.5rem; border-radius: 30px; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.3rem;">ğŸ“</span> æ•°å­¦æ¨å¯¼
                    </span>
                </div>
            </div>
        </div>
    </section>

    <div class="container">

        <!-- ä¸€å¥è¯ç†è§£ -->
        <section class="section-card">
            <h2 style="color: var(--accent-pink); margin-bottom: 2rem; text-align: center; font-size: 2.5rem;">
                ğŸ’¡ ä¸€å¥è¯ç†è§£LSTM
            </h2>
            <p style="font-size: 1.5rem; text-align: center; line-height: 2; margin-bottom: 3rem;">
                LSTMå°±åƒä¸€ä¸ªç²¾å¯†çš„è®°å¿†ç®¡ç†ç³»ç»Ÿï¼Œ<br>
                é€šè¿‡ä¸‰ä¸ªé—¨æ§åˆ¶ä¿¡æ¯çš„æµåŠ¨ï¼š<br>
                <span style="color: #f5576c; font-weight: bold;">é—å¿˜é—¨</span>å†³å®šå¿˜è®°ä»€ä¹ˆï¼Œ
                <span style="color: #4facfe; font-weight: bold;">è¾“å…¥é—¨</span>å†³å®šè®°ä½ä»€ä¹ˆï¼Œ
                <span style="color: #43e97b; font-weight: bold;">è¾“å‡ºé—¨</span>å†³å®šè¾“å‡ºä»€ä¹ˆã€‚
            </p>

            <!-- å››ä¸ªæ ¸å¿ƒæ¦‚å¿µ -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem;">
                <div style="text-align: center;">
                    <div style="
                        width: 100px;
                        height: 100px;
                        margin: 0 auto 1rem;
                        background: var(--forget-gradient);
                        border-radius: 25px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 3rem;
                        color: white;
                        box-shadow: 0 10px 30px rgba(240, 147, 251, 0.4);
                        transition: all 0.3s ease;
                        cursor: pointer;
                    " onmouseover="this.style.transform='translateY(-5px) scale(1.05)'" onmouseout="this.style.transform='translateY(0) scale(1)'">
                        ğŸšª
                    </div>
                    <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">é—å¿˜é—¨</h4>
                    <p style="color: #94a3b8; font-size: 0.95rem; line-height: 1.5;">
                        é€‰æ‹©æ€§é—å¿˜<br>è¿‡æ»¤æ— ç”¨ä¿¡æ¯
                    </p>
                </div>

                <div style="text-align: center;">
                    <div style="
                        width: 100px;
                        height: 100px;
                        margin: 0 auto 1rem;
                        background: var(--input-gradient);
                        border-radius: 25px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 3rem;
                        color: white;
                        box-shadow: 0 10px 30px rgba(79, 172, 254, 0.4);
                        transition: all 0.3s ease;
                        cursor: pointer;
                    " onmouseover="this.style.transform='translateY(-5px) scale(1.05)'" onmouseout="this.style.transform='translateY(0) scale(1)'">
                        â•
                    </div>
                    <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">è¾“å…¥é—¨</h4>
                    <p style="color: #94a3b8; font-size: 0.95rem; line-height: 1.5;">
                        é€‰æ‹©æ€§è®°å¿†<br>å­˜å‚¨é‡è¦ä¿¡æ¯
                    </p>
                </div>

                <div style="text-align: center;">
                    <div style="
                        width: 100px;
                        height: 100px;
                        margin: 0 auto 1rem;
                        background: var(--output-gradient);
                        border-radius: 25px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 3rem;
                        color: white;
                        box-shadow: 0 10px 30px rgba(67, 233, 123, 0.4);
                        transition: all 0.3s ease;
                        cursor: pointer;
                    " onmouseover="this.style.transform='translateY(-5px) scale(1.05)'" onmouseout="this.style.transform='translateY(0) scale(1)'">
                        ğŸ“¤
                    </div>
                    <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">è¾“å‡ºé—¨</h4>
                    <p style="color: #94a3b8; font-size: 0.95rem; line-height: 1.5;">
                        æ§åˆ¶è¾“å‡º<br>å†³å®šå±•ç¤ºä»€ä¹ˆ
                    </p>
                </div>

                <div style="text-align: center;">
                    <div style="
                        width: 100px;
                        height: 100px;
                        margin: 0 auto 1rem;
                        background: var(--cell-gradient);
                        border-radius: 25px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 3rem;
                        color: white;
                        box-shadow: 0 10px 30px rgba(250, 112, 154, 0.4);
                        transition: all 0.3s ease;
                        cursor: pointer;
                    " onmouseover="this.style.transform='translateY(-5px) scale(1.05)'" onmouseout="this.style.transform='translateY(0) scale(1)'">
                        ğŸ“¦
                    </div>
                    <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">ç»†èƒçŠ¶æ€</h4>
                    <p style="color: #94a3b8; font-size: 0.95rem; line-height: 1.5;">
                        é•¿æœŸè®°å¿†<br>ä¿¡æ¯é«˜é€Ÿé€šé“
                    </p>
                </div>
            </div>
        </section>

        <!-- æ€è€ƒå¼•å¯¼ï¼šä¸ºä»€ä¹ˆéœ€è¦LSTM -->
        <section class="think-card">
            <h3>ğŸ¤” æ€è€ƒæ—¶åˆ»ï¼šä¸ºä»€ä¹ˆRNNä¼šå¤±è´¥ï¼Ÿ</h3>
            <p>åœ¨å­¦ä¹ LSTMä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆä¼ ç»ŸRNNåœ¨å¤„ç†é•¿åºåˆ—æ—¶ä¼šå¤±è´¥ï¼Ÿ</p>

            <div class="think-options">
                <div class="think-option" data-answer="a">
                    A. è®¡ç®—é€Ÿåº¦å¤ªæ…¢
                </div>
                <div class="think-option" data-answer="b">
                    B. æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸
                </div>
                <div class="think-option" data-answer="c">
                    C. å‚æ•°å¤ªå¤š
                </div>
                <div class="think-option" data-answer="d">
                    D. æ¿€æ´»å‡½æ•°é€‰æ‹©ä¸å½“
                </div>
            </div>

            <div class="think-feedback" id="thinkFeedback1">
                <!-- åé¦ˆå†…å®¹å°†åŠ¨æ€æ’å…¥ -->
            </div>
        </section>

        <!-- åºè¨€ï¼šè®°å¿†çš„è‰ºæœ¯ -->
        <section id="intro" class="section-card">
            <div class="story-card">
                <h2 style="color: var(--accent-pink); margin-bottom: 1.5rem;">ğŸ“– åºè¨€ï¼šè®°å¿†çš„è‰ºæœ¯</h2>

                <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 2rem;">
                    1997å¹´ï¼Œå¾·å›½æ…•å°¼é»‘å·¥ä¸šå¤§å­¦çš„ä¸€ä¸ªç ”ç©¶å°ç»„æ­£åœ¨ä¸ºä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜è‹¦æ¼...
                </p>

                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘¨â€ğŸ”¬</div>
                        Sepp Hochreiterï¼š
                    </div>
                    <div>"æˆ‘ä»¬çš„RNNåœ¨å¤„ç†é•¿å¥å­æ—¶æ€»æ˜¯å¤±è´¥ã€‚æ¯”å¦‚è¿™ä¸ªå¾·è¯­å¥å­ï¼ŒåŠ¨è¯åœ¨æœ€åï¼Œä½†ç½‘ç»œåœ¨å¤„ç†åˆ°åŠ¨è¯æ—¶å·²ç»å¿˜è®°äº†ä¸»è¯­æ˜¯ä»€ä¹ˆï¼"</div>
                </div>

                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">ğŸ‘¨â€ğŸ«</div>
                        JÃ¼rgen Schmidhuberï¼š
                    </div>
                    <div>"é—®é¢˜çš„æ ¹æºæ˜¯æ¢¯åº¦æ¶ˆå¤±ã€‚å½“è¯¯å·®ä¿¡å·é€šè¿‡æ—¶é—´åå‘ä¼ æ’­æ—¶ï¼Œå®ƒä¼šæŒ‡æ•°çº§è¡°å‡ã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§æ–°çš„æ¶æ„ï¼"</div>
                </div>

                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #fa709a, #fee140);">ğŸ§‘â€ğŸ”¬</div>
                        ç ”ç©¶ç”Ÿï¼š
                    </div>
                    <div>"å¦‚æœæˆ‘ä»¬èƒ½åˆ›å»ºä¸€æ¡'é«˜é€Ÿå…¬è·¯'ï¼Œè®©æ¢¯åº¦å¯ä»¥æ— æŸåœ°ä¼ æ’­å‘¢ï¼Ÿå°±åƒ...å°±åƒæ°´ç®¡ä¸­çš„é˜€é—¨ï¼Œå¯ä»¥æ§åˆ¶æ°´æµï¼"</div>
                </div>

                <div class="timeline mt-4">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4 style="color: var(--accent-pink);">1991å¹´</h4>
                        <p>Hochreiterå‘ç°æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</p>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4 style="color: var(--accent-blue);">1997å¹´</h4>
                        <p>LSTMè®ºæ–‡å‘è¡¨ï¼Œå¼•å…¥é—¨æ§æœºåˆ¶</p>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4 style="color: var(--accent-green);">2000å¹´</h4>
                        <p>æ·»åŠ é—å¿˜é—¨ï¼ŒLSTMç»“æ„å®Œå–„</p>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4 style="color: var(--accent-orange);">2014å¹´</h4>
                        <p>LSTMåœ¨æœºå™¨ç¿»è¯‘ä¸­å¤§æ”¾å¼‚å½©</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- RNNçš„å›°å¢ƒ -->
        <section id="problem" class="section-card">
            <h2 style="color: var(--accent-red); margin-bottom: 2rem;">ğŸ’” RNNçš„å›°å¢ƒï¼šä¸ºä»€ä¹ˆéœ€è¦LSTMï¼Ÿ</h2>

            <!-- æ¢¯åº¦æ¶ˆå¤±å¯è§†åŒ– -->
            <div class="visualization-container">
                <h3 style="color: var(--accent-cyan); margin-bottom: 1.5rem;">æ¢¯åº¦æ¶ˆå¤±çš„ç›´è§‚ç†è§£</h3>
                <canvas id="gradientVanishingCanvas" width="900" height="300"></canvas>
                <div class="viz-controls" style="margin-top: 1rem;">
                    <button class="btn btn-primary" onclick="animateGradientVanishing()">
                        â–¶ï¸ æ¼”ç¤ºæ¢¯åº¦æ¶ˆå¤±
                    </button>
                    <button class="btn btn-secondary" onclick="resetGradientAnimation()">
                        ğŸ”„ é‡ç½®
                    </button>
                </div>
            </div>

            <div class="math-derivation">
                <h3 style="color: var(--accent-red); margin-bottom: 1.5rem;">ğŸ”¬ æ¢¯åº¦æ¶ˆå¤±çš„æ•°å­¦æœ¬è´¨</h3>

                <div class="derivation-step">
                    <div class="derivation-step-number">1</div>
                    <h4>RNNçš„æ¢¯åº¦ä¼ æ’­</h4>
                    <p>å›å¿†RNNçš„éšè—çŠ¶æ€æ›´æ–°å…¬å¼ï¼š</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $$\mathbf{h}_t = \tanh(\mathbf{W}_{hh} \mathbf{h}_{t-1} + \mathbf{W}_{xh} \mathbf{x}_t + \mathbf{b}_h)$$
                    </div>
                    <p>å½“æˆ‘ä»¬è®¡ç®—æŸå¤±å¯¹æ—©æœŸéšè—çŠ¶æ€çš„æ¢¯åº¦æ—¶ï¼š</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $$\frac{\partial L}{\partial \mathbf{h}_1} = \frac{\partial L}{\partial \mathbf{h}_T} \cdot \prod_{t=2}^{T} \frac{\partial \mathbf{h}_t}{\partial \mathbf{h}_{t-1}}$$
                    </div>
                </div>

                <div class="derivation-step">
                    <div class="derivation-step-number">2</div>
                    <h4>é—®é¢˜çš„æ ¹æº</h4>
                    <p>æ¯ä¸€é¡¹æ¢¯åº¦éƒ½åŒ…å«tanhçš„å¯¼æ•°ï¼š</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $$\frac{\partial \mathbf{h}_t}{\partial \mathbf{h}_{t-1}} = \text{diag}(\tanh'(\mathbf{z}_t)) \cdot \mathbf{W}_{hh}$$
                    </div>
                    <p>ç”±äº $\tanh'(x) = 1 - \tanh^2(x) \in (0, 1]$ï¼Œæ¢¯åº¦ä¼šæŒ‡æ•°çº§è¡°å‡ï¼</p>
                </div>
            </div>

            <div class="tip warning">
                <span style="font-size: 1.5rem;">âš ï¸</span>
                <div>
                    <strong>å…³é”®æ´å¯Ÿï¼š</strong>å½“åºåˆ—é•¿åº¦ä¸º100æ—¶ï¼Œå¦‚æœæ¯æ­¥æ¢¯åº¦è¡°å‡0.9ï¼Œæœ€ç»ˆæ¢¯åº¦åªæœ‰åˆå§‹çš„ $0.9^{100} \approx 10^{-5}$ï¼
                    è¿™å°±æ˜¯ä¸ºä»€ä¹ˆRNNæ— æ³•å­¦ä¹ é•¿æœŸä¾èµ–ã€‚
                </div>
            </div>
        </section>

        <!-- è§£å†³æ€è·¯æ¨å¯¼ -->
        <section id="solution" class="section-card">
            <h2 style="color: var(--accent-blue); margin-bottom: 2rem;">ğŸ’¡ è§£å†³æ€è·¯ï¼šå¦‚ä½•è®¾è®¡æ›´å¥½çš„è®°å¿†æœºåˆ¶ï¼Ÿ</h2>

            <div class="think-card">
                <h3>ğŸ§  è®¾è®¡æ€è€ƒï¼šå¦‚æœä½ æ¥è®¾è®¡ï¼Œä¼šæ€ä¹ˆåšï¼Ÿ</h3>
                <p>åœ¨çœ‹LSTMçš„è§£å†³æ–¹æ¡ˆä¹‹å‰ï¼Œè®©æˆ‘ä»¬è‡ªå·±æ€è€ƒä¸€ä¸‹ï¼šå¦‚ä½•è®©ç½‘ç»œæ—¢èƒ½è®°ä½é‡è¦ä¿¡æ¯ï¼Œåˆèƒ½å¿˜è®°æ— ç”¨ä¿¡æ¯ï¼Ÿ</p>

                <div style="display: grid; gap: 1rem; margin-top: 1.5rem;">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 0.5rem;">ğŸ’­ æ€è€ƒ1ï¼šä¿¡æ¯ä¼ é€’</h4>
                        <p>å¦‚ä½•åˆ›å»ºä¸€æ¡"é«˜é€Ÿå…¬è·¯"ï¼Œè®©ä¿¡æ¯å¯ä»¥æ— æŸä¼ é€’ï¼Ÿ</p>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                        <h4 style="color: var(--accent-pink); margin-bottom: 0.5rem;">ğŸ’­ æ€è€ƒ2ï¼šé€‰æ‹©æœºåˆ¶</h4>
                        <p>å¦‚ä½•è®©ç½‘ç»œè‡ªå·±å†³å®šä»€ä¹ˆä¿¡æ¯é‡è¦ï¼Œä»€ä¹ˆä¿¡æ¯å¯ä»¥ä¸¢å¼ƒï¼Ÿ</p>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                        <h4 style="color: var(--accent-green); margin-bottom: 0.5rem;">ğŸ’­ æ€è€ƒ3ï¼šæ§åˆ¶æ–¹å¼</h4>
                        <p>ç”¨ä»€ä¹ˆæ•°å­¦å·¥å…·æ¥å®ç°è¿™ç§é€‰æ‹©æ€§æ§åˆ¶ï¼Ÿ</p>
                    </div>
                </div>
            </div>

            <div class="story-card" style="margin-top: 2rem;">
                <h3 style="color: var(--accent-blue); margin-bottom: 1.5rem;">ğŸ¯ LSTMçš„æ ¸å¿ƒåˆ›æ–°</h3>
                <p style="font-size: 1.1rem; line-height: 1.8;">
                    LSTMçš„å¤©æ‰ä¹‹å¤„åœ¨äºå¼•å…¥äº†<strong>ç»†èƒçŠ¶æ€ï¼ˆCell Stateï¼‰</strong>ä½œä¸ºä¿¡æ¯çš„é«˜é€Ÿå…¬è·¯ï¼Œ
                    å¹¶é€šè¿‡<strong>é—¨æ§æœºåˆ¶ï¼ˆGating Mechanismï¼‰</strong>æ¥æ§åˆ¶ä¿¡æ¯çš„æµåŠ¨ã€‚
                </p>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 2rem;">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.75rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">ğŸ›¤ï¸ ç»†èƒçŠ¶æ€</h4>
                        <ul style="margin-left: 1.5rem;">
                            <li>çº¿æ€§ä¼ æ’­ï¼Œé¿å…éçº¿æ€§æ¿€æ´»</li>
                            <li>æ¢¯åº¦å¯ä»¥æ— æŸåœ°åå‘ä¼ æ’­</li>
                            <li>å°±åƒä¸€æ¡ä¿¡æ¯é«˜é€Ÿå…¬è·¯</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.75rem;">
                        <h4 style="color: var(--accent-pink); margin-bottom: 1rem;">ğŸšª é—¨æ§æœºåˆ¶</h4>
                        <ul style="margin-left: 1.5rem;">
                            <li>ä½¿ç”¨Sigmoidå‡½æ•°ä½œä¸ºå¼€å…³</li>
                            <li>è¾“å‡ºåœ¨[0,1]ä¹‹é—´ï¼Œåƒç™¾åˆ†æ¯”</li>
                            <li>å¯å­¦ä¹ çš„å‚æ•°å†³å®šå¼€å…³ç¨‹åº¦</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- æ ¸å¿ƒLSTMå•å…ƒäº¤äº’å›¾ -->
        <section class="section-card">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">ğŸ¯ LSTMæ ¸å¿ƒç»“æ„ - äº¤äº’å¼æ¢ç´¢</h2>

            <div class="lstm-unit-interactive">
                <canvas id="lstmCanvas"></canvas>

                <div style="margin-top: 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <button class="btn btn-primary" onclick="highlightForgetGate()">
                        ğŸ—‘ï¸ é«˜äº®é—å¿˜é—¨
                    </button>
                    <button class="btn btn-primary" onclick="highlightInputGate()">
                        â• é«˜äº®è¾“å…¥é—¨
                    </button>
                    <button class="btn btn-primary" onclick="highlightOutputGate()">
                        ğŸ“¤ é«˜äº®è¾“å‡ºé—¨
                    </button>
                    <button class="btn btn-primary" onclick="animateDataFlow()">
                        ğŸŒŠ æ¼”ç¤ºæ•°æ®æµ
                    </button>
                </div>
            </div>

            <div id="gateDescription" style="margin-top: 2rem; padding: 2rem; background: rgba(255, 255, 255, 0.05); border-radius: 1rem; min-height: 150px;">
                <p style="text-align: center; color: var(--text-secondary); font-size: 1.1rem;">
                    ğŸ‘† ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ï¼Œæ¢ç´¢LSTMçš„å„ä¸ªç»„ä»¶
                </p>
            </div>
        </section>

        <!-- é—å¿˜é—¨è¯¦è§£ -->
        <section id="forget-gate" class="section-card">
            <h2 style="color: var(--accent-pink); margin-bottom: 2rem;">ğŸšª é—å¿˜é—¨ï¼šå­¦ä¼šå¿˜è®°</h2>

            <div class="story-card">
                <p style="font-size: 1.1rem; line-height: 1.8; margin-bottom: 1.5rem;">
                    è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¨å¯¼é—å¿˜é—¨çš„è®¾è®¡...
                </p>

                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘¨â€ğŸ”¬</div>
                        è®¾è®¡è€…ï¼š
                    </div>
                    <div>"é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å†³å®šä»ä¸Šä¸€æ—¶åˆ»çš„ç»†èƒçŠ¶æ€ $\mathbf{C}_{t-1}$ ä¸­å¿˜è®°ä»€ä¹ˆã€‚è¿™ä¸ªå†³å®šåº”è¯¥åŸºäºä»€ä¹ˆï¼Ÿ"</div>
                </div>

                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">ğŸ‘©â€ğŸ”¬</div>
                        åŒäº‹ï¼š
                    </div>
                    <div>"åº”è¯¥åŸºäºå½“å‰è¾“å…¥ $\mathbf{x}_t$ å’Œä¸Šä¸€æ—¶åˆ»çš„éšè—çŠ¶æ€ $\mathbf{h}_{t-1}$ï¼æ¯”å¦‚åœ¨è¯­è¨€æ¨¡å‹ä¸­ï¼Œçœ‹åˆ°æ–°çš„ä¸»è¯­æ—¶å°±åº”è¯¥å¿˜è®°æ—§çš„ä¸»è¯­ã€‚"</div>
                </div>
            </div>

            <!-- ä¸‰æ å…¬å¼è§£é‡Š -->
            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>æ•°å­¦å…¬å¼</h4>
                    <div class="formula-math">
                        <span class="highlight-target" data-symbol="f_t">f<sub>t</sub></span> =
                        <span class="highlight-target" data-symbol="sigma">Ïƒ</span>(
                        <span class="highlight-target" data-symbol="W_f">W<sub>f</sub></span> Â·
                        [<span class="highlight-target" data-symbol="h_t-1">h<sub>t-1</sub></span>,
                        <span class="highlight-target" data-symbol="x_t">x<sub>t</sub></span>] +
                        <span class="highlight-target" data-symbol="b_f">b<sub>f</sub></span>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>çŸ©é˜µå½¢çŠ¶å¯è§†åŒ–</h4>
                    <div class="matrix-visual" id="forgetGateVisual">
                        <svg width="400" height="300" viewBox="0 0 400 300">
                            <!-- è¾“å…¥å‘é‡ -->
                            <g id="input-vectors">
                                <rect x="20" y="50" width="40" height="80" fill="rgba(79, 172, 254, 0.3)" stroke="#4facfe" stroke-width="2" rx="5"/>
                                <text x="40" y="35" text-anchor="middle" fill="#4facfe" font-size="14">h<tspan dy="3" font-size="10">t-1</tspan></text>
                                <text x="40" y="90" text-anchor="middle" fill="white" font-size="12">128Ã—1</text>

                                <rect x="20" y="150" width="40" height="60" fill="rgba(67, 233, 123, 0.3)" stroke="#43e97b" stroke-width="2" rx="5"/>
                                <text x="40" y="180" text-anchor="middle" fill="#43e97b" font-size="14">x<tspan dy="3" font-size="10">t</tspan></text>
                                <text x="40" y="195" text-anchor="middle" fill="white" font-size="12">100Ã—1</text>
                            </g>

                            <!-- æ‹¼æ¥ -->
                            <g id="concatenation">
                                <path d="M 70 90 Q 100 90 100 130 M 70 180 Q 100 180 100 130" stroke="white" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
                                <rect x="110" y="80" width="40" height="100" fill="rgba(168, 237, 234, 0.3)" stroke="#a8edea" stroke-width="2" rx="5"/>
                                <text x="130" y="130" text-anchor="middle" fill="white" font-size="12">228Ã—1</text>
                            </g>

                            <!-- æƒé‡çŸ©é˜µ -->
                            <g id="weight-matrix">
                                <rect x="200" y="60" width="80" height="120" fill="rgba(240, 147, 251, 0.3)" stroke="#f093fb" stroke-width="2" rx="5"/>
                                <text x="240" y="45" text-anchor="middle" fill="#f093fb" font-size="14">W<tspan dy="3" font-size="10">f</tspan></text>
                                <text x="240" y="120" text-anchor="middle" fill="white" font-size="12">128Ã—228</text>

                                <!-- çŸ©é˜µç½‘æ ¼ -->
                                <g opacity="0.5">
                                    <line x1="210" y1="80" x2="270" y2="80" stroke="white" stroke-width="0.5"/>
                                    <line x1="210" y1="100" x2="270" y2="100" stroke="white" stroke-width="0.5"/>
                                    <line x1="210" y1="120" x2="270" y2="120" stroke="white" stroke-width="0.5"/>
                                    <line x1="210" y1="140" x2="270" y2="140" stroke="white" stroke-width="0.5"/>
                                    <line x1="210" y1="160" x2="270" y2="160" stroke="white" stroke-width="0.5"/>

                                    <line x1="230" y1="70" x2="230" y2="170" stroke="white" stroke-width="0.5"/>
                                    <line x1="250" y1="70" x2="250" y2="170" stroke="white" stroke-width="0.5"/>
                                </g>
                            </g>

                            <!-- ç»“æœ -->
                            <g id="result">
                                <path d="M 160 130 L 190 120 M 280 120 L 310 110" stroke="white" stroke-width="2" marker-end="url(#arrowhead)"/>
                                <rect x="320" y="80" width="40" height="80" fill="rgba(245, 87, 108, 0.3)" stroke="#f5576c" stroke-width="2" rx="5"/>
                                <text x="340" y="120" text-anchor="middle" fill="white" font-size="14">f<tspan dy="3" font-size="10">t</tspan></text>
                                <text x="340" y="140" text-anchor="middle" fill="white" font-size="12">128Ã—1</text>
                            </g>

                            <!-- ç®­å¤´å®šä¹‰ -->
                            <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="white"/>
                                </marker>
                            </defs>
                        </svg>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>ç¬¦å·å«ä¹‰</h4>
                    <div class="formula-meaning">
                        <div class="meaning-item" data-symbol="f_t">
                            <strong>f<sub>t</sub></strong>: é—å¿˜é—¨è¾“å‡º
                            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                èŒƒå›´[0,1]ï¼Œå†³å®šä¿ç•™å¤šå°‘è¿‡å»çš„ä¿¡æ¯
                            </p>
                        </div>
                        <div class="meaning-item" data-symbol="sigma">
                            <strong>Ïƒ</strong>: Sigmoidæ¿€æ´»å‡½æ•°
                            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                å°†å€¼å‹ç¼©åˆ°[0,1]ï¼Œå……å½“"é—¨"çš„ä½œç”¨
                            </p>
                        </div>
                        <div class="meaning-item" data-symbol="W_f">
                            <strong>W<sub>f</sub></strong>: é—å¿˜é—¨æƒé‡çŸ©é˜µ
                            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                å­¦ä¹ ä»€ä¹ˆæ¨¡å¼åº”è¯¥è¢«é—å¿˜
                            </p>
                        </div>
                        <div class="meaning-item" data-symbol="h_t-1">
                            <strong>h<sub>t-1</sub></strong>: ä¸Šä¸€æ—¶åˆ»éšè—çŠ¶æ€
                            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                åŒ…å«å†å²ä¿¡æ¯çš„å‘é‡
                            </p>
                        </div>
                        <div class="meaning-item" data-symbol="x_t">
                            <strong>x<sub>t</sub></strong>: å½“å‰æ—¶åˆ»è¾“å…¥
                            <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                æ–°çš„è¾“å…¥ä¿¡æ¯
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ‰‹åŠ¨è®¡ç®—åŠ¨ç”» -->
            <div class="step-animation">
                <h3 style="color: var(--accent-cyan); margin-bottom: 1.5rem;">ğŸ¬ æ‰‹åŠ¨è®¡ç®—æ¼”ç¤º</h3>

                <div class="step-indicator">
                    <span class="step-dot active" data-step="0"></span>
                    <span class="step-dot" data-step="1"></span>
                    <span class="step-dot" data-step="2"></span>
                    <span class="step-dot" data-step="3"></span>
                </div>

                <div class="step-content" id="stepContent">
                    <div class="step-visual active" data-step-content="0">
                        <div style="text-align: center;">
                            <h4 style="color: var(--accent-cyan); margin-bottom: 2rem;">æ­¥éª¤1ï¼šå‡†å¤‡è¾“å…¥</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; max-width: 600px; margin: 0 auto;">
                                <div>
                                    <h5 style="color: var(--accent-pink); margin-bottom: 1rem;">è¾“å…¥å€¼ï¼š</h5>
                                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                                        <p style="font-family: monospace; font-size: 1.1rem;">x_t = [0.5, -0.2]</p>
                                        <p style="font-family: monospace; font-size: 1.1rem;">h_{t-1} = [0.3, 0.1]</p>
                                    </div>
                                </div>
                                <div>
                                    <h5 style="color: var(--accent-blue); margin-bottom: 1rem;">æ‹¼æ¥ç»“æœï¼š</h5>
                                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                                        <p style="font-family: monospace; font-size: 1.1rem;">[h_{t-1}, x_t] = </p>
                                        <p style="font-family: monospace; font-size: 1.1rem;">[0.3, 0.1, 0.5, -0.2]</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="step-visual" data-step-content="1">
                        <div style="text-align: center;">
                            <h4 style="color: var(--accent-cyan); margin-bottom: 2rem;">æ­¥éª¤2ï¼šçŸ©é˜µä¹˜æ³•</h4>
                            <div style="max-width: 700px; margin: 0 auto;">
                                <div class="matrix-container">
                                    <div class="matrix-bracket left"></div>
                                    <div class="matrix-grid" style="grid-template-columns: repeat(4, 1fr);">
                                        <div class="matrix-cell">0.1</div>
                                        <div class="matrix-cell">0.2</div>
                                        <div class="matrix-cell">-0.1</div>
                                        <div class="matrix-cell">0.3</div>
                                        <div class="matrix-cell">0.2</div>
                                        <div class="matrix-cell">-0.1</div>
                                        <div class="matrix-cell">0.1</div>
                                        <div class="matrix-cell">0.2</div>
                                    </div>
                                    <div class="matrix-bracket right"></div>
                                </div>
                                <p style="font-size: 1.5rem; margin: 1rem;">Ã—</p>
                                <div class="matrix-container">
                                    <div class="matrix-bracket left"></div>
                                    <div class="matrix-grid" style="grid-template-columns: 1fr;">
                                        <div class="matrix-cell">0.3</div>
                                        <div class="matrix-cell">0.1</div>
                                        <div class="matrix-cell">0.5</div>
                                        <div class="matrix-cell">-0.2</div>
                                    </div>
                                    <div class="matrix-bracket right"></div>
                                </div>
                                <p style="font-size: 1.5rem; margin: 1rem;">=</p>
                                <div class="matrix-container">
                                    <div class="matrix-bracket left"></div>
                                    <div class="matrix-grid" style="grid-template-columns: 1fr;">
                                        <div class="matrix-cell" style="background: rgba(79, 172, 254, 0.3);">0.04</div>
                                        <div class="matrix-cell" style="background: rgba(79, 172, 254, 0.3);">0.12</div>
                                    </div>
                                    <div class="matrix-bracket right"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="step-visual" data-step-content="2">
                        <div style="text-align: center;">
                            <h4 style="color: var(--accent-cyan); margin-bottom: 2rem;">æ­¥éª¤3ï¼šåŠ åç½®</h4>
                            <div style="max-width: 500px; margin: 0 auto;">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 2rem;">
                                    <div>
                                        <p>z_f = </p>
                                    </div>
                                    <div class="matrix-container">
                                        <div class="matrix-bracket left"></div>
                                        <div class="matrix-grid" style="grid-template-columns: 1fr;">
                                            <div class="matrix-cell">0.04</div>
                                            <div class="matrix-cell">0.12</div>
                                        </div>
                                        <div class="matrix-bracket right"></div>
                                    </div>
                                    <div>
                                        <p>+</p>
                                    </div>
                                    <div class="matrix-container">
                                        <div class="matrix-bracket left"></div>
                                        <div class="matrix-grid" style="grid-template-columns: 1fr;">
                                            <div class="matrix-cell">0.5</div>
                                            <div class="matrix-cell">0.5</div>
                                        </div>
                                        <div class="matrix-bracket right"></div>
                                    </div>
                                    <div>
                                        <p>=</p>
                                    </div>
                                    <div class="matrix-container">
                                        <div class="matrix-bracket left"></div>
                                        <div class="matrix-grid" style="grid-template-columns: 1fr;">
                                            <div class="matrix-cell" style="background: rgba(240, 147, 251, 0.3);">0.54</div>
                                            <div class="matrix-cell" style="background: rgba(240, 147, 251, 0.3);">0.62</div>
                                        </div>
                                        <div class="matrix-bracket right"></div>
                                    </div>
                                </div>
                                <p style="margin-top: 2rem; color: var(--text-secondary);">
                                    ğŸ’¡ åç½®åˆå§‹åŒ–ä¸ºæ­£å€¼ï¼ˆå¦‚0.5ï¼‰å¯ä»¥ä¿ƒè¿›åˆæœŸçš„ä¿¡æ¯ä¿ç•™
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="step-visual" data-step-content="3">
                        <div style="text-align: center;">
                            <h4 style="color: var(--accent-cyan); margin-bottom: 2rem;">æ­¥éª¤4ï¼šSigmoidæ¿€æ´»</h4>
                            <div style="max-width: 600px; margin: 0 auto;">
                                <p style="font-size: 1.2rem; margin-bottom: 2rem;">
                                    f_t = Ïƒ(z_f) = Ïƒ([0.54, 0.62])
                                </p>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                                        <p>Ïƒ(0.54) = 1/(1+e^(-0.54))</p>
                                        <p>= 1/(1+0.583)</p>
                                        <p style="color: var(--accent-pink); font-weight: bold;">= 0.632</p>
                                    </div>
                                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                                        <p>Ïƒ(0.62) = 1/(1+e^(-0.62))</p>
                                        <p>= 1/(1+0.538)</p>
                                        <p style="color: var(--accent-pink); font-weight: bold;">= 0.650</p>
                                    </div>
                                </div>
                                <div class="tip success" style="margin-top: 2rem;">
                                    <span style="font-size: 1.5rem;">âœ…</span>
                                    <div>
                                        é—å¿˜é—¨è¾“å‡ºçº¦63%å’Œ65%ï¼Œè¡¨ç¤ºä¿ç•™å¤§éƒ¨åˆ†ä¹‹å‰çš„è®°å¿†ï¼
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="display: flex; justify-content: center; gap: 1rem; margin-top: 2rem;">
                    <button class="btn btn-secondary" id="prevStep">â¬…ï¸ ä¸Šä¸€æ­¥</button>
                    <button class="btn btn-primary" id="nextStep">ä¸‹ä¸€æ­¥ â¡ï¸</button>
                </div>
            </div>
        </section>

        <!-- è¾“å…¥é—¨è¯¦è§£ -->
        <section id="input-gate" class="section-card">
            <h2 style="color: var(--accent-blue); margin-bottom: 2rem;">â• è¾“å…¥é—¨ï¼šé€‰æ‹©è®°å¿†</h2>

            <div class="story-card">
                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">ğŸ‘©â€ğŸ”¬</div>
                        è®¾è®¡è€…ï¼š
                    </div>
                    <div>"ç°åœ¨æˆ‘ä»¬éœ€è¦å†³å®šå­˜å‚¨ä»€ä¹ˆæ–°ä¿¡æ¯ã€‚ä½†è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªä¸œè¥¿..."</div>
                </div>

                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘¨â€ğŸ”¬</div>
                        åŒäº‹ï¼š
                    </div>
                    <div>"å¯¹ï¼æˆ‘ä»¬éœ€è¦ï¼š<br>
                        1. å€™é€‰è®°å¿†å†…å®¹ - è¦è®°ä½ä»€ä¹ˆ<br>
                        2. é‡è¦æ€§æƒé‡ - è®°ä½å¤šå°‘"</div>
                </div>
            </div>

            <div class="think-card">
                <h3>ğŸ¤” æ€è€ƒï¼šä¸ºä»€ä¹ˆéœ€è¦ä¸¤ä¸ªéƒ¨åˆ†ï¼Ÿ</h3>
                <p>è¾“å…¥é—¨åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šè¾“å…¥é—¨æ¿€æ´» i<sub>t</sub> å’Œå€™é€‰å€¼ CÌƒ<sub>t</sub>ã€‚ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ç”¨ä¸€ä¸ªï¼Ÿ</p>

                <div class="think-options">
                    <div class="think-option" data-answer="a">
                        A. å¢åŠ æ¨¡å‹å®¹é‡
                    </div>
                    <div class="think-option" data-answer="b">
                        B. åˆ†ç¦»"ä»€ä¹ˆ"å’Œ"å¤šå°‘"
                    </div>
                    <div class="think-option" data-answer="c">
                        C. å‡å°‘è®¡ç®—é‡
                    </div>
                    <div class="think-option" data-answer="d">
                        D. ç¬¦åˆç”Ÿç‰©å­¦åŸç†
                    </div>
                </div>

                <div class="think-feedback" id="thinkFeedback2">
                    <!-- åé¦ˆå†…å®¹å°†åŠ¨æ€æ’å…¥ -->
                </div>
            </div>

            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>æ•°å­¦å…¬å¼</h4>
                    <div class="formula-math">
                        <div style="margin-bottom: 1rem;">
                            i<sub>t</sub> = Ïƒ(W<sub>i</sub> Â· [h<sub>t-1</sub>, x<sub>t</sub>] + b<sub>i</sub>)
                        </div>
                        <div>
                            CÌƒ<sub>t</sub> = tanh(W<sub>C</sub> Â· [h<sub>t-1</sub>, x<sub>t</sub>] + b<sub>C</sub>)
                        </div>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>ä½œç”¨è§£é‡Š</h4>
                    <div style="display: grid; gap: 1rem;">
                        <div style="background: rgba(79, 172, 254, 0.1); padding: 1.5rem; border-radius: 0.5rem;">
                            <h5 style="color: var(--accent-blue); margin-bottom: 0.5rem;">è¾“å…¥é—¨ i<sub>t</sub></h5>
                            <p>å†³å®š"é‡è¦æ€§"æƒé‡</p>
                            <p style="font-size: 0.9rem; color: var(--text-secondary);">ä½¿ç”¨sigmoidï¼Œè¾“å‡º[0,1]</p>
                        </div>
                        <div style="background: rgba(67, 233, 123, 0.1); padding: 1.5rem; border-radius: 0.5rem;">
                            <h5 style="color: var(--accent-green); margin-bottom: 0.5rem;">å€™é€‰å€¼ CÌƒ<sub>t</sub></h5>
                            <p>ç¼–ç "å†…å®¹"ä¿¡æ¯</p>
                            <p style="font-size: 0.9rem; color: var(--text-secondary);">ä½¿ç”¨tanhï¼Œè¾“å‡º[-1,1]</p>
                        </div>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>ç»„åˆæ•ˆæœ</h4>
                    <div style="text-align: center; padding: 2rem;">
                        <p style="font-size: 1.2rem; margin-bottom: 1rem;">æ–°å¢è®°å¿† = i<sub>t</sub> âŠ™ CÌƒ<sub>t</sub></p>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                            <p>é€šè¿‡<span class="term-tooltip">Hadamardç§¯<span class="tooltip-content">é€å…ƒç´ ä¹˜æ³•ï¼Œä¿æŒç»´åº¦ä¸å˜</span></span>å®ç°é€‰æ‹©æ€§æ›´æ–°</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç»†èƒçŠ¶æ€æ›´æ–° -->
        <section id="cell-state" class="section-card">
            <h2 style="color: var(--accent-orange); margin-bottom: 2rem;">ğŸ“¦ ç»†èƒçŠ¶æ€æ›´æ–°ï¼šé•¿æœŸè®°å¿†çš„é«˜é€Ÿå…¬è·¯</h2>

            <div class="visualization-container">
                <h3 style="color: var(--accent-cyan); margin-bottom: 1.5rem;">ğŸ›¤ï¸ ä¿¡æ¯é«˜é€Ÿå…¬è·¯</h3>
                <canvas id="cellStateHighway" width="900" height="400"></canvas>
            </div>

            <div class="math-derivation">
                <h3 style="color: var(--accent-orange); margin-bottom: 1.5rem;">ğŸ“ ç»†èƒçŠ¶æ€æ›´æ–°å…¬å¼</h3>

                <div style="text-align: center; padding: 2rem; background: rgba(255, 255, 255, 0.05); border-radius: 1rem;">
                    <p style="font-size: 1.5rem;">
                        C<sub>t</sub> = f<sub>t</sub> âŠ™ C<sub>t-1</sub> + i<sub>t</sub> âŠ™ CÌƒ<sub>t</sub>
                    </p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 2rem; text-align: left;">
                        <div>
                            <p style="color: var(--accent-pink);">f<sub>t</sub> âŠ™ C<sub>t-1</sub></p>
                            <p style="font-size: 0.9rem; color: var(--text-secondary);">ä¿ç•™çš„æ—§è®°å¿†</p>
                        </div>
                        <div>
                            <p style="color: var(--accent-blue);">i<sub>t</sub> âŠ™ CÌƒ<sub>t</sub></p>
                            <p style="font-size: 0.9rem; color: var(--text-secondary);">æ·»åŠ çš„æ–°è®°å¿†</p>
                        </div>
                    </div>
                </div>

                <div class="tip success" style="margin-top: 2rem;">
                    <span style="font-size: 1.5rem;">ğŸ’¡</span>
                    <div>
                        <strong>å…³é”®æ´å¯Ÿï¼š</strong>ç»†èƒçŠ¶æ€çš„æ›´æ–°æ˜¯<strong>çº¿æ€§çš„</strong>ï¼æ²¡æœ‰æ¿€æ´»å‡½æ•°ï¼Œè¿™ä½¿å¾—æ¢¯åº¦å¯ä»¥æ— æŸä¼ æ’­ã€‚
                        è¿™å°±æ˜¯LSTMè§£å†³æ¢¯åº¦æ¶ˆå¤±çš„æ ¸å¿ƒç§˜å¯†ã€‚
                    </div>
                </div>
            </div>
        </section>

        <!-- è¾“å‡ºé—¨è¯¦è§£ -->
        <section id="output-gate" class="section-card">
            <h2 style="color: var(--accent-green); margin-bottom: 2rem;">ğŸ“¤ è¾“å‡ºé—¨ï¼šæŒ‰éœ€æå–</h2>

            <div class="story-card">
                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">ğŸ‘¨â€ğŸ”¬</div>
                        è®¾è®¡è€…ï¼š
                    </div>
                    <div>"ç»†èƒçŠ¶æ€åŒ…å«äº†æ‰€æœ‰è®°å¿†ï¼Œä½†æˆ‘ä»¬ä¸éœ€è¦åœ¨æ¯ä¸ªæ—¶åˆ»è¾“å‡ºæ‰€æœ‰ä¿¡æ¯ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¿‡æ»¤å™¨ï¼"</div>
                </div>
            </div>

            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>æ•°å­¦å…¬å¼</h4>
                    <div class="formula-math">
                        <div style="margin-bottom: 1rem;">
                            o<sub>t</sub> = Ïƒ(W<sub>o</sub> Â· [h<sub>t-1</sub>, x<sub>t</sub>] + b<sub>o</sub>)
                        </div>
                        <div>
                            h<sub>t</sub> = o<sub>t</sub> âŠ™ tanh(C<sub>t</sub>)
                        </div>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>ç›´è§‚ç†è§£</h4>
                    <div style="text-align: center; padding: 1rem;">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDMwMCAyMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8IS0tIENlbGwgU3RhdGUgLS0+CiAgICA8cmVjdCB4PSI1MCIgeT0iNTAiIHdpZHRoPSIyMDAiIGhlaWdodD0iNDAiIGZpbGw9InJnYmEoMjUwLCAxMTIsIDE1NCwgMC4zKSIgc3Ryb2tlPSIjZmE3MDlhIiBzdHJva2Utd2lkdGg9IjIiIHJ4PSI1Ii8+CiAgICA8dGV4dCB4PSIxNTAiIHk9Ijc1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSI+Q2VsbCBTdGF0ZTwvdGV4dD4KICAgIAogICAgPCEtLSBUYW5oIC0tPgogICAgPGNpcmNsZSBjeD0iMTUwIiBjeT0iMTIwIiByPSIyMCIgZmlsbD0icmdiYSg2NywgMjMzLCAxMjMsIDAuMykiIHN0cm9rZT0iIzQzZTk3YiIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICA8dGV4dCB4PSIxNTAiIHk9IjEyNSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtc2l6ZT0iMTIiPnRhbmg8L3RleHQ+CiAgICAKICAgIDwhLS0gT3V0cHV0IEdhdGUgLS0+CiAgICA8Y2lyY2xlIGN4PSI4MCIgY3k9IjE2MCIgcj0iMjAiIGZpbGw9InJnYmEoNjcsIDIzMywgMTIzLCAwLjUpIiBzdHJva2U9IiM0M2U5N2IiIHN0cm9rZS13aWR0aD0iMiIvPgogICAgPHRleHQgeD0iODAiIHk9IjE2NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtc2l6ZT0iMTIiPm88L3RleHQ+CiAgICAKICAgIDwhLS0gQXJyb3dzIC0tPgogICAgPHBhdGggZD0iTSAxNTAgOTAgTCAxNTAgMTAwIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIG1hcmtlci1lbmQ9InVybCgjYXJyb3cpIi8+CiAgICA8cGF0aCBkPSJNIDEwMCAxNjAgTCAxMzAgMTQwIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIG1hcmtlci1lbmQ9InVybCgjYXJyb3cpIi8+CiAgICAKICAgIDwhLS0gQXJyb3cgZGVmaW5pdGlvbiAtLT4KICAgIDxkZWZzPgogICAgICAgIDxtYXJrZXIgaWQ9ImFycm93IiBtYXJrZXJXaWR0aD0iMTAiIG1hcmtlckhlaWdodD0iNyIgcmVmWD0iOSIgcmVmWT0iMy41IiBvcmllbnQ9ImF1dG8iPgogICAgICAgICAgICA8cG9seWdvbiBwb2ludHM9IjAgMCwgMTAgMy41LCAwIDciIGZpbGw9IndoaXRlIi8+CiAgICAgICAgPC9tYXJrZXI+CiAgICA8L2RlZnM+Cjwvc3ZnPg==" alt="è¾“å‡ºé—¨ç¤ºæ„å›¾" style="max-width: 100%;">
                        <p style="margin-top: 1rem; color: var(--text-secondary);">
                            è¾“å‡ºé—¨å†³å®šä»å‹ç¼©åçš„ç»†èƒçŠ¶æ€ä¸­<br>æå–å“ªäº›ä¿¡æ¯ä½œä¸ºè¾“å‡º
                        </p>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>ä¸ºä»€ä¹ˆè¦tanhï¼Ÿ</h4>
                    <div style="padding: 1.5rem;">
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 1rem;">
                                <span style="color: var(--accent-green); font-weight: bold;">âœ“</span>
                                å°†ç»†èƒçŠ¶æ€å‹ç¼©åˆ°[-1, 1]
                            </li>
                            <li style="margin-bottom: 1rem;">
                                <span style="color: var(--accent-green); font-weight: bold;">âœ“</span>
                                ä¸ç½‘ç»œå…¶ä»–éƒ¨åˆ†ä¿æŒä¸€è‡´
                            </li>
                            <li style="margin-bottom: 1rem;">
                                <span style="color: var(--accent-green); font-weight: bold;">âœ“</span>
                                å¢åŠ éçº¿æ€§è¡¨è¾¾èƒ½åŠ›
                            </li>
                            <li>
                                <span style="color: var(--accent-green); font-weight: bold;">âœ“</span>
                                é˜²æ­¢æ•°å€¼æº¢å‡º
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- LSTMå®Œæ•´ç»“æ„ -->
        <section id="complete-lstm" class="section-card">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">ğŸ—ï¸ LSTMå®Œæ•´ç»“æ„</h2>

            <div style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(236, 72, 153, 0.05)); padding: 2.5rem; border-radius: 1rem; margin-bottom: 2rem;">
                <h3 style="text-align: center; color: var(--accent-purple); margin-bottom: 2rem;">LSTMå®Œæ•´å…¬å¼æ±‡æ€»</h3>

                <div style="display: grid; gap: 1rem; max-width: 800px; margin: 0 auto; font-size: 1.1rem;">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem 1.5rem; border-radius: 0.5rem; display: flex; align-items: center;">
                        <span style="color: var(--accent-pink); margin-right: 1rem;">é—å¿˜é—¨ï¼š</span>
                        <span style="font-family: monospace;">f_t = Ïƒ(W_f Â· [h_{t-1}, x_t] + b_f)</span>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem 1.5rem; border-radius: 0.5rem; display: flex; align-items: center;">
                        <span style="color: var(--accent-blue); margin-right: 1rem;">è¾“å…¥é—¨ï¼š</span>
                        <span style="font-family: monospace;">i_t = Ïƒ(W_i Â· [h_{t-1}, x_t] + b_i)</span>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem 1.5rem; border-radius: 0.5rem; display: flex; align-items: center;">
                        <span style="color: var(--accent-cyan); margin-right: 1rem;">å€™é€‰å€¼ï¼š</span>
                        <span style="font-family: monospace;">CÌƒ_t = tanh(W_C Â· [h_{t-1}, x_t] + b_C)</span>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem 1.5rem; border-radius: 0.5rem; display: flex; align-items: center;">
                        <span style="color: var(--accent-orange); margin-right: 1rem;">ç»†èƒæ€ï¼š</span>
                        <span style="font-family: monospace;">C_t = f_t âŠ™ C_{t-1} + i_t âŠ™ CÌƒ_t</span>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem 1.5rem; border-radius: 0.5rem; display: flex; align-items: center;">
                        <span style="color: var(--accent-green); margin-right: 1rem;">è¾“å‡ºé—¨ï¼š</span>
                        <span style="font-family: monospace;">o_t = Ïƒ(W_o Â· [h_{t-1}, x_t] + b_o)</span>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem 1.5rem; border-radius: 0.5rem; display: flex; align-items: center;">
                        <span style="color: var(--accent-yellow); margin-right: 1rem;">éšè—æ€ï¼š</span>
                        <span style="font-family: monospace;">h_t = o_t âŠ™ tanh(C_t)</span>
                    </div>
                </div>
            </div>

            <div class="comparison-table">
                <table>
                    <thead>
                    <tr>
                        <th>ç»„ä»¶</th>
                        <th>ä½œç”¨</th>
                        <th>æ¿€æ´»å‡½æ•°</th>
                        <th>è¾“å‡ºèŒƒå›´</th>
                        <th>å…³é”®ç‰¹æ€§</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><strong>é—å¿˜é—¨</strong></td>
                        <td>å†³å®šå¿˜è®°ä»€ä¹ˆ</td>
                        <td>Sigmoid</td>
                        <td>[0, 1]</td>
                        <td>é€‰æ‹©æ€§é—å¿˜</td>
                    </tr>
                    <tr>
                        <td><strong>è¾“å…¥é—¨</strong></td>
                        <td>å†³å®šå­˜å‚¨æƒé‡</td>
                        <td>Sigmoid</td>
                        <td>[0, 1]</td>
                        <td>æ§åˆ¶æ›´æ–°å¼ºåº¦</td>
                    </tr>
                    <tr>
                        <td><strong>å€™é€‰å€¼</strong></td>
                        <td>æ–°çš„è®°å¿†å†…å®¹</td>
                        <td>Tanh</td>
                        <td>[-1, 1]</td>
                        <td>ç¼–ç æ–°ä¿¡æ¯</td>
                    </tr>
                    <tr>
                        <td><strong>ç»†èƒçŠ¶æ€</strong></td>
                        <td>é•¿æœŸè®°å¿†å­˜å‚¨</td>
                        <td>çº¿æ€§</td>
                        <td>(-âˆ, +âˆ)</td>
                        <td>æ¢¯åº¦é«˜é€Ÿå…¬è·¯</td>
                    </tr>
                    <tr>
                        <td><strong>è¾“å‡ºé—¨</strong></td>
                        <td>å†³å®šè¾“å‡ºä»€ä¹ˆ</td>
                        <td>Sigmoid</td>
                        <td>[0, 1]</td>
                        <td>ä¿¡æ¯è¿‡æ»¤</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- æ•°å­¦è¯æ˜ -->
        <section id="math-proof" class="section-card">
            <h2 style="color: var(--accent-red); margin-bottom: 2rem;">ğŸ”¬ æ•°å­¦è¯æ˜ï¼šLSTMå¦‚ä½•è§£å†³æ¢¯åº¦æ¶ˆå¤±</h2>

            <div class="math-derivation">
                <h3 style="color: var(--accent-red); margin-bottom: 1.5rem;">ğŸ“ æ¢¯åº¦ä¼ æ’­åˆ†æ</h3>

                <div class="derivation-step">
                    <div class="derivation-step-number">1</div>
                    <h4>ç»†èƒçŠ¶æ€çš„æ¢¯åº¦ä¼ æ’­</h4>
                    <p>ä»ç»†èƒçŠ¶æ€æ›´æ–°å…¬å¼å‡ºå‘ï¼š</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $$C_t = f_t \odot C_{t-1} + i_t \odot \tilde{C}_t$$
                    </div>
                    <p>è®¡ç®—æ¢¯åº¦ï¼š</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $$\frac{\partial C_t}{\partial C_{t-1}} = \text{diag}(f_t)$$
                    </div>
                </div>

                <div class="derivation-step">
                    <div class="derivation-step-number">2</div>
                    <h4>å…³é”®æ´å¯Ÿ</h4>
                    <p>æ¢¯åº¦é€šè¿‡<strong>å¯¹è§’çŸ©é˜µ</strong>ä¼ æ’­ï¼Œè€Œä¸æ˜¯å¯†é›†çŸ©é˜µï¼</p>
                    <div class="tip success">
                        <span style="font-size: 1.5rem;">ğŸ’¡</span>
                        <div>
                            è¿™æ„å‘³ç€ï¼š
                            <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                                <li>æ¯ä¸ªç»´åº¦çš„æ¢¯åº¦ç‹¬ç«‹ä¼ æ’­</li>
                                <li>æ²¡æœ‰ä¿¡æ¯æ··åˆ</li>
                                <li>ç½‘ç»œå¯ä»¥å­¦ä¹ è®© f_t â‰ˆ 1 æ¥ä¿æŒæ¢¯åº¦</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="derivation-step">
                    <div class="derivation-step-number">3</div>
                    <h4>ä¸RNNå¯¹æ¯”</h4>
                    <div class="comparison-table">
                        <table>
                            <thead>
                            <tr>
                                <th>æ¨¡å‹</th>
                                <th>æ¢¯åº¦ä¼ æ’­</th>
                                <th>100æ­¥åæ¢¯åº¦</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>RNN</td>
                                <td>$(W_{hh}^T \cdot \text{diag}(\tanh'))^{100}$</td>
                                <td>â‰ˆ 10â»Â³â°</td>
                            </tr>
                            <tr>
                                <td>LSTM</td>
                                <td>$\prod_{t=1}^{100} \text{diag}(f_t)$</td>
                                <td>â‰ˆ 10â»âµ</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- ä»£ç å®ç° -->
        <section id="implementation" class="section-card">
            <h2 style="color: var(--accent-yellow); margin-bottom: 2rem;">ğŸ› ï¸ ä»é›¶å®ç°LSTM</h2>

            <div class="code-layers">
                <div class="code-layer-tabs">
                    <button class="code-layer-tab active" data-layer="pseudo">ä¼ªä»£ç </button>
                    <button class="code-layer-tab" data-layer="numpy">NumPyå®ç°</button>
                    <button class="code-layer-tab" data-layer="pytorch">PyTorchå®ç°</button>
                    <button class="code-layer-tab" data-layer="tensorflow">TensorFlowå®ç°</button>
                </div>

                <div class="code-layer-content active" data-layer-content="pseudo">
                    <pre><code class="language-plaintext">LSTMå‰å‘ä¼ æ’­ç®—æ³•ï¼š

è¾“å…¥ï¼šå½“å‰è¾“å…¥ x_t, ä¸Šä¸€éšè—çŠ¶æ€ h_{t-1}, ä¸Šä¸€ç»†èƒçŠ¶æ€ C_{t-1}
è¾“å‡ºï¼šå½“å‰éšè—çŠ¶æ€ h_t, å½“å‰ç»†èƒçŠ¶æ€ C_t

ç®—æ³•æ­¥éª¤ï¼š
1. è®¡ç®—é—å¿˜é—¨ï¼š
   f_t = sigmoid(W_f Â· [h_{t-1}, x_t] + b_f)

2. è®¡ç®—è¾“å…¥é—¨å’Œå€™é€‰å€¼ï¼š
   i_t = sigmoid(W_i Â· [h_{t-1}, x_t] + b_i)
   C_tilde_t = tanh(W_C Â· [h_{t-1}, x_t] + b_C)

3. æ›´æ–°ç»†èƒçŠ¶æ€ï¼š
   C_t = f_t âŠ™ C_{t-1} + i_t âŠ™ C_tilde_t

4. è®¡ç®—è¾“å‡ºé—¨å’Œéšè—çŠ¶æ€ï¼š
   o_t = sigmoid(W_o Â· [h_{t-1}, x_t] + b_o)
   h_t = o_t âŠ™ tanh(C_t)

è¿”å› h_t, C_t</code></pre>
                </div>

                <div class="code-layer-content" data-layer-content="numpy">
                    <pre><code class="language-python">import numpy as np

class LSTMCell:
    """LSTMå•å…ƒçš„NumPyå®ç°"""

    def __init__(self, input_dim, hidden_dim):
        # åˆå§‹åŒ–æƒé‡çŸ©é˜µ - Xavieråˆå§‹åŒ–
        scale = np.sqrt(2.0 / (input_dim + hidden_dim))

        # é—å¿˜é—¨å‚æ•°
        self.Wf = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bf = np.ones((hidden_dim, 1))  # åˆå§‹åŒ–ä¸º1ï¼Œä¿ƒè¿›è®°å¿†

        # è¾“å…¥é—¨å‚æ•°
        self.Wi = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bi = np.zeros((hidden_dim, 1))

        # å€™é€‰å€¼å‚æ•°
        self.Wc = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bc = np.zeros((hidden_dim, 1))

        # è¾“å‡ºé—¨å‚æ•°
        self.Wo = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bo = np.zeros((hidden_dim, 1))

    def forward(self, x_t, h_prev, c_prev):
        """LSTMå‰å‘ä¼ æ’­"""
        # æ‹¼æ¥è¾“å…¥ [h_{t-1}, x_t]
        concat = np.vstack([h_prev, x_t])

        # è®¡ç®—å››ä¸ªé—¨
        f_t = self.sigmoid(np.dot(self.Wf, concat) + self.bf)  # é—å¿˜é—¨
        i_t = self.sigmoid(np.dot(self.Wi, concat) + self.bi)  # è¾“å…¥é—¨
        c_tilde_t = np.tanh(np.dot(self.Wc, concat) + self.bc)  # å€™é€‰å€¼
        o_t = self.sigmoid(np.dot(self.Wo, concat) + self.bo)  # è¾“å‡ºé—¨

        # æ›´æ–°ç»†èƒçŠ¶æ€
        c_t = f_t * c_prev + i_t * c_tilde_t

        # è®¡ç®—éšè—çŠ¶æ€
        h_t = o_t * np.tanh(c_t)

        # ä¿å­˜ä¸­é—´ç»“æœç”¨äºåå‘ä¼ æ’­
        cache = {
            'x_t': x_t, 'h_prev': h_prev, 'c_prev': c_prev,
            'f_t': f_t, 'i_t': i_t, 'c_tilde_t': c_tilde_t, 'o_t': o_t,
            'c_t': c_t, 'concat': concat
        }

        return h_t, c_t, cache

    def backward(self, dh_next, dc_next, cache):
        """LSTMåå‘ä¼ æ’­"""
        # è§£åŒ…ç¼“å­˜
        x_t = cache['x_t']
        h_prev = cache['h_prev']
        c_prev = cache['c_prev']
        f_t = cache['f_t']
        i_t = cache['i_t']
        c_tilde_t = cache['c_tilde_t']
        o_t = cache['o_t']
        c_t = cache['c_t']
        concat = cache['concat']

        # è®¡ç®—å„ä¸ªé—¨çš„æ¢¯åº¦
        do_t = dh_next * np.tanh(c_t)
        dc_t = dc_next + dh_next * o_t * (1 - np.tanh(c_t)**2)

        df_t = dc_t * c_prev
        di_t = dc_t * c_tilde_t
        dc_tilde_t = dc_t * i_t
        dc_prev = dc_t * f_t

        # é€šè¿‡æ¿€æ´»å‡½æ•°çš„æ¢¯åº¦
        dzo_t = do_t * o_t * (1 - o_t)
        dzf_t = df_t * f_t * (1 - f_t)
        dzi_t = di_t * i_t * (1 - i_t)
        dzc_t = dc_tilde_t * (1 - c_tilde_t**2)

        # è®¡ç®—æƒé‡æ¢¯åº¦
        self.dWo = np.dot(dzo_t, concat.T)
        self.dbo = dzo_t

        self.dWf = np.dot(dzf_t, concat.T)
        self.dbf = dzf_t

        self.dWi = np.dot(dzi_t, concat.T)
        self.dbi = dzi_t

        self.dWc = np.dot(dzc_t, concat.T)
        self.dbc = dzc_t

        # è®¡ç®—è¾“å…¥æ¢¯åº¦
        dconcat = (np.dot(self.Wf.T, dzf_t) +
                   np.dot(self.Wi.T, dzi_t) +
                   np.dot(self.Wc.T, dzc_t) +
                   np.dot(self.Wo.T, dzo_t))

        dh_prev = dconcat[:h_prev.shape[0]]
        dx_t = dconcat[h_prev.shape[0]:]

        return dx_t, dh_prev, dc_prev

    @staticmethod
    def sigmoid(x):
        """æ•°å€¼ç¨³å®šçš„sigmoidå‡½æ•°"""
        return np.where(x >= 0,
                       1 / (1 + np.exp(-x)),
                       np.exp(x) / (1 + np.exp(x)))

    @staticmethod
    def sigmoid_derivative(x):
        """sigmoidå¯¼æ•°"""
        s = LSTMCell.sigmoid(x)
        return s * (1 - s)

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºLSTMå•å…ƒ
    lstm = LSTMCell(input_dim=100, hidden_dim=128)

    # æ¨¡æ‹Ÿè¾“å…¥
    x_t = np.random.randn(100, 1)
    h_prev = np.zeros((128, 1))
    c_prev = np.zeros((128, 1))

    # å‰å‘ä¼ æ’­
    h_t, c_t, cache = lstm.forward(x_t, h_prev, c_prev)

    print(f"éšè—çŠ¶æ€å½¢çŠ¶: {h_t.shape}")
    print(f"ç»†èƒçŠ¶æ€å½¢çŠ¶: {c_t.shape}")
    print(f"éšè—çŠ¶æ€èŒƒå›´: [{h_t.min():.3f}, {h_t.max():.3f}]")
    print(f"ç»†èƒçŠ¶æ€èŒƒå›´: [{c_t.min():.3f}, {c_t.max():.3f}]")</code></pre>
                </div>

                <div class="code-layer-content" data-layer-content="pytorch">
                    <pre><code class="language-python">import torch
import torch.nn as nn
import torch.nn.functional as F

class LSTMCell(nn.Module):
    """PyTorch LSTMå•å…ƒå®ç°"""

    def __init__(self, input_size, hidden_size):
        super(LSTMCell, self).__init__()
        self.input_size = input_size
        self.hidden_size = hidden_size

        # åˆå¹¶æ‰€æœ‰é—¨çš„æƒé‡ï¼Œæé«˜è®¡ç®—æ•ˆç‡
        self.weight_ih = nn.Linear(input_size, 4 * hidden_size)
        self.weight_hh = nn.Linear(hidden_size, 4 * hidden_size)

        # åˆå§‹åŒ–å‚æ•°
        self.reset_parameters()

    def reset_parameters(self):
        """å‚æ•°åˆå§‹åŒ–"""
        std = 1.0 / (self.hidden_size)**0.5
        for weight in self.parameters():
            weight.data.uniform_(-std, std)

        # é—å¿˜é—¨åç½®åˆå§‹åŒ–ä¸º1
        self.weight_ih.bias.data[0:self.hidden_size].fill_(1.0)

    def forward(self, input, hidden):
        """
        å‰å‘ä¼ æ’­
        input: (batch, input_size)
        hidden: tuple of (h, c), each (batch, hidden_size)
        """
        hx, cx = hidden

        # è®¡ç®—æ‰€æœ‰é—¨
        gates = self.weight_ih(input) + self.weight_hh(hx)

        # åˆ†å‰²é—¨
        ingate, forgetgate, cellgate, outgate = gates.chunk(4, 1)

        # åº”ç”¨æ¿€æ´»å‡½æ•°
        ingate = torch.sigmoid(ingate)
        forgetgate = torch.sigmoid(forgetgate)
        cellgate = torch.tanh(cellgate)
        outgate = torch.sigmoid(outgate)

        # æ›´æ–°ç»†èƒçŠ¶æ€
        cy = forgetgate * cx + ingate * cellgate

        # è®¡ç®—éšè—çŠ¶æ€
        hy = outgate * torch.tanh(cy)

        return hy, cy


class LSTM(nn.Module):
    """å®Œæ•´çš„LSTMæ¨¡å‹"""

    def __init__(self, input_size, hidden_size, num_layers=1,
                 batch_first=True, dropout=0.0):
        super(LSTM, self).__init__()
        self.input_size = input_size
        self.hidden_size = hidden_size
        self.num_layers = num_layers
        self.batch_first = batch_first
        self.dropout = dropout

        # åˆ›å»ºLSTMå±‚
        self.lstm_layers = nn.ModuleList()
        for i in range(num_layers):
            layer_input_size = input_size if i == 0 else hidden_size
            self.lstm_layers.append(LSTMCell(layer_input_size, hidden_size))

        # Dropoutå±‚
        if dropout > 0:
            self.dropout_layer = nn.Dropout(dropout)

    def forward(self, input, hidden=None):
        """
        å‰å‘ä¼ æ’­
        input: (batch, seq_len, input_size) if batch_first=True
        hidden: tuple of (h0, c0), each (num_layers, batch, hidden_size)
        """
        if self.batch_first:
            batch_size, seq_len, _ = input.size()
        else:
            seq_len, batch_size, _ = input.size()
            input = input.transpose(0, 1)

        # åˆå§‹åŒ–éšè—çŠ¶æ€
        if hidden is None:
            h_0 = torch.zeros(self.num_layers, batch_size,
                            self.hidden_size, device=input.device)
            c_0 = torch.zeros(self.num_layers, batch_size,
                            self.hidden_size, device=input.device)
            hidden = (h_0, c_0)

        h_0, c_0 = hidden

        # å­˜å‚¨æ‰€æœ‰æ—¶é—´æ­¥çš„è¾“å‡º
        output = []

        # é€æ—¶é—´æ­¥å¤„ç†
        for t in range(seq_len):
            x_t = input[:, t, :]

            # é€å±‚å¤„ç†
            for layer in range(self.num_layers):
                h_t = h_0[layer]
                c_t = c_0[layer]

                # LSTMè®¡ç®—
                h_t, c_t = self.lstm_layers[layer](x_t, (h_t, c_t))

                # æ›´æ–°çŠ¶æ€
                h_0[layer] = h_t
                c_0[layer] = c_t

                # å‡†å¤‡ä¸‹ä¸€å±‚çš„è¾“å…¥
                x_t = h_t

                # Dropout (é™¤äº†æœ€åä¸€å±‚)
                if self.dropout > 0 and layer < self.num_layers - 1:
                    x_t = self.dropout_layer(x_t)

            output.append(h_t.unsqueeze(1))

        # åˆå¹¶è¾“å‡º
        output = torch.cat(output, dim=1)

        if not self.batch_first:
            output = output.transpose(0, 1)

        return output, (h_0, c_0)


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºæ¨¡å‹
    lstm = LSTM(input_size=100, hidden_size=256, num_layers=2,
                batch_first=True, dropout=0.1)

    # æ¨¡æ‹Ÿè¾“å…¥
    batch_size = 32
    seq_len = 50
    input_size = 100

    x = torch.randn(batch_size, seq_len, input_size)

    # å‰å‘ä¼ æ’­
    output, (h_n, c_n) = lstm(x)

    print(f"è¾“å…¥å½¢çŠ¶: {x.shape}")
    print(f"è¾“å‡ºå½¢çŠ¶: {output.shape}")
    print(f"æœ€ç»ˆéšè—çŠ¶æ€å½¢çŠ¶: {h_n.shape}")
    print(f"æœ€ç»ˆç»†èƒçŠ¶æ€å½¢çŠ¶: {c_n.shape}")

    # å‚æ•°ç»Ÿè®¡
    total_params = sum(p.numel() for p in lstm.parameters())
    print(f"æ€»å‚æ•°é‡: {total_params:,}")</code></pre>
                </div>

                <div class="code-layer-content" data-layer-content="tensorflow">
                    <pre><code class="language-python">import tensorflow as tf
import numpy as np

class LSTMCell(tf.keras.layers.Layer):
    """TensorFlow LSTMå•å…ƒå®ç°"""

    def __init__(self, units, **kwargs):
        super(LSTMCell, self).__init__(**kwargs)
        self.units = units
        self.state_size = [units, units]  # [h, c]

    def build(self, input_shape):
        input_dim = input_shape[-1]

        # åˆ›å»ºæƒé‡çŸ©é˜µ
        self.kernel = self.add_weight(
            shape=(input_dim, self.units * 4),
            name='kernel',
            initializer='glorot_uniform'
        )

        self.recurrent_kernel = self.add_weight(
            shape=(self.units, self.units * 4),
            name='recurrent_kernel',
            initializer='orthogonal'
        )

        # åç½®
        self.bias = self.add_weight(
            shape=(self.units * 4,),
            name='bias',
            initializer=self.bias_initializer
        )

    def bias_initializer(self, shape, dtype=None):
        """è‡ªå®šä¹‰åç½®åˆå§‹åŒ– - é—å¿˜é—¨åç½®ä¸º1"""
        bias = np.zeros(shape)
        bias[:self.units] = 1.0  # é—å¿˜é—¨
        return tf.constant(bias, dtype=dtype)

    def call(self, inputs, states):
        """
        å‰å‘ä¼ æ’­
        inputs: (batch, input_dim)
        states: [h, c], each (batch, units)
        """
        h_prev, c_prev = states

        # è®¡ç®—æ‰€æœ‰é—¨
        z = tf.matmul(inputs, self.kernel)
        z += tf.matmul(h_prev, self.recurrent_kernel)
        z = tf.nn.bias_add(z, self.bias)

        # åˆ†å‰²é—¨
        z0, z1, z2, z3 = tf.split(z, 4, axis=1)

        # åº”ç”¨æ¿€æ´»å‡½æ•°
        f = tf.nn.sigmoid(z0)  # é—å¿˜é—¨
        i = tf.nn.sigmoid(z1)  # è¾“å…¥é—¨
        c_tilde = tf.nn.tanh(z2)  # å€™é€‰å€¼
        o = tf.nn.sigmoid(z3)  # è¾“å‡ºé—¨

        # æ›´æ–°çŠ¶æ€
        c = f * c_prev + i * c_tilde
        h = o * tf.nn.tanh(c)

        return h, [h, c]


class LSTM(tf.keras.Model):
    """å®Œæ•´çš„LSTMæ¨¡å‹"""

    def __init__(self, units, num_layers=1, dropout=0.0,
                 return_sequences=True, **kwargs):
        super(LSTM, self).__init__(**kwargs)
        self.units = units
        self.num_layers = num_layers
        self.dropout = dropout
        self.return_sequences = return_sequences

        # åˆ›å»ºLSTMå±‚
        self.lstm_layers = []
        for i in range(num_layers):
            self.lstm_layers.append(
                tf.keras.layers.RNN(
                    LSTMCell(units),
                    return_sequences=True if i < num_layers-1 else return_sequences,
                    return_state=True
                )
            )

            # Dropoutå±‚
            if dropout > 0 and i < num_layers - 1:
                self.lstm_layers.append(tf.keras.layers.Dropout(dropout))

    def call(self, inputs, initial_state=None, training=None):
        """å‰å‘ä¼ æ’­"""
        x = inputs
        states = []

        for layer in self.lstm_layers:
            if isinstance(layer, tf.keras.layers.Dropout):
                x = layer(x, training=training)
            else:
                x, h, c = layer(x, initial_state=initial_state)
                states.append((h, c))
                initial_state = [h, c]

        return x, states

    def get_config(self):
        config = super().get_config()
        config.update({
            'units': self.units,
            'num_layers': self.num_layers,
            'dropout': self.dropout,
            'return_sequences': self.return_sequences
        })
        return config


# ä½¿ç”¨Kerasé«˜çº§APIçš„LSTM
def create_keras_lstm(input_shape, units, num_layers=1, dropout=0.0):
    """ä½¿ç”¨Kerasé«˜çº§APIåˆ›å»ºLSTMæ¨¡å‹"""
    model = tf.keras.Sequential()

    # è¾“å…¥å±‚
    model.add(tf.keras.layers.Input(shape=input_shape))

    # LSTMå±‚
    for i in range(num_layers):
        return_sequences = True if i < num_layers - 1 else False

        model.add(tf.keras.layers.LSTM(
            units=units,
            return_sequences=return_sequences,
            dropout=dropout,
            recurrent_dropout=dropout,
            kernel_initializer='glorot_uniform',
            recurrent_initializer='orthogonal',
            bias_initializer='zeros'
        ))

        if dropout > 0 and i < num_layers - 1:
            model.add(tf.keras.layers.Dropout(dropout))

    return model


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # æ–¹æ³•1ï¼šä½¿ç”¨è‡ªå®šä¹‰LSTM
    lstm_custom = LSTM(units=256, num_layers=2, dropout=0.1)

    # æ–¹æ³•2ï¼šä½¿ç”¨Kerasé«˜çº§API
    lstm_keras = create_keras_lstm(
        input_shape=(50, 100),  # (seq_len, input_dim)
        units=256,
        num_layers=2,
        dropout=0.1
    )

    # æµ‹è¯•è¾“å…¥
    batch_size = 32
    seq_len = 50
    input_dim = 100

    x = tf.random.normal((batch_size, seq_len, input_dim))

    # è‡ªå®šä¹‰LSTMå‰å‘ä¼ æ’­
    output_custom, states_custom = lstm_custom(x, training=True)
    print(f"è‡ªå®šä¹‰LSTMè¾“å‡ºå½¢çŠ¶: {output_custom.shape}")

    # Keras LSTMå‰å‘ä¼ æ’­
    output_keras = lstm_keras(x, training=True)
    print(f"Keras LSTMè¾“å‡ºå½¢çŠ¶: {output_keras.shape}")

    # æ¨¡å‹æ‘˜è¦
    lstm_keras.summary()</code></pre>
                </div>
            </div>

            <!-- å¯è§†åŒ–ä»£ç æŠ˜å  -->
            <div class="collapsible">
                <div class="collapsible-header">
                    <span>ğŸ“Š å¯è§†åŒ–å®ç°ä»£ç ï¼ˆå¯é€‰æŸ¥çœ‹ï¼‰</span>
                    <span class="collapsible-icon">â–¼</span>
                </div>
                <div class="collapsible-content">
                    <pre><code class="language-python"># è¿™é‡ŒåŒ…å«ç”Ÿæˆæœ¬é¡µé¢æ‰€æœ‰å¯è§†åŒ–å›¾è¡¨çš„ä»£ç 
# ç”±äºä¸ç†è§£LSTMåŸç†æ— å…³ï¼Œé»˜è®¤æŠ˜å 
# å¦‚éœ€æŸ¥çœ‹å…·ä½“å®ç°ï¼Œè¯·å±•å¼€æ­¤éƒ¨åˆ†

import matplotlib.pyplot as plt
import numpy as np

def visualize_lstm_gates(sequence_length=20):
    """å¯è§†åŒ–LSTMé—¨çš„æ¿€æ´»æ¨¡å¼"""
    # æ¨¡æ‹Ÿé—¨æ¿€æ´»å€¼
    forget_gates = np.random.beta(5, 1, sequence_length)
    input_gates = np.random.beta(2, 2, sequence_length)
    output_gates = np.random.beta(3, 2, sequence_length)

    plt.figure(figsize=(12, 6))

    # ç»˜åˆ¶é—¨æ¿€æ´»å€¼
    plt.plot(forget_gates, 'r-', label='Forget Gate', linewidth=2)
    plt.plot(input_gates, 'b-', label='Input Gate', linewidth=2)
    plt.plot(output_gates, 'g-', label='Output Gate', linewidth=2)

    plt.xlabel('Time Step')
    plt.ylabel('Gate Activation')
    plt.title('LSTM Gate Activations Over Time')
    plt.legend()
    plt.grid(True, alpha=0.3)
    plt.ylim(0, 1)

    plt.tight_layout()
    plt.show()

# æ›´å¤šå¯è§†åŒ–ä»£ç ...</code></pre>
                </div>
            </div>
        </section>

        <!-- å®æ—¶æ¼”ç¤º -->
        <section id="visualization" class="section-card">
            <h2 style="color: var(--accent-green); margin-bottom: 2rem;">ğŸš€ å®æ—¶æƒ…æ„Ÿåˆ†ææ¼”ç¤º</h2>

            <div class="live-demo">
                <div class="live-demo-content">
                    <p style="margin-bottom: 1.5rem; font-size: 1.1rem;">
                        è¾“å…¥ä¸€å¥è¯ï¼Œå®æ—¶æŸ¥çœ‹LSTMå¦‚ä½•å¤„ç†å¹¶åˆ†ææƒ…æ„Ÿï¼š
                    </p>

                    <div class="input-group">
                        <input type="text"
                               class="live-demo-input"
                               id="sentimentInput"
                               placeholder="ä¾‹å¦‚ï¼šè¿™ä¸ªäº§å“å¤ªæ£’äº†ï¼æˆ‘éå¸¸å–œæ¬¢ï¼"
                               value="è¿™ä¸ªäº§å“å¤ªæ£’äº†ï¼æˆ‘éå¸¸å–œæ¬¢ï¼">

                        <button class="analyze-btn" id="analyzeBtn">
                            åˆ†ææƒ…æ„Ÿ âœ¨
                        </button>
                    </div>

                    <div class="live-demo-output">
                        <div class="demo-result-card">
                            <h4 style="color: var(--accent-pink); margin-bottom: 1rem;">ğŸ˜Š é¢„æµ‹ç»“æœ</h4>
                            <div id="predictionResult" style="text-align: center;">
                                <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ˜Š</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: var(--accent-green);">
                                    æ­£é¢æƒ…æ„Ÿ
                                </div>
                                <div style="font-size: 1.2rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                    ç½®ä¿¡åº¦ï¼š95%
                                </div>
                                <div style="margin-top: 1.5rem;">
                                    <div style="background: rgba(255, 255, 255, 0.1); border-radius: 0.5rem; height: 20px; overflow: hidden;">
                                        <div style="height: 100%; width: 95%; background: var(--accent-green); transition: width 0.5s ease;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="demo-result-card">
                            <h4 style="color: var(--accent-blue); margin-bottom: 1rem;">ğŸšª é—¨æ¿€æ´»å€¼</h4>
                            <div id="gateActivations">
                                <canvas id="gateChart" width="400" height="250"></canvas>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 2rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">ğŸ“ˆ å¤„ç†è¿‡ç¨‹å¯è§†åŒ–</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                            <div>
                                <h5 style="color: var(--accent-pink); margin-bottom: 0.5rem;">ç»†èƒçŠ¶æ€å˜åŒ–</h5>
                                <canvas id="cellStateChart" width="100%" height="200"></canvas>
                            </div>
                            <div>
                                <h5 style="color: var(--accent-green); margin-bottom: 0.5rem;">éšè—çŠ¶æ€çƒ­å›¾</h5>
                                <canvas id="hiddenStateChart" width="100%" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- å®æˆ˜åº”ç”¨ -->
        <section id="practice" class="section-card">
            <h2 style="color: var(--accent-pink); margin-bottom: 2rem;">âš”ï¸ å®æˆ˜ï¼šç”¨LSTMç”ŸæˆéŸ³ä¹</h2>

            <div class="story-card">
                <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 2rem;">
                    è®©æˆ‘ä»¬ç”¨LSTMåˆ›å»ºä¸€ä¸ªéŸ³ä¹ç”Ÿæˆå™¨ï¼Œä½“éªŒé•¿æœŸè®°å¿†åœ¨åºåˆ—ç”Ÿæˆä¸­çš„å¨åŠ›ï¼
                </p>
            </div>

            <div class="practice-section">
                <h3 style="color: var(--accent-yellow); margin-bottom: 1.5rem;">ğŸµ éŸ³ä¹ç”Ÿæˆå™¨</h3>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    <button class="btn btn-primary" onclick="generateMelody('happy')">
                        ğŸ˜Š ç”Ÿæˆæ¬¢å¿«æ—‹å¾‹
                    </button>
                    <button class="btn btn-primary" onclick="generateMelody('sad')">
                        ğŸ˜¢ ç”Ÿæˆå¿§ä¼¤æ—‹å¾‹
                    </button>
                    <button class="btn btn-primary" onclick="generateMelody('energetic')">
                        âš¡ ç”Ÿæˆæ¿€æ˜‚æ—‹å¾‹
                    </button>
                    <button class="btn btn-primary" onclick="generateMelody('calm')">
                        ğŸŒŠ ç”Ÿæˆå¹³é™æ—‹å¾‹
                    </button>
                </div>

                <div id="musicVisualizer" style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 1rem;">
                    <canvas id="musicCanvas" width="100%" height="300"></canvas>
                </div>

                <div style="margin-top: 2rem;">
                    <audio id="musicPlayer" controls style="width: 100%;"></audio>
                </div>
            </div>
        </section>

        <!-- ç»ƒä¹ ä¸æ€è€ƒ -->
        <section id="exercises" class="section-card">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">ğŸ“ ç»ƒä¹ ä¸æ€è€ƒ</h2>

            <div class="practice-section">
                <div class="practice-item">
                    <h3 style="color: var(--accent-blue); margin-bottom: 1rem;">
                        ç»ƒä¹ 1ï¼šæ‰‹åŠ¨è®¡ç®—LSTMå‰å‘ä¼ æ’­
                    </h3>
                    <p>ç»™å®šä»¥ä¸‹å‚æ•°ï¼Œæ‰‹åŠ¨è®¡ç®—ä¸€æ­¥LSTMçš„è¾“å‡ºï¼š</p>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem; margin: 1rem 0;">
                        <code>
                            x_t = [0.5, -0.2], h_{t-1} = [0.3, 0.1], C_{t-1} = [0.8, -0.4]<br>
                            W_f = [[0.1, 0.2, -0.1, 0.3], [0.2, -0.1, 0.1, 0.2]], b_f = [0.5, 0.5]
                        </code>
                    </div>
                    <div class="practice-solution">
                        <h4 style="color: var(--accent-green); margin-bottom: 1rem;">è§£ç­”ï¼š</h4>
                        <p>æ­¥éª¤1ï¼šæ‹¼æ¥è¾“å…¥ [h_{t-1}, x_t] = [0.3, 0.1, 0.5, -0.2]</p>
                        <p>æ­¥éª¤2ï¼šè®¡ç®—é—å¿˜é—¨...</p>
                        <p>ï¼ˆå®Œæ•´è§£ç­”è¯·å±•å¼€æŸ¥çœ‹ï¼‰</p>
                    </div>
                </div>

                <div class="practice-item">
                    <h3 style="color: var(--accent-pink); margin-bottom: 1rem;">
                        ç»ƒä¹ 2ï¼šåˆ†ææ¢¯åº¦ä¼ æ’­
                    </h3>
                    <p>è¯æ˜ï¼šå½“é—å¿˜é—¨ f_t = 1 ä¸”è¾“å…¥é—¨ i_t = 0 æ—¶ï¼Œæ¢¯åº¦å¯ä»¥æ— æŸä¼ æ’­ã€‚</p>
                    <div class="practice-solution">
                        <h4 style="color: var(--accent-green); margin-bottom: 1rem;">æç¤ºï¼š</h4>
                        <p>ä»ç»†èƒçŠ¶æ€æ›´æ–°å…¬å¼å¼€å§‹ï¼Œè®¡ç®—é›…å¯æ¯”çŸ©é˜µ...</p>
                    </div>
                </div>

                <div class="practice-item">
                    <h3 style="color: var(--accent-orange); margin-bottom: 1rem;">
                        ç»ƒä¹ 3ï¼šé—¨çš„ç›¸å…³æ€§åˆ†æ
                    </h3>
                    <p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé—å¿˜é—¨å’Œè¾“å…¥é—¨å¾€å¾€å‘ˆç°è´Ÿç›¸å…³ã€‚è§£é‡Šè¿™ç§ç°è±¡çš„åŸå› ã€‚</p>
                    <div class="practice-solution">
                        <h4 style="color: var(--accent-green); margin-bottom: 1rem;">æ€è·¯ï¼š</h4>
                        <p>è€ƒè™‘ç»†èƒçŠ¶æ€çš„å®¹é‡é™åˆ¶...</p>
                    </div>
                </div>
            </div>

            <div class="think-card" style="margin-top: 2rem;">
                <h3>ğŸ¤” æ·±åº¦æ€è€ƒé¢˜</h3>
                <ol style="margin-left: 1.5rem; line-height: 2;">
                    <li>ä¸ºä»€ä¹ˆLSTMåœ¨å¤„ç†æ–‡æœ¬æ—¶é€šå¸¸æ¯”å¤„ç†å›¾åƒæ›´æœ‰æ•ˆï¼Ÿ</li>
                    <li>å¦‚ä½•è§£é‡ŠLSTMä¸­çš„"è®°å¿†"ä¸äººç±»è®°å¿†çš„ç›¸ä¼¼æ€§ï¼Ÿ</li>
                    <li>åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œç®€å•çš„RNNå¯èƒ½æ¯”LSTMè¡¨ç°æ›´å¥½ï¼Ÿ</li>
                    <li>LSTMçš„å“ªäº›è®¾è®¡å¯ä»¥è¢«è¿›ä¸€æ­¥ç®€åŒ–è€Œä¸å½±å“æ€§èƒ½ï¼Ÿ</li>
                </ol>
            </div>
        </section>

        <!-- æ€»ç»“ä¸å±•æœ› -->
        <section id="summary" class="section-card">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">ğŸ¯ æœ¬ç« æ€»ç»“ï¼šLSTMçš„ç²¾å¦™è®¾è®¡</h2>

            <div class="concept-grid">
                <div class="concept-card forget">
                    <h3 style="color: var(--accent-pink); margin-bottom: 1rem;">ğŸ¯ æ ¸å¿ƒåˆ›æ–°</h3>
                    <ul style="margin-left: 1.5rem;">
                        <li>ç»†èƒçŠ¶æ€ï¼šçº¿æ€§ä¿¡æ¯é«˜é€Ÿå…¬è·¯</li>
                        <li>é—¨æ§æœºåˆ¶ï¼šç²¾ç¡®çš„ä¿¡æ¯æµæ§åˆ¶</li>
                        <li>æ¢¯åº¦é«˜é€Ÿè·¯ï¼šè§£å†³é•¿æœŸä¾èµ–</li>
                        <li>æ¨¡å—åŒ–è®¾è®¡ï¼šæ¸…æ™°çš„æ•°å­¦ç»“æ„</li>
                    </ul>
                </div>

                <div class="concept-card input">
                    <h3 style="color: var(--accent-blue); margin-bottom: 1rem;">ğŸ’¡ è®¾è®¡æ™ºæ…§</h3>
                    <ul style="margin-left: 1.5rem;">
                        <li>é—å¿˜é—¨ï¼šé€‰æ‹©æ€§é—å¿˜</li>
                        <li>è¾“å…¥é—¨ï¼šé€‰æ‹©æ€§è®°å¿†</li>
                        <li>è¾“å‡ºé—¨ï¼šæŒ‰éœ€æå–</li>
                        <li>çº¿æ€§è·¯å¾„ï¼šæ¢¯åº¦ä¿æŠ¤</li>
                    </ul>
                </div>

                <div class="concept-card output">
                    <h3 style="color: var(--accent-green); margin-bottom: 1rem;">ğŸš€ åº”ç”¨é¢†åŸŸ</h3>
                    <ul style="margin-left: 1.5rem;">
                        <li>è‡ªç„¶è¯­è¨€å¤„ç†</li>
                        <li>è¯­éŸ³è¯†åˆ«</li>
                        <li>æ—¶åºé¢„æµ‹</li>
                        <li>éŸ³ä¹ç”Ÿæˆ</li>
                    </ul>
                </div>

                <div class="concept-card cell">
                    <h3 style="color: var(--accent-orange); margin-bottom: 1rem;">âš ï¸ å±€é™æ€§</h3>
                    <ul style="margin-left: 1.5rem;">
                        <li>è®¡ç®—å¤æ‚åº¦é«˜</li>
                        <li>éš¾ä»¥å¹¶è¡ŒåŒ–</li>
                        <li>å‚æ•°é‡å¤§</li>
                        <li>è®­ç»ƒæ—¶é—´é•¿</li>
                    </ul>
                </div>
            </div>

            <div class="timeline" style="margin-top: 3rem;">
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-pink);">è¿‡å»ï¼šRNNæ—¶ä»£</h4>
                    <p>ç®€å•ä½†æ¢¯åº¦æ¶ˆå¤±ä¸¥é‡</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-blue);">ç°åœ¨ï¼šLSTMä¸»å¯¼</h4>
                    <p>è§£å†³é•¿æœŸä¾èµ–ï¼Œå¹¿æ³›åº”ç”¨</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-green);">æœªæ¥ï¼šTransformerå´›èµ·</h4>
                    <p>å¹¶è¡Œè®¡ç®—ï¼Œè‡ªæ³¨æ„åŠ›æœºåˆ¶</p>
                </div>
            </div>

            <div class="tip success" style="margin-top: 3rem;">
                <span style="font-size: 2rem;">ğŸ“</span>
                <div>
                    <h3 style="margin-bottom: 1rem;">å­¦ä¹ LSTMçš„æ”¶è·</h3>
                    <p style="font-size: 1.1rem; line-height: 1.8;">
                        é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œä½ å·²ç»æŒæ¡äº†ï¼š<br>
                        â€¢ LSTMå¦‚ä½•é€šè¿‡é—¨æ§æœºåˆ¶è§£å†³æ¢¯åº¦æ¶ˆå¤±<br>
                        â€¢ ç»†èƒçŠ¶æ€ä½œä¸ºä¿¡æ¯é«˜é€Ÿå…¬è·¯çš„è®¾è®¡æ™ºæ…§<br>
                        â€¢ ä»é›¶å®ç°LSTMçš„å®Œæ•´ä»£ç <br>
                        â€¢ LSTMåœ¨å®é™…åº”ç”¨ä¸­çš„ä¼˜åŒ–æŠ€å·§
                    </p>
                    <p style="margin-top: 1rem; font-size: 1.2rem; color: var(--accent-cyan);">
                        <strong>ä¸‹ä¸€æ­¥ï¼š</strong>å­¦ä¹ GRUå’ŒTransformerï¼Œäº†è§£åºåˆ—å»ºæ¨¡çš„æœ€æ–°è¿›å±•ï¼
                    </p>
                </div>
            </div>
        </section>

        <!-- å‚è€ƒèµ„æº -->
        <section class="section-card" style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(59, 130, 246, 0.05));">
            <h2 style="color: var(--accent-cyan); margin-bottom: 2rem;">ğŸ“š å»¶ä¼¸é˜…è¯»ä¸èµ„æº</h2>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 1rem;">
                    <h3 style="color: var(--accent-blue); margin-bottom: 1rem;">ğŸ“„ ç»å…¸è®ºæ–‡</h3>
                    <ul style="line-height: 2;">
                        <li>Hochreiter & Schmidhuber (1997) - Long Short-Term Memory</li>
                        <li>Gers et al. (2000) - Learning to Forget</li>
                        <li>Graves (2013) - Generating Sequences with RNNs</li>
                    </ul>
                </div>

                <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 1rem;">
                    <h3 style="color: var(--accent-green); margin-bottom: 1rem;">ğŸ¥ æ¨èæ•™ç¨‹</h3>
                    <ul style="line-height: 2;">
                        <li>Christopher Olah - Understanding LSTM Networks</li>
                        <li>Andrej Karpathy - The Unreasonable Effectiveness of RNNs</li>
                        <li>Fast.ai - Practical Deep Learning Course</li>
                    </ul>
                </div>

                <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 1rem;">
                    <h3 style="color: var(--accent-orange); margin-bottom: 1rem;">ğŸ’» ä»£ç èµ„æº</h3>
                    <ul style="line-height: 2;">
                        <li>PyTorch LSTM Tutorial</li>
                        <li>TensorFlow RNN Guide</li>
                        <li>Keras Sequential Models</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- ç»“è¯­ -->
        <section class="section-card" style="background: var(--lstm-gradient); color: #0f172a; margin-bottom: 0;">
            <div style="text-align: center; padding: 2rem;">
                <h2 style="font-size: 3rem; margin-bottom: 1.5rem;">ğŸŠ æ­å–œå®Œæˆæœ¬ç« å­¦ä¹ ï¼</h2>
                <p style="font-size: 1.3rem; margin-bottom: 2rem; line-height: 1.8;">
                    ä½ å·²ç»æŒæ¡äº†LSTMçš„ç²¾é«“ â€”â€” é€šè¿‡ç²¾å¦™çš„é—¨æ§è®¾è®¡è®©ç¥ç»ç½‘ç»œå­¦ä¼šé—å¿˜ä¸è®°å¿†ã€‚<br>
                    è¿™æ˜¯æ·±åº¦å­¦ä¹ å†å²ä¸Šçš„ä¸€ä¸ªé‡Œç¨‹ç¢‘ï¼Œä¹Ÿæ˜¯é€šå‘ç°ä»£AIçš„é‡è¦ä¸€æ­¥ã€‚
                </p>
                <div style="display: flex; justify-content: center; gap: 2rem; flex-wrap: wrap;">
                    <a href="#" class="btn" style="background: white; color: #0f172a; padding: 1rem 2rem; font-size: 1.1rem;">
                        â¬…ï¸ ä¸Šä¸€ç« ï¼šRNNåŸºç¡€
                    </a>
                    <a href="#" class="btn" style="background: #0f172a; color: white; padding: 1rem 2rem; font-size: 1.1rem;">
                        ä¸‹ä¸€ç« ï¼šæ³¨æ„åŠ›æœºåˆ¶ â¡ï¸
                    </a>
                </div>
            </div>
        </section>

    </div>
</main>

<!-- é¡µè„š -->
<footer style="background: var(--bg-section); padding: 3rem 0; border-top: 1px solid var(--border-color);">
    <div class="container">
        <div style="text-align: center; color: var(--text-secondary);">
            <p style="margin-bottom: 1rem; font-size: 1.1rem;">
                ğŸ“– æ·±åº¦å­¦ä¹ åºåˆ—å»ºæ¨¡ | ç¬¬8ç« ï¼šé•¿çŸ­æœŸè®°å¿†ç½‘ç»œLSTM
            </p>
            <p>
                ç”¨â¤ï¸åˆ¶ä½œ | è®©AIçŸ¥è¯†è§¦æ‰‹å¯åŠ
            </p>
        </div>
    </div>
</footer>

<!-- JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>

<!-- TensorFlow.js for live demo -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>

<script>
    // ===== åˆå§‹åŒ– =====
    // åˆå§‹åŒ–è¯­æ³•é«˜äº®
    hljs.highlightAll();

    // åˆå§‹åŒ–æ•°å­¦å…¬å¼
    renderMathInElement(document.body, {
        delimiters: [
            {left: '$', right: '$', display: true},
            {left: ', right: ', display: false}
        ],
        throwOnError: false
    });

    // ===== èƒŒæ™¯åŠ¨ç”» =====
    function createBackgroundAnimation() {
        const bgAnimation = document.getElementById('bgAnimation');
        const particleCount = 50;

        for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.className = 'bg-particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 20 + 's';
            particle.style.animationDuration = (20 + Math.random() * 10) + 's';
            bgAnimation.appendChild(particle);
        }
    }
    createBackgroundAnimation();

    // ===== å¯¼èˆªåŠŸèƒ½ =====
    const sidebar = document.getElementById('sidebar');
    const toggleSidebar = document.getElementById('toggle-sidebar');
    const navHeader = document.querySelector('.nav-header');
    let lastScrollTop = 0;

    toggleSidebar.addEventListener('click', () => {
        sidebar.classList.toggle('open');
    });

    // è‡ªåŠ¨éšè—å¯¼èˆªæ 
    window.addEventListener('scroll', () => {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

        if (scrollTop > lastScrollTop && scrollTop > 100) {
            navHeader.classList.add('hidden');
        } else {
            navHeader.classList.remove('hidden');
        }

        lastScrollTop = scrollTop;

        // æ›´æ–°è¿›åº¦æ¡
        const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
        const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        const scrolled = (winScroll / height) * 100;
        document.getElementById('progress-bar').style.width = scrolled + '%';
    });

    // ä¾§è¾¹æ å¯¼èˆªé«˜äº®
    const sections = document.querySelectorAll('section[id]');
    const tocItems = document.querySelectorAll('.toc-item');

    window.addEventListener('scroll', () => {
        let current = '';

        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            if (pageYOffset >= sectionTop - 200) {
                current = section.getAttribute('id');
            }
        });

        tocItems.forEach(item => {
            item.classList.remove('active');
            if (item.getAttribute('href') === `#${current}`) {
                item.classList.add('active');
            }
        });
    });

    // ===== äº¤äº’å¼å…¬å¼é«˜äº® =====
    document.querySelectorAll('.highlight-target').forEach(elem => {
        elem.addEventListener('mouseenter', function() {
            const symbol = this.getAttribute('data-symbol');
            highlightSymbol(symbol, true);
        });

        elem.addEventListener('mouseleave', function() {
            const symbol = this.getAttribute('data-symbol');
            highlightSymbol(symbol, false);
        });
    });

    function highlightSymbol(symbol, highlight) {
        // é«˜äº®æ‰€æœ‰ç›¸å…³å…ƒç´ 
        document.querySelectorAll(`[data-symbol="${symbol}"]`).forEach(elem => {
            if (highlight) {
                elem.classList.add('highlight-active');
            } else {
                elem.classList.remove('highlight-active');
            }
        });

        // é«˜äº®å¯¹åº”çš„å«ä¹‰é¡¹
        document.querySelectorAll('.meaning-item').forEach(item => {
            const strongText = item.querySelector('strong').textContent;
            if (strongText.includes(symbol.replace('_', ''))) {
                if (highlight) {
                    item.style.background = 'rgba(79, 172, 254, 0.2)';
                    item.style.borderColor = 'var(--accent-blue)';
                } else {
                    item.style.background = '';
                    item.style.borderColor = 'transparent';
                }
            }
        });
    }

    // ===== LSTMå•å…ƒäº¤äº’ =====
    function initializeLSTMCanvas() {
        const canvas = document.getElementById('lstmCanvas');
        if (!canvas) return;

        const ctx = canvas.getContext('2d');
        canvas.width = canvas.offsetWidth;
        canvas.height = 500;

        // ç»˜åˆ¶LSTMç»“æ„
        drawLSTMStructure(ctx, canvas.width, canvas.height);
    }

    function drawLSTMStructure(ctx, width, height) {
        // æ¸…ç©ºç”»å¸ƒ
        ctx.clearRect(0, 0, width, height);

        // ç»˜åˆ¶ç»†èƒçŠ¶æ€é«˜é€Ÿå…¬è·¯
        ctx.strokeStyle = '#a8edea';
        ctx.lineWidth = 4;
        ctx.beginPath();
        ctx.moveTo(50, height/2);
        ctx.lineTo(width - 50, height/2);
        ctx.stroke();

        // ç»˜åˆ¶é—¨
        const gates = [
            { name: 'é—å¿˜é—¨', x: width * 0.25, y: height * 0.3, color: '#f5576c' },
            { name: 'è¾“å…¥é—¨', x: width * 0.5, y: height * 0.3, color: '#4facfe' },
            { name: 'è¾“å‡ºé—¨', x: width * 0.75, y: height * 0.7, color: '#43e97b' }
        ];

        gates.forEach(gate => {
            // ç»˜åˆ¶é—¨åœ†åœˆ
            ctx.beginPath();
            ctx.arc(gate.x, gate.y, 40, 0, 2 * Math.PI);
            ctx.fillStyle = gate.color;
            ctx.fill();
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            ctx.stroke();

            // ç»˜åˆ¶æ ‡ç­¾
            ctx.fillStyle = 'white';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(gate.name, gate.x, gate.y + 60);
        });
    }

    function highlightForgetGate() {
        updateGateDescription('forget', '#f5576c');
    }

    function highlightInputGate() {
        updateGateDescription('input', '#4facfe');
    }

    function highlightOutputGate() {
        updateGateDescription('output', '#43e97b');
    }

    function animateDataFlow() {
        // å®ç°æ•°æ®æµåŠ¨ç”»
        console.log('Animating data flow...');
    }

    function updateGateDescription(gateType, color) {
        const descriptions = {
            forget: {
                title: 'é—å¿˜é—¨ (Forget Gate)',
                formula: 'f_t = Ïƒ(W_f Â· [h_{t-1}, x_t] + b_f)',
                description: 'é—å¿˜é—¨å†³å®šä»ç»†èƒçŠ¶æ€ä¸­ä¸¢å¼ƒä»€ä¹ˆä¿¡æ¯ã€‚å®ƒæŸ¥çœ‹ h_{t-1} å’Œ x_tï¼Œè¾“å‡ºä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„æ•°å€¼ç»™æ¯ä¸ªç»†èƒçŠ¶æ€ã€‚1 è¡¨ç¤º"å®Œå…¨ä¿ç•™"ï¼Œ0 è¡¨ç¤º"å®Œå…¨ä¸¢å¼ƒ"ã€‚'
            },
            input: {
                title: 'è¾“å…¥é—¨ (Input Gate)',
                formula: 'i_t = Ïƒ(W_i Â· [h_{t-1}, x_t] + b_i)',
                description: 'è¾“å…¥é—¨å†³å®šä»€ä¹ˆæ–°ä¿¡æ¯è¦å­˜å‚¨åˆ°ç»†èƒçŠ¶æ€ä¸­ã€‚è¿™åŒ…å«ä¸¤éƒ¨åˆ†ï¼šsigmoid å±‚å†³å®šå“ªäº›å€¼è¦æ›´æ–°ï¼Œtanh å±‚åˆ›å»ºæ–°çš„å€™é€‰å€¼å‘é‡ã€‚'
            },
            output: {
                title: 'è¾“å‡ºé—¨ (Output Gate)',
                formula: 'o_t = Ïƒ(W_o Â· [h_{t-1}, x_t] + b_o)',
                description: 'è¾“å‡ºé—¨å†³å®šåŸºäºç»†èƒçŠ¶æ€è¾“å‡ºä»€ä¹ˆã€‚é¦–å…ˆè¿è¡Œ sigmoid å±‚å†³å®šç»†èƒçŠ¶æ€çš„å“ªäº›éƒ¨åˆ†è¦è¾“å‡ºï¼Œç„¶åå°†ç»†èƒçŠ¶æ€é€šè¿‡ tanh å¹¶ä¹˜ä»¥ sigmoid çš„è¾“å‡ºã€‚'
            }
        };

        const desc = descriptions[gateType];
        document.getElementById('gateDescription').innerHTML = `
            <h3 style="color: ${color}; margin-bottom: 1rem;">${desc.title}</h3>
            <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                <code style="font-size: 1.2rem;">${desc.formula}</code>
            </div>
            <p style="line-height: 1.8;">${desc.description}</p>
        `;
    }

    // ===== æ­¥è¿›åŠ¨ç”» =====
    let currentStep = 0;
    const totalSteps = 4;

    document.querySelectorAll('.step-dot').forEach(dot => {
        dot.addEventListener('click', function() {
            currentStep = parseInt(this.getAttribute('data-step'));
            updateStep();
        });
    });

    document.getElementById('prevStep').addEventListener('click', () => {
        if (currentStep > 0) {
            currentStep--;
            updateStep();
        }
    });

    document.getElementById('nextStep').addEventListener('click', () => {
        if (currentStep < totalSteps - 1) {
            currentStep++;
            updateStep();
        }
    });

    function updateStep() {
        // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
        document.querySelectorAll('.step-dot').forEach((dot, index) => {
            if (index === currentStep) {
                dot.classList.add('active');
            } else {
                dot.classList.remove('active');
            }
        });

        // æ›´æ–°æ­¥éª¤å†…å®¹
        document.querySelectorAll('.step-visual').forEach((visual, index) => {
            if (index === currentStep) {
                visual.classList.add('active');
            } else {
                visual.classList.remove('active');
            }
        });

        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        document.getElementById('prevStep').disabled = currentStep === 0;
        document.getElementById('nextStep').disabled = currentStep === totalSteps - 1;
    }

    // ===== ä»£ç å±‚åˆ‡æ¢ =====
    document.querySelectorAll('.code-layer-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            const layer = this.getAttribute('data-layer');

            // æ›´æ–°æ ‡ç­¾çŠ¶æ€
            document.querySelectorAll('.code-layer-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');

            // æ›´æ–°å†…å®¹æ˜¾ç¤º
            document.querySelectorAll('.code-layer-content').forEach(content => {
                if (content.getAttribute('data-layer-content') === layer) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        });
    });

    // ===== æ€è€ƒé¢˜äº¤äº’ =====
    document.querySelectorAll('.think-option').forEach(option => {
        option.addEventListener('click', function() {
            const answer = this.getAttribute('data-answer');
            const feedbackId = this.closest('.think-card').querySelector('.think-feedback').id;

            // ç§»é™¤å…¶ä»–é€‰é¡¹çš„é€‰ä¸­çŠ¶æ€
            this.parentElement.querySelectorAll('.think-option').forEach(opt => {
                opt.classList.remove('selected');
            });

            // æ·»åŠ é€‰ä¸­çŠ¶æ€
            this.classList.add('selected');

            // æ˜¾ç¤ºåé¦ˆ
            showThinkFeedback(feedbackId, answer);
        });
    });

    function showThinkFeedback(feedbackId, answer) {
        const feedbackElement = document.getElementById(feedbackId);
        const feedbacks = {
            'thinkFeedback1': {
                'a': { correct: false, text: 'é€Ÿåº¦ç¡®å®æ˜¯ä¸ªé—®é¢˜ï¼Œä½†ä¸æ˜¯RNNå¤±è´¥çš„ä¸»è¦åŸå› ã€‚' },
                'b': { correct: true, text: 'æ­£ç¡®ï¼æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸æ˜¯RNNå¤„ç†é•¿åºåˆ—å¤±è´¥çš„æ ¹æœ¬åŸå› ã€‚å½“åºåˆ—å¾ˆé•¿æ—¶ï¼Œæ¢¯åº¦ä¼šæŒ‡æ•°çº§è¡°å‡æˆ–å¢é•¿ã€‚' },
                'c': { correct: false, text: 'RNNçš„å‚æ•°é‡å…¶å®ç›¸å¯¹è¾ƒå°‘ï¼Œè¿™ä¸æ˜¯ä¸»è¦é—®é¢˜ã€‚' },
                'd': { correct: false, text: 'æ¿€æ´»å‡½æ•°çš„é€‰æ‹©ä¼šå½±å“æ€§èƒ½ï¼Œä½†ä¸æ˜¯å¤±è´¥çš„ä¸»è¦åŸå› ã€‚' }
            },
            'thinkFeedback2': {
                'a': { correct: false, text: 'å¢åŠ æ¨¡å‹å®¹é‡ä¸æ˜¯ä¸»è¦ç›®çš„ã€‚' },
                'b': { correct: true, text: 'æ­£ç¡®ï¼åˆ†ç¦»"ä»€ä¹ˆ"ï¼ˆå€™é€‰å€¼ï¼‰å’Œ"å¤šå°‘"ï¼ˆæƒé‡ï¼‰è®©ç½‘ç»œå¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶ä¿¡æ¯æµã€‚' },
                'c': { correct: false, text: 'å®é™…ä¸Šå¢åŠ äº†è®¡ç®—é‡ã€‚' },
                'd': { correct: false, text: 'è™½ç„¶æœ‰ä¸€å®šé“ç†ï¼Œä½†ä¸»è¦è¿˜æ˜¯ä¸ºäº†æ›´å¥½çš„ä¿¡æ¯æ§åˆ¶ã€‚' }
            }
        };

        const feedback = feedbacks[feedbackId][answer];
        feedbackElement.innerHTML = `
            <div style="padding: 1rem; background: ${feedback.correct ? 'rgba(34, 197, 94, 0.1)' : 'rgba(239, 68, 68, 0.1)'}; border-radius: 0.5rem;">
                <p style="font-weight: bold; color: ${feedback.correct ? 'var(--accent-green)' : 'var(--accent-red)'};">
                    ${feedback.correct ? 'âœ… æ­£ç¡®ï¼' : 'âŒ ä¸å¤ªå¯¹'}
                </p>
                <p style="margin-top: 0.5rem;">${feedback.text}</p>
            </div>
        `;
        feedbackElement.classList.add('show');
    }

    // ===== æŠ˜å æ§åˆ¶ =====
    document.querySelectorAll('.collapsible-header').forEach(header => {
        header.addEventListener('click', function() {
            const collapsible = this.closest('.collapsible');
            collapsible.classList.toggle('open');
        });
    });

    // ===== ç»ƒä¹ é¢˜å±•å¼€ =====
    document.querySelectorAll('.practice-item').forEach(item => {
        item.addEventListener('click', function() {
            this.classList.toggle('open');
        });
    });

    // ===== å®æ—¶æ¼”ç¤º =====
    let model = null;

    // åˆå§‹åŒ–æƒ…æ„Ÿåˆ†æï¼ˆæ¨¡æ‹Ÿï¼‰
    async function initSentimentModel() {
        // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šåŠ è½½é¢„è®­ç»ƒçš„TensorFlow.jsæ¨¡å‹
        console.log('Sentiment model initialized');
    }

    document.getElementById('analyzeBtn').addEventListener('click', async () => {
        const input = document.getElementById('sentimentInput').value;

        // æ·»åŠ åŠ è½½åŠ¨ç”»
        const btn = document.getElementById('analyzeBtn');
        btn.innerHTML = '<span class="loading"></span> åˆ†æä¸­...';
        btn.disabled = true;

        // æ¨¡æ‹Ÿå¤„ç†å»¶è¿Ÿ
        await new Promise(resolve => setTimeout(resolve, 1000));

        // æ¨¡æ‹Ÿåˆ†æ
        analyzeSentiment(input);

        // æ¢å¤æŒ‰é’®
        btn.innerHTML = 'åˆ†ææƒ…æ„Ÿ âœ¨';
        btn.disabled = false;
    });

    function analyzeSentiment(text) {
        // ç®€å•çš„æƒ…æ„Ÿåˆ†ææ¨¡æ‹Ÿ
        const positiveWords = ['æ£’', 'å¥½', 'å–œæ¬¢', 'ä¼˜ç§€', 'æ¨è', 'æ»¡æ„', 'å®Œç¾', 'èµ'];
        const negativeWords = ['å·®', 'ç³Ÿ', 'å¤±æœ›', 'ä¸å¥½', 'åƒåœ¾', 'è®¨åŒ', 'ç³Ÿç³•', 'çƒ‚'];

        let score = 0.5;
        positiveWords.forEach(word => {
            if (text.includes(word)) score += 0.15;
        });
        negativeWords.forEach(word => {
            if (text.includes(word)) score -= 0.15;
        });

        score = Math.max(0, Math.min(1, score));

        // æ›´æ–°ç»“æœ
        updatePredictionResult(score);

        // ç»˜åˆ¶é—¨æ¿€æ´»å›¾
        drawGateActivations();

        // ç»˜åˆ¶çŠ¶æ€å˜åŒ–å›¾
        drawCellStateChart();
        drawHiddenStateChart();
    }

    function updatePredictionResult(score) {
        const isPositive = score > 0.5;
        const confidence = isPositive ? score : 1 - score;
        const emoji = isPositive ? 'ğŸ˜Š' : 'ğŸ˜”';
        const sentiment = isPositive ? 'æ­£é¢æƒ…æ„Ÿ' : 'è´Ÿé¢æƒ…æ„Ÿ';
        const color = isPositive ? 'var(--accent-green)' : 'var(--accent-red)';

        document.getElementById('predictionResult').innerHTML = `
            <div style="font-size: 4rem; margin-bottom: 1rem;">${emoji}</div>
            <div style="font-size: 1.5rem; font-weight: bold; color: ${color};">
                ${sentiment}
            </div>
            <div style="font-size: 1.2rem; color: var(--text-secondary); margin-top: 0.5rem;">
                ç½®ä¿¡åº¦ï¼š${Math.round(confidence * 100)}%
            </div>
            <div style="margin-top: 1.5rem;">
                <div style="background: rgba(255, 255, 255, 0.1); border-radius: 0.5rem; height: 20px; overflow: hidden;">
                    <div style="height: 100%; width: ${confidence * 100}%; background: ${color}; transition: width 0.5s ease;"></div>
                </div>
            </div>
        `;
    }

    function drawGateActivations() {
        const canvas = document.getElementById('gateChart');
        const ctx = canvas.getContext('2d');

        // è®¾ç½®ç”»å¸ƒå¤§å°
        canvas.width = 400;
        canvas.height = 250;

        // æ¸…ç©ºç”»å¸ƒ
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // æ¨¡æ‹Ÿé—¨æ¿€æ´»å€¼
        const gates = {
            'é—å¿˜é—¨': Math.random() * 0.3 + 0.6,
            'è¾“å…¥é—¨': Math.random() * 0.4 + 0.3,
            'è¾“å‡ºé—¨': Math.random() * 0.3 + 0.6
        };

        const colors = ['#f5576c', '#4facfe', '#43e97b'];
        const labels = Object.keys(gates);
        const values = Object.values(gates);

        // ç»˜åˆ¶æŸ±çŠ¶å›¾
        const barWidth = 80;
        const spacing = 40;
        const startX = (canvas.width - (barWidth * 3 + spacing * 2)) / 2;

        values.forEach((value, i) => {
            const x = startX + i * (barWidth + spacing);
            const height = value * 150;
            const y = canvas.height - height - 40;

            // ç»˜åˆ¶æŸ±å­
            ctx.fillStyle = colors[i];
            ctx.fillRect(x, y, barWidth, height);

            // ç»˜åˆ¶æ ‡ç­¾
            ctx.fillStyle = '#f1f5f9';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(labels[i], x + barWidth/2, canvas.height - 15);
            ctx.fillText((value * 100).toFixed(0) + '%', x + barWidth/2, y - 10);
        });
    }

    function drawCellStateChart() {
        const canvas = document.getElementById('cellStateChart');
        const ctx = canvas.getContext('2d');

        // è®¾ç½®ç”»å¸ƒå¤§å°
        canvas.width = canvas.offsetWidth;
        canvas.height = 200;

        // æ¸…ç©ºç”»å¸ƒ
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // æ¨¡æ‹Ÿç»†èƒçŠ¶æ€å˜åŒ–
        const steps = 30;
        const values = [];
        let current = 0;

        for (let i = 0; i < steps; i++) {
            current += (Math.random() - 0.5) * 0.3;
            values.push(current);
        }

        // ç»˜åˆ¶æŠ˜çº¿å›¾
        ctx.strokeStyle = '#fa709a';
        ctx.lineWidth = 3;
        ctx.beginPath();

        const stepWidth = canvas.width / steps;
        const midY = canvas.height / 2;
        const scale = 40;

        values.forEach((value, i) => {
            const x = i * stepWidth;
            const y = midY - value * scale;

            if (i === 0) {
                ctx.moveTo(x, y);
            } else {
                ctx.lineTo(x, y);
            }
        });

        ctx.stroke();

        // ç»˜åˆ¶åŸºå‡†çº¿
        ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
        ctx.lineWidth = 1;
        ctx.setLineDash([5, 5]);
        ctx.beginPath();
        ctx.moveTo(0, midY);
        ctx.lineTo(canvas.width, midY);
        ctx.stroke();
        ctx.setLineDash([]);
    }

    function drawHiddenStateChart() {
        const canvas = document.getElementById('hiddenStateChart');
        const ctx = canvas.getContext('2d');

        // è®¾ç½®ç”»å¸ƒå¤§å°
        canvas.width = canvas.offsetWidth;
        canvas.height = 200;

        // æ¸…ç©ºç”»å¸ƒ
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // æ¨¡æ‹Ÿéšè—çŠ¶æ€çƒ­å›¾
        const width = 30;
        const height = 10;
        const cellWidth = canvas.width / width;
        const cellHeight = canvas.height / height;

        for (let i = 0; i < width; i++) {
            for (let j = 0; j < height; j++) {
                const value = Math.random();
                const intensity = Math.floor(value * 255);

                // ä½¿ç”¨æ¸å˜è‰²
                if (value > 0.7) {
                    ctx.fillStyle = `rgb(${intensity}, ${100}, ${100})`;
                } else if (value > 0.3) {
                    ctx.fillStyle = `rgb(${100}, ${intensity}, ${100})`;
                } else {
                    ctx.fillStyle = `rgb(${100}, ${100}, ${intensity})`;
                }

                ctx.fillRect(i * cellWidth, j * cellHeight, cellWidth - 1, cellHeight - 1);
            }
        }
    }

    // ===== æ¢¯åº¦æ¶ˆå¤±åŠ¨ç”» =====
    function animateGradientVanishing() {
        const canvas = document.getElementById('gradientVanishingCanvas');
        const ctx = canvas.getContext('2d');

        canvas.width = 900;
        canvas.height = 300;

        let step = 0;
        const totalSteps = 20;

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // ç»˜åˆ¶æ—¶é—´æ­¥
            const stepWidth = canvas.width / totalSteps;

            for (let i = 0; i <= step; i++) {
                const x = i * stepWidth;
                const gradientStrength = Math.pow(0.5, i);

                // ç»˜åˆ¶æ¢¯åº¦å¼ºåº¦
                ctx.fillStyle = `rgba(239, 68, 68, ${gradientStrength})`;
                ctx.fillRect(x, 50, stepWidth - 5, 200);

                // ç»˜åˆ¶æ•°å€¼
                ctx.fillStyle = '#f1f5f9';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`t=${i}`, x + stepWidth/2, 40);
                ctx.fillText(gradientStrength.toFixed(3), x + stepWidth/2, 150);
            }

            step++;
            if (step <= totalSteps) {
                setTimeout(animate, 200);
            }
        }

        animate();
    }

    function resetGradientAnimation() {
        const canvas = document.getElementById('gradientVanishingCanvas');
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    // ===== éŸ³ä¹ç”Ÿæˆ =====
    function generateMelody(mood) {
        console.log(`Generating ${mood} melody...`);

        // æ›´æ–°å¯è§†åŒ–
        const canvas = document.getElementById('musicCanvas');
        const ctx = canvas.getContext('2d');

        canvas.width = canvas.offsetWidth;
        canvas.height = 300;

        // æ¸…ç©ºç”»å¸ƒ
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // æ ¹æ®æƒ…ç»ªç”Ÿæˆä¸åŒçš„éŸ³ç¬¦æ¨¡å¼
        const notePatterns = {
            happy: [60, 64, 67, 72, 67, 64, 60],
            sad: [60, 63, 65, 67, 65, 63, 60],
            energetic: [60, 60, 67, 67, 72, 72, 67],
            calm: [60, 62, 64, 65, 64, 62, 60]
        };

        const notes = notePatterns[mood];
        const noteWidth = canvas.width / notes.length;

        // ç»˜åˆ¶éŸ³ç¬¦
        notes.forEach((note, i) => {
            const x = i * noteWidth + noteWidth / 2;
            const y = canvas.height - (note - 50) * 4;

            // ç»˜åˆ¶éŸ³ç¬¦
            ctx.beginPath();
            ctx.arc(x, y, 15, 0, 2 * Math.PI);
            ctx.fillStyle = getColorForMood(mood);
            ctx.fill();

            // è¿æ¥çº¿
            if (i > 0) {
                ctx.beginPath();
                ctx.moveTo((i-1) * noteWidth + noteWidth / 2, canvas.height - (notes[i-1] - 50) * 4);
                ctx.lineTo(x, y);
                ctx.strokeStyle = getColorForMood(mood);
                ctx.lineWidth = 2;
                ctx.stroke();
            }
        });

        // æ¨¡æ‹ŸéŸ³é¢‘æ’­æ”¾
        document.getElementById('musicPlayer').src = 'data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YQAAAAA=';
    }

    function getColorForMood(mood) {
        const colors = {
            happy: '#fbbf24',
            sad: '#3b82f6',
            energetic: '#ef4444',
            calm: '#22c55e'
        };
        return colors[mood] || '#8b5cf6';
    }

    // ===== åˆå§‹åŒ–æ‰€æœ‰ç»„ä»¶ =====
    window.addEventListener('load', () => {
        initializeLSTMCanvas();
        initSentimentModel();
        drawGateActivations();
        drawCellStateChart();
        drawHiddenStateChart();
    });

    // ===== ä¸»é¢˜åˆ‡æ¢ =====
    document.getElementById('toggle-theme').addEventListener('click', () => {
        // è¿™é‡Œå¯ä»¥å®ç°äº®è‰²/æš—è‰²ä¸»é¢˜åˆ‡æ¢
        console.log('Toggle theme');
    });

    // ===== åŠ¨ç”»æ§åˆ¶ =====
    let animationsEnabled = true;
    document.getElementById('toggle-animations').addEventListener('click', () => {
        animationsEnabled = !animationsEnabled;
        document.body.style.setProperty('--animation-duration', animationsEnabled ? '0.3s' : '0s');
    });

    console.log('LSTMæ•™ç¨‹å®Œæ•´ç‰ˆåŠ è½½å®Œæˆï¼');
</script>

</body>
</html>
. æ•™å­¦ä¸è®¤çŸ¥ä¼˜åŒ– (Pedagogy & Cognitive Optimization)

ç—›ç‚¹ï¼šç†è®ºä¸å®è·µçš„å‰²è£‚æ„Ÿ

ç›®å‰ï¼Œå…¬å¼è®²è§£ã€äº¤äº’å›¾ç¤ºå’Œå®æ—¶Demoæ˜¯å„è‡ªç‹¬ç«‹çš„æ¨¡å—ã€‚å­¦ä¹ è€…ç†è§£äº†å…¬å¼ï¼Œä½†æ— æ³•ç›´è§‚åœ°çœ‹åˆ°å…¬å¼åœ¨å¤„ç†çœŸå®æ•°æ®æ—¶æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚

ä¼˜åŒ–å»ºè®®ï¼š

å°†å…¬å¼è®²è§£ä¸å®æ—¶Demoæ·±åº¦è”åŠ¨ï¼š

å½“ç”¨æˆ·åœ¨â€œå®æ—¶æƒ…æ„Ÿåˆ†æâ€Demoä¸­è¾“å…¥æ–‡æœ¬å¹¶ç‚¹å‡»åˆ†ææ—¶ï¼Œä¸ä»…æ˜¾ç¤ºæœ€ç»ˆç»“æœï¼Œè¿˜è¦åŒæ­¥é©±åŠ¨ä¸Šæ–¹çš„â€œä¸‰æ å¼å…¬å¼è®²è§£â€åŒºåŸŸã€‚

ä¾‹å¦‚ï¼Œå½“æ¨¡å‹å¤„ç†ç¬¬ä¸€ä¸ªå­—æ—¶ï¼Œâ€œé—å¿˜é—¨â€å…¬å¼åŒºåŸŸçš„ xtâ€‹ å’Œ htâˆ’1â€‹ éƒ¨åˆ†å¯ä»¥é«˜äº®ï¼Œå¹¶çŸ­æš‚æ˜¾ç¤ºè¯¥å­—å¯¹åº”çš„å‘é‡å€¼ã€‚ç´§æ¥ç€ï¼Œæ•´ä¸ªå…¬å¼å’ŒçŸ©é˜µå¯è§†åŒ–éƒ¨åˆ†ä¼šâ€œæµåŠ¨â€ä¸€æ¬¡ï¼Œæœ€ç»ˆåœ¨â€œé—¨æ¿€æ´»å€¼â€å›¾è¡¨ä¸­æ˜¾ç¤ºç¬¬ä¸€ä¸ªç‚¹çš„ç»“æœã€‚

æ•ˆæœï¼š å­¦ä¹ è€…å¯ä»¥çœŸæ­£åœ°â€œçœ‹â€åˆ°æ•°æ®æ˜¯å¦‚ä½•æµç»å…¬å¼çš„ï¼Œå°†æŠ½è±¡çš„æ•°å­¦ç¬¦å·ä¸å…·ä½“çš„è®¡ç®—è¿‡ç¨‹å®Œç¾ç»Ÿä¸€ï¼Œå®ç°â€œæ‰€è§å³æ‰€å¾—â€çš„ç»ˆæç†è§£ã€‚

å¢åŠ â€œå¤±è´¥æ¡ˆä¾‹â€å¯¹æ¯”ï¼š

åœ¨â€œRNNçš„å›°å¢ƒâ€éƒ¨åˆ†ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ªä¸LSTMå®æ—¶Demoå¹¶æ’çš„ã€ç®€åŒ–çš„**â€œRNNå®æ—¶Demoâ€**ã€‚

è®©ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå…·æœ‰é•¿è·ç¦»ä¾èµ–çš„å¥å­ï¼ˆä¾‹å¦‚ï¼šâ€œæˆ‘åœ¨æ³•å›½é•¿å¤§ï¼Œâ€¦â€¦ï¼Œæ‰€ä»¥æˆ‘èƒ½è¯´ä¸€å£æµåˆ©çš„æ³•è¯­ã€‚â€ï¼‰ã€‚

ç”¨æˆ·ä¼šç›´è§‚åœ°çœ‹åˆ°ï¼ŒRNNåœ¨é¢„æµ‹æœ€åä¸€ä¸ªè¯æ—¶å¯èƒ½ä¼šå¤±è´¥ï¼ˆå› ä¸ºå®ƒå¿˜è®°äº†â€œæ³•å›½â€ï¼‰ï¼Œè€ŒLSTMåˆ™èƒ½æˆåŠŸé¢„æµ‹ã€‚è¿™ç§A/Bæµ‹è¯•çš„è§†è§‰å†²å‡»åŠ›è¿œèƒœäºå•çº¯çš„æ–‡å­—è§£é‡Šã€‚

2. äº¤äº’ä½“éªŒä¸ç”¨æˆ·ç•Œé¢ (UX/UI Enhancement)

ç—›ç‚¹ï¼šäº¤äº’æ·±åº¦ä¸è¶³

å½“å‰çš„äº¤äº’æ›´å¤šæ˜¯â€œå±•ç¤ºå‹â€ï¼Œç”¨æˆ·çš„å‚ä¸æ„Ÿè¿˜æœ‰æå‡ç©ºé—´ã€‚

ä¼˜åŒ–å»ºè®®ï¼š

å…¬å¼å¯â€œç‚¹æ’­â€è§£é‡Šï¼š

åœ¨â€œä¸‰æ å¼å…¬å¼è®²è§£â€ä¸­ï¼Œå…è®¸ç”¨æˆ·ç‚¹å‡»å…¬å¼ä¸­çš„å…·ä½“ç¬¦å·ï¼ˆå¦‚ Ctâ€‹ï¼‰ï¼Œå¼¹å‡ºä¸€ä¸ªå°æµ®çª—ï¼Œè¯¦ç»†è§£é‡Šè¯¥ç¬¦å·çš„â€œå‰ä¸–ä»Šç”Ÿâ€ï¼šå®ƒæ˜¯å¦‚ä½•ä»ä¸Šä¸€æ­¥è®¡ç®—å¾—æ¥çš„ï¼Œä»¥åŠå®ƒå°†å¦‚ä½•å‚ä¸ä¸‹ä¸€æ­¥çš„è®¡ç®—ã€‚

å®æ—¶Demoçš„â€œè¿‡ç¨‹åŒ–â€åé¦ˆï¼š

åœ¨æƒ…æ„Ÿåˆ†æDemoä¸­ï¼Œå½“ç”¨æˆ·è¾“å…¥æ—¶ï¼Œå¯ä»¥å®æ—¶æ˜¾ç¤ºæ¨¡å‹å¯¹ä¸‹ä¸€ä¸ªå­—çš„é¢„æµ‹ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥â€œè¿™éƒ¨ç”µå½±å¾ˆâ€æ—¶ï¼Œæ¨¡å‹å¯èƒ½ä¼šé¢„æµ‹å‡ºâ€œæ£’â€æˆ–â€œå¥½â€ã€‚è¿™èƒ½æ›´å¥½åœ°å±•ç¤ºLSTMä½œä¸ºè¯­è¨€æ¨¡å‹çš„æœ¬è´¨ã€‚

éŸ³ä¹ç”ŸæˆDemoçš„â€œå¯åˆ›ä½œæ€§â€ï¼š

ä¸å…¶ä»…æä¾›å›ºå®šçš„æƒ…ç»ªæŒ‰é’®ï¼Œä¸å¦‚æä¾›ä¸€ä¸ªè¿·ä½ çš„è™šæ‹Ÿé’¢ç´é”®ç›˜ï¼Œè®©ç”¨æˆ·å¯ä»¥è¾“å…¥ä¸€å°æ®µâ€œç§å­æ—‹å¾‹â€ï¼Œç„¶åç”±æ¨¡å‹åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œç»­å†™ã€‚è¿™èƒ½æå¤§æå‡ç”¨æˆ·çš„å‚ä¸æ„Ÿå’Œåˆ›é€ æ¬²ã€‚

3. å†…å®¹æ·±åº¦ä¸å¹¿åº¦ (Content Depth & Breadth)

ç—›ç‚¹ï¼šéƒ¨åˆ†æ ¸å¿ƒæ¦‚å¿µä¸€ç¬”å¸¦è¿‡

é¡µé¢å·²ç»éå¸¸å…¨é¢ï¼Œä½†å¯ä»¥åœ¨æŸäº›å…³é”®å¯¹æ¯”å’Œç†è®ºç»†èŠ‚ä¸Šè¿›ä¸€æ­¥æ·±åŒ–ã€‚

ä¼˜åŒ–å»ºè®®ï¼š

å¢åŠ ä¸GRUçš„è¯¦ç»†å¯¹æ¯”ï¼š

åœ¨â€œè¿›é˜¶å†…å®¹â€éƒ¨åˆ†ï¼Œå¯ä»¥ä¸“é—¨å¢åŠ ä¸€èŠ‚â€œLSTM vs. GRUï¼šç¹ä¸ç®€çš„æƒè¡¡â€ã€‚

å¹¶æ’å±•ç¤ºLSTMå’ŒGRUçš„ç»“æ„å›¾ä¸å…¬å¼ï¼Œç”¨é«˜äº®å’Œç®­å¤´æ¸…æ™°åœ°æŒ‡å‡ºGRUæ˜¯å¦‚ä½•å°†é—å¿˜é—¨å’Œè¾“å…¥é—¨åˆå¹¶ä¸ºâ€œæ›´æ–°é—¨â€ï¼Œä»¥åŠå®ƒå¦‚ä½•èˆå¼ƒç‹¬ç«‹çš„ç»†èƒçŠ¶æ€ã€‚è¿™èƒ½å¸®åŠ©å­¦ä¹ è€…ç†è§£æ¨¡å‹æ¼”åŒ–çš„å†…åœ¨é€»è¾‘ã€‚

æ¢è®¨LSTMçš„å†…åœ¨ç¼ºé™·ï¼š

åœ¨â€œæ€»ç»“ä¸å±•æœ›â€çš„â€œå±€é™æ€§â€éƒ¨åˆ†ï¼Œå¯ä»¥è¡¥å……ä¸€ç‚¹ï¼šè™½ç„¶ç»†èƒçŠ¶æ€æ˜¯çº¿æ€§ä¼ æ’­ï¼Œä½†å®ƒä»å¯èƒ½æ— é™å¢é•¿æˆ–ç¼©å°ï¼Œå¯¼è‡´æ•°å€¼ä¸ç¨³å®šã€‚è¿™æ­£æ˜¯ä¸ºä»€ä¹ˆtanhæ¿€æ´»å’Œå±‚å½’ä¸€åŒ–ï¼ˆLayer Normalizationï¼‰ç­‰æŠ€æœ¯åœ¨ç°ä»£LSTMåº”ç”¨ä¸­å¾ˆé‡è¦çš„åŸå› ã€‚è¿™ä¸ªç»†èŠ‚å¯ä»¥å±•ç°å†…å®¹çš„ä¸“ä¸šæ·±åº¦ã€‚

4. æ€§èƒ½ä¸æŠ€æœ¯ç»†èŠ‚ (Performance & Technical Details)

ç—›ç‚¹ï¼šå¤§å‹èµ„æºåŠ è½½å¯èƒ½å½±å“åˆæ¬¡è®¿é—®é€Ÿåº¦

é¡µé¢é›†æˆäº†å¤§é‡é«˜è´¨é‡å†…å®¹å’Œäº¤äº’è„šæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´åˆå§‹åŠ è½½æ—¶é—´å˜é•¿ã€‚

ä¼˜åŒ–å»ºè®®ï¼š

èµ„æºæ‡’åŠ è½½ (Lazy Loading)ï¼š

â€œå®æ—¶æƒ…æ„Ÿåˆ†æDemoâ€å’Œâ€œéŸ³ä¹ç”Ÿæˆå™¨â€åŠå…¶èƒŒåçš„TensorFlow.jsæ¨¡å‹å’ŒChart.jsåº“ï¼Œå¯ä»¥ä¸éšé¡µé¢ä¸€èµ·åŠ è½½ã€‚

ä½¿ç”¨IntersectionObserver APIï¼Œå½“ç”¨æˆ·æ»šåŠ¨åˆ°ç›¸åº”åŒºåŸŸæ—¶ï¼Œå†å¼€å§‹åŠ è½½ç›¸å…³çš„JSåº“å’Œæ¨¡å‹æ–‡ä»¶ï¼Œå¹¶åˆå§‹åŒ–åŠŸèƒ½ã€‚è¿™å°†å¤§å¤§åŠ å¿«é¡µé¢çš„åˆå§‹æ¸²æŸ“é€Ÿåº¦ï¼Œä¼˜åŒ–é¦–æ¬¡è®¿é—®ä½“éªŒã€‚

ä¿å­˜ç”¨æˆ·çŠ¶æ€ï¼š

ä½¿ç”¨æµè§ˆå™¨çš„ localStorageï¼Œè‡ªåŠ¨ä¿å­˜ç”¨æˆ·åœ¨â€œå®æ—¶Demoâ€ä¸­è¾“å…¥çš„æœ€åä¸€å¥è¯ã€‚å½“ç”¨æˆ·åˆ·æ–°æˆ–ä¸‹æ¬¡è®¿é—®æ—¶ï¼Œè¾“å…¥æ¡†å†…ä¼šè‡ªåŠ¨å¡«å……ä¸Šæ¬¡çš„å†…å®¹ï¼Œæä¾›ä¸€ç§æ— ç¼çš„ã€ä¸ªæ€§åŒ–çš„è¿ç»­ä½“éªŒã€‚

JavaScriptä»£ç å°è£…ï¼š

ä¸ºäº†æ›´è§„èŒƒå’Œé¿å…å…¨å±€å˜é‡æ±¡æŸ“ï¼Œå¯ä»¥å°†é¡µé¢åº•éƒ¨çš„æ‰€æœ‰JavaScripté€»è¾‘åŒ…è£¹åœ¨ä¸€ä¸ªIIFE (ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼) (function() { ... })(); æˆ–ä½¿ç”¨ç°ä»£çš„ ES6æ¨¡å— <script type="module">ã€‚æ³¨æ„çŸ©é˜µä¹˜æ³•ä¸è¦ç«–ç€å åŠ ä¹˜ï¼Œå·¦å³æ”¾ç½®ï¼Œç»™æˆ‘å®Œæ•´ç‰ˆä¿®æ”¹çš„åçš„