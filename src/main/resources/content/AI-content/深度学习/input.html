<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第8章：长短期记忆网络LSTM - 深度理解与实践</title>
    <meta name="description" content="从原理到实践，深入理解LSTM的设计智慧与数学原理">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">

    <style>
        /* ===== CSS变量定义 ===== */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --lstm-gradient: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            --gru-gradient: linear-gradient(135deg, #fdbb2d 0%, #22c1c3 100%);
            --forget-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --input-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --output-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --cell-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --bg-dark: #0f172a;
            --bg-section: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --accent-red: #ef4444;
            --accent-green: #22c55e;
            --accent-blue: #3b82f6;
            --accent-yellow: #fbbf24;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-orange: #f97316;
            --accent-cyan: #06b6d4;
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        /* ===== 全局样式 ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ===== 背景动画 ===== */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            z-index: -1;
        }

        .bg-particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(168, 237, 234, 0.5);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            from { transform: translateY(100vh) translateX(0); }
            to { transform: translateY(-100px) translateX(100px); }
        }

        /* ===== 布局组件 ===== */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* ===== 导航栏 ===== */
        .nav-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
            transition: transform 0.3s ease;
        }

        .nav-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
        }

        .nav-title h1 {
            font-size: 1.25rem;
            font-weight: 600;
            background: var(--lstm-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            height: 100%;
            background: var(--lstm-gradient);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* ===== 侧边导航 ===== */
        .sidebar {
            position: fixed;
            left: -300px;
            top: 60px;
            bottom: 0;
            width: 300px;
            background: var(--bg-section);
            border-right: 1px solid var(--border-color);
            padding: 2rem;
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 999;
        }

        .sidebar.open { transform: translateX(300px); }

        .toc-item {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            margin-bottom: 0.25rem;
        }

        .toc-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            transform: translateX(4px);
        }

        .toc-item.active {
            background: var(--lstm-gradient);
            color: #0f172a;
        }

        /* ===== 主内容 ===== */
        main {
            margin-top: 80px;
            padding-bottom: 4rem;
        }

        /* ===== 章节标题 ===== */
        .chapter-hero {
            background: var(--lstm-gradient);
            padding: 6rem 0;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .chapter-hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: #0f172a;
        }

        .chapter-hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            animation: fadeInUp 0.8s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== 内容卡片 ===== */
        .section-card {
            background: var(--bg-section);
            border-radius: 1rem;
            padding: 3rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        /* ===== 公式解释布局 ===== */
        .formula-explainer {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr;
            gap: 2rem;
            background: var(--bg-section);
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
            border: 1px solid var(--border-color);
        }

        .formula-column h4 {
            color: var(--accent-cyan);
            margin-bottom: 1rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .formula-math {
            font-size: 1.3rem;
            text-align: center;
            padding: 2rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
        }

        /* ===== 信息卡片网格 ===== */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .info-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.75rem;
            padding: 2rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .info-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .card-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
            display: block;
        }

        .card-title {
            color: var(--accent-cyan);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        /* ===== 重要提示框 ===== */
        .insight-box {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(6, 182, 212, 0.1));
            border: 2px solid rgba(34, 197, 94, 0.3);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .insight-title {
            color: var(--accent-green);
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        /* ===== 代码示例 ===== */
        .code-example {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            overflow-x: auto;
        }

        /* ===== 比较表格 ===== */
        .comparison-table {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            overflow: hidden;
            margin: 2rem 0;
            box-shadow: var(--shadow-lg);
        }

        .comparison-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th {
            background: var(--lstm-gradient);
            color: #0f172a;
            padding: 1.25rem;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        /* ===== 流程图 ===== */
        .lstm-flow-diagram {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            border: 1px solid var(--border-color);
        }

        .flow-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .flow-block {
            background: var(--bg-section);
            border: 2px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            min-width: 150px;
            transition: all 0.3s ease;
        }

        .flow-block:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .flow-arrow {
            font-size: 2rem;
            color: var(--accent-purple);
        }

        /* ===== 矩阵可视化 ===== */
        .matrix-visualization {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            margin: 2rem 0;
        }

        .matrix-container {
            position: relative;
            display: inline-block;
            margin: 0.5rem;
        }

        .matrix-grid {
            display: grid;
            gap: 0.5rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 0.5rem;
        }

        .matrix-cell {
            width: 3.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 0.25rem;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .matrix-cell:hover {
            background: rgba(79, 172, 254, 0.2);
            transform: scale(1.1);
        }

        /* ===== 交互式演示 ===== */
        .interactive-demo {
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(59, 130, 246, 0.05));
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid var(--accent-cyan);
        }

        .demo-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .control-group {
            text-align: center;
        }

        .control-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .forget-slider::-webkit-slider-thumb {
            background: var(--forget-gradient);
            box-shadow: 0 0 10px rgba(240, 147, 251, 0.5);
        }

        .input-slider::-webkit-slider-thumb {
            background: var(--input-gradient);
            box-shadow: 0 0 10px rgba(79, 172, 254, 0.5);
        }

        .output-slider::-webkit-slider-thumb {
            background: var(--output-gradient);
            box-shadow: 0 0 10px rgba(67, 233, 123, 0.5);
        }

        /* ===== 时间线 ===== */
        .timeline {
            position: relative;
            padding: 2rem 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border-color);
        }

        .timeline-item {
            position: relative;
            margin: 2rem 0;
            padding: 0 2rem;
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }

        .timeline-item:nth-child(odd) {
            text-align: right;
            padding-right: 50%;
        }

        .timeline-item:nth-child(even) {
            padding-left: 50%;
        }

        .timeline-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: var(--lstm-gradient);
            border-radius: 50%;
            z-index: 1;
        }

        /* ===== 思考卡片 ===== */
        .think-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(236, 72, 153, 0.1));
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .think-card h3 {
            color: var(--accent-purple);
            margin-bottom: 1rem;
        }

        .think-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .think-option {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .think-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.3);
        }

        /* ===== 数学推导 ===== */
        .math-derivation {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(236, 72, 153, 0.05));
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
        }

        .derivation-step {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid var(--accent-cyan);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 0.5rem 0.5rem 0;
            position: relative;
        }

        /* ===== 按钮样式 ===== */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--lstm-gradient);
            color: #0f172a;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(168, 237, 234, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        /* ===== 提示框 ===== */
        .tip {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin: 1.5rem 0;
            position: relative;
            overflow: hidden;
        }

        .tip::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 4px;
        }

        .tip.info {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.3);
        }
        .tip.info::before { background: var(--accent-blue); }

        .tip.warning {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
        }
        .tip.warning::before { background: var(--accent-yellow); }

        .tip.success {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }
        .tip.success::before { background: var(--accent-green); }

        /* ===== 响应式设计 ===== */
        @media (max-width: 1024px) {
            .formula-explainer { grid-template-columns: 1fr; }
            .card-grid { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
        }

        @media (max-width: 768px) {
            .chapter-hero h1 { font-size: 2.5rem; }
            .section-card { padding: 2rem; }
            .timeline-item:nth-child(odd),
            .timeline-item:nth-child(even) {
                padding-left: 3rem;
                padding-right: 1rem;
                text-align: left;
            }
            .timeline::before { left: 20px; }
            .timeline-dot { left: 20px; }
        }

        /* ===== 动画 ===== */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        /* ===== 滚动条美化 ===== */
        ::-webkit-scrollbar { width: 10px; height: 10px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); }
        ::-webkit-scrollbar-thumb {
            background: var(--text-muted);
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }
    </style>
</head>
<body>

<!-- 背景动画 -->
<div class="bg-animation" id="bgAnimation"></div>

<!-- 导航栏 -->
<nav class="nav-header" role="navigation" aria-label="主导航">
    <div class="container">
        <div class="nav-content">
            <div class="nav-title">
                <button id="toggle-sidebar" class="btn btn-secondary" style="margin-right: 1rem;">
                    ☰ 目录
                </button>
                <h1>第8章：长短期记忆网络LSTM</h1>
            </div>
            <div>
                <button id="toggle-theme" class="btn btn-secondary">🌙</button>
            </div>
        </div>
        <div class="nav-progress">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
    </div>
</nav>

<!-- 侧边栏目录 -->
<aside class="sidebar" id="sidebar">
    <h3 style="margin-bottom: 1.5rem; color: var(--accent-pink);">📚 目录导航</h3>
    <nav>
        <a href="#intro" class="toc-item active">序言：记忆的艺术</a>
        <a href="#problem" class="toc-item">RNN的困境</a>
        <a href="#solution" class="toc-item">解决思路</a>
        <a href="#lstm-structure" class="toc-item">LSTM核心结构</a>
        <a href="#forget-gate" class="toc-item">遗忘门详解</a>
        <a href="#input-gate" class="toc-item">输入门详解</a>
        <a href="#output-gate" class="toc-item">输出门详解</a>
        <a href="#integration" class="toc-item">整合过程</a>
        <a href="#math-proof" class="toc-item">数学证明</a>
        <a href="#implementation" class="toc-item">代码实现</a>
        <a href="#comparison" class="toc-item">LSTM vs GRU</a>
        <a href="#applications" class="toc-item">实际应用</a>
        <a href="#summary" class="toc-item">总结与展望</a>
    </nav>
</aside>

<!-- 主内容 -->
<main>
    <!-- 章节标题 -->
    <section class="chapter-hero">
        <div class="container">
            <div class="chapter-hero-content">
                <h1>长短期记忆网络：让AI学会遗忘与记忆</h1>
                <p style="font-size: 1.5rem; margin-bottom: 2rem;">深入理解LSTM的精妙设计，掌握门控机制的数学原理</p>
            </div>
        </div>
    </section>

    <div class="container">
        <!-- 序言：记忆的艺术 -->
        <section id="intro" class="section-card">
            <h2 style="color: var(--accent-pink); margin-bottom: 2rem;">📖 序言：记忆的艺术</h2>

            <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 2rem;">
                1997年，德国慕尼黑工业大学的研究团队面临着一个棘手的问题：如何让神经网络真正"记住"长期的信息？
            </p>

            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-pink);">1991年</h4>
                    <p>Hochreiter发现梯度消失问题</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-blue);">1997年</h4>
                    <p>LSTM论文发表，引入门控机制</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-green);">2000年</h4>
                    <p>添加遗忘门，LSTM结构完善</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-orange);">2014年</h4>
                    <p>LSTM在机器翻译中大放异彩</p>
                </div>
            </div>
        </section>

        <!-- RNN的困境 -->
        <section id="problem" class="section-card">
            <h2 style="color: var(--accent-red); margin-bottom: 2rem;">💔 RNN的困境：梯度消失问题</h2>

            <div class="math-derivation">
                <h3 style="color: var(--accent-red); margin-bottom: 1.5rem;">🔬 梯度消失的数学本质</h3>

                <div class="derivation-step">
                    <h4>RNN的梯度传播</h4>
                    <p>回忆RNN的隐藏状态更新公式：</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $$\mathbf{h}_t = \tanh(\mathbf{W}_{hh} \mathbf{h}_{t-1} + \mathbf{W}_{xh} \mathbf{x}_t + \mathbf{b}_h)$$
                    </div>
                    <p>当计算损失对早期隐藏状态的梯度时，会出现连乘：</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $$\frac{\partial L}{\partial \mathbf{h}_1} = \frac{\partial L}{\partial \mathbf{h}_T} \cdot \prod_{t=2}^{T} \frac{\partial \mathbf{h}_t}{\partial \mathbf{h}_{t-1}}$$
                    </div>
                </div>

                <div class="derivation-step">
                    <h4>问题的根源</h4>
                    <p>由于 $\tanh'(x) = 1 - \tanh^2(x) \in (0, 1]$，梯度会指数级衰减！</p>
                </div>
            </div>

            <div class="tip warning">
                <span style="font-size: 1.5rem;">⚠️</span>
                <div>
                    <strong>关键洞察：</strong>当序列长度为100时，如果每步梯度衰减0.9，最终梯度只有初始的 $0.9^{100} \approx 10^{-5}$！
                </div>
            </div>
        </section>

        <!-- 解决思路 -->
        <section id="solution" class="section-card">
            <h2 style="color: var(--accent-blue); margin-bottom: 2rem;">💡 解决思路：如何设计更好的记忆机制？</h2>

            <div class="think-card">
                <h3>🧠 设计思考：如果你来设计，会怎么做？</h3>
                <p>在看LSTM的解决方案之前，让我们自己思考一下：如何让网络既能记住重要信息，又能忘记无用信息？</p>

                <div class="think-options">
                    <div class="think-option">
                        <h4 style="color: var(--accent-cyan);">💭 思考1</h4>
                        <p>如何创建一条"高速公路"，让信息可以无损传递？</p>
                    </div>
                    <div class="think-option">
                        <h4 style="color: var(--accent-pink);">💭 思考2</h4>
                        <p>如何让网络自己决定什么信息重要？</p>
                    </div>
                    <div class="think-option">
                        <h4 style="color: var(--accent-green);">💭 思考3</h4>
                        <p>用什么数学工具来实现选择性控制？</p>
                    </div>
                </div>
            </div>

            <div class="insight-box">
                <h3 class="insight-title">🎯 LSTM的核心创新</h3>
                <p>LSTM的天才之处在于引入了<strong>细胞状态（Cell State）</strong>作为信息的高速公路，
                    并通过<strong>门控机制（Gating Mechanism）</strong>来控制信息的流动。</p>
            </div>
        </section>

        <!-- LSTM核心结构 -->
        <section id="lstm-structure" class="section-card">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">🎯 LSTM核心结构</h2>

            <div class="lstm-flow-diagram">
                <h3 style="text-align: center; color: var(--accent-cyan); margin-bottom: 2rem;">LSTM信息流向图</h3>
                <div class="flow-container">
                    <div class="flow-block">
                        <div style="font-size: 2rem;">📊</div>
                        <div style="color: var(--accent-green);">C<sub>t-1</sub></div>
                        <div style="font-size: 0.875rem;">前一时刻细胞状态</div>
                    </div>

                    <div class="flow-arrow">→</div>

                    <div class="flow-block">
                        <div style="font-size: 2rem;">🚪</div>
                        <div style="color: var(--accent-pink);">遗忘门</div>
                        <div style="font-size: 0.875rem;">决定遗忘什么</div>
                    </div>

                    <div class="flow-arrow">→</div>

                    <div class="flow-block">
                        <div style="font-size: 2rem;">📥</div>
                        <div style="color: var(--accent-cyan);">输入门</div>
                        <div style="font-size: 0.875rem;">决定存储什么</div>
                    </div>

                    <div class="flow-arrow">→</div>

                    <div class="flow-block">
                        <div style="font-size: 2rem;">📤</div>
                        <div style="color: var(--accent-yellow);">输出门</div>
                        <div style="font-size: 0.875rem;">决定输出什么</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 遗忘门详解 -->
        <section id="forget-gate" class="section-card">
            <h2 style="color: var(--accent-pink); margin-bottom: 2rem;">🚪 遗忘门详细解析</h2>

            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>数学公式</h4>
                    <div class="formula-math">
                        f<sub>t</sub> = σ(W<sub>f</sub> · [h<sub>t-1</sub>, x<sub>t</sub>] + b<sub>f</sub>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>矩阵运算可视化</h4>
                    <div class="matrix-visualization">
                        <div class="matrix-container">
                            <div class="matrix-grid" style="grid-template-columns: repeat(4, 1fr);">
                                <div class="matrix-cell">W<sub>f</sub></div>
                                <div class="matrix-cell">×</div>
                                <div class="matrix-cell">[h,x]</div>
                                <div class="matrix-cell">= f<sub>t</sub></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>含义解释</h4>
                    <div>
                        <p><strong>f<sub>t</sub>:</strong> 遗忘门输出，控制遗忘程度</p>
                        <p><strong>σ:</strong> Sigmoid函数，输出[0,1]</p>
                        <p><strong>W<sub>f</sub>:</strong> 遗忘门权重矩阵</p>
                    </div>
                </div>
            </div>

            <div class="card-grid">
                <div class="info-card">
                    <span class="card-icon">🎯</span>
                    <h3 class="card-title">遗忘门的作用</h3>
                    <p>控制向量，每个元素∈[0,1]</p>
                    <ul style="margin-top: 0.5rem;">
                        <li>0 = 完全遗忘</li>
                        <li>1 = 完全保留</li>
                        <li>0.5 = 保留一半</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">🔄</span>
                    <h3 class="card-title">Sigmoid函数</h3>
                    <p>将任意值映射到[0,1]</p>
                    <p style="font-family: monospace;">σ(x) = 1/(1+e<sup>-x</sup>)</p>
                </div>

                <div class="info-card">
                    <span class="card-icon">⚡</span>
                    <h3 class="card-title">权重矩阵</h3>
                    <p>学习如何组合输入信息</p>
                    <p>维度：隐藏维度 × (h维度 + x维度)</p>
                </div>
            </div>

            <div class="insight-box">
                <h3 class="insight-title">遗忘门如何作用于细胞状态？</h3>
                <div style="text-align: center; font-size: 1.5rem; margin: 1rem 0;">
                    C<sub>t</sub><sup>new</sup> = f<sub>t</sub> ⊙ C<sub>t-1</sub>
                </div>
                <p>⊙ 表示逐元素相乘（Hadamard积）</p>
            </div>
        </section>

        <!-- 输入门详解 -->
        <section id="input-gate" class="section-card">
            <h2 style="color: var(--accent-cyan); margin-bottom: 2rem;">📥 输入门与候选值详解</h2>

            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>输入门公式</h4>
                    <div class="formula-math">
                        i<sub>t</sub> = σ(W<sub>i</sub> · [h<sub>t-1</sub>, x<sub>t</sub>] + b<sub>i</sub>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>候选值公式</h4>
                    <div class="formula-math">
                        C̃<sub>t</sub> = tanh(W<sub>C</sub> · [h<sub>t-1</sub>, x<sub>t</sub>] + b<sub>C</sub>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>新信息计算</h4>
                    <div class="formula-math">
                        新增信息 = i<sub>t</sub> ⊙ C̃<sub>t</sub>
                    </div>
                </div>
            </div>

            <div class="insight-box" style="background: linear-gradient(135deg, rgba(79, 172, 254, 0.1), rgba(0, 242, 254, 0.1)); border-color: var(--accent-cyan);">
                <h3 class="insight-title" style="color: var(--accent-cyan);">输入门的作用机制</h3>
                <p>输入门通过两步确定要存储的新信息：</p>
                <ul>
                    <li><strong>i<sub>t</sub>:</strong> 决定存储权重（0=忽略，1=全部存储）</li>
                    <li><strong>C̃<sub>t</sub>:</strong> 候选记忆内容（范围[-1,1]）</li>
                </ul>
            </div>
        </section>

        <!-- 输出门详解 -->
        <section id="output-gate" class="section-card">
            <h2 style="color: var(--accent-yellow); margin-bottom: 2rem;">📤 输出门详解</h2>

            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>输出门公式</h4>
                    <div class="formula-math">
                        o<sub>t</sub> = σ(W<sub>o</sub> · [h<sub>t-1</sub>, x<sub>t</sub>] + b<sub>o</sub>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>隐藏状态公式</h4>
                    <div class="formula-math">
                        h<sub>t</sub> = o<sub>t</sub> ⊙ tanh(C<sub>t</sub>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>输出过滤</h4>
                    <div class="formula-math">
                        从细胞状态C<sub>t</sub>中<br>选择性输出信息
                    </div>
                </div>
            </div>

            <div class="insight-box" style="background: linear-gradient(135deg, rgba(250, 112, 154, 0.1), rgba(254, 225, 64, 0.1)); border-color: var(--accent-yellow);">
                <h3 class="insight-title" style="color: var(--accent-yellow);">输出门的智能选择</h3>
                <p>输出门决定从丰富的细胞状态中输出哪些信息：</p>
                <ul>
                    <li>细胞状态C<sub>t</sub>保存完整信息</li>
                    <li>通过tanh压缩到[-1,1]范围</li>
                    <li>o<sub>t</sub>选择性过滤输出内容</li>
                </ul>
            </div>
        </section>

        <!-- 整合过程 -->
        <section id="integration" class="section-card" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">🔄 整合过程：三个门的协同效果</h2>

            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>细胞状态更新</h4>
                    <div class="formula-math">
                        C<sub>t</sub> = f<sub>t</sub> ⊙ C<sub>t-1</sub> + i<sub>t</sub> ⊙ C̃<sub>t</sub>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>三个门的作用</h4>
                    <div style="text-align: left; padding: 1rem;">
                        <p><span style="color: var(--accent-pink);">遗忘门:</span> 选择性遗忘</p>
                        <p><span style="color: var(--accent-cyan);">输入门:</span> 选择性记忆</p>
                        <p><span style="color: var(--accent-yellow);">输出门:</span> 选择性输出</p>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>最终效果</h4>
                    <div style="text-align: center; padding: 1rem;">
                        <div style="font-size: 2rem;">✨</div>
                        <p>精确控制信息流<br>解决长期依赖问题</p>
                    </div>
                </div>
            </div>

            <!-- 矩阵维度变化详解 -->
            <div class="insight-box" style="background: linear-gradient(135deg, rgba(167, 139, 250, 0.1), rgba(96, 165, 250, 0.1)); border-color: var(--accent-purple); margin-top: 3rem;">
                <h3 class="insight-title" style="color: var(--accent-purple);">📐 矩阵维度变化详解</h3>
                <div class="insight-content">
                    <p>假设：隐藏维度 = 128，输入维度 = 100，批次大小 = 32</p>

                    <div style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">第一步：输入拼接</h4>
                        <div style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: 0.5rem; font-family: monospace;">
                            [h<sub>t-1</sub>, x<sub>t</sub>] = [32×128, 32×100] → 32×228
                        </div>
                    </div>

                    <div style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-pink); margin-bottom: 1rem;">第二步：计算三个门</h4>
                        <div style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: 0.5rem;">
                            <p style="font-family: monospace; margin-bottom: 0.5rem;">
                                f<sub>t</sub> = σ(W<sub>f</sub>[32×228] + b<sub>f</sub>) → 32×128
                            </p>
                            <p style="font-family: monospace; margin-bottom: 0.5rem;">
                                i<sub>t</sub> = σ(W<sub>i</sub>[32×228] + b<sub>i</sub>) → 32×128
                            </p>
                            <p style="font-family: monospace; margin-bottom: 0.5rem;">
                                o<sub>t</sub> = σ(W<sub>o</sub>[32×228] + b<sub>o</sub>) → 32×128
                            </p>
                            <p style="font-family: monospace;">
                                C̃<sub>t</sub> = tanh(W<sub>c</sub>[32×228] + b<sub>c</sub>) → 32×128
                            </p>
                        </div>
                    </div>

                    <div style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-green); margin-bottom: 1rem;">第三步：更新细胞状态</h4>
                        <div style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: 0.5rem; font-family: monospace;">
                            <p style="margin-bottom: 0.5rem;">C<sub>t</sub> = f<sub>t</sub> ⊙ C<sub>t-1</sub> + i<sub>t</sub> ⊙ C̃<sub>t</sub></p>
                            <p>= [32×128] ⊙ [32×128] + [32×128] ⊙ [32×128] → 32×128</p>
                        </div>
                    </div>

                    <div style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-yellow); margin-bottom: 1rem;">第四步：计算输出</h4>
                        <div style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: 0.5rem; font-family: monospace;">
                            <p style="margin-bottom: 0.5rem;">h<sub>t</sub> = o<sub>t</sub> ⊙ tanh(C<sub>t</sub>)</p>
                            <p>= [32×128] ⊙ tanh([32×128]) → 32×128</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 效果展示 -->
            <div class="card-grid" style="margin-top: 3rem;">
                <div class="info-card">
                    <span class="card-icon">🎯</span>
                    <h3 class="card-title">遗忘门的效果</h3>
                    <p>通过 f<sub>t</sub> ⊙ C<sub>t-1</sub>：</p>
                    <ul style="margin-top: 0.5rem;">
                        <li>选择性保留历史信息</li>
                        <li>过滤掉不相关的记忆</li>
                        <li>避免信息过载</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">✨</span>
                    <h3 class="card-title">输入门的效果</h3>
                    <p>通过 i<sub>t</sub> ⊙ C̃<sub>t</sub>：</p>
                    <ul style="margin-top: 0.5rem;">
                        <li>控制新信息的强度</li>
                        <li>选择重要特征存储</li>
                        <li>防止噪声干扰</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">🔍</span>
                    <h3 class="card-title">输出门的效果</h3>
                    <p>通过 o<sub>t</sub> ⊙ tanh(C<sub>t</sub>)：</p>
                    <ul style="margin-top: 0.5rem;">
                        <li>过滤输出信息</li>
                        <li>保持内部状态私密</li>
                        <li>适应不同任务需求</li>
                    </ul>
                </div>
            </div>

            <!-- 交互式演示 -->
            <div class="interactive-demo">
                <h3 style="color: var(--accent-cyan); text-align: center; margin-bottom: 2rem;">🎮 LSTM门控交互演示</h3>

                <div class="demo-controls">
                    <div class="control-group">
                        <label>遗忘门 f<sub>t</sub></label>
                        <div class="control-value" style="color: var(--accent-pink);" id="forget-value">0.5</div>
                        <input type="range" class="slider forget-slider" id="forget-slider" min="0" max="1" step="0.01" value="0.5">
                    </div>

                    <div class="control-group">
                        <label>输入门 i<sub>t</sub></label>
                        <div class="control-value" style="color: var(--accent-cyan);" id="input-value">0.5</div>
                        <input type="range" class="slider input-slider" id="input-slider" min="0" max="1" step="0.01" value="0.5">
                    </div>

                    <div class="control-group">
                        <label>输出门 o<sub>t</sub></label>
                        <div class="control-value" style="color: var(--accent-yellow);" id="output-value">0.5</div>
                        <input type="range" class="slider output-slider" id="output-slider" min="0" max="1" step="0.01" value="0.5">
                    </div>
                </div>

                <div style="background: rgba(255, 255, 255, 0.05); border-radius: 0.75rem; padding: 2rem; margin-top: 2rem;">
                    <h4 style="color: var(--accent-purple); margin-bottom: 1rem;">计算结果</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div>
                            <strong>遗忘后：</strong><span id="after-forget">0.50</span><br>
                            <strong>新增信息：</strong><span id="new-info">0.40</span>
                        </div>
                        <div>
                            <strong>新细胞状态：</strong>C<sub>t</sub> = <span id="new-cell">0.90</span><br>
                            <strong>最终输出：</strong>h<sub>t</sub> = <span id="final-output">0.36</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 实际效果对比 -->
            <div style="margin-top: 3rem;">
                <h3 style="color: var(--accent-purple); text-align: center; margin-bottom: 2rem;">🔬 实际效果对比</h3>

                <div class="comparison-table">
                    <table>
                        <thead>
                        <tr>
                            <th>场景</th>
                            <th>遗忘门设置</th>
                            <th>输入门设置</th>
                            <th>输出门设置</th>
                            <th>效果</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><strong>句子开始</strong></td>
                            <td>f ≈ 0.1 (低)</td>
                            <td>i ≈ 0.9 (高)</td>
                            <td>o ≈ 0.8 (高)</td>
                            <td>清空旧信息，接收新句子</td>
                        </tr>
                        <tr>
                            <td><strong>重要实体</strong></td>
                            <td>f ≈ 0.9 (高)</td>
                            <td>i ≈ 0.8 (高)</td>
                            <td>o ≈ 0.5 (中)</td>
                            <td>保留历史，添加新信息</td>
                        </tr>
                        <tr>
                            <td><strong>标点符号</strong></td>
                            <td>f ≈ 0.8 (高)</td>
                            <td>i ≈ 0.1 (低)</td>
                            <td>o ≈ 0.3 (低)</td>
                            <td>维持状态，忽略无关信息</td>
                        </tr>
                        <tr>
                            <td><strong>句子结束</strong></td>
                            <td>f ≈ 0.7 (中高)</td>
                            <td>i ≈ 0.3 (低)</td>
                            <td>o ≈ 0.9 (高)</td>
                            <td>输出总结信息</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="tip success">
                <span style="font-size: 1.5rem;">🎯</span>
                <div>
                    <strong>关键洞察：</strong>通过三个门的协同工作，LSTM实现了：
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li><strong>梯度稳定传播：</strong>细胞状态的线性路径避免梯度消失</li>
                        <li><strong>选择性记忆：</strong>精确控制信息的保留、更新和输出</li>
                        <li><strong>长期依赖建模：</strong>重要信息可以跨越很长的时间步传递</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- 数学证明 -->
        <section id="math-proof" class="section-card">
            <h2 style="color: var(--accent-red); margin-bottom: 2rem;">🔬 数学证明：LSTM如何解决梯度消失</h2>

            <div class="math-derivation">
                <h3 style="color: var(--accent-red); margin-bottom: 1.5rem;">📐 梯度传播分析</h3>

                <div class="derivation-step">
                    <h4>细胞状态的梯度传播</h4>
                    <p>从细胞状态更新公式出发：</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $C_t = f_t \odot C_{t-1} + i_t \odot \tilde{C}_t$
                    </div>
                    <p>计算梯度：</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $\frac{\partial C_t}{\partial C_{t-1}} = \text{diag}(f_t)$
                    </div>
                </div>

                <div class="derivation-step">
                    <h4>关键洞察</h4>
                    <p>梯度通过<strong>对角矩阵</strong>传播，而不是密集矩阵！</p>
                    <div class="tip success">
                        <span>💡</span>
                        <div>
                            这意味着：
                            <ul style="margin-left: 1.5rem;">
                                <li>每个维度的梯度独立传播</li>
                                <li>网络可以学习让 f_t ≈ 1 来保持梯度</li>
                                <li>避免了梯度的指数级衰减</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 代码实现 -->
        <section id="implementation" class="section-card">
            <h2 style="color: var(--accent-yellow); margin-bottom: 2rem;">🛠️ 从零实现LSTM</h2>

            <div class="code-example">
                <pre><code class="language-python">import numpy as np

class LSTMCell:
    """LSTM单元的NumPy实现"""
    def __init__(self, input_dim, hidden_dim):
        # 初始化权重矩阵
        scale = np.sqrt(2.0 / (input_dim + hidden_dim))

        # 遗忘门参数
        self.Wf = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bf = np.ones((hidden_dim, 1))  # 初始化为1，促进记忆

        # 输入门参数
        self.Wi = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bi = np.zeros((hidden_dim, 1))

        # 候选值参数
        self.Wc = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bc = np.zeros((hidden_dim, 1))

        # 输出门参数
        self.Wo = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bo = np.zeros((hidden_dim, 1))

    def forward(self, x_t, h_prev, c_prev):
        """LSTM前向传播"""
        # 拼接输入
        concat = np.vstack([h_prev, x_t])

        # 计算四个门
        f_t = self.sigmoid(np.dot(self.Wf, concat) + self.bf)  # 遗忘门
        i_t = self.sigmoid(np.dot(self.Wi, concat) + self.bi)  # 输入门
        c_tilde_t = np.tanh(np.dot(self.Wc, concat) + self.bc)  # 候选值
        o_t = self.sigmoid(np.dot(self.Wo, concat) + self.bo)  # 输出门

        # 更新细胞状态
        c_t = f_t * c_prev + i_t * c_tilde_t

        # 计算隐藏状态
        h_t = o_t * np.tanh(c_t)

        return h_t, c_t

    @staticmethod
    def sigmoid(x):
        """数值稳定的sigmoid函数"""
        return np.where(x >= 0,
                       1 / (1 + np.exp(-x)),
                       np.exp(x) / (1 + np.exp(x)))</code></pre>
            </div>
        </section>

        <!-- LSTM vs GRU对比 -->
        <section id="comparison" class="section-card">
            <h2 style="color: var(--accent-yellow); margin-bottom: 2rem;">⚔️ LSTM vs GRU：繁与简的权衡</h2>

            <div class="comparison-table">
                <table>
                    <thead>
                    <tr>
                        <th>特性</th>
                        <th>LSTM (1997)</th>
                        <th>GRU (2014)</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><strong>门的数量</strong></td>
                        <td>3个门（遗忘、输入、输出）</td>
                        <td>2个门（重置、更新）</td>
                    </tr>
                    <tr>
                        <td><strong>状态数量</strong></td>
                        <td>双状态（细胞状态+隐藏状态）</td>
                        <td>单状态（只有隐藏状态）</td>
                    </tr>
                    <tr>
                        <td><strong>参数量</strong></td>
                        <td>4个权重矩阵</td>
                        <td>3个权重矩阵</td>
                    </tr>
                    <tr>
                        <td><strong>优势</strong></td>
                        <td>表达能力强，适合复杂任务</td>
                        <td>参数少，训练快</td>
                    </tr>
                    <tr>
                        <td><strong>劣势</strong></td>
                        <td>参数多，训练慢</td>
                        <td>表达能力稍弱</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 实际应用 -->
        <section id="applications" class="section-card">
            <h2 style="color: var(--accent-green); margin-bottom: 2rem;">🚀 实际应用案例</h2>

            <div class="card-grid">
                <div class="info-card">
                    <span class="card-icon">🌐</span>
                    <h3 class="card-title">机器翻译</h3>
                    <p>Google翻译使用LSTM实现高质量的序列到序列翻译，准确处理长句子中的语法和语义关系。</p>
                </div>

                <div class="info-card">
                    <span class="card-icon">🗣️</span>
                    <h3 class="card-title">语音识别</h3>
                    <p>Apple Siri、Amazon Alexa等语音助手使用LSTM处理连续语音流，准确识别用户意图。</p>
                </div>

                <div class="info-card">
                    <span class="card-icon">📈</span>
                    <h3 class="card-title">时序预测</h3>
                    <p>金融市场预测、天气预报、交通流量预测等领域广泛使用LSTM捕获时间序列中的长期模式。</p>
                </div>

                <div class="info-card">
                    <span class="card-icon">✍️</span>
                    <h3 class="card-title">文本生成</h3>
                    <p>GPT系列模型的前身，LSTM在文本生成、诗歌创作、代码补全等任务中表现出色。</p>
                </div>
            </div>
        </section>

        <!-- 总结与展望 -->
        <section id="summary" class="section-card">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">🎯 本章总结：LSTM的精妙设计</h2>

            <div class="card-grid">
                <div class="info-card">
                    <span class="card-icon">🎯</span>
                    <h3 class="card-title">核心创新</h3>
                    <ul>
                        <li>细胞状态：线性信息高速公路</li>
                        <li>门控机制：精确的信息流控制</li>
                        <li>梯度高速路：解决长期依赖</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">💡</span>
                    <h3 class="card-title">设计智慧</h3>
                    <ul>
                        <li>遗忘门：选择性遗忘</li>
                        <li>输入门：选择性记忆</li>
                        <li>输出门：按需提取</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">🚀</span>
                    <h3 class="card-title">应用领域</h3>
                    <ul>
                        <li>自然语言处理</li>
                        <li>语音识别</li>
                        <li>时序预测</li>
                        <li>序列生成</li>
                    </ul>
                </div>

                <div class="info-card">
                    <span class="card-icon">⚠️</span>
                    <h3 class="card-title">局限性</h3>
                    <ul>
                        <li>计算复杂度高</li>
                        <li>难以并行化</li>
                        <li>参数量大</li>
                        <li>训练时间长</li>
                    </ul>
                </div>
            </div>

            <div class="tip success" style="margin-top: 3rem;">
                <span style="font-size: 2rem;">🎓</span>
                <div>
                    <h3 style="margin-bottom: 1rem;">学习LSTM的收获</h3>
                    <p style="font-size: 1.1rem; line-height: 1.8;">
                        通过本章的深度学习，你已经掌握了：<br>
                        • LSTM如何通过巧妙的门控机制解决梯度消失问题<br>
                        • 细胞状态作为信息高速公路的设计智慧<br>
                        • 从零实现LSTM的完整代码和数学推导<br>
                        • LSTM与GRU的详细对比和选择策略<br>
                        • 在实际应用中的优化技巧和最佳实践
                    </p>
                    <p style="margin-top: 1rem; font-size: 1.2rem; color: var(--accent-cyan);">
                        <strong>下一步：</strong>学习Transformer和自注意力机制，了解序列建模的最新突破！
                    </p>
                </div>
            </div>
        </section>
    </div>
</main>

<!-- 页脚 -->
<footer style="background: var(--bg-section); padding: 3rem 0; border-top: 1px solid var(--border-color);">
    <div class="container">
        <div style="text-align: center; color: var(--text-secondary);">
            <p style="margin-bottom: 1rem; font-size: 1.1rem;">
                📖 深度学习序列建模 | 第8章：长短期记忆网络LSTM
            </p>
            <p>© 2024 Deep Learning Tutorial Series. 教育目的使用。</p>
        </div>
    </div>
</footer>

<script>
    // 主要交互功能
    (function() {
        'use strict';

        // 导航功能
        const toggleSidebar = document.getElementById('toggle-sidebar');
        const sidebar = document.getElementById('sidebar');

        toggleSidebar.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });

        // 进度条
        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('progress-bar').style.width = scrolled + '%';

            // 更新侧边栏高亮
            updateSidebarHighlight();
        });

        // 更新侧边栏高亮
        function updateSidebarHighlight() {
            const sections = document.querySelectorAll('section[id]');
            const tocItems = document.querySelectorAll('.toc-item');
            let current = '';

            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            tocItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === `#${current}`) {
                    item.classList.add('active');
                }
            });
        }

        // 交互式演示
        const forgetSlider = document.getElementById('forget-slider');
        const inputSlider = document.getElementById('input-slider');
        const outputSlider = document.getElementById('output-slider');

        function updateCalculations() {
            const ft = parseFloat(forgetSlider.value);
            const it = parseFloat(inputSlider.value);
            const ot = parseFloat(outputSlider.value);

            // 更新显示值
            document.getElementById('forget-value').textContent = ft.toFixed(2);
            document.getElementById('input-value').textContent = it.toFixed(2);
            document.getElementById('output-value').textContent = ot.toFixed(2);

            // 计算
            const Ct_prev = 1.0;
            const C_tilde = 0.8;

            const forgotten = ft * Ct_prev;
            const newInfo = it * C_tilde;
            const Ct = forgotten + newInfo;
            const ht = ot * Math.tanh(Ct);

            // 更新结果
            document.getElementById('after-forget').textContent = forgotten.toFixed(2);
            document.getElementById('new-info').textContent = newInfo.toFixed(2);
            document.getElementById('new-cell').textContent = Ct.toFixed(2);
            document.getElementById('final-output').textContent = ht.toFixed(2);
        }

        forgetSlider.addEventListener('input', updateCalculations);
        inputSlider.addEventListener('input', updateCalculations);
        outputSlider.addEventListener('input', updateCalculations);

        // 初始计算
        updateCalculations();

        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

    })();
</script>

<!-- 外部依赖加载 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<script>
    // 代码高亮
    if (window.hljs) {
        hljs.highlightAll();
    }

    // 数学公式渲染
    if (window.renderMathInElement) {
        renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });
    }
</script>

</body>
</html>