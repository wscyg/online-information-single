<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬8ç« ï¼šé•¿çŸ­æœŸè®°å¿†ç½‘ç»œLSTM - è®©ç¥ç»ç½‘ç»œå­¦ä¼šé—å¿˜ä¸è®°å¿† | æ·±åº¦å­¦ä¹ åºåˆ—å»ºæ¨¡</title>
    <meta name="description" content="é€šè¿‡äº¤äº’å¼å¯è§†åŒ–æ·±å…¥ç†è§£LSTMçš„ç²¾å¦™è®¾è®¡ï¼Œä¸€æ­¥æ­¥æ¨å¯¼é—¨æ§æœºåˆ¶çš„æ•°å­¦åŸç†">

    <!-- å¤–éƒ¨ä¾èµ– - æŒ‰éœ€åŠ è½½ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">

    <style>
        /* ===== CSSå˜é‡å®šä¹‰ ===== */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --lstm-gradient: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            --gru-gradient: linear-gradient(135deg, #fdbb2d 0%, #22c1c3 100%);
            --forget-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --input-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --output-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --cell-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --bg-dark: #0f172a;
            --bg-section: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --accent-red: #ef4444;
            --accent-green: #22c55e;
            --accent-blue: #3b82f6;
            --accent-yellow: #fbbf24;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-orange: #f97316;
            --accent-cyan: #06b6d4;
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.3);
            --animation-duration: 0.3s;
            --content-max-width: 1400px;
        }

        /* ===== å…¨å±€æ ·å¼ ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }

        /* ===== èƒŒæ™¯åŠ¨ç”» ===== */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            z-index: -1;
        }

        .bg-particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(168, 237, 234, 0.5);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            from {
                transform: translateY(100vh) translateX(0);
            }
            to {
                transform: translateY(-100px) translateX(100px);
            }
        }

        /* ===== å¸ƒå±€ç»„ä»¶ ===== */
        .container {
            max-width: var(--content-max-width);
            margin: 0 auto;
            padding: 0 1rem;
            position: relative;
        }

        /* ===== å¯¼èˆªæ  ===== */
        .nav-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
            transition: transform 0.3s ease;
        }

        .nav-header.hidden {
            transform: translateY(-100%);
        }

        .nav-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
        }

        .nav-title h1 {
            font-size: 1.25rem;
            font-weight: 600;
            background: var(--lstm-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            height: 100%;
            background: var(--lstm-gradient);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* ===== ä¾§è¾¹å¯¼èˆª ===== */
        .sidebar {
            position: fixed;
            left: -300px;
            top: 60px;
            bottom: 0;
            width: 300px;
            background: var(--bg-section);
            border-right: 1px solid var(--border-color);
            padding: 2rem;
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 999;
        }

        .sidebar.open {
            transform: translateX(300px);
        }

        .toc-item {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.5rem;
            transition: all var(--animation-duration) ease;
            margin-bottom: 0.25rem;
        }

        .toc-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            transform: translateX(4px);
        }

        .toc-item.active {
            background: var(--lstm-gradient);
            color: #0f172a;
        }

        /* ===== ä¸»å†…å®¹ ===== */
        main {
            margin-top: 80px;
            padding-bottom: 4rem;
        }

        /* ===== ç« èŠ‚æ ‡é¢˜ ===== */
        .chapter-hero {
            background: var(--lstm-gradient);
            padding: 6rem 0;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .chapter-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, transparent 70%);
            animation: pulse 10s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(180deg); }
        }

        .chapter-hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: #0f172a;
        }

        .chapter-hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            animation: fadeInUp 0.8s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== ä¸‰æ å…¬å¼è§£é‡Šå¸ƒå±€ ===== */
        .formula-explainer {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr;
            gap: 2rem;
            background: var(--bg-section);
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .formula-explainer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--lstm-gradient);
        }

        .formula-column {
            position: relative;
        }

        .formula-column h4 {
            color: var(--accent-cyan);
            margin-bottom: 1rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* å…¬å¼åˆ— */
        .formula-math {
            font-size: 1.3rem;
            text-align: center;
            padding: 2rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .formula-math::before {
            content: 'âˆ‘';
            position: absolute;
            top: -20px;
            right: -10px;
            font-size: 4rem;
            opacity: 0.05;
            font-family: 'Times New Roman', serif;
        }

        /* çŸ©é˜µå¯è§†åŒ–åˆ— - ä¼˜åŒ–å·¦å³å¸ƒå±€ */
        .matrix-visual {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .matrix-operation {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
            margin: 1rem 0;
        }

        .matrix-visual svg {
            filter: drop-shadow(0 4px 15px rgba(0, 0, 0, 0.3));
        }

        /* é‡Šä¹‰åˆ— */
        .formula-meaning {
            padding: 1rem;
            font-size: 0.95rem;
            line-height: 1.8;
        }

        .meaning-item {
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            cursor: pointer;
        }

        .meaning-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--border-color);
        }

        /* é«˜äº®äº¤äº’æ ·å¼ */
        .highlight-target {
            transition: all 0.3s ease;
            cursor: pointer;
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            position: relative;
        }

        .highlight-target:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .highlight-active {
            background: rgba(79, 172, 254, 0.3) !important;
            color: var(--accent-blue) !important;
            font-weight: bold;
            box-shadow: 0 0 20px rgba(79, 172, 254, 0.5);
        }

        /* å®æ—¶è”åŠ¨é«˜äº® */
        .live-highlight {
            animation: pulse-highlight 1s ease-in-out;
        }

        @keyframes pulse-highlight {
            0%, 100% {
                background: rgba(79, 172, 254, 0.3);
                transform: scale(1);
            }
            50% {
                background: rgba(79, 172, 254, 0.6);
                transform: scale(1.05);
            }
        }

        /* ===== äº¤äº’å¼çŸ©é˜µå¯è§†åŒ– ===== */
        .matrix-container {
            position: relative;
            display: inline-block;
            margin: 0.5rem;
            transition: all 0.3s ease;
        }

        .matrix-bracket {
            position: absolute;
            width: 10px;
            height: 100%;
            border: 2px solid var(--text-secondary);
        }

        .matrix-bracket.left {
            left: -10px;
            border-right: none;
            border-radius: 5px 0 0 5px;
        }

        .matrix-bracket.right {
            right: -10px;
            border-left: none;
            border-radius: 0 5px 5px 0;
        }

        .matrix-grid {
            display: grid;
            gap: 0.5rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 0.5rem;
        }

        .matrix-cell {
            width: 3.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 0.25rem;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .matrix-cell::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(79, 172, 254, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.5s ease;
        }

        .matrix-cell:hover {
            background: rgba(79, 172, 254, 0.2);
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 0 20px rgba(79, 172, 254, 0.5);
        }

        .matrix-cell:hover::before {
            width: 100px;
            height: 100px;
        }

        /* è¿ç®—ç¬¦æ ·å¼ */
        .operation-symbol {
            font-size: 2rem;
            color: var(--accent-cyan);
            font-weight: bold;
            padding: 0 1rem;
        }

        /* ===== äº¤äº’å¼LSTMå•å…ƒå›¾ ===== */
        .lstm-unit-interactive {
            width: 100%;
            max-width: 1000px;
            margin: 3rem auto;
            position: relative;
            background: linear-gradient(135deg, rgba(168, 237, 234, 0.1), rgba(254, 214, 227, 0.05));
            border-radius: 2rem;
            padding: 3rem;
            border: 2px solid var(--border-color);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        #lstmCanvas {
            width: 100%;
            height: 500px;
            cursor: grab;
        }

        #lstmCanvas:active {
            cursor: grabbing;
        }

        /* ===== æ€è€ƒå¼•å¯¼å¡ç‰‡ ===== */
        .think-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(236, 72, 153, 0.1));
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .think-card::before {
            content: 'ğŸ¤”';
            position: absolute;
            top: -20px;
            right: 20px;
            font-size: 5rem;
            opacity: 0.1;
            transform: rotate(15deg);
        }

        .think-card h3 {
            color: var(--accent-purple);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .think-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .think-option {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .think-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.3);
            border-color: var(--accent-purple);
        }

        .think-option.selected {
            background: rgba(139, 92, 246, 0.2);
            border-color: var(--accent-purple);
        }

        .think-feedback {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: 0.5rem;
            display: none;
        }

        .think-feedback.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== å®æ—¶è®¡ç®—æ¼”ç¤º ===== */
        .live-demo {
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(59, 130, 246, 0.05));
            border-radius: 1.5rem;
            padding: 3rem;
            margin: 2rem 0;
            border: 2px solid var(--accent-cyan);
            position: relative;
            overflow: hidden;
        }

        .live-demo::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(6, 182, 212, 0.2), transparent);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .live-demo-content {
            position: relative;
            z-index: 2;
        }

        .input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .live-demo-input {
            flex: 1;
            padding: 1rem 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border-color);
            border-radius: 0.75rem;
            color: var(--text-primary);
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .live-demo-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 30px rgba(6, 182, 212, 0.3);
        }

        /* å®æ—¶è¾“å…¥é¢„æµ‹ */
        .prediction-preview {
            position: absolute;
            background: var(--bg-dark);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            z-index: 1000;
            display: none;
            max-width: 200px;
        }

        .analyze-btn {
            padding: 1rem 2rem;
            background: var(--accent-cyan);
            color: white;
            border: none;
            border-radius: 0.75rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .analyze-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.6s ease;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(6, 182, 212, 0.4);
        }

        .analyze-btn:active::before {
            width: 300px;
            height: 300px;
        }

        .live-demo-output {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .demo-result-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 2rem;
            border-radius: 1rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .demo-result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--lstm-gradient);
            transform: scaleX(0);
            transition: transform 0.5s ease;
        }

        .demo-result-card:hover::before {
            transform: scaleX(1);
        }

        /* ===== åŒæ¨¡å‹å¯¹æ¯”å±•ç¤º ===== */
        .model-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .model-demo {
            background: var(--bg-section);
            border-radius: 1rem;
            padding: 2rem;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .model-demo.rnn {
            border-color: var(--accent-red);
        }

        .model-demo.lstm {
            border-color: var(--accent-green);
        }

        .model-demo::before {
            content: attr(data-model);
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--bg-dark);
            padding: 0.25rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .model-demo.rnn::before {
            color: var(--accent-red);
        }

        .model-demo.lstm::before {
            color: var(--accent-green);
        }

        /* ===== æ­¥è¿›åŠ¨ç”»æ§åˆ¶ ===== */
        .step-animation {
            background: var(--bg-section);
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--text-muted);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .step-dot.active {
            width: 30px;
            border-radius: 6px;
            background: var(--accent-cyan);
        }

        .step-content {
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .step-visual {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.5s ease;
        }

        .step-visual.active {
            opacity: 1;
            transform: translateX(0);
        }

        /* ===== ä»£ç åˆ†å±‚å±•ç¤º ===== */
        .code-layers {
            margin: 2rem 0;
            background: var(--bg-section);
            border-radius: 1rem;
            overflow: hidden;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
        }

        .code-layer-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.02);
            border-bottom: 2px solid var(--border-color);
        }

        .code-layer-tab {
            flex: 1;
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
        }

        .code-layer-tab::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-blue);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .code-layer-tab.active {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .code-layer-tab.active::after {
            transform: scaleX(1);
        }

        .code-layer-content {
            display: none;
            padding: 2rem;
            max-height: 600px;
            overflow-y: auto;
        }

        .code-layer-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* ===== æ¯”è¾ƒè¡¨æ ¼ ===== */
        .comparison-table {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            overflow: hidden;
            margin: 2rem 0;
            box-shadow: var(--shadow-lg);
        }

        .comparison-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th {
            background: var(--lstm-gradient);
            color: #0f172a;
            padding: 1.25rem;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .comparison-table tr:hover td {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(5px);
        }

        /* ===== LSTM vs GRU å¯¹æ¯”åŒºåŸŸ ===== */
        .architecture-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            margin: 3rem 0;
            padding: 3rem;
            background: linear-gradient(135deg, rgba(168, 237, 234, 0.1), rgba(253, 187, 45, 0.1));
            border-radius: 2rem;
            border: 2px solid var(--border-color);
        }

        .architecture-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 1.5rem;
            padding: 2.5rem;
            position: relative;
            overflow: hidden;
        }

        .architecture-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .architecture-card.lstm::before {
            background: var(--lstm-gradient);
        }

        .architecture-card.gru::before {
            background: var(--gru-gradient);
        }

        .architecture-title {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .architecture-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
        }

        .architecture-icon.lstm {
            background: var(--lstm-gradient);
        }

        .architecture-icon.gru {
            background: var(--gru-gradient);
        }

        /* ===== æ•°å­¦æ¨å¯¼åŠ¨ç”» ===== */
        .math-derivation {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(236, 72, 153, 0.05));
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .derivation-step {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid var(--accent-cyan);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 0.5rem 0.5rem 0;
            position: relative;
            opacity: 0;
            transform: translateX(-20px);
            animation: slideIn 0.5s ease forwards;
        }

        .derivation-step:nth-child(1) { animation-delay: 0.1s; }
        .derivation-step:nth-child(2) { animation-delay: 0.2s; }
        .derivation-step:nth-child(3) { animation-delay: 0.3s; }
        .derivation-step:nth-child(4) { animation-delay: 0.4s; }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .derivation-step-number {
            position: absolute;
            left: -20px;
            top: 1.5rem;
            width: 40px;
            height: 40px;
            background: var(--accent-cyan);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4);
        }

        /* ===== å®è·µç»ƒä¹  ===== */
        .practice-section {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.05));
            border-radius: 1rem;
            padding: 2.5rem;
            margin: 2rem 0;
            border: 2px solid rgba(251, 191, 36, 0.3);
        }

        .practice-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .practice-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(251, 191, 36, 0.3);
        }

        .practice-solution {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
            margin-top: 1rem;
        }

        .practice-item.open .practice-solution {
            max-height: 1000px;
        }

        /* ===== å¯è§†åŒ–å›¾è¡¨ ===== */
        .visualization-container {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .viz-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        /* ===== æŒ‰é’®æ ·å¼ ===== */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--animation-duration) ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.6s ease;
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: var(--lstm-gradient);
            color: #0f172a;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(168, 237, 234, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent-cyan);
        }

        /* ===== æç¤ºæ¡† ===== */
        .tip {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin: 1.5rem 0;
            position: relative;
            overflow: hidden;
        }

        .tip::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 4px;
        }

        .tip.info {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.3);
        }

        .tip.info::before {
            background: var(--accent-blue);
        }

        .tip.warning {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .tip.warning::before {
            background: var(--accent-yellow);
        }

        .tip.success {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .tip.success::before {
            background: var(--accent-green);
        }

        /* ===== æœ¯è¯­æç¤º ===== */
        .term-tooltip {
            position: relative;
            border-bottom: 2px dotted var(--accent-cyan);
            cursor: help;
            display: inline-block;
        }

        .term-tooltip .tooltip-content {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-dark);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem 1.5rem;
            font-size: 0.9rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            margin-bottom: 0.5rem;
        }

        .term-tooltip:hover .tooltip-content {
            opacity: 1;
            transform: translateX(-50%) translateY(-5px);
        }

        /* ===== æŠ˜å å†…å®¹ ===== */
        .collapsible {
            margin: 1rem 0;
        }

        .collapsible-header {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            user-select: none;
        }

        .collapsible-header:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .collapsible.open .collapsible-content {
            max-height: 2000px;
            padding: 1rem 1.5rem;
        }

        .collapsible-icon {
            transition: transform 0.3s ease;
        }

        .collapsible.open .collapsible-icon {
            transform: rotate(180deg);
        }

        /* ===== å¡ç‰‡æ ·å¼ ===== */
        .section-card {
            background: var(--bg-section);
            border-radius: 1rem;
            padding: 3rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .section-card::before {
            content: '';
            position: absolute;
            top: -100px;
            right: -100px;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(168, 237, 234, 0.1), transparent);
            border-radius: 50%;
        }

        /* ===== æ•…äº‹å¡ç‰‡ ===== */
        .story-card {
            background: linear-gradient(135deg, rgba(168, 237, 234, 0.15), rgba(254, 214, 227, 0.1));
            border-radius: 1rem;
            padding: 2.5rem;
            margin-bottom: 2rem;
            border: 2px solid rgba(168, 237, 234, 0.2);
            position: relative;
            overflow: hidden;
        }

        .story-card::before {
            content: 'ğŸ“–';
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 5rem;
            opacity: 0.1;
            transform: rotate(15deg);
        }

        /* ===== å¯¹è¯æ¡† ===== */
        .dialogue-box {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid var(--accent-pink);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 0.5rem 0.5rem 0;
            position: relative;
            opacity: 0;
            transform: translateX(-20px);
            animation: slideInLeft 0.5s ease forwards;
        }

        .dialogue-box:nth-child(1) { animation-delay: 0.1s; }
        .dialogue-box:nth-child(2) { animation-delay: 0.3s; }
        .dialogue-box:nth-child(3) { animation-delay: 0.5s; }

        @keyframes slideInLeft {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .dialogue-box .speaker {
            font-weight: bold;
            color: var(--accent-pink);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .dialogue-box .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        /* ===== æ¦‚å¿µç½‘æ ¼ ===== */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .concept-card {
            padding: 2rem;
            border-radius: 0.75rem;
            transition: all var(--animation-duration) ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .concept-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            transform: scaleX(0);
            transition: transform var(--animation-duration) ease;
        }

        .concept-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .concept-card:hover::before {
            transform: scaleX(1);
        }

        .concept-card.forget {
            background: rgba(240, 147, 251, 0.1);
            border: 1px solid rgba(240, 147, 251, 0.3);
        }

        .concept-card.forget::before {
            background: var(--forget-gradient);
        }

        .concept-card.input {
            background: rgba(79, 172, 254, 0.1);
            border: 1px solid rgba(79, 172, 254, 0.3);
        }

        .concept-card.input::before {
            background: var(--input-gradient);
        }

        .concept-card.output {
            background: rgba(67, 233, 123, 0.1);
            border: 1px solid rgba(67, 233, 123, 0.3);
        }

        .concept-card.output::before {
            background: var(--output-gradient);
        }

        .concept-card.cell {
            background: rgba(250, 112, 154, 0.1);
            border: 1px solid rgba(250, 112, 154, 0.3);
        }

        .concept-card.cell::before {
            background: var(--cell-gradient);
        }

        /* ===== æ—¶é—´çº¿ ===== */
        .timeline {
            position: relative;
            padding: 2rem 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border-color);
        }

        .timeline-item {
            position: relative;
            margin: 2rem 0;
            padding: 0 2rem;
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }

        .timeline-item:nth-child(1) { animation-delay: 0.1s; }
        .timeline-item:nth-child(2) { animation-delay: 0.2s; }
        .timeline-item:nth-child(3) { animation-delay: 0.3s; }
        .timeline-item:nth-child(4) { animation-delay: 0.4s; }

        .timeline-item:nth-child(odd) {
            text-align: right;
            padding-right: 50%;
        }

        .timeline-item:nth-child(even) {
            padding-left: 50%;
        }

        .timeline-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: var(--lstm-gradient);
            border-radius: 50%;
            z-index: 1;
            box-shadow: 0 0 20px rgba(168, 237, 234, 0.5);
        }

        /* ===== éŸ³ä¹é”®ç›˜ ===== */
        .piano-keyboard {
            display: flex;
            gap: 2px;
            margin: 2rem 0;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .piano-key {
            width: 40px;
            height: 120px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 0 0 8px 8px;
            cursor: pointer;
            position: relative;
            transition: all 0.1s ease;
            user-select: none;
        }

        .piano-key:hover {
            background: #f0f0f0;
            transform: translateY(2px);
        }

        .piano-key.active {
            background: var(--accent-cyan);
            transform: translateY(3px);
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.5);
        }

        .piano-key.black {
            width: 25px;
            height: 80px;
            background: #333;
            margin: 0 -12.5px;
            z-index: 2;
            border-radius: 0 0 4px 4px;
        }

        .piano-key.black:hover {
            background: #555;
        }

        .piano-key.black.active {
            background: var(--accent-orange);
        }

        /* ===== å“åº”å¼è®¾è®¡ ===== */
        @media (max-width: 1024px) {
            .formula-explainer {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .live-demo-output {
                grid-template-columns: 1fr;
            }

            .concept-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }

            .model-comparison {
                grid-template-columns: 1fr;
            }

            .architecture-comparison {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }

        @media (max-width: 768px) {
            .chapter-hero h1 {
                font-size: 2.5rem;
            }

            .section-card {
                padding: 2rem;
            }

            .timeline-item:nth-child(odd),
            .timeline-item:nth-child(even) {
                padding-left: 3rem;
                padding-right: 1rem;
                text-align: left;
            }

            .timeline::before {
                left: 20px;
            }

            .timeline-dot {
                left: 20px;
            }

            .code-layer-tabs {
                flex-direction: column;
            }

            .code-layer-tab {
                border-bottom: 1px solid var(--border-color);
            }

            .matrix-operation {
                flex-direction: column;
                align-items: center;
            }

            .piano-keyboard {
                overflow-x: auto;
                justify-content: flex-start;
            }
        }

        /* ===== åŠ è½½åŠ¨ç”» ===== */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-pink);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== æ‡’åŠ è½½å ä½ç¬¦ ===== */
        .lazy-placeholder {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            padding: 3rem;
            text-align: center;
            color: var(--text-secondary);
            position: relative;
            overflow: hidden;
        }

        .lazy-placeholder::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* ===== æ»šåŠ¨æ¡ç¾åŒ– ===== */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-muted);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        /* ===== æ‰“å°æ ·å¼ ===== */
        @media print {
            body {
                background: white;
                color: black;
            }

            .nav-header,
            .sidebar,
            .btn,
            .viz-controls {
                display: none;
            }
        }
    </style>
</head>
<body>

<!-- èƒŒæ™¯åŠ¨ç”» -->
<div class="bg-animation" id="bgAnimation"></div>

<!-- å¯¼èˆªæ  -->
<nav class="nav-header" role="navigation" aria-label="ä¸»å¯¼èˆª">
    <div class="container">
        <div class="nav-content">
            <div class="nav-title">
                <button id="toggle-sidebar" class="btn btn-secondary" style="margin-right: 1rem;" aria-label="åˆ‡æ¢ä¾§è¾¹æ ">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <h1>ç¬¬8ç« ï¼šé•¿çŸ­æœŸè®°å¿†ç½‘ç»œLSTM</h1>
            </div>
            <div style="display: flex; gap: 1rem;">
                <button id="toggle-animations" class="btn btn-secondary" aria-label="åˆ‡æ¢åŠ¨ç”»">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M10 8l6 4-6 4V8z"></path>
                    </svg>
                </button>
                <button id="toggle-theme" class="btn btn-secondary" aria-label="åˆ‡æ¢ä¸»é¢˜">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                    </svg>
                </button>
            </div>
        </div>
        <div class="nav-progress">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
    </div>
</nav>

<!-- ä¾§è¾¹æ  -->
<aside class="sidebar" id="sidebar">
    <h3 style="margin-bottom: 1.5rem; color: var(--accent-pink);">ğŸ“š ç›®å½•å¯¼èˆª</h3>
    <nav>
        <a href="#intro" class="toc-item active">åºè¨€ï¼šè®°å¿†çš„è‰ºæœ¯</a>
        <a href="#problem" class="toc-item">RNNçš„å›°å¢ƒ</a>
        <a href="#solution" class="toc-item">è§£å†³æ€è·¯æ¨å¯¼</a>
        <a href="#forget-gate" class="toc-item">é—å¿˜é—¨çš„è¯ç”Ÿ</a>
        <a href="#input-gate" class="toc-item">è¾“å…¥é—¨çš„è®¾è®¡</a>
        <a href="#cell-state" class="toc-item">ç»†èƒçŠ¶æ€æ›´æ–°</a>
        <a href="#output-gate" class="toc-item">è¾“å‡ºé—¨çš„æ§åˆ¶</a>
        <a href="#complete-lstm" class="toc-item">LSTMå®Œæ•´ç»“æ„</a>
        <a href="#lstm-vs-gru" class="toc-item">LSTM vs GRUå¯¹æ¯”</a>
        <a href="#math-proof" class="toc-item">æ•°å­¦è¯æ˜</a>
        <a href="#implementation" class="toc-item">ä»é›¶å®ç°LSTM</a>
        <a href="#visualization" class="toc-item">å¯è§†åŒ–ç†è§£</a>
        <a href="#practice" class="toc-item">å®æˆ˜åº”ç”¨</a>
        <a href="#exercises" class="toc-item">ç»ƒä¹ ä¸æ€è€ƒ</a>
        <a href="#summary" class="toc-item">æ€»ç»“ä¸å±•æœ›</a>
    </nav>
</aside>

<!-- ä¸»å†…å®¹ -->
<main>
    <!-- ç« èŠ‚æ ‡é¢˜ -->
    <section class="chapter-hero">
        <div class="container">
            <div class="chapter-hero-content">
                <h1>é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼šè®©AIå­¦ä¼šé—å¿˜ä¸è®°å¿†</h1>
                <p style="font-size: 1.5rem; margin-bottom: 2rem;">æ·±å…¥ç†è§£LSTMçš„ç²¾å¦™è®¾è®¡ï¼Œä¸€æ­¥æ­¥æ¨å¯¼é—¨æ§æœºåˆ¶çš„æ•°å­¦åŸç†</p>
                <div style="display: flex; justify-content: center; gap: 1.5rem; flex-wrap: wrap;">
                    <span style="background: rgba(0, 0, 0, 0.1); padding: 0.75rem 1.5rem; border-radius: 30px; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.3rem;">ğŸšª</span> é—¨æ§æœºåˆ¶
                    </span>
                    <span style="background: rgba(0, 0, 0, 0.1); padding: 0.75rem 1.5rem; border-radius: 30px; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.3rem;">ğŸ§ </span> é•¿æœŸè®°å¿†
                    </span>
                    <span style="background: rgba(0, 0, 0, 0.1); padding: 0.75rem 1.5rem; border-radius: 30px; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.3rem;">ğŸ“</span> æ•°å­¦æ¨å¯¼
                    </span>
                </div>
            </div>
        </div>
    </section>

    <div class="container">

        <!-- ä¸€å¥è¯ç†è§£ -->
        <section class="section-card">
            <h2 style="color: var(--accent-pink); margin-bottom: 2rem; text-align: center; font-size: 2.5rem;">
                ğŸ’¡ ä¸€å¥è¯ç†è§£LSTM
            </h2>
            <p style="font-size: 1.5rem; text-align: center; line-height: 2; margin-bottom: 3rem;">
                LSTMå°±åƒä¸€ä¸ªç²¾å¯†çš„è®°å¿†ç®¡ç†ç³»ç»Ÿï¼Œ<br>
                é€šè¿‡ä¸‰ä¸ªé—¨æ§åˆ¶ä¿¡æ¯çš„æµåŠ¨ï¼š<br>
                <span style="color: #f5576c; font-weight: bold;">é—å¿˜é—¨</span>å†³å®šå¿˜è®°ä»€ä¹ˆï¼Œ
                <span style="color: #4facfe; font-weight: bold;">è¾“å…¥é—¨</span>å†³å®šè®°ä½ä»€ä¹ˆï¼Œ
                <span style="color: #43e97b; font-weight: bold;">è¾“å‡ºé—¨</span>å†³å®šè¾“å‡ºä»€ä¹ˆã€‚
            </p>

            <!-- å››ä¸ªæ ¸å¿ƒæ¦‚å¿µ -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem;">
                <div style="text-align: center;">
                    <div style="
                        width: 100px;
                        height: 100px;
                        margin: 0 auto 1rem;
                        background: var(--forget-gradient);
                        border-radius: 25px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 3rem;
                        color: white;
                        box-shadow: 0 10px 30px rgba(240, 147, 251, 0.4);
                        transition: all 0.3s ease;
                        cursor: pointer;
                    " onmouseover="this.style.transform='translateY(-5px) scale(1.05)'" onmouseout="this.style.transform='translateY(0) scale(1)'">
                        ğŸšª
                    </div>
                    <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">é—å¿˜é—¨</h4>
                    <p style="color: #94a3b8; font-size: 0.95rem; line-height: 1.5;">
                        é€‰æ‹©æ€§é—å¿˜<br>è¿‡æ»¤æ— ç”¨ä¿¡æ¯
                    </p>
                </div>

                <div style="text-align: center;">
                    <div style="
                        width: 100px;
                        height: 100px;
                        margin: 0 auto 1rem;
                        background: var(--input-gradient);
                        border-radius: 25px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 3rem;
                        color: white;
                        box-shadow: 0 10px 30px rgba(79, 172, 254, 0.4);
                        transition: all 0.3s ease;
                        cursor: pointer;
                    " onmouseover="this.style.transform='translateY(-5px) scale(1.05)'" onmouseout="this.style.transform='translateY(0) scale(1)'">
                        â•
                    </div>
                    <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">è¾“å…¥é—¨</h4>
                    <p style="color: #94a3b8; font-size: 0.95rem; line-height: 1.5;">
                        é€‰æ‹©æ€§è®°å¿†<br>å­˜å‚¨é‡è¦ä¿¡æ¯
                    </p>
                </div>

                <div style="text-align: center;">
                    <div style="
                        width: 100px;
                        height: 100px;
                        margin: 0 auto 1rem;
                        background: var(--output-gradient);
                        border-radius: 25px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 3rem;
                        color: white;
                        box-shadow: 0 10px 30px rgba(67, 233, 123, 0.4);
                        transition: all 0.3s ease;
                        cursor: pointer;
                    " onmouseover="this.style.transform='translateY(-5px) scale(1.05)'" onmouseout="this.style.transform='translateY(0) scale(1)'">
                        ğŸ“¤
                    </div>
                    <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">è¾“å‡ºé—¨</h4>
                    <p style="color: #94a3b8; font-size: 0.95rem; line-height: 1.5;">
                        æ§åˆ¶è¾“å‡º<br>å†³å®šå±•ç¤ºä»€ä¹ˆ
                    </p>
                </div>

                <div style="text-align: center;">
                    <div style="
                        width: 100px;
                        height: 100px;
                        margin: 0 auto 1rem;
                        background: var(--cell-gradient);
                        border-radius: 25px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 3rem;
                        color: white;
                        box-shadow: 0 10px 30px rgba(250, 112, 154, 0.4);
                        transition: all 0.3s ease;
                        cursor: pointer;
                    " onmouseover="this.style.transform='translateY(-5px) scale(1.05)'" onmouseout="this.style.transform='translateY(0) scale(1)'">
                        ğŸ“¦
                    </div>
                    <h4 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">ç»†èƒçŠ¶æ€</h4>
                    <p style="color: #94a3b8; font-size: 0.95rem; line-height: 1.5;">
                        é•¿æœŸè®°å¿†<br>ä¿¡æ¯é«˜é€Ÿé€šé“
                    </p>
                </div>
            </div>
        </section>

        <!-- æ€è€ƒå¼•å¯¼ï¼šä¸ºä»€ä¹ˆéœ€è¦LSTM -->
        <section class="think-card">
            <h3>ğŸ¤” æ€è€ƒæ—¶åˆ»ï¼šä¸ºä»€ä¹ˆRNNä¼šå¤±è´¥ï¼Ÿ</h3>
            <p>åœ¨å­¦ä¹ LSTMä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆä¼ ç»ŸRNNåœ¨å¤„ç†é•¿åºåˆ—æ—¶ä¼šå¤±è´¥ï¼Ÿ</p>

            <div class="think-options">
                <div class="think-option" data-answer="a">
                    A. è®¡ç®—é€Ÿåº¦å¤ªæ…¢
                </div>
                <div class="think-option" data-answer="b">
                    B. æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸
                </div>
                <div class="think-option" data-answer="c">
                    C. å‚æ•°å¤ªå¤š
                </div>
                <div class="think-option" data-answer="d">
                    D. æ¿€æ´»å‡½æ•°é€‰æ‹©ä¸å½“
                </div>
            </div>

            <div class="think-feedback" id="thinkFeedback1">
                <!-- åé¦ˆå†…å®¹å°†åŠ¨æ€æ’å…¥ -->
            </div>
        </section>

        <!-- åºè¨€ï¼šè®°å¿†çš„è‰ºæœ¯ -->
        <section id="intro" class="section-card">
            <div class="story-card">
                <h2 style="color: var(--accent-pink); margin-bottom: 1.5rem;">ğŸ“– åºè¨€ï¼šè®°å¿†çš„è‰ºæœ¯</h2>

                <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 2rem;">
                    1997å¹´ï¼Œå¾·å›½æ…•å°¼é»‘å·¥ä¸šå¤§å­¦çš„ä¸€ä¸ªç ”ç©¶å°ç»„æ­£åœ¨ä¸ºä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜è‹¦æ¼...
                </p>

                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #f093fb, #f5576c);">ğŸ‘¨â€ğŸ”¬</div>
                        Sepp Hochreiterï¼š
                    </div>
                    <div>"æˆ‘ä»¬çš„RNNåœ¨å¤„ç†é•¿å¥å­æ—¶æ€»æ˜¯å¤±è´¥ã€‚æ¯”å¦‚è¿™ä¸ªå¾·è¯­å¥å­ï¼ŒåŠ¨è¯åœ¨æœ€åï¼Œä½†ç½‘ç»œåœ¨å¤„ç†åˆ°åŠ¨è¯æ—¶å·²ç»å¿˜è®°äº†ä¸»è¯­æ˜¯ä»€ä¹ˆï¼"</div>
                </div>

                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">ğŸ‘¨â€ğŸ«</div>
                        JÃ¼rgen Schmidhuberï¼š
                    </div>
                    <div>"é—®é¢˜çš„æ ¹æºæ˜¯æ¢¯åº¦æ¶ˆå¤±ã€‚å½“è¯¯å·®ä¿¡å·é€šè¿‡æ—¶é—´åå‘ä¼ æ’­æ—¶ï¼Œå®ƒä¼šæŒ‡æ•°çº§è¡°å‡ã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§æ–°çš„æ¶æ„ï¼"</div>
                </div>

                <div class="dialogue-box">
                    <div class="speaker">
                        <div class="avatar" style="background: linear-gradient(135deg, #fa709a, #fee140);">ğŸ§‘â€ğŸ”¬</div>
                        ç ”ç©¶ç”Ÿï¼š
                    </div>
                    <div>"å¦‚æœæˆ‘ä»¬èƒ½åˆ›å»ºä¸€æ¡'é«˜é€Ÿå…¬è·¯'ï¼Œè®©æ¢¯åº¦å¯ä»¥æ— æŸåœ°ä¼ æ’­å‘¢ï¼Ÿå°±åƒ...å°±åƒæ°´ç®¡ä¸­çš„é˜€é—¨ï¼Œå¯ä»¥æ§åˆ¶æ°´æµï¼"</div>
                </div>

                <div class="timeline mt-4">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4 style="color: var(--accent-pink);">1991å¹´</h4>
                        <p>Hochreiterå‘ç°æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</p>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4 style="color: var(--accent-blue);">1997å¹´</h4>
                        <p>LSTMè®ºæ–‡å‘è¡¨ï¼Œå¼•å…¥é—¨æ§æœºåˆ¶</p>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4 style="color: var(--accent-green);">2000å¹´</h4>
                        <p>æ·»åŠ é—å¿˜é—¨ï¼ŒLSTMç»“æ„å®Œå–„</p>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <h4 style="color: var(--accent-orange);">2014å¹´</h4>
                        <p>LSTMåœ¨æœºå™¨ç¿»è¯‘ä¸­å¤§æ”¾å¼‚å½©</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- RNNçš„å›°å¢ƒ -->
        <section id="problem" class="section-card">
            <h2 style="color: var(--accent-red); margin-bottom: 2rem;">ğŸ’” RNNçš„å›°å¢ƒï¼šä¸ºä»€ä¹ˆéœ€è¦LSTMï¼Ÿ</h2>

            <!-- åŒæ¨¡å‹å¯¹æ¯” -->
            <div class="model-comparison">
                <div class="model-demo rnn" data-model="ä¼ ç»ŸRNN">
                    <h3 style="color: var(--accent-red); margin-bottom: 1rem;">ä¼ ç»ŸRNNçš„é•¿è·ç¦»ä¾èµ–æµ‹è¯•</h3>
                    <div style="background: rgba(239, 68, 68, 0.1); padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                        <p style="margin-bottom: 1rem;">æµ‹è¯•å¥å­ï¼š<em>"æˆ‘åœ¨<strong>æ³•å›½</strong>é•¿å¤§ï¼Œæ¥å—äº†ä¼˜è´¨çš„æ•™è‚²ï¼Œå­¦ä¹ äº†è¯­è¨€å’Œæ–‡åŒ–ï¼Œç°åœ¨æˆ‘èƒ½è¯´ä¸€å£æµåˆ©çš„<strong>____</strong>ã€‚"</em></p>
                        <div id="rnnPrediction" style="font-size: 1.2rem; color: var(--accent-red);">
                            RNNé¢„æµ‹ï¼š<span style="background: rgba(239, 68, 68, 0.2); padding: 0.25rem 0.5rem; border-radius: 0.25rem;">ä¸­æ–‡</span> âŒ
                        </div>
                        <p style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-secondary);">
                            RNNå¿˜è®°äº†å¥å­å¼€å¤´çš„"æ³•å›½"ä¿¡æ¯
                        </p>
                    </div>
                </div>

                <div class="model-demo lstm" data-model="LSTMç½‘ç»œ">
                    <h3 style="color: var(--accent-green); margin-bottom: 1rem;">LSTMçš„é•¿è·ç¦»ä¾èµ–æµ‹è¯•</h3>
                    <div style="background: rgba(34, 197, 94, 0.1); padding: 1.5rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                        <p style="margin-bottom: 1rem;">åŒæ ·å¥å­ï¼š<em>"æˆ‘åœ¨<strong>æ³•å›½</strong>é•¿å¤§ï¼Œæ¥å—äº†ä¼˜è´¨çš„æ•™è‚²ï¼Œå­¦ä¹ äº†è¯­è¨€å’Œæ–‡åŒ–ï¼Œç°åœ¨æˆ‘èƒ½è¯´ä¸€å£æµåˆ©çš„<strong>____</strong>ã€‚"</em></p>
                        <div id="lstmPrediction" style="font-size: 1.2rem; color: var(--accent-green);">
                            LSTMé¢„æµ‹ï¼š<span style="background: rgba(34, 197, 94, 0.2); padding: 0.25rem 0.5rem; border-radius: 0.25rem;">æ³•è¯­</span> âœ…
                        </div>
                        <p style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-secondary);">
                            LSTMæˆåŠŸè®°ä½äº†å…³é”®ä¿¡æ¯"æ³•å›½"
                        </p>
                    </div>
                </div>
            </div>
            <div class="static-illustration">
                <h3 style="color: var(--accent-cyan); margin-bottom: 1.5rem;">æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</h3>
                <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 0.5rem;">
                    <p style="font-size: 1.2rem; margin-bottom: 2rem;">
                        RNNåœ¨å¤„ç†é•¿åºåˆ—æ—¶ï¼Œæ¢¯åº¦ä¼šæŒ‡æ•°çº§è¡°å‡ï¼š
                    </p>
                    <div style="display: flex; align-items: center; justify-content: center; gap: 2rem; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <div style="width: 80px; height: 80px; background: rgba(239, 68, 68, 1); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                                t=1<br>1.0
                            </div>
                            <p style="margin-top: 0.5rem;">åˆå§‹æ¢¯åº¦</p>
                        </div>
                        <span style="font-size: 2rem;">â†’</span>
                        <div style="text-align: center;">
                            <div style="width: 60px; height: 60px; background: rgba(239, 68, 68, 0.5); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.9rem;">
                                t=10<br>0.1
                            </div>
                            <p style="margin-top: 0.5rem;">è¡°å‡90%</p>
                        </div>
                        <span style="font-size: 2rem;">â†’</span>
                        <div style="text-align: center;">
                            <div style="width: 40px; height: 40px; background: rgba(239, 68, 68, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.8rem;">
                                t=50<br>â‰ˆ0
                            </div>
                            <p style="margin-top: 0.5rem;">å‡ ä¹æ¶ˆå¤±</p>
                        </div>
                    </div>
                </div>
            </div>


            <div class="math-derivation">
                <h3 style="color: var(--accent-red); margin-bottom: 1.5rem;">ğŸ”¬ æ¢¯åº¦æ¶ˆå¤±çš„æ•°å­¦æœ¬è´¨</h3>

                <div class="derivation-step">
                    <div class="derivation-step-number">1</div>
                    <h4>RNNçš„æ¢¯åº¦ä¼ æ’­</h4>
                    <p>å›å¿†RNNçš„éšè—çŠ¶æ€æ›´æ–°å…¬å¼ï¼š</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $$\mathbf{h}_t = \tanh(\mathbf{W}_{hh} \mathbf{h}_{t-1} + \mathbf{W}_{xh} \mathbf{x}_t + \mathbf{b}_h)$$
                    </div>
                    <p>å½“æˆ‘ä»¬è®¡ç®—æŸå¤±å¯¹æ—©æœŸéšè—çŠ¶æ€çš„æ¢¯åº¦æ—¶ï¼š</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $$\frac{\partial L}{\partial \mathbf{h}_1} = \frac{\partial L}{\partial \mathbf{h}_T} \cdot \prod_{t=2}^{T} \frac{\partial \mathbf{h}_t}{\partial \mathbf{h}_{t-1}}$$
                    </div>
                </div>

                <div class="derivation-step">
                    <div class="derivation-step-number">2</div>
                    <h4>é—®é¢˜çš„æ ¹æº</h4>
                    <p>æ¯ä¸€é¡¹æ¢¯åº¦éƒ½åŒ…å«tanhçš„å¯¼æ•°ï¼š</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $$\frac{\partial \mathbf{h}_t}{\partial \mathbf{h}_{t-1}} = \text{diag}(\tanh'(\mathbf{z}_t)) \cdot \mathbf{W}_{hh}$$
                    </div>
                    <p>ç”±äº $\tanh'(x) = 1 - \tanh^2(x) \in (0, 1]$ï¼Œæ¢¯åº¦ä¼šæŒ‡æ•°çº§è¡°å‡ï¼</p>
                </div>
            </div>

            <div class="tip warning">
                <span style="font-size: 1.5rem;">âš ï¸</span>
                <div>
                    <strong>å…³é”®æ´å¯Ÿï¼š</strong>å½“åºåˆ—é•¿åº¦ä¸º100æ—¶ï¼Œå¦‚æœæ¯æ­¥æ¢¯åº¦è¡°å‡0.9ï¼Œæœ€ç»ˆæ¢¯åº¦åªæœ‰åˆå§‹çš„ $0.9^{100} \approx 10^{-5}$ï¼
                    è¿™å°±æ˜¯ä¸ºä»€ä¹ˆRNNæ— æ³•å­¦ä¹ é•¿æœŸä¾èµ–ã€‚
                </div>
            </div>
        </section>

        <!-- è§£å†³æ€è·¯æ¨å¯¼ -->
        <section id="solution" class="section-card">
            <h2 style="color: var(--accent-blue); margin-bottom: 2rem;">ğŸ’¡ è§£å†³æ€è·¯ï¼šå¦‚ä½•è®¾è®¡æ›´å¥½çš„è®°å¿†æœºåˆ¶ï¼Ÿ</h2>

            <div class="think-card">
                <h3>ğŸ§  è®¾è®¡æ€è€ƒï¼šå¦‚æœä½ æ¥è®¾è®¡ï¼Œä¼šæ€ä¹ˆåšï¼Ÿ</h3>
                <p>åœ¨çœ‹LSTMçš„è§£å†³æ–¹æ¡ˆä¹‹å‰ï¼Œè®©æˆ‘ä»¬è‡ªå·±æ€è€ƒä¸€ä¸‹ï¼šå¦‚ä½•è®©ç½‘ç»œæ—¢èƒ½è®°ä½é‡è¦ä¿¡æ¯ï¼Œåˆèƒ½å¿˜è®°æ— ç”¨ä¿¡æ¯ï¼Ÿ</p>

                <div style="display: grid; gap: 1rem; margin-top: 1.5rem;">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 0.5rem;">ğŸ’­ æ€è€ƒ1ï¼šä¿¡æ¯ä¼ é€’</h4>
                        <p>å¦‚ä½•åˆ›å»ºä¸€æ¡"é«˜é€Ÿå…¬è·¯"ï¼Œè®©ä¿¡æ¯å¯ä»¥æ— æŸä¼ é€’ï¼Ÿ</p>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                        <h4 style="color: var(--accent-pink); margin-bottom: 0.5rem;">ğŸ’­ æ€è€ƒ2ï¼šé€‰æ‹©æœºåˆ¶</h4>
                        <p>å¦‚ä½•è®©ç½‘ç»œè‡ªå·±å†³å®šä»€ä¹ˆä¿¡æ¯é‡è¦ï¼Œä»€ä¹ˆä¿¡æ¯å¯ä»¥ä¸¢å¼ƒï¼Ÿ</p>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem;">
                        <h4 style="color: var(--accent-green); margin-bottom: 0.5rem;">ğŸ’­ æ€è€ƒ3ï¼šæ§åˆ¶æ–¹å¼</h4>
                        <p>ç”¨ä»€ä¹ˆæ•°å­¦å·¥å…·æ¥å®ç°è¿™ç§é€‰æ‹©æ€§æ§åˆ¶ï¼Ÿ</p>
                    </div>
                </div>
            </div>

            <div class="story-card" style="margin-top: 2rem;">
                <h3 style="color: var(--accent-blue); margin-bottom: 1.5rem;">ğŸ¯ LSTMçš„æ ¸å¿ƒåˆ›æ–°</h3>
                <p style="font-size: 1.1rem; line-height: 1.8;">
                    LSTMçš„å¤©æ‰ä¹‹å¤„åœ¨äºå¼•å…¥äº†<strong>ç»†èƒçŠ¶æ€ï¼ˆCell Stateï¼‰</strong>ä½œä¸ºä¿¡æ¯çš„é«˜é€Ÿå…¬è·¯ï¼Œ
                    å¹¶é€šè¿‡<strong>é—¨æ§æœºåˆ¶ï¼ˆGating Mechanismï¼‰</strong>æ¥æ§åˆ¶ä¿¡æ¯çš„æµåŠ¨ã€‚
                </p>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 2rem;">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.75rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">ğŸ›¤ï¸ ç»†èƒçŠ¶æ€</h4>
                        <ul style="margin-left: 1.5rem;">
                            <li>çº¿æ€§ä¼ æ’­ï¼Œé¿å…éçº¿æ€§æ¿€æ´»</li>
                            <li>æ¢¯åº¦å¯ä»¥æ— æŸåœ°åå‘ä¼ æ’­</li>
                            <li>å°±åƒä¸€æ¡ä¿¡æ¯é«˜é€Ÿå…¬è·¯</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.75rem;">
                        <h4 style="color: var(--accent-pink); margin-bottom: 1rem;">ğŸšª é—¨æ§æœºåˆ¶</h4>
                        <ul style="margin-left: 1.5rem;">
                            <li>ä½¿ç”¨Sigmoidå‡½æ•°ä½œä¸ºå¼€å…³</li>
                            <li>è¾“å‡ºåœ¨[0,1]ä¹‹é—´ï¼Œåƒç™¾åˆ†æ¯”</li>
                            <li>å¯å­¦ä¹ çš„å‚æ•°å†³å®šå¼€å…³ç¨‹åº¦</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- æ ¸å¿ƒLSTMå•å…ƒäº¤äº’å›¾ -->
        <section class="section-card">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">ğŸ¯ LSTMæ ¸å¿ƒç»“æ„ - äº¤äº’å¼æ¢ç´¢</h2>

            <div class="lstm-unit-interactive">
                <canvas id="lstmCanvas"></canvas>

                <div style="margin-top: 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <button class="btn btn-primary" onclick="window.lstmTutorial.highlightForgetGate()">
                        ğŸ—‘ï¸ é«˜äº®é—å¿˜é—¨
                    </button>
                    <button class="btn btn-primary" onclick="window.lstmTutorial.highlightInputGate()">
                        â• é«˜äº®è¾“å…¥é—¨
                    </button>
                    <button class="btn btn-primary" onclick="window.lstmTutorial.highlightOutputGate()">
                        ğŸ“¤ é«˜äº®è¾“å‡ºé—¨
                    </button>
                    <button class="btn btn-primary" onclick="window.lstmTutorial.animateDataFlow()">
                        ğŸŒŠ æ¼”ç¤ºæ•°æ®æµ
                    </button>
                </div>
            </div>

            <div id="gateDescription" style="margin-top: 2rem; padding: 2rem; background: rgba(255, 255, 255, 0.05); border-radius: 1rem; min-height: 150px;">
                <p style="text-align: center; color: var(--text-secondary); font-size: 1.1rem;">
                    ğŸ‘† ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ï¼Œæ¢ç´¢LSTMçš„å„ä¸ªç»„ä»¶
                </p>
            </div>
        </section>

        <!-- é—å¿˜é—¨è¯¦ç»†è§£æ - å®Œæ•´ç‰ˆ -->
        <section id="forget-gate-detail" class="section-card">
            <h2 style="color: var(--accent-pink); margin-bottom: 2rem;">ğŸšª é—å¿˜é—¨è¯¦ç»†è§£æ</h2>

            <!-- å…¬å¼å±•ç¤º -->
            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>æ•°å­¦å…¬å¼</h4>
                    <div class="formula-math">
                        <span class="highlight-target" data-symbol="f_t">f<sub>t</sub></span> =
                        <span class="highlight-target" data-symbol="sigma">Ïƒ</span>(<span class="highlight-target" data-symbol="W_f">W<sub>f</sub></span> Â·
                        [<span class="highlight-target" data-symbol="h_t-1">h<sub>t-1</sub></span>,
                        <span class="highlight-target" data-symbol="x_t">x<sub>t</sub></span>] +
                        <span class="highlight-target" data-symbol="b_f">b<sub>f</sub></span>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>çŸ©é˜µè¿ç®—å¯è§†åŒ–</h4>
                    <div class="matrix-visual">
                        <div class="matrix-operation">
                            <svg width="200" height="150" viewBox="0 0 200 150">
                                <!-- æƒé‡çŸ©é˜µ -->
                                <rect x="10" y="20" width="60" height="80" fill="rgba(240, 147, 251, 0.2)" stroke="#f5576c" stroke-width="2"/>
                                <text x="40" y="15" text-anchor="middle" fill="#f5576c" font-size="12">W<tspan baseline-shift="sub" font-size="10">f</tspan></text>
                                <text x="40" y="60" text-anchor="middle" fill="#fff" font-size="10">128Ã—228</text>

                                <!-- è¾“å…¥å‘é‡ -->
                                <rect x="90" y="30" width="30" height="60" fill="rgba(79, 172, 254, 0.2)" stroke="#4facfe" stroke-width="2"/>
                                <text x="105" y="25" text-anchor="middle" fill="#4facfe" font-size="12">[h,x]</text>
                                <text x="105" y="60" text-anchor="middle" fill="#fff" font-size="10">228Ã—1</text>

                                <!-- ç»“æœ -->
                                <rect x="140" y="40" width="30" height="40" fill="rgba(67, 233, 123, 0.2)" stroke="#43e97b" stroke-width="2"/>
                                <text x="155" y="35" text-anchor="middle" fill="#43e97b" font-size="12">f<tspan baseline-shift="sub" font-size="10">t</tspan></text>
                                <text x="155" y="60" text-anchor="middle" fill="#fff" font-size="10">128Ã—1</text>

                                <!-- è¿ç®—ç¬¦å· -->
                                <text x="80" y="65" text-anchor="middle" fill="#fff" font-size="16">Ã—</text>
                                <text x="130" y="65" text-anchor="middle" fill="#fff" font-size="16">=</text>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>å«ä¹‰è§£é‡Š</h4>
                    <div class="formula-meaning">
                        <div class="meaning-item">
                            <strong>f<sub>t</sub>:</strong> é—å¿˜é—¨è¾“å‡ºï¼Œæ§åˆ¶é—å¿˜ç¨‹åº¦
                        </div>
                        <div class="meaning-item">
                            <strong>Ïƒ:</strong> Sigmoidå‡½æ•°ï¼Œè¾“å‡º[0,1]
                        </div>
                        <div class="meaning-item">
                            <strong>W<sub>f</sub>:</strong> é—å¿˜é—¨æƒé‡çŸ©é˜µ
                        </div>
                        <div class="meaning-item">
                            <strong>[h<sub>t-1</sub>, x<sub>t</sub>]:</strong> æ‹¼æ¥çš„è¾“å…¥å‘é‡
                        </div>
                    </div>
                </div>
            </div>

            <!-- ä½¿ç”¨5åˆ—ç½‘æ ¼å¸ƒå±€çš„è¯¦ç»†å¡ç‰‡ -->
            <div class="card-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1rem; margin: 2rem 0;">
                <!-- ç¬¬1ä¸ªå¡ç‰‡ï¼šé—å¿˜é—¨è¾“å‡º -->
                <div class="info-card forget-card slide-in-left">
                    <span class="card-icon">ğŸ¯</span>
                    <h3 class="card-title">f<sub>t</sub> - é—å¿˜é—¨è¾“å‡º</h3>
                    <div class="card-content">
                        <p>æ§åˆ¶å‘é‡ï¼Œæ¯ä¸ªå…ƒç´ âˆˆ[0,1]</p>
                        <ul style="margin-top: 0.5rem; margin-left: 1rem; font-size: 0.875rem;">
                            <li>0 = å®Œå…¨é—å¿˜</li>
                            <li>1 = å®Œå…¨ä¿ç•™</li>
                            <li>0.5 = ä¿ç•™ä¸€åŠ</li>
                        </ul>
                        <p style="margin-top: 0.5rem; font-size: 0.875rem;"><strong>ç»´åº¦ï¼š</strong>ä¸éšè—çŠ¶æ€ç›¸åŒ</p>

                        <!-- å‘é‡å¯è§†åŒ– -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 0.75rem;">
                            <div style="display: flex; align-items: center; justify-content: center; gap: 0.25rem; flex-wrap: wrap;">
                                <span style="font-family: monospace; color: var(--accent-yellow); font-size: 0.8rem;">f<sub>t</sub> =</span>
                                <div style="display: flex; flex-direction: column; align-items: center; border-left: 2px solid var(--accent-pink); border-right: 2px solid var(--accent-pink); padding: 0.2rem 0.4rem;">
                                    <div style="background: rgba(244,114,182,0.2); padding: 0.2rem 0.4rem; margin: 0.05rem; border-radius: 3px; font-family: monospace; font-size: 0.75rem;">0.9</div>
                                    <div style="background: rgba(244,114,182,0.2); padding: 0.2rem 0.4rem; margin: 0.05rem; border-radius: 3px; font-family: monospace; font-size: 0.75rem;">0.1</div>
                                    <div style="background: rgba(244,114,182,0.2); padding: 0.2rem 0.4rem; margin: 0.05rem; border-radius: 3px; font-family: monospace; font-size: 0.75rem;">0.5</div>
                                    <div style="color: var(--text-dim); font-size: 0.7rem;">â‹®</div>
                                </div>
                                <span style="color: var(--text-secondary); font-size: 0.75rem; text-align: center;">æ¯ä¸ªå€¼æ§åˆ¶<br>å¯¹åº”ç‰¹å¾</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬2ä¸ªå¡ç‰‡ï¼šSigmoidå‡½æ•° -->
                <div class="info-card forget-card slide-in-right">
                    <span class="card-icon">ğŸ”„</span>
                    <h3 class="card-title">Ïƒ(Â·) - Sigmoidå‡½æ•°</h3>
                    <div class="card-content">
                        <p style="font-size: 0.875rem;">å°†ä»»æ„å€¼æ˜ å°„åˆ°[0,1]</p>
                        <p style="font-family: monospace; margin: 0.5rem 0; font-size: 0.875rem;">Ïƒ(x) = 1/(1+e<sup>-x</sup>)</p>
                        <ul style="margin-top: 0.5rem; margin-left: 1rem; font-size: 0.875rem;">
                            <li>å¤§æ­£æ•° â†’ â‰ˆ1</li>
                            <li>å¤§è´Ÿæ•° â†’ â‰ˆ0</li>
                            <li>0 â†’ 0.5</li>
                        </ul>

                        <!-- Sigmoidå‡½æ•°æ›²çº¿ -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 0.75rem;">
                            <svg width="100%" height="100" viewBox="0 0 200 100" style="display: block;">
                                <!-- åæ ‡è½´ -->
                                <line x1="20" y1="50" x2="180" y2="50" stroke="var(--text-dim)" stroke-width="1"/>
                                <line x1="100" y1="10" x2="100" y2="90" stroke="var(--text-dim)" stroke-width="1"/>

                                <!-- Sigmoidæ›²çº¿ -->
                                <path d="M 20 85 Q 50 85, 70 75 Q 85 60, 100 50 Q 115 40, 130 25 Q 150 15, 180 15"
                                      fill="none" stroke="var(--accent-cyan)" stroke-width="2.5"/>

                                <!-- æ ‡æ³¨ç‚¹ -->
                                <circle cx="100" cy="50" r="3" fill="var(--accent-yellow)"/>
                                <text x="105" y="55" fill="var(--text-secondary)" font-size="10">0.5</text>

                                <circle cx="35" cy="85" r="2.5" fill="var(--accent-pink)"/>
                                <text x="25" y="80" fill="var(--text-secondary)" font-size="9">â‰ˆ0</text>

                                <circle cx="165" cy="15" r="2.5" fill="var(--accent-green)"/>
                                <text x="155" y="28" fill="var(--text-secondary)" font-size="9">â‰ˆ1</text>
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬3ä¸ªå¡ç‰‡ï¼šæƒé‡çŸ©é˜µ -->
                <div class="info-card forget-card slide-in-left">
                    <span class="card-icon">âš¡</span>
                    <h3 class="card-title">W<sub>f</sub> - æƒé‡çŸ©é˜µ</h3>
                    <div class="card-content">
                        <p style="font-size: 0.875rem;">å­¦ä¹ å¦‚ä½•ç»„åˆè¾“å…¥ä¿¡æ¯</p>
                        <p style="margin-top: 0.5rem; font-size: 0.875rem;"><strong>ç»´åº¦ï¼š</strong></p>
                        <ul style="margin-left: 1rem; font-size: 0.875rem;">
                            <li>è¡Œ = éšè—ç»´åº¦</li>
                            <li>åˆ— = hç»´åº¦ + xç»´åº¦</li>
                        </ul>
                        <p style="margin-top: 0.5rem; color: var(--accent-yellow); font-size: 0.875rem;">ä¾‹ï¼š128Ã—228çŸ©é˜µ</p>

                        <!-- çŸ©é˜µç»“æ„å¯è§†åŒ– -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 0.75rem;">
                            <div style="text-align: center;">
                                <div style="display: inline-block; position: relative;">
                                    <!-- çŸ©é˜µè¡¨ç¤º -->
                                    <div style="display: grid; grid-template-columns: repeat(6, 30px); grid-template-rows: repeat(4, 25px); gap: 2px;">
                                        <!-- ç¬¬ä¸€è¡Œ -->
                                        <div style="background: rgba(244,114,182,0.3); border: 1px solid var(--accent-pink); border-radius: 2px; font-size: 10px; display: flex; align-items: center; justify-content: center; font-family: monospace;">wâ‚â‚</div>
                                        <div style="background: rgba(244,114,182,0.2); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.2); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.2); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.2); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.3); border: 1px solid var(--accent-pink); border-radius: 2px; font-size: 8px; display: flex; align-items: center; justify-content: center; font-family: monospace;">wâ‚,â‚‚â‚‚â‚ˆ</div>

                                        <!-- ç¬¬äºŒè¡Œ -->
                                        <div style="background: rgba(244,114,182,0.15); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.1); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.15); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.1); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.15); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.1); border: 1px solid var(--border-color); border-radius: 2px;"></div>

                                        <!-- ç¬¬ä¸‰è¡Œ - çœç•¥å· -->
                                        <div style="grid-column: 1/7; display: flex; align-items: center; justify-content: center; color: var(--text-dim); font-size: 16px; height: 25px;">â‹®</div>

                                        <!-- ç¬¬å››è¡Œ -->
                                        <div style="background: rgba(244,114,182,0.3); border: 1px solid var(--accent-pink); border-radius: 2px; font-size: 8px; display: flex; align-items: center; justify-content: center; font-family: monospace;">wâ‚â‚‚â‚ˆ,â‚</div>
                                        <div style="background: rgba(244,114,182,0.2); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.2); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.2); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.2); border: 1px solid var(--border-color); border-radius: 2px;"></div>
                                        <div style="background: rgba(244,114,182,0.3); border: 1px solid var(--accent-pink); border-radius: 2px; font-size: 7px; display: flex; align-items: center; justify-content: center; font-family: monospace;">wâ‚â‚‚â‚ˆ,â‚‚â‚‚â‚ˆ</div>
                                    </div>

                                    <!-- ç»´åº¦æ ‡æ³¨ -->
                                    <div style="position: absolute; left: -40px; top: 50%; transform: translateY(-50%); color: var(--accent-yellow); font-size: 12px; font-weight: 600;">128</div>
                                    <div style="position: absolute; bottom: -25px; left: 50%; transform: translateX(-50%); color: var(--accent-yellow); font-size: 12px; font-weight: 600;">228</div>
                                </div>
                            </div>
                            <p style="text-align: center; margin-top: 1.5rem; color: var(--text-secondary); font-size: 0.75rem;">
                                å°†228ç»´è¾“å…¥æ˜ å°„åˆ°128ç»´
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬4ä¸ªå¡ç‰‡ï¼šæ‹¼æ¥è¾“å…¥ -->
                <div class="info-card forget-card slide-in-right">
                    <span class="card-icon">ğŸ”—</span>
                    <h3 class="card-title">[h<sub>t-1</sub>, x<sub>t</sub>] - æ‹¼æ¥è¾“å…¥</h3>
                    <div class="card-content">
                        <p style="font-size: 0.875rem;">å‚ç›´æ‹¼æ¥ä¸¤ä¸ªå‘é‡</p>
                        <ul style="margin-top: 0.5rem; margin-left: 1rem; font-size: 0.875rem;">
                            <li>h<sub>t-1</sub>: å†å²ä¿¡æ¯</li>
                            <li>x<sub>t</sub>: å½“å‰è¾“å…¥</li>
                        </ul>
                        <p style="margin-top: 0.5rem; font-family: monospace; font-size: 0.8rem;">
                            [a,b] + [c,d] = [a,b,c,d]
                        </p>

                        <!-- æ‹¼æ¥è¿‡ç¨‹å¯è§†åŒ– -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 0.75rem;">
                            <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem; flex-wrap: wrap;">
                                <!-- hå‘é‡ -->
                                <div style="text-align: center;">
                                    <div style="font-size: 0.7rem; color: var(--accent-yellow); margin-bottom: 0.2rem;">h<sub>t-1</sub></div>
                                    <div style="display: flex; flex-direction: column; border: 2px solid var(--accent-pink); border-radius: 3px; padding: 0.2rem;">
                                        <div style="background: rgba(244,114,182,0.2); padding: 0.15rem 0.3rem; margin: 0.05rem; border-radius: 2px; font-size: 0.7rem;">hâ‚</div>
                                        <div style="background: rgba(244,114,182,0.2); padding: 0.15rem 0.3rem; margin: 0.05rem; border-radius: 2px; font-size: 0.7rem;">hâ‚‚</div>
                                        <div style="color: var(--text-dim); font-size: 0.5rem;">â‹®</div>
                                    </div>
                                    <div style="font-size: 0.65rem; color: var(--text-secondary); margin-top: 0.2rem;">128ç»´</div>
                                </div>

                                <div style="font-size: 1.2rem; color: var(--accent-cyan);">+</div>

                                <!-- xå‘é‡ -->
                                <div style="text-align: center;">
                                    <div style="font-size: 0.7rem; color: var(--accent-yellow); margin-bottom: 0.2rem;">x<sub>t</sub></div>
                                    <div style="display: flex; flex-direction: column; border: 2px solid var(--accent-cyan); border-radius: 3px; padding: 0.2rem;">
                                        <div style="background: rgba(34,211,238,0.2); padding: 0.15rem 0.3rem; margin: 0.05rem; border-radius: 2px; font-size: 0.7rem;">xâ‚</div>
                                        <div style="background: rgba(34,211,238,0.2); padding: 0.15rem 0.3rem; margin: 0.05rem; border-radius: 2px; font-size: 0.7rem;">xâ‚‚</div>
                                        <div style="color: var(--text-dim); font-size: 0.5rem;">â‹®</div>
                                    </div>
                                    <div style="font-size: 0.65rem; color: var(--text-secondary); margin-top: 0.2rem;">100ç»´</div>
                                </div>

                                <div style="font-size: 1.2rem; color: var(--accent-green);">=</div>

                                <!-- ç»“æœå‘é‡ -->
                                <div style="text-align: center;">
                                    <div style="font-size: 0.7rem; color: var(--accent-yellow); margin-bottom: 0.2rem;">[h,x]</div>
                                    <div style="display: flex; flex-direction: column; border: 2px solid var(--accent-purple); border-radius: 3px; padding: 0.2rem;">
                                        <div style="background: rgba(244,114,182,0.2); padding: 0.15rem 0.3rem; margin: 0.05rem; border-radius: 2px; font-size: 0.7rem;">hâ‚</div>
                                        <div style="color: var(--text-dim); font-size: 0.5rem;">â‹®</div>
                                        <div style="background: rgba(34,211,238,0.2); padding: 0.15rem 0.3rem; margin: 0.05rem; border-radius: 2px; font-size: 0.7rem;">xâ‚</div>
                                        <div style="color: var(--text-dim); font-size: 0.5rem;">â‹®</div>
                                    </div>
                                    <div style="font-size: 0.65rem; color: var(--text-secondary); margin-top: 0.2rem;">228ç»´</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬5ä¸ªå¡ç‰‡ï¼šåç½®å‘é‡ -->
                <div class="info-card forget-card slide-in-left">
                    <span class="card-icon">â•</span>
                    <h3 class="card-title">b<sub>f</sub> - åç½®å‘é‡</h3>
                    <div class="card-content">
                        <p style="font-size: 0.875rem;">å¯è®­ç»ƒçš„åç½®å‘é‡ï¼Œæä¾›åŸºå‡†å€¼</p>
                        <ul style="margin-top: 0.5rem; margin-left: 1rem; font-size: 0.875rem;">
                            <li>ç»´åº¦ = éšè—çŠ¶æ€ç»´åº¦</li>
                            <li>é€šå¸¸åˆå§‹åŒ–ä¸ºæ­£å€¼</li>
                        </ul>
                        <p style="margin-top: 0.5rem; font-size: 0.875rem;"><strong>ä½œç”¨ï¼š</strong>è®©æ¨¡å‹é»˜è®¤å€¾å‘äºè®°ä½</p>

                        <!-- åç½®æ•ˆæœå¯è§†åŒ– -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 0.75rem;">
                            <div style="text-align: center;">
                                <p style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.5rem;">åç½®å¦‚ä½•å½±å“é—å¿˜å€¾å‘</p>
                                <div style="display: flex; justify-content: space-around; align-items: flex-end; height: 60px; margin-top: 0.5rem;">
                                    <div style="text-align: center;">
                                        <div style="width: 30px; height: 20px; background: rgba(244,114,182,0.3); border: 1px solid var(--accent-pink); border-radius: 3px 3px 0 0;"></div>
                                        <div style="font-size: 0.7rem; color: var(--accent-pink); margin-top: 0.2rem;">b=-1</div>
                                        <div style="font-size: 0.65rem; color: var(--text-dim);">æ˜“å¿˜</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="width: 30px; height: 35px; background: rgba(251,191,36,0.3); border: 1px solid var(--accent-yellow); border-radius: 3px 3px 0 0;"></div>
                                        <div style="font-size: 0.7rem; color: var(--accent-yellow); margin-top: 0.2rem;">b=0</div>
                                        <div style="font-size: 0.65rem; color: var(--text-dim);">ä¸­æ€§</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="width: 30px; height: 50px; background: rgba(34,197,94,0.3); border: 1px solid var(--accent-green); border-radius: 3px 3px 0 0;"></div>
                                        <div style="font-size: 0.7rem; color: var(--accent-green); margin-top: 0.2rem;">b=1</div>
                                        <div style="font-size: 0.65rem; color: var(--text-dim);">æ˜“è®°</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- çŸ©é˜µè¿ç®—è¯¦è§£ -->
            <h3 style="text-align: center; color: var(--accent-cyan); margin: 3rem 0 2rem;">ğŸ”¢ çŸ©é˜µç»´åº¦å˜åŒ–è¯¦è§£</h3>

            <p style="text-align: center; color: var(--text-secondary); margin-bottom: 2rem;">
                å‡è®¾ï¼šéšè—çŠ¶æ€hä¸º128ç»´ï¼Œè¾“å…¥xä¸º100ç»´
            </p>

            <div class="matrix-visualization" style="display: flex; align-items: center; justify-content: center; gap: 2rem; flex-wrap: wrap; margin: 2rem 0;">
                <div class="matrix-container">
                    <div class="matrix-bracket left"></div>
                    <div class="matrix-bracket right"></div>
                    <div class="matrix-grid" style="grid-template-columns: 1fr;">
                        <div class="matrix-cell">hâ‚</div>
                        <div class="matrix-cell">â‹®</div>
                        <div class="matrix-cell">hâ‚â‚‚â‚ˆ</div>
                    </div>
                    <div style="color: var(--accent-green); margin-top: 0.5rem; text-align: center;">[128Ã—1]</div>
                </div>

                <span class="operation-symbol">+</span>

                <div class="matrix-container">
                    <div class="matrix-bracket left"></div>
                    <div class="matrix-bracket right"></div>
                    <div class="matrix-grid" style="grid-template-columns: 1fr;">
                        <div class="matrix-cell">xâ‚</div>
                        <div class="matrix-cell">â‹®</div>
                        <div class="matrix-cell">xâ‚â‚€â‚€</div>
                    </div>
                    <div style="color: var(--accent-cyan); margin-top: 0.5rem; text-align: center;">[100Ã—1]</div>
                </div>

                <span class="operation-symbol">=</span>

                <div class="matrix-container">
                    <div class="matrix-bracket left"></div>
                    <div class="matrix-bracket right"></div>
                    <div class="matrix-grid" style="grid-template-columns: 1fr;">
                        <div class="matrix-cell">hâ‚</div>
                        <div class="matrix-cell">â‹®</div>
                        <div class="matrix-cell">xâ‚â‚€â‚€</div>
                    </div>
                    <div style="color: var(--accent-purple); margin-top: 0.5rem; text-align: center;">[228Ã—1]</div>
                </div>
            </div>

            <!-- ç»´åº¦æ€»ç»“è¡¨ -->
            <div class="comparison-table">
                <table>
                    <thead>
                    <tr>
                        <th>ç¬¦å·</th>
                        <th>å«ä¹‰</th>
                        <th>ç»´åº¦</th>
                        <th>è¯´æ˜</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><strong>h<sub>t-1</sub></strong></td>
                        <td>å‰ä¸€æ—¶åˆ»éšè—çŠ¶æ€</td>
                        <td>128Ã—1</td>
                        <td>åŒ…å«å†å²ä¿¡æ¯çš„å‘é‡</td>
                    </tr>
                    <tr>
                        <td><strong>x<sub>t</sub></strong></td>
                        <td>å½“å‰è¾“å…¥</td>
                        <td>100Ã—1</td>
                        <td>å½“å‰æ—¶åˆ»çš„è¾“å…¥ç‰¹å¾</td>
                    </tr>
                    <tr>
                        <td><strong>W<sub>f</sub></strong></td>
                        <td>é—å¿˜é—¨æƒé‡</td>
                        <td>128Ã—228</td>
                        <td>å­¦ä¹ å¦‚ä½•ç»„åˆè¾“å…¥ä¿¡æ¯</td>
                    </tr>
                    <tr>
                        <td><strong>b<sub>f</sub></strong></td>
                        <td>é—å¿˜é—¨åç½®</td>
                        <td>128Ã—1</td>
                        <td>æ¯ä¸ªéšè—å•å…ƒçš„åŸºå‡†å€¼</td>
                    </tr>
                    <tr>
                        <td><strong>f<sub>t</sub></strong></td>
                        <td>é—å¿˜é—¨è¾“å‡º</td>
                        <td>128Ã—1</td>
                        <td>æ§åˆ¶é—å¿˜ç¨‹åº¦ï¼Œå€¼âˆˆ[0,1]</td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <!-- æ ¸å¿ƒæ¦‚å¿µä¸åº”ç”¨ -->
            <h3 style="text-align: center; color: var(--accent-yellow); margin: 3rem 0 2rem;">ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µä¸åº”ç”¨</h3>

            <div class="insight-box" style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(6, 182, 212, 0.1)); border: 2px solid rgba(34, 197, 94, 0.3);">
                <h3 class="insight-title" style="color: var(--accent-green);">é—å¿˜é—¨å¦‚ä½•ä½œç”¨äºç»†èƒçŠ¶æ€ï¼Ÿ</h3>
                <div class="formula-display" style="margin: 1.5rem 0; background: rgba(0,0,0,0.2);">
                    <div style="font-size: 1.75rem; font-family: Georgia, serif;">
                        C<sub>t</sub><sup>new</sup> = f<sub>t</sub> âŠ™ C<sub>t-1</sub>
                    </div>
                    <p style="color: var(--text-secondary); margin-top: 1rem;">
                        âŠ™ è¡¨ç¤ºé€å…ƒç´ ç›¸ä¹˜ï¼ˆHadamardç§¯ï¼‰
                    </p>
                </div>

                <div class="card-grid" style="margin-top: 2rem;">
                    <div class="info-card" style="background: rgba(34, 197, 94, 0.1); border-color: var(--accent-green);">
                        <h4 style="color: var(--accent-green);">f = 0.9 (å¼ºè®°å¿†)</h4>
                        <p>C<sub>old</sub> = 2.0</p>
                        <p>C<sub>new</sub> = 0.9 Ã— 2.0 = 1.8</p>
                        <p style="margin-top: 0.5rem; font-weight: 600;">ä¿ç•™90%çš„ä¿¡æ¯</p>

                        <!-- å¯è§†åŒ–è¿›åº¦æ¡ -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 0.75rem;">
                            <div style="position: relative; height: 40px;">
                                <!-- åŸå§‹å€¼ -->
                                <div style="position: absolute; width: 100%; height: 20px; background: rgba(255,255,255,0.1); border-radius: 10px; top: 0;">
                                    <div style="width: 100%; height: 100%; background: linear-gradient(90deg, var(--accent-green) 0%, var(--accent-cyan) 100%); border-radius: 10px;"></div>
                                </div>
                                <!-- ä¿ç•™å€¼ -->
                                <div style="position: absolute; width: 90%; height: 20px; background: rgba(255,255,255,0.2); border-radius: 10px; bottom: 0; box-shadow: 0 2px 10px rgba(34,197,94,0.5);">
                                    <div style="width: 100%; height: 100%; background: var(--accent-green); border-radius: 10px;"></div>
                                </div>
                                <!-- æ ‡ç­¾ -->
                                <div style="position: absolute; right: 5px; top: 1px; color: white; font-size: 0.75rem;">100%</div>
                                <div style="position: absolute; right: 15%; bottom: 1px; color: white; font-size: 0.75rem;">90%</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-card" style="background: rgba(251, 191, 36, 0.1); border-color: var(--accent-yellow);">
                        <h4 style="color: var(--accent-yellow);">f = 0.5 (ä¸­ç­‰è®°å¿†)</h4>
                        <p>C<sub>old</sub> = 2.0</p>
                        <p>C<sub>new</sub> = 0.5 Ã— 2.0 = 1.0</p>
                        <p style="margin-top: 0.5rem; font-weight: 600;">ä¿ç•™50%çš„ä¿¡æ¯</p>

                        <!-- å¯è§†åŒ–è¿›åº¦æ¡ -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 0.75rem;">
                            <div style="position: relative; height: 40px;">
                                <!-- åŸå§‹å€¼ -->
                                <div style="position: absolute; width: 100%; height: 20px; background: rgba(255,255,255,0.1); border-radius: 10px; top: 0;">
                                    <div style="width: 100%; height: 100%; background: linear-gradient(90deg, var(--accent-yellow) 0%, var(--accent-purple) 100%); border-radius: 10px;"></div>
                                </div>
                                <!-- ä¿ç•™å€¼ -->
                                <div style="position: absolute; width: 50%; height: 20px; background: rgba(255,255,255,0.2); border-radius: 10px; bottom: 0; box-shadow: 0 2px 10px rgba(251,191,36,0.5);">
                                    <div style="width: 100%; height: 100%; background: var(--accent-yellow); border-radius: 10px;"></div>
                                </div>
                                <!-- æ ‡ç­¾ -->
                                <div style="position: absolute; right: 5px; top: 1px; color: white; font-size: 0.75rem;">100%</div>
                                <div style="position: absolute; right: 52%; bottom: 1px; color: white; font-size: 0.75rem;">50%</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-card" style="background: rgba(244, 114, 182, 0.1); border-color: var(--accent-pink);">
                        <h4 style="color: var(--accent-pink);">f = 0.1 (å¼±è®°å¿†)</h4>
                        <p>C<sub>old</sub> = 2.0</p>
                        <p>C<sub>new</sub> = 0.1 Ã— 2.0 = 0.2</p>
                        <p style="margin-top: 0.5rem; font-weight: 600;">ä»…ä¿ç•™10%çš„ä¿¡æ¯</p>

                        <!-- å¯è§†åŒ–è¿›åº¦æ¡ -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 0.75rem;">
                            <div style="position: relative; height: 40px;">
                                <!-- åŸå§‹å€¼ -->
                                <div style="position: absolute; width: 100%; height: 20px; background: rgba(255,255,255,0.1); border-radius: 10px; top: 0;">
                                    <div style="width: 100%; height: 100%; background: linear-gradient(90deg, var(--accent-pink) 0%, var(--accent-purple) 100%); border-radius: 10px; opacity: 0.5;"></div>
                                </div>
                                <!-- ä¿ç•™å€¼ -->
                                <div style="position: absolute; width: 10%; height: 20px; background: rgba(255,255,255,0.2); border-radius: 10px; bottom: 0; box-shadow: 0 2px 10px rgba(244,114,182,0.5);">
                                    <div style="width: 100%; height: 100%; background: var(--accent-pink); border-radius: 10px;"></div>
                                </div>
                                <!-- æ ‡ç­¾ -->
                                <div style="position: absolute; right: 5px; top: 1px; color: white; font-size: 0.75rem;">100%</div>
                                <div style="position: absolute; left: 12%; bottom: 1px; color: white; font-size: 0.75rem;">10%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="insight-box" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(96, 165, 250, 0.1)); border-color: var(--accent-purple);">
                <h3 class="insight-title" style="color: var(--accent-purple);">ğŸ”‘ è®¾è®¡çš„å·§å¦™ä¹‹å¤„</h3>
                <ul class="insight-list">
                    <li><strong>çº¿æ€§è·¯å¾„ï¼š</strong>é€šè¿‡ç®€å•ä¹˜æ³•æ›´æ–°ï¼Œé¿å…æ¢¯åº¦æ¶ˆå¤±</li>
                    <li><strong>é€‰æ‹©æ€§æ§åˆ¶ï¼š</strong>æ¯ä¸ªç»´åº¦ç‹¬ç«‹ï¼Œç²¾ç¡®æ§åˆ¶ç‰¹å¾ä¿ç•™</li>
                    <li><strong>å¯å­¦ä¹ æ€§ï¼š</strong>åå‘ä¼ æ’­è‡ªåŠ¨å­¦ä¹ é—å¿˜ç­–ç•¥</li>
                    <li><strong>æ•°å€¼ç¨³å®šï¼š</strong>Sigmoidç¡®ä¿è¾“å‡ºåœ¨[0,1]èŒƒå›´</li>
                </ul>
            </div>

            <!-- ç›´è§‚ç†è§£ -->
            <h3 style="text-align: center; color: var(--accent-cyan); margin: 3rem 0 2rem;">ğŸ­ ç”¨ç”Ÿæ´»ç±»æ¯”ç†è§£é—å¿˜é—¨</h3>

            <div class="insight-box" style="background: linear-gradient(135deg, rgba(240, 147, 251, 0.1), rgba(34, 211, 238, 0.1)); border: 2px solid rgba(240, 147, 251, 0.3);">
                <h3 class="insight-title" style="color: var(--accent-pink);">é—å¿˜é—¨å°±åƒå¤§è„‘çš„"è®°å¿†è¿‡æ»¤å™¨"</h3>
                <div class="insight-content">
                    <p>æƒ³è±¡ä½ åœ¨å¬ä¸€ä¸ªç²¾å½©çš„æ•…äº‹ï¼Œä½ çš„å¤§è„‘ä¼šè‡ªåŠ¨ï¼š</p>
                    <ul class="insight-list">
                        <li><strong>é‡è¦æƒ…èŠ‚ï¼ˆf â‰ˆ 0.9ï¼‰ï¼š</strong>ä¸»è§’åå­—ã€å…³é”®è½¬æŠ˜ â†’ æ·±åˆ»è®°å¿†</li>
                        <li><strong>æ™®é€šç»†èŠ‚ï¼ˆf â‰ˆ 0.5ï¼‰ï¼š</strong>ç¯å¢ƒæè¿°ã€èƒŒæ™¯éŸ³ä¹ â†’ æ¨¡ç³Šå°è±¡</li>
                        <li><strong>æ— å…³ä¿¡æ¯ï¼ˆf â‰ˆ 0.1ï¼‰ï¼š</strong>è·¯äººå¯¹è¯ã€é‡å¤å†…å®¹ â†’ è‡ªåŠ¨è¿‡æ»¤</li>
                    </ul>
                    <p style="margin-top: 1rem; color: var(--accent-cyan);">
                        ğŸ’¡ é—å¿˜é—¨é€šè¿‡è®­ç»ƒï¼Œå­¦ä¼šè¯†åˆ«å“ªäº›ä¿¡æ¯å¯¹ä»»åŠ¡é‡è¦ï¼
                    </p>
                </div>
            </div>

            <div class="process-flow">
                <div class="process-connector"></div>
                <div class="process-step">
                    <span class="step-number">1</span>
                    <span class="step-icon">ğŸ“¥</span>
                    <h4 class="step-title">æ¥æ”¶ä¿¡æ¯</h4>
                    <p class="step-description">
                        ç»“åˆå†å²çŠ¶æ€h<sub>t-1</sub>å’Œå½“å‰è¾“å…¥x<sub>t</sub>
                    </p>
                </div>

                <div class="process-step">
                    <span class="step-number">2</span>
                    <span class="step-icon">âš–ï¸</span>
                    <h4 class="step-title">æƒé‡è¯„ä¼°</h4>
                    <p class="step-description">
                        é€šè¿‡W<sub>f</sub>çŸ©é˜µè®¡ç®—æ¯ä¸ªç‰¹å¾çš„é‡è¦æ€§
                    </p>
                </div>

                <div class="process-step">
                    <span class="step-number">3</span>
                    <span class="step-icon">ğŸšï¸</span>
                    <h4 class="step-title">ç”Ÿæˆæ§åˆ¶ä¿¡å·</h4>
                    <p class="step-description">
                        Sigmoidå‡½æ•°è¾“å‡º0-1ä¹‹é—´çš„é—å¿˜ç³»æ•°
                    </p>
                </div>
            </div>

            <!-- å®é™…åº”ç”¨ç¤ºä¾‹ -->
            <h3 style="text-align: center; color: var(--accent-yellow); margin: 3rem 0 2rem;">ğŸ“ å®é™…åº”ç”¨åœºæ™¯</h3>

            <div class="card-grid">
                <div class="info-card">
                    <span class="card-icon">ğŸ“–</span>
                    <h3 class="card-title">æ–‡æœ¬å¤„ç†</h3>
                    <div class="card-content">
                        <p>åœ¨å¥å­"å°æ˜å»äº†åŒ—äº¬ï¼Œä»–å¾ˆå–œæ¬¢é‚£é‡Œ"ä¸­ï¼š</p>
                        <ul style="margin-top: 0.5rem; margin-left: 1rem;">
                            <li>çœ‹åˆ°"ä»–"æ—¶ï¼Œé—å¿˜é—¨ä¿ç•™"å°æ˜"çš„ä¿¡æ¯</li>
                            <li>çœ‹åˆ°"é‚£é‡Œ"æ—¶ï¼Œé—å¿˜é—¨ä¿ç•™"åŒ—äº¬"çš„ä¿¡æ¯</li>
                            <li>è‡ªåŠ¨è¿‡æ»¤æ ‡ç‚¹ç¬¦å·ç­‰æ— å…³ä¿¡æ¯</li>
                        </ul>

                        <!-- æ–‡æœ¬å¤„ç†å¯è§†åŒ– -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 0.75rem;">
                            <div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; gap: 0.5rem;">
                                <div style="text-align: center;">
                                    <div style="background: rgba(244,114,182,0.3); padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.875rem;">å°æ˜</div>
                                    <div style="color: var(--accent-green); font-size: 0.75rem; margin-top: 0.25rem;">f=0.9</div>
                                </div>
                                <div style="color: var(--text-dim);">â†’</div>
                                <div style="text-align: center;">
                                    <div style="background: rgba(100,100,100,0.2); padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.875rem;">å»äº†</div>
                                    <div style="color: var(--text-dim); font-size: 0.75rem; margin-top: 0.25rem;">f=0.3</div>
                                </div>
                                <div style="color: var(--text-dim);">â†’</div>
                                <div style="text-align: center;">
                                    <div style="background: rgba(34,211,238,0.3); padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.875rem;">åŒ—äº¬</div>
                                    <div style="color: var(--accent-green); font-size: 0.75rem; margin-top: 0.25rem;">f=0.8</div>
                                </div>
                                <div style="color: var(--text-dim);">â†’</div>
                                <div style="text-align: center;">
                                    <div style="background: rgba(100,100,100,0.1); padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.875rem;">ï¼Œ</div>
                                    <div style="color: var(--accent-pink); font-size: 0.75rem; margin-top: 0.25rem;">f=0.1</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ“Š</span>
                    <h3 class="card-title">æ—¶åºé¢„æµ‹</h3>
                    <div class="card-content">
                        <p>åœ¨è‚¡ç¥¨ä»·æ ¼é¢„æµ‹ä¸­ï¼š</p>
                        <ul style="margin-top: 0.5rem; margin-left: 1rem;">
                            <li>é•¿æœŸè¶‹åŠ¿ä¿¡æ¯è¢«é«˜åº¦ä¿ç•™ï¼ˆf â‰ˆ 0.9ï¼‰</li>
                            <li>çŸ­æœŸæ³¢åŠ¨é€æ¸è¢«é—å¿˜ï¼ˆf â‰ˆ 0.3ï¼‰</li>
                            <li>å¼‚å¸¸å€¼å½±å“è¢«å¿«é€Ÿæ¶ˆé™¤ï¼ˆf â‰ˆ 0.1ï¼‰</li>
                        </ul>

                        <!-- æ—¶åºæ•°æ®å¯è§†åŒ– -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 0.75rem;">
                            <svg width="100%" height="80" viewBox="0 0 200 80" style="display: block;">
                                <!-- è¶‹åŠ¿çº¿ -->
                                <path d="M 10 60 Q 50 50, 100 40 T 190 20" fill="none" stroke="var(--accent-green)" stroke-width="2" stroke-dasharray="5,5" opacity="0.8"/>
                                <!-- å®é™…æ•°æ®çº¿ -->
                                <path d="M 10 60 L 30 55 L 50 52 L 70 48 L 90 44 L 110 38 L 130 36 L 150 30 L 170 26 L 190 20"
                                      fill="none" stroke="var(--accent-cyan)" stroke-width="2"/>
                                <!-- å¼‚å¸¸ç‚¹ -->
                                <circle cx="70" cy="35" r="3" fill="var(--accent-pink)"/>
                                <circle cx="130" cy="45" r="3" fill="var(--accent-pink)"/>

                                <!-- æ ‡æ³¨ -->
                                <text x="100" y="15" text-anchor="middle" fill="var(--text-secondary)" font-size="10">é•¿æœŸè¶‹åŠ¿ (fâ‰ˆ0.9)</text>
                                <text x="70" y="30" text-anchor="middle" fill="var(--accent-pink)" font-size="9">å¼‚å¸¸å€¼ (fâ‰ˆ0.1)</text>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="info-card">
                    <span class="card-icon">ğŸ—£ï¸</span>
                    <h3 class="card-title">è¯­éŸ³è¯†åˆ«</h3>
                    <div class="card-content">
                        <p>åœ¨è¿ç»­è¯­éŸ³æµä¸­ï¼š</p>
                        <ul style="margin-top: 0.5rem; margin-left: 1rem;">
                            <li>å…³é”®éŸ³ç´ ç‰¹å¾è¢«ä¿ç•™</li>
                            <li>èƒŒæ™¯å™ªéŸ³è¢«è¿‡æ»¤</li>
                            <li>è¯­è°ƒå˜åŒ–é€‰æ‹©æ€§è®°å¿†</li>
                        </ul>

                        <!-- éŸ³é¢‘æ³¢å½¢å¯è§†åŒ– -->
                        <div style="margin-top: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 0.75rem;">
                            <div style="position: relative; height: 60px;">
                                <!-- èƒŒæ™¯å™ªéŸ³ -->
                                <div style="position: absolute; width: 100%; height: 100%; display: flex; align-items: center; justify-content: space-around;">
                                    <div style="width: 3px; height: 20%; background: var(--text-dim); opacity: 0.3;"></div>
                                    <div style="width: 3px; height: 15%; background: var(--text-dim); opacity: 0.3;"></div>
                                    <div style="width: 3px; height: 25%; background: var(--text-dim); opacity: 0.3;"></div>
                                    <div style="width: 3px; height: 18%; background: var(--text-dim); opacity: 0.3;"></div>
                                </div>
                                <!-- è¯­éŸ³ä¿¡å· -->
                                <div style="position: absolute; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; gap: 2px;">
                                    <div style="width: 4px; height: 30%; background: var(--accent-cyan); border-radius: 2px;"></div>
                                    <div style="width: 4px; height: 50%; background: var(--accent-green); border-radius: 2px;"></div>
                                    <div style="width: 4px; height: 80%; background: var(--accent-green); border-radius: 2px;"></div>
                                    <div style="width: 4px; height: 90%; background: var(--accent-yellow); border-radius: 2px;"></div>
                                    <div style="width: 4px; height: 70%; background: var(--accent-green); border-radius: 2px;"></div>
                                    <div style="width: 4px; height: 40%; background: var(--accent-cyan); border-radius: 2px;"></div>
                                    <div style="width: 4px; height: 20%; background: var(--accent-cyan); border-radius: 2px;"></div>
                                </div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 0.5rem; font-size: 0.75rem;">
                                <span style="color: var(--text-dim);">å™ªéŸ³ (fâ‰ˆ0.1)</span>
                                <span style="color: var(--accent-yellow);">å…³é”®éŸ³ç´  (fâ‰ˆ0.9)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- è¾“å…¥é—¨ã€è¾“å‡ºé—¨å’Œæ•´åˆè¿‡ç¨‹çš„è¯¦è§£ -->
        <section class="section-card">
            <h2 style="color: var(--accent-cyan); margin-bottom: 2rem;">ğŸ“¥ è¾“å…¥é—¨ä¸å€™é€‰å€¼è¯¦è§£</h2>

            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>è¾“å…¥é—¨å…¬å¼</h4>
                    <div class="formula-math">
                        i<sub>t</sub> = Ïƒ(W<sub>i</sub> Â· [h<sub>t-1</sub>, x<sub>t</sub>] + b<sub>i</sub>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>å€™é€‰å€¼å…¬å¼</h4>
                    <div class="formula-math">
                        CÌƒ<sub>t</sub> = tanh(W<sub>C</sub> Â· [h<sub>t-1</sub>, x<sub>t</sub>] + b<sub>C</sub>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>æ–°ä¿¡æ¯è®¡ç®—</h4>
                    <div class="formula-math">
                        æ–°å¢ä¿¡æ¯ = i<sub>t</sub> âŠ™ CÌƒ<sub>t</sub>
                    </div>
                </div>
            </div>

            <div class="insight-box" style="background: linear-gradient(135deg, rgba(79, 172, 254, 0.1), rgba(0, 242, 254, 0.1)); border: 2px solid rgba(79, 172, 254, 0.3);">
                <h3 class="insight-title" style="color: var(--accent-cyan);">è¾“å…¥é—¨çš„ä½œç”¨æœºåˆ¶</h3>
                <p>è¾“å…¥é—¨é€šè¿‡ä¸¤æ­¥ç¡®å®šè¦å­˜å‚¨çš„æ–°ä¿¡æ¯ï¼š</p>
                <ul>
                    <li><strong>i<sub>t</sub>:</strong> å†³å®šå­˜å‚¨æƒé‡ï¼ˆ0=å¿½ç•¥ï¼Œ1=å…¨éƒ¨å­˜å‚¨ï¼‰</li>
                    <li><strong>CÌƒ<sub>t</sub>:</strong> å€™é€‰è®°å¿†å†…å®¹ï¼ˆèŒƒå›´[-1,1]ï¼‰</li>
                </ul>
            </div>
        </section>

        <section class="section-card">
            <h2 style="color: var(--accent-yellow); margin-bottom: 2rem;">ğŸ“¤ è¾“å‡ºé—¨è¯¦è§£</h2>

            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>è¾“å‡ºé—¨å…¬å¼</h4>
                    <div class="formula-math">
                        o<sub>t</sub> = Ïƒ(W<sub>o</sub> Â· [h<sub>t-1</sub>, x<sub>t</sub>] + b<sub>o</sub>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>éšè—çŠ¶æ€å…¬å¼</h4>
                    <div class="formula-math">
                        h<sub>t</sub> = o<sub>t</sub> âŠ™ tanh(C<sub>t</sub>)
                    </div>
                </div>

                <div class="formula-column">
                    <h4>è¾“å‡ºè¿‡æ»¤</h4>
                    <div class="formula-math">
                        ä»ç»†èƒçŠ¶æ€C<sub>t</sub>ä¸­<br>é€‰æ‹©æ€§è¾“å‡ºä¿¡æ¯
                    </div>
                </div>
            </div>

            <div class="insight-box" style="background: linear-gradient(135deg, rgba(250, 112, 154, 0.1), rgba(254, 225, 64, 0.1)); border: 2px solid rgba(250, 112, 154, 0.3);">
                <h3 class="insight-title" style="color: var(--accent-yellow);">è¾“å‡ºé—¨çš„æ™ºèƒ½é€‰æ‹©</h3>
                <p>è¾“å‡ºé—¨å†³å®šä»ä¸°å¯Œçš„ç»†èƒçŠ¶æ€ä¸­è¾“å‡ºå“ªäº›ä¿¡æ¯ï¼š</p>
                <ul>
                    <li>ç»†èƒçŠ¶æ€C<sub>t</sub>ä¿å­˜å®Œæ•´ä¿¡æ¯</li>
                    <li>é€šè¿‡tanhå‹ç¼©åˆ°[-1,1]èŒƒå›´</li>
                    <li>o<sub>t</sub>é€‰æ‹©æ€§è¿‡æ»¤è¾“å‡ºå†…å®¹</li>
                </ul>
            </div>
        </section>

        <section class="section-card" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">ğŸ”„ æ•´åˆè¿‡ç¨‹ï¼šä¸‰ä¸ªé—¨çš„ååŒæ•ˆæœ</h2>

            <div class="formula-explainer">
                <div class="formula-column">
                    <h4>ç»†èƒçŠ¶æ€æ›´æ–°</h4>
                    <div class="formula-math">
                        C<sub>t</sub> = f<sub>t</sub> âŠ™ C<sub>t-1</sub> + i<sub>t</sub> âŠ™ CÌƒ<sub>t</sub>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>ä¸‰ä¸ªé—¨çš„ä½œç”¨</h4>
                    <div style="text-align: left; padding: 1rem;">
                        <p><span style="color: var(--accent-pink);">é—å¿˜é—¨:</span> é€‰æ‹©æ€§é—å¿˜</p>
                        <p><span style="color: var(--accent-cyan);">è¾“å…¥é—¨:</span> é€‰æ‹©æ€§è®°å¿†</p>
                        <p><span style="color: var(--accent-yellow);">è¾“å‡ºé—¨:</span> é€‰æ‹©æ€§è¾“å‡º</p>
                    </div>
                </div>

                <div class="formula-column">
                    <h4>æœ€ç»ˆæ•ˆæœ</h4>
                    <div style="text-align: center; padding: 1rem;">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">âœ¨</div>
                        <p>ç²¾ç¡®æ§åˆ¶ä¿¡æ¯æµ<br>è§£å†³é•¿æœŸä¾èµ–é—®é¢˜</p>
                    </div>
                </div>
            </div>

            <!-- æ•´åˆè¿‡ç¨‹çš„åŠ¨æ€å±•ç¤º -->
            <div style="background: rgba(255, 255, 255, 0.05); border-radius: 1rem; padding: 2rem; margin: 2rem 0;">
                <h3 style="color: var(--accent-cyan); text-align: center; margin-bottom: 2rem;">ğŸ“Š æ•°æ®æµåŠ¨è¿‡ç¨‹ç¤ºä¾‹</h3>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; text-align: center;">
                    <div>
                        <h4 style="color: var(--accent-green); margin-bottom: 1rem;">åˆå§‹çŠ¶æ€</h4>
                        <div style="background: rgba(34, 197, 94, 0.1); padding: 1rem; border-radius: 0.5rem;">
                            <p>C<sub>t-1</sub> = 1.5</p>
                            <p>h<sub>t-1</sub> = 0.8</p>
                            <p>x<sub>t</sub> = 0.6</p>
                        </div>
                    </div>

                    <div>
                        <h4 style="color: var(--accent-pink); margin-bottom: 1rem;">é—å¿˜é˜¶æ®µ</h4>
                        <div style="background: rgba(244, 114, 182, 0.1); padding: 1rem; border-radius: 0.5rem;">
                            <p>f<sub>t</sub> = 0.7</p>
                            <p>é—å¿˜å: 1.5 Ã— 0.7 = 1.05</p>
                        </div>
                    </div>

                    <div>
                        <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">è¾“å…¥é˜¶æ®µ</h4>
                        <div style="background: rgba(79, 172, 254, 0.1); padding: 1rem; border-radius: 0.5rem;">
                            <p>i<sub>t</sub> = 0.6, CÌƒ<sub>t</sub> = 0.9</p>
                            <p>æ–°å¢: 0.6 Ã— 0.9 = 0.54</p>
                        </div>
                    </div>

                    <div>
                        <h4 style="color: var(--accent-yellow); margin-bottom: 1rem;">è¾“å‡ºé˜¶æ®µ</h4>
                        <div style="background: rgba(250, 112, 154, 0.1); padding: 1rem; border-radius: 0.5rem;">
                            <p>C<sub>t</sub> = 1.05 + 0.54 = 1.59</p>
                            <p>o<sub>t</sub> = 0.8</p>
                            <p>h<sub>t</sub> = 0.8 Ã— tanh(1.59) â‰ˆ 0.73</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tip success" style="margin-top: 2rem;">
                <span style="font-size: 1.5rem;">ğŸ¯</span>
                <div>
                    <strong>å…³é”®æ´å¯Ÿï¼š</strong>é€šè¿‡ä¸‰ä¸ªé—¨çš„ååŒå·¥ä½œï¼ŒLSTMå®ç°äº†ï¼š
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li><strong>æ¢¯åº¦ç¨³å®šä¼ æ’­ï¼š</strong>ç»†èƒçŠ¶æ€çš„çº¿æ€§è·¯å¾„é¿å…æ¢¯åº¦æ¶ˆå¤±</li>
                        <li><strong>é€‰æ‹©æ€§è®°å¿†ï¼š</strong>ç²¾ç¡®æ§åˆ¶ä¿¡æ¯çš„ä¿ç•™ã€æ›´æ–°å’Œè¾“å‡º</li>
                        <li><strong>é•¿æœŸä¾èµ–å»ºæ¨¡ï¼š</strong>é‡è¦ä¿¡æ¯å¯ä»¥è·¨è¶Šå¾ˆé•¿çš„æ—¶é—´æ­¥ä¼ é€’</li>
                    </ul>
                </div>
            </div>
        </section>

            <div class="comparison-table">
                <table>
                    <thead>
                    <tr>
                        <th>ç»„ä»¶</th>
                        <th>ä½œç”¨</th>
                        <th>æ¿€æ´»å‡½æ•°</th>
                        <th>è¾“å‡ºèŒƒå›´</th>
                        <th>å…³é”®ç‰¹æ€§</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><strong>é—å¿˜é—¨</strong></td>
                        <td>å†³å®šå¿˜è®°ä»€ä¹ˆ</td>
                        <td>Sigmoid</td>
                        <td>[0, 1]</td>
                        <td>é€‰æ‹©æ€§é—å¿˜</td>
                    </tr>
                    <tr>
                        <td><strong>è¾“å…¥é—¨</strong></td>
                        <td>å†³å®šå­˜å‚¨æƒé‡</td>
                        <td>Sigmoid</td>
                        <td>[0, 1]</td>
                        <td>æ§åˆ¶æ›´æ–°å¼ºåº¦</td>
                    </tr>
                    <tr>
                        <td><strong>å€™é€‰å€¼</strong></td>
                        <td>æ–°çš„è®°å¿†å†…å®¹</td>
                        <td>Tanh</td>
                        <td>[-1, 1]</td>
                        <td>ç¼–ç æ–°ä¿¡æ¯</td>
                    </tr>
                    <tr>
                        <td><strong>ç»†èƒçŠ¶æ€</strong></td>
                        <td>é•¿æœŸè®°å¿†å­˜å‚¨</td>
                        <td>çº¿æ€§</td>
                        <td>(-âˆ, +âˆ)</td>
                        <td>æ¢¯åº¦é«˜é€Ÿå…¬è·¯</td>
                    </tr>
                    <tr>
                        <td><strong>è¾“å‡ºé—¨</strong></td>
                        <td>å†³å®šè¾“å‡ºä»€ä¹ˆ</td>
                        <td>Sigmoid</td>
                        <td>[0, 1]</td>
                        <td>ä¿¡æ¯è¿‡æ»¤</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- LSTM vs GRU å¯¹æ¯”åˆ†æ -->
        <section id="lstm-vs-gru" class="section-card">
            <h2 style="color: var(--accent-yellow); margin-bottom: 2rem;">âš”ï¸ LSTM vs GRUï¼šç¹ä¸ç®€çš„æƒè¡¡</h2>

            <div class="architecture-comparison">
                <div class="architecture-card lstm">
                    <div class="architecture-title">
                        <div class="architecture-icon lstm">ğŸ—ï¸</div>
                        <div>
                            <h3 style="color: var(--accent-pink);">LSTM (1997)</h3>
                            <p style="color: var(--text-secondary);">Long Short-Term Memory</p>
                        </div>
                    </div>

                    <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">ğŸ”§ æ¶æ„ç‰¹ç‚¹</h4>
                    <ul style="margin-left: 1.5rem; line-height: 1.8;">
                        <li><strong>ä¸‰ä¸ªé—¨ï¼š</strong>é—å¿˜é—¨ã€è¾“å…¥é—¨ã€è¾“å‡ºé—¨</li>
                        <li><strong>åŒçŠ¶æ€ï¼š</strong>ç»†èƒçŠ¶æ€ + éšè—çŠ¶æ€</li>
                        <li><strong>å‚æ•°å¤šï¼š</strong>4ä¸ªæƒé‡çŸ©é˜µ</li>
                        <li><strong>æ§åˆ¶ç²¾ç»†ï¼š</strong>ç‹¬ç«‹æ§åˆ¶é—å¿˜å’Œè®°å¿†</li>
                    </ul>

                    <div style="margin: 1.5rem 0;">
                        <canvas id="lstmArchCanvas" width="300" height="200"></canvas>
                    </div>

                    <div class="tip info">
                        <span>ğŸ’¡</span>
                        <div>
                            <strong>ä¼˜åŠ¿ï¼š</strong>è¡¨è¾¾èƒ½åŠ›å¼ºï¼Œé€‚åˆå¤æ‚ä»»åŠ¡<br>
                            <strong>åŠ£åŠ¿ï¼š</strong>å‚æ•°å¤šï¼Œè®­ç»ƒæ…¢
                        </div>
                    </div>
                </div>

                <div class="architecture-card gru">
                    <div class="architecture-title">
                        <div class="architecture-icon gru">âš¡</div>
                        <div>
                            <h3 style="color: var(--accent-orange);">GRU (2014)</h3>
                            <p style="color: var(--text-secondary);">Gated Recurrent Unit</p>
                        </div>
                    </div>

                    <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">ğŸ”§ æ¶æ„ç‰¹ç‚¹</h4>
                    <ul style="margin-left: 1.5rem; line-height: 1.8;">
                        <li><strong>ä¸¤ä¸ªé—¨ï¼š</strong>é‡ç½®é—¨ã€æ›´æ–°é—¨</li>
                        <li><strong>å•çŠ¶æ€ï¼š</strong>åªæœ‰éšè—çŠ¶æ€</li>
                        <li><strong>å‚æ•°å°‘ï¼š</strong>3ä¸ªæƒé‡çŸ©é˜µ</li>
                        <li><strong>ç®€åŒ–ç‰ˆï¼š</strong>é—å¿˜é—¨ + è¾“å…¥é—¨ = æ›´æ–°é—¨</li>
                    </ul>

                    <div style="margin: 1.5rem 0;">
                        <canvas id="gruArchCanvas" width="300" height="200"></canvas>
                    </div>

                    <div class="tip success">
                        <span>âš¡</span>
                        <div>
                            <strong>ä¼˜åŠ¿ï¼š</strong>å‚æ•°å°‘ï¼Œè®­ç»ƒå¿«ï¼Œæ€§èƒ½æ¥è¿‘<br>
                            <strong>åŠ£åŠ¿ï¼š</strong>è¡¨è¾¾èƒ½åŠ›ç¨å¼±
                        </div>
                    </div>
                </div>
            </div>

            <!-- å…¬å¼å¯¹æ¯” -->
            <div style="background: var(--bg-section); padding: 2rem; border-radius: 1rem; margin: 2rem 0;">
                <h3 style="color: var(--accent-purple); text-align: center; margin-bottom: 2rem;">ğŸ“ å…¬å¼å¯¹æ¯”</h3>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                    <div>
                        <h4 style="color: var(--accent-pink); margin-bottom: 1rem;">LSTMå…¬å¼</h4>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem; font-family: monospace; font-size: 0.9rem;">
                            f_t = Ïƒ(W_f[h_{t-1}, x_t] + b_f)<br>
                            i_t = Ïƒ(W_i[h_{t-1}, x_t] + b_i)<br>
                            CÌƒ_t = tanh(W_C[h_{t-1}, x_t] + b_C)<br>
                            C_t = f_t âŠ™ C_{t-1} + i_t âŠ™ CÌƒ_t<br>
                            o_t = Ïƒ(W_o[h_{t-1}, x_t] + b_o)<br>
                            h_t = o_t âŠ™ tanh(C_t)
                        </div>
                    </div>

                    <div>
                        <h4 style="color: var(--accent-orange); margin-bottom: 1rem;">GRUå…¬å¼</h4>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem; font-family: monospace; font-size: 0.9rem;">
                            r_t = Ïƒ(W_r[h_{t-1}, x_t] + b_r)<br>
                            z_t = Ïƒ(W_z[h_{t-1}, x_t] + b_z)<br>
                            hÌƒ_t = tanh(W_h[r_t âŠ™ h_{t-1}, x_t] + b_h)<br>
                            h_t = z_t âŠ™ h_{t-1} + (1-z_t) âŠ™ hÌƒ_t<br>
                            <br>
                            <span style="color: var(--text-secondary);"># æ³¨æ„ï¼šGRUåªéœ€è¦4è¡Œï¼</span>
                        </div>
                    </div>
                </div>

                <div class="tip warning" style="margin-top: 2rem;">
                    <span>ğŸ¤”</span>
                    <div>
                        <strong>å…³é”®æ´å¯Ÿï¼š</strong>GRUé€šè¿‡ <code>z_t</code> å’Œ <code>(1-z_t)</code> å®ç°äº†LSTMä¸­é—å¿˜é—¨å’Œè¾“å…¥é—¨çš„åŠŸèƒ½ã€‚
                        å½“ z_t = 1 æ—¶å®Œå…¨ä¿ç•™æ—§çŠ¶æ€ï¼Œå½“ z_t = 0 æ—¶å®Œå…¨æ¥å—æ–°çŠ¶æ€ã€‚
                    </div>
                </div>
            </div>

            <!-- æ€§èƒ½å¯¹æ¯”å®éªŒ -->
            <div class="live-demo">
                <div class="live-demo-content">
                    <h3 style="color: var(--accent-cyan); margin-bottom: 1.5rem;">ğŸ† æ€§èƒ½å¯¹æ¯”å®éªŒ</h3>
                    <p style="margin-bottom: 1.5rem;">åœ¨ç›¸åŒçš„è¯­è¨€å»ºæ¨¡ä»»åŠ¡ä¸Šæ¯”è¾ƒLSTMå’ŒGRUï¼š</p>

                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem;">
                        <div style="text-align: center;">
                            <h4 style="color: var(--accent-blue);">è®­ç»ƒé€Ÿåº¦</h4>
                            <div style="font-size: 2rem; margin: 1rem 0;">âš¡</div>
                            <p>GRUå¿«30%</p>
                        </div>
                        <div style="text-align: center;">
                            <h4 style="color: var(--accent-green);">å‡†ç¡®ç‡</h4>
                            <div style="font-size: 2rem; margin: 1rem 0;">ğŸ“Š</div>
                            <p>LSTMç•¥èƒœ2%</p>
                        </div>
                        <div style="text-align: center;">
                            <h4 style="color: var(--accent-orange);">å†…å­˜å ç”¨</h4>
                            <div style="font-size: 2rem; margin: 1rem 0;">ğŸ’¾</div>
                            <p>GRUçœ25%</p>
                        </div>
                    </div>

                    <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(255, 255, 255, 0.05); border-radius: 0.5rem;">
                        <h4 style="color: var(--accent-purple); margin-bottom: 1rem;">é€‰æ‹©å»ºè®®</h4>
                        <ul style="margin-left: 1.5rem; line-height: 1.8;">
                            <li><strong>é€‰æ‹©LSTMï¼š</strong>å¤æ‚ä»»åŠ¡ã€éœ€è¦ç²¾ç»†æ§åˆ¶ã€è®¡ç®—èµ„æºå……è¶³</li>
                            <li><strong>é€‰æ‹©GRUï¼š</strong>ç®€å•ä»»åŠ¡ã€å¿«é€ŸåŸå‹ã€èµ„æºå—é™</li>
                            <li><strong>å®é™…å»ºè®®ï¼š</strong>ä¸¤ä¸ªéƒ½è¯•è¯•ï¼Œçœ‹å“ªä¸ªåœ¨ä½ çš„ä»»åŠ¡ä¸Šæ•ˆæœæ›´å¥½ï¼</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- æ•°å­¦è¯æ˜ -->
        <section id="math-proof" class="section-card">
            <h2 style="color: var(--accent-red); margin-bottom: 2rem;">ğŸ”¬ æ•°å­¦è¯æ˜ï¼šLSTMå¦‚ä½•è§£å†³æ¢¯åº¦æ¶ˆå¤±</h2>

            <div class="math-derivation">
                <h3 style="color: var(--accent-red); margin-bottom: 1.5rem;">ğŸ“ æ¢¯åº¦ä¼ æ’­åˆ†æ</h3>

                <div class="derivation-step">
                    <div class="derivation-step-number">1</div>
                    <h4>ç»†èƒçŠ¶æ€çš„æ¢¯åº¦ä¼ æ’­</h4>
                    <p>ä»ç»†èƒçŠ¶æ€æ›´æ–°å…¬å¼å‡ºå‘ï¼š</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $C_t = f_t \odot C_{t-1} + i_t \odot \tilde{C}_t$
                    </div>
                    <p>è®¡ç®—æ¢¯åº¦ï¼š</p>
                    <div style="text-align: center; margin: 1rem 0; font-size: 1.2rem;">
                        $\frac{\partial C_t}{\partial C_{t-1}} = \text{diag}(f_t)$
                    </div>
                </div>

                <div class="derivation-step">
                    <div class="derivation-step-number">2</div>
                    <h4>å…³é”®æ´å¯Ÿ</h4>
                    <p>æ¢¯åº¦é€šè¿‡<strong>å¯¹è§’çŸ©é˜µ</strong>ä¼ æ’­ï¼Œè€Œä¸æ˜¯å¯†é›†çŸ©é˜µï¼</p>
                    <div class="tip success">
                        <span style="font-size: 1.5rem;">ğŸ’¡</span>
                        <div>
                            è¿™æ„å‘³ç€ï¼š
                            <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                                <li>æ¯ä¸ªç»´åº¦çš„æ¢¯åº¦ç‹¬ç«‹ä¼ æ’­</li>
                                <li>æ²¡æœ‰ä¿¡æ¯æ··åˆ</li>
                                <li>ç½‘ç»œå¯ä»¥å­¦ä¹ è®© f_t â‰ˆ 1 æ¥ä¿æŒæ¢¯åº¦</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="derivation-step">
                    <div class="derivation-step-number">3</div>
                    <h4>æ•°å€¼ç¨³å®šæ€§åˆ†æ</h4>
                    <p>è™½ç„¶ç»†èƒçŠ¶æ€çº¿æ€§ä¼ æ’­ï¼Œä½†ä»å¯èƒ½æ•°å€¼ä¸ç¨³å®šã€‚ç°ä»£LSTMå¸¸ç”¨æŠ€å·§ï¼š</p>
                    <ul style="margin-left: 1.5rem; margin-top: 1rem;">
                        <li><strong>å±‚å½’ä¸€åŒ–ï¼š</strong>åœ¨æ¯ä¸ªé—¨ä¹‹å‰æ ‡å‡†åŒ–è¾“å…¥</li>
                        <li><strong>æ¢¯åº¦è£å‰ªï¼š</strong>é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸</li>
                        <li><strong>æƒé‡åˆå§‹åŒ–ï¼š</strong>é—å¿˜é—¨åç½®åˆå§‹åŒ–ä¸ºå¤§æ­£å€¼</li>
                    </ul>
                </div>

                <div class="derivation-step">
                    <div class="derivation-step-number">4</div>
                    <h4>ä¸RNNå¯¹æ¯”</h4>
                    <div class="comparison-table">
                        <table>
                            <thead>
                            <tr>
                                <th>æ¨¡å‹</th>
                                <th>æ¢¯åº¦ä¼ æ’­</th>
                                <th>100æ­¥åæ¢¯åº¦</th>
                                <th>ç¨³å®šæ€§</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>RNN</td>
                                <td>$(W_{hh}^T \cdot \text{diag}(\tanh'))^{100}$</td>
                                <td>â‰ˆ 10â»Â³â°</td>
                                <td>âŒ æä¸ç¨³å®š</td>
                            </tr>
                            <tr>
                                <td>LSTM</td>
                                <td>$\prod_{t=1}^{100} \text{diag}(f_t)$</td>
                                <td>â‰ˆ 10â»âµ</td>
                                <td>âœ… ç›¸å¯¹ç¨³å®š</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- ä»£ç å®ç° -->
        <section id="implementation" class="section-card">
            <h2 style="color: var(--accent-yellow); margin-bottom: 2rem;">ğŸ› ï¸ ä»é›¶å®ç°LSTM</h2>

            <div class="code-layers">
                <div class="code-layer-tabs">
                    <button class="code-layer-tab active" data-layer="pseudo">ä¼ªä»£ç </button>
                    <button class="code-layer-tab" data-layer="numpy">NumPyå®ç°</button>
                    <button class="code-layer-tab" data-layer="pytorch">PyTorchå®ç°</button>
                    <button class="code-layer-tab" data-layer="tensorflow">TensorFlowå®ç°</button>
                </div>

                <div class="code-layer-content active" data-layer-content="pseudo">
                    <pre><code class="language-plaintext">LSTMå‰å‘ä¼ æ’­ç®—æ³•ï¼š

è¾“å…¥ï¼šå½“å‰è¾“å…¥ x_t, ä¸Šä¸€éšè—çŠ¶æ€ h_{t-1}, ä¸Šä¸€ç»†èƒçŠ¶æ€ C_{t-1}
è¾“å‡ºï¼šå½“å‰éšè—çŠ¶æ€ h_t, å½“å‰ç»†èƒçŠ¶æ€ C_t

ç®—æ³•æ­¥éª¤ï¼š
1. è®¡ç®—é—å¿˜é—¨ï¼š
   f_t = sigmoid(W_f Â· [h_{t-1}, x_t] + b_f)

2. è®¡ç®—è¾“å…¥é—¨å’Œå€™é€‰å€¼ï¼š
   i_t = sigmoid(W_i Â· [h_{t-1}, x_t] + b_i)
   C_tilde_t = tanh(W_C Â· [h_{t-1}, x_t] + b_C)

3. æ›´æ–°ç»†èƒçŠ¶æ€ï¼š
   C_t = f_t âŠ™ C_{t-1} + i_t âŠ™ C_tilde_t

4. è®¡ç®—è¾“å‡ºé—¨å’Œéšè—çŠ¶æ€ï¼š
   o_t = sigmoid(W_o Â· [h_{t-1}, x_t] + b_o)
   h_t = o_t âŠ™ tanh(C_t)

è¿”å› h_t, C_t</code></pre>
                </div>

                <div class="code-layer-content" data-layer-content="numpy">
                    <pre><code class="language-python">import numpy as np

class LSTMCell:
    """LSTMå•å…ƒçš„NumPyå®ç°"""

    def __init__(self, input_dim, hidden_dim):
        # åˆå§‹åŒ–æƒé‡çŸ©é˜µ - Xavieråˆå§‹åŒ–
        scale = np.sqrt(2.0 / (input_dim + hidden_dim))

        # é—å¿˜é—¨å‚æ•°
        self.Wf = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bf = np.ones((hidden_dim, 1))  # åˆå§‹åŒ–ä¸º1ï¼Œä¿ƒè¿›è®°å¿†

        # è¾“å…¥é—¨å‚æ•°
        self.Wi = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bi = np.zeros((hidden_dim, 1))

        # å€™é€‰å€¼å‚æ•°
        self.Wc = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bc = np.zeros((hidden_dim, 1))

        # è¾“å‡ºé—¨å‚æ•°
        self.Wo = np.random.randn(hidden_dim, input_dim + hidden_dim) * scale
        self.bo = np.zeros((hidden_dim, 1))

    def forward(self, x_t, h_prev, c_prev):
        """LSTMå‰å‘ä¼ æ’­"""
        # æ‹¼æ¥è¾“å…¥ [h_{t-1}, x_t]
        concat = np.vstack([h_prev, x_t])

        # è®¡ç®—å››ä¸ªé—¨
        f_t = self.sigmoid(np.dot(self.Wf, concat) + self.bf)  # é—å¿˜é—¨
        i_t = self.sigmoid(np.dot(self.Wi, concat) + self.bi)  # è¾“å…¥é—¨
        c_tilde_t = np.tanh(np.dot(self.Wc, concat) + self.bc)  # å€™é€‰å€¼
        o_t = self.sigmoid(np.dot(self.Wo, concat) + self.bo)  # è¾“å‡ºé—¨

        # æ›´æ–°ç»†èƒçŠ¶æ€
        c_t = f_t * c_prev + i_t * c_tilde_t

        # è®¡ç®—éšè—çŠ¶æ€
        h_t = o_t * np.tanh(c_t)

        # ä¿å­˜ä¸­é—´ç»“æœç”¨äºåå‘ä¼ æ’­
        cache = {
            'x_t': x_t, 'h_prev': h_prev, 'c_prev': c_prev,
            'f_t': f_t, 'i_t': i_t, 'c_tilde_t': c_tilde_t, 'o_t': o_t,
            'c_t': c_t, 'concat': concat
        }

        return h_t, c_t, cache

    def backward(self, dh_next, dc_next, cache):
        """LSTMåå‘ä¼ æ’­"""
        # è§£åŒ…ç¼“å­˜
        x_t = cache['x_t']
        h_prev = cache['h_prev']
        c_prev = cache['c_prev']
        f_t = cache['f_t']
        i_t = cache['i_t']
        c_tilde_t = cache['c_tilde_t']
        o_t = cache['o_t']
        c_t = cache['c_t']
        concat = cache['concat']

        # è®¡ç®—å„ä¸ªé—¨çš„æ¢¯åº¦
        do_t = dh_next * np.tanh(c_t)
        dc_t = dc_next + dh_next * o_t * (1 - np.tanh(c_t)**2)

        df_t = dc_t * c_prev
        di_t = dc_t * c_tilde_t
        dc_tilde_t = dc_t * i_t
        dc_prev = dc_t * f_t

        # é€šè¿‡æ¿€æ´»å‡½æ•°çš„æ¢¯åº¦
        dzo_t = do_t * o_t * (1 - o_t)
        dzf_t = df_t * f_t * (1 - f_t)
        dzi_t = di_t * i_t * (1 - i_t)
        dzc_t = dc_tilde_t * (1 - c_tilde_t**2)

        # è®¡ç®—æƒé‡æ¢¯åº¦
        self.dWo = np.dot(dzo_t, concat.T)
        self.dbo = dzo_t

        self.dWf = np.dot(dzf_t, concat.T)
        self.dbf = dzf_t

        self.dWi = np.dot(dzi_t, concat.T)
        self.dbi = dzi_t

        self.dWc = np.dot(dzc_t, concat.T)
        self.dbc = dzc_t

        # è®¡ç®—è¾“å…¥æ¢¯åº¦
        dconcat = (np.dot(self.Wf.T, dzf_t) +
                   np.dot(self.Wi.T, dzi_t) +
                   np.dot(self.Wc.T, dzc_t) +
                   np.dot(self.Wo.T, dzo_t))

        dh_prev = dconcat[:h_prev.shape[0]]
        dx_t = dconcat[h_prev.shape[0]:]

        return dx_t, dh_prev, dc_prev

    @staticmethod
    def sigmoid(x):
        """æ•°å€¼ç¨³å®šçš„sigmoidå‡½æ•°"""
        return np.where(x >= 0,
                       1 / (1 + np.exp(-x)),
                       np.exp(x) / (1 + np.exp(x)))

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºLSTMå•å…ƒ
    lstm = LSTMCell(input_dim=100, hidden_dim=128)

    # æ¨¡æ‹Ÿè¾“å…¥
    x_t = np.random.randn(100, 1)
    h_prev = np.zeros((128, 1))
    c_prev = np.zeros((128, 1))

    # å‰å‘ä¼ æ’­
    h_t, c_t, cache = lstm.forward(x_t, h_prev, c_prev)

    print(f"éšè—çŠ¶æ€å½¢çŠ¶: {h_t.shape}")
    print(f"ç»†èƒçŠ¶æ€å½¢çŠ¶: {c_t.shape}")
    print(f"éšè—çŠ¶æ€èŒƒå›´: [{h_t.min():.3f}, {h_t.max():.3f}]")
    print(f"ç»†èƒçŠ¶æ€èŒƒå›´: [{c_t.min():.3f}, {c_t.max():.3f}]")</code></pre>
                </div>

                <div class="code-layer-content" data-layer-content="pytorch">
                    <pre><code class="language-python">import torch
import torch.nn as nn
import torch.nn.functional as F

class LSTMCell(nn.Module):
    """PyTorch LSTMå•å…ƒå®ç°"""

    def __init__(self, input_size, hidden_size):
        super(LSTMCell, self).__init__()
        self.input_size = input_size
        self.hidden_size = hidden_size

        # åˆå¹¶æ‰€æœ‰é—¨çš„æƒé‡ï¼Œæé«˜è®¡ç®—æ•ˆç‡
        self.weight_ih = nn.Linear(input_size, 4 * hidden_size)
        self.weight_hh = nn.Linear(hidden_size, 4 * hidden_size)

        # åˆå§‹åŒ–å‚æ•°
        self.reset_parameters()

    def reset_parameters(self):
        """å‚æ•°åˆå§‹åŒ–"""
        std = 1.0 / (self.hidden_size)**0.5
        for weight in self.parameters():
            weight.data.uniform_(-std, std)

        # é—å¿˜é—¨åç½®åˆå§‹åŒ–ä¸º1
        self.weight_ih.bias.data[0:self.hidden_size].fill_(1.0)

    def forward(self, input, hidden):
        """å‰å‘ä¼ æ’­"""
        hx, cx = hidden

        # è®¡ç®—æ‰€æœ‰é—¨
        gates = self.weight_ih(input) + self.weight_hh(hx)

        # åˆ†å‰²é—¨
        ingate, forgetgate, cellgate, outgate = gates.chunk(4, 1)

        # åº”ç”¨æ¿€æ´»å‡½æ•°
        ingate = torch.sigmoid(ingate)
        forgetgate = torch.sigmoid(forgetgate)
        cellgate = torch.tanh(cellgate)
        outgate = torch.sigmoid(outgate)

        # æ›´æ–°ç»†èƒçŠ¶æ€
        cy = forgetgate * cx + ingate * cellgate

        # è®¡ç®—éšè—çŠ¶æ€
        hy = outgate * torch.tanh(cy)

        return hy, cy

class LSTM(nn.Module):
    """å®Œæ•´çš„LSTMæ¨¡å‹"""

    def __init__(self, input_size, hidden_size, num_layers=1, dropout=0.0):
        super(LSTM, self).__init__()
        self.input_size = input_size
        self.hidden_size = hidden_size
        self.num_layers = num_layers

        # åˆ›å»ºLSTMå±‚
        self.lstm_layers = nn.ModuleList()
        for i in range(num_layers):
            layer_input_size = input_size if i == 0 else hidden_size
            self.lstm_layers.append(LSTMCell(layer_input_size, hidden_size))

        # Dropoutå±‚
        self.dropout = nn.Dropout(dropout) if dropout > 0 else None

    def forward(self, input, hidden=None):
        """å‰å‘ä¼ æ’­"""
        batch_size, seq_len, _ = input.size()

        # åˆå§‹åŒ–éšè—çŠ¶æ€
        if hidden is None:
            h_0 = torch.zeros(self.num_layers, batch_size, self.hidden_size, device=input.device)
            c_0 = torch.zeros(self.num_layers, batch_size, self.hidden_size, device=input.device)
            hidden = (h_0, c_0)

        h_n, c_n = hidden
        output = []

        # é€æ—¶é—´æ­¥å¤„ç†
        for t in range(seq_len):
            x_t = input[:, t, :]

            # é€å±‚å¤„ç†
            for layer in range(self.num_layers):
                h_t = h_n[layer]
                c_t = c_n[layer]

                # LSTMè®¡ç®—
                h_t, c_t = self.lstm_layers[layer](x_t, (h_t, c_t))

                # æ›´æ–°çŠ¶æ€
                h_n[layer] = h_t
                c_n[layer] = c_t

                # å‡†å¤‡ä¸‹ä¸€å±‚çš„è¾“å…¥
                x_t = h_t
                if self.dropout and layer < self.num_layers - 1:
                    x_t = self.dropout(x_t)

            output.append(h_t.unsqueeze(1))

        # åˆå¹¶è¾“å‡º
        output = torch.cat(output, dim=1)
        return output, (h_n, c_n)

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºæ¨¡å‹
    lstm = LSTM(input_size=100, hidden_size=256, num_layers=2, dropout=0.1)

    # æ¨¡æ‹Ÿè¾“å…¥
    x = torch.randn(32, 50, 100)  # (batch, seq_len, input_size)

    # å‰å‘ä¼ æ’­
    output, (h_n, c_n) = lstm(x)

    print(f"è¾“å…¥å½¢çŠ¶: {x.shape}")
    print(f"è¾“å‡ºå½¢çŠ¶: {output.shape}")
    print(f"æœ€ç»ˆéšè—çŠ¶æ€å½¢çŠ¶: {h_n.shape}")
    print(f"æœ€ç»ˆç»†èƒçŠ¶æ€å½¢çŠ¶: {c_n.shape}")

    # å‚æ•°ç»Ÿè®¡
    total_params = sum(p.numel() for p in lstm.parameters())
    print(f"æ€»å‚æ•°é‡: {total_params:,}")</code></pre>
                </div>

                <div class="code-layer-content" data-layer-content="tensorflow">
                    <pre><code class="language-python">import tensorflow as tf
import numpy as np

class LSTMCell(tf.keras.layers.Layer):
    """TensorFlow LSTMå•å…ƒå®ç°"""

    def __init__(self, units, **kwargs):
        super(LSTMCell, self).__init__(**kwargs)
        self.units = units
        self.state_size = [units, units]  # [h, c]

    def build(self, input_shape):
        input_dim = input_shape[-1]

        # åˆ›å»ºæƒé‡çŸ©é˜µ
        self.kernel = self.add_weight(
            shape=(input_dim, self.units * 4),
            name='kernel',
            initializer='glorot_uniform'
        )

        self.recurrent_kernel = self.add_weight(
            shape=(self.units, self.units * 4),
            name='recurrent_kernel',
            initializer='orthogonal'
        )

        # åç½®
        self.bias = self.add_weight(
            shape=(self.units * 4,),
            name='bias',
            initializer=self.bias_initializer
        )

    def bias_initializer(self, shape, dtype=None):
        """è‡ªå®šä¹‰åç½®åˆå§‹åŒ– - é—å¿˜é—¨åç½®ä¸º1"""
        bias = np.zeros(shape)
        bias[:self.units] = 1.0  # é—å¿˜é—¨
        return tf.constant(bias, dtype=dtype)

    def call(self, inputs, states):
        """å‰å‘ä¼ æ’­"""
        h_prev, c_prev = states

        # è®¡ç®—æ‰€æœ‰é—¨
        z = tf.matmul(inputs, self.kernel)
        z += tf.matmul(h_prev, self.recurrent_kernel)
        z = tf.nn.bias_add(z, self.bias)

        # åˆ†å‰²é—¨
        z0, z1, z2, z3 = tf.split(z, 4, axis=1)

        # åº”ç”¨æ¿€æ´»å‡½æ•°
        f = tf.nn.sigmoid(z0)  # é—å¿˜é—¨
        i = tf.nn.sigmoid(z1)  # è¾“å…¥é—¨
        c_tilde = tf.nn.tanh(z2)  # å€™é€‰å€¼
        o = tf.nn.sigmoid(z3)  # è¾“å‡ºé—¨

        # æ›´æ–°çŠ¶æ€
        c = f * c_prev + i * c_tilde
        h = o * tf.nn.tanh(c)

        return h, [h, c]

# ä½¿ç”¨Kerasé«˜çº§APIçš„LSTM
def create_lstm_model(input_shape, units, num_layers=1, dropout=0.0):
    """åˆ›å»ºLSTMæ¨¡å‹"""
    model = tf.keras.Sequential()

    # è¾“å…¥å±‚
    model.add(tf.keras.layers.Input(shape=input_shape))

    # LSTMå±‚
    for i in range(num_layers):
        return_sequences = True if i < num_layers - 1 else False

        model.add(tf.keras.layers.LSTM(
            units=units,
            return_sequences=return_sequences,
            dropout=dropout,
            recurrent_dropout=dropout
        ))

    return model

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºæ¨¡å‹
    model = create_lstm_model(
        input_shape=(50, 100),  # (seq_len, input_dim)
        units=256,
        num_layers=2,
        dropout=0.1
    )

    # æµ‹è¯•è¾“å…¥
    x = tf.random.normal((32, 50, 100))
    output = model(x)

    print(f"è¾“å…¥å½¢çŠ¶: {x.shape}")
    print(f"è¾“å‡ºå½¢çŠ¶: {output.shape}")

    # æ¨¡å‹æ‘˜è¦
    model.summary()</code></pre>
                </div>
            </div>
        </section>

        <!-- å®æ—¶æ¼”ç¤º -->
        <section id="visualization" class="section-card">
            <h2 style="color: var(--accent-green); margin-bottom: 2rem;">ğŸš€ å®æ—¶æƒ…æ„Ÿåˆ†ææ¼”ç¤º</h2>

            <div class="live-demo">
                <div class="live-demo-content">
                    <p style="margin-bottom: 1.5rem; font-size: 1.1rem;">
                        è¾“å…¥ä¸€å¥è¯ï¼Œå®æ—¶æŸ¥çœ‹LSTMå¦‚ä½•å¤„ç†å¹¶åˆ†ææƒ…æ„Ÿï¼ˆæ”¯æŒå®æ—¶é¢„æµ‹ä¸‹ä¸€ä¸ªå­—ï¼‰ï¼š
                    </p>

                    <div class="input-group">
                        <div style="position: relative; flex: 1;">
                            <input type="text"
                                   class="live-demo-input"
                                   id="sentimentInput"
                                   placeholder="ä¾‹å¦‚ï¼šè¿™ä¸ªäº§å“å¤ªæ£’äº†ï¼æˆ‘éå¸¸å–œæ¬¢ï¼"
                                   value="">
                            <div class="prediction-preview" id="predictionPreview"></div>
                        </div>

                        <button class="analyze-btn" id="analyzeBtn">
                            åˆ†ææƒ…æ„Ÿ âœ¨
                        </button>
                    </div>

                    <div class="live-demo-output">
                        <div class="demo-result-card">
                            <h4 style="color: var(--accent-pink); margin-bottom: 1rem;">ğŸ˜Š é¢„æµ‹ç»“æœ</h4>
                            <div id="predictionResult" style="text-align: center;">
                                <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ¤”</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: var(--text-secondary);">
                                    ç­‰å¾…è¾“å…¥...
                                </div>
                            </div>
                        </div>

                        <div class="demo-result-card">
                            <h4 style="color: var(--accent-blue); margin-bottom: 1rem;">ğŸšª é—¨æ¿€æ´»å€¼</h4>
                            <div id="gateActivations">
                                <canvas id="gateChart" width="400" height="250"></canvas>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 2rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">ğŸ“ˆ å¤„ç†è¿‡ç¨‹å¯è§†åŒ–</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                            <div>
                                <h5 style="color: var(--accent-pink); margin-bottom: 0.5rem;">ç»†èƒçŠ¶æ€å˜åŒ–</h5>
                                <canvas id="cellStateChart" width="300" height="200"></canvas>
                            </div>
                            <div>
                                <h5 style="color: var(--accent-green); margin-bottom: 0.5rem;">éšè—çŠ¶æ€çƒ­å›¾</h5>
                                <canvas id="hiddenStateChart" width="300" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- å®æˆ˜åº”ç”¨ -->
        <section id="practice" class="section-card">
            <h2 style="color: var(--accent-pink); margin-bottom: 2rem;">âš”ï¸ å®æˆ˜ï¼šç”¨LSTMç”ŸæˆéŸ³ä¹</h2>

            <div class="story-card">
                <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 2rem;">
                    è®©æˆ‘ä»¬ç”¨LSTMåˆ›å»ºä¸€ä¸ªéŸ³ä¹ç”Ÿæˆå™¨ï¼Œä½“éªŒé•¿æœŸè®°å¿†åœ¨åºåˆ—ç”Ÿæˆä¸­çš„å¨åŠ›ï¼
                </p>
            </div>

            <div class="practice-section">
                <h3 style="color: var(--accent-yellow); margin-bottom: 1.5rem;">ğŸµ æ™ºèƒ½éŸ³ä¹ç”Ÿæˆå™¨</h3>

                <!-- è™šæ‹Ÿé’¢ç´é”®ç›˜ -->
                <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 1rem; margin-bottom: 2rem;">
                    <h4 style="color: var(--accent-cyan); margin-bottom: 1rem;">ğŸ¹ è¾“å…¥ç§å­æ—‹å¾‹</h4>
                    <p style="margin-bottom: 1rem; color: var(--text-secondary);">ç‚¹å‡»é’¢ç´é”®è¾“å…¥ä¸€å°æ®µæ—‹å¾‹ï¼ŒLSTMå°†ç»­å†™ï¼š</p>

                    <div class="piano-keyboard" id="pianoKeyboard">
                        <!-- é’¢ç´é”®å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>

                    <div style="margin-top: 1rem; display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span>ç§å­æ—‹å¾‹ï¼š</span>
                            <div id="seedMelody" style="background: rgba(255, 255, 255, 0.1); padding: 0.5rem 1rem; border-radius: 0.5rem; min-width: 100px; font-family: monospace;">
                                []
                            </div>
                        </div>
                        <button class="btn btn-secondary" onclick="window.lstmTutorial.clearMelody()">ğŸ—‘ï¸ æ¸…ç©º</button>
                        <button class="btn btn-primary" onclick="window.lstmTutorial.generateFromSeed()">ğŸ¼ ç»­å†™æ—‹å¾‹</button>
                    </div>
                </div>

                <!-- é¢„è®¾æƒ…ç»ªæŒ‰é’® -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    <button class="btn btn-primary" onclick="window.lstmTutorial.generateMelody('happy')">
                        ğŸ˜Š ç”Ÿæˆæ¬¢å¿«æ—‹å¾‹
                    </button>
                    <button class="btn btn-primary" onclick="window.lstmTutorial.generateMelody('sad')">
                        ğŸ˜¢ ç”Ÿæˆå¿§ä¼¤æ—‹å¾‹
                    </button>
                    <button class="btn btn-primary" onclick="window.lstmTutorial.generateMelody('energetic')">
                        âš¡ ç”Ÿæˆæ¿€æ˜‚æ—‹å¾‹
                    </button>
                    <button class="btn btn-primary" onclick="window.lstmTutorial.generateMelody('calm')">
                        ğŸŒŠ ç”Ÿæˆå¹³é™æ—‹å¾‹
                    </button>
                </div>

                <div id="musicVisualizer" style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 1rem;">
                    <canvas id="musicCanvas" width="100%" height="300"></canvas>
                </div>

                <div style="margin-top: 2rem;">
                    <audio id="musicPlayer" controls style="width: 100%;"></audio>
                </div>
            </div>
        </section>

        <!-- ç»ƒä¹ ä¸æ€è€ƒ -->
        <section id="exercises" class="section-card">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">ğŸ“ ç»ƒä¹ ä¸æ€è€ƒ</h2>

            <div class="practice-section">
                <div class="practice-item">
                    <h3 style="color: var(--accent-blue); margin-bottom: 1rem;">
                        ç»ƒä¹ 1ï¼šæ‰‹åŠ¨è®¡ç®—LSTMå‰å‘ä¼ æ’­
                    </h3>
                    <p>ç»™å®šä»¥ä¸‹å‚æ•°ï¼Œæ‰‹åŠ¨è®¡ç®—ä¸€æ­¥LSTMçš„è¾“å‡ºï¼š</p>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 0.5rem; margin: 1rem 0;">
                        <code>
                            x_t = [0.5, -0.2], h_{t-1} = [0.3, 0.1], C_{t-1} = [0.8, -0.4]<br>
                            W_f = [[0.1, 0.2, -0.1, 0.3], [0.2, -0.1, 0.1, 0.2]], b_f = [0.5, 0.5]
                        </code>
                    </div>
                    <div class="practice-solution">
                        <h4 style="color: var(--accent-green); margin-bottom: 1rem;">è§£ç­”ï¼š</h4>
                        <div style="padding: 1rem; background: rgba(34, 197, 94, 0.1); border-radius: 0.5rem;">
                            <p><strong>æ­¥éª¤1ï¼š</strong>æ‹¼æ¥è¾“å…¥ [h_{t-1}, x_t] = [0.3, 0.1, 0.5, -0.2]</p>
                            <p><strong>æ­¥éª¤2ï¼š</strong>è®¡ç®—é—å¿˜é—¨</p>
                            <p>z_f = W_f Â· [0.3, 0.1, 0.5, -0.2]^T + [0.5, 0.5]^T</p>
                            <p>= [0.1Ã—0.3 + 0.2Ã—0.1 + (-0.1)Ã—0.5 + 0.3Ã—(-0.2), 0.2Ã—0.3 + (-0.1)Ã—0.1 + 0.1Ã—0.5 + 0.2Ã—(-0.2)] + [0.5, 0.5]</p>
                            <p>= [-0.04, 0.09] + [0.5, 0.5] = [0.46, 0.59]</p>
                            <p><strong>æ­¥éª¤3ï¼š</strong>åº”ç”¨sigmoidæ¿€æ´»</p>
                            <p>f_t = Ïƒ([0.46, 0.59]) = [0.613, 0.643]</p>
                        </div>
                    </div>
                </div>

                <div class="practice-item">
                    <h3 style="color: var(--accent-pink); margin-bottom: 1rem;">
                        ç»ƒä¹ 2ï¼šåˆ†ææ¢¯åº¦ä¼ æ’­
                    </h3>
                    <p>è¯æ˜ï¼šå½“é—å¿˜é—¨ f_t = 1 ä¸”è¾“å…¥é—¨ i_t = 0 æ—¶ï¼Œæ¢¯åº¦å¯ä»¥æ— æŸä¼ æ’­ã€‚</p>
                    <div class="practice-solution">
                        <h4 style="color: var(--accent-green); margin-bottom: 1rem;">è§£ç­”æ€è·¯ï¼š</h4>
                        <div style="padding: 1rem; background: rgba(34, 197, 94, 0.1); border-radius: 0.5rem;">
                            <p>å½“ f_t = 1, i_t = 0 æ—¶ï¼š</p>
                            <p>C_t = f_t âŠ™ C_{t-1} + i_t âŠ™ CÌƒ_t = 1 âŠ™ C_{t-1} + 0 âŠ™ CÌƒ_t = C_{t-1}</p>
                            <p>å› æ­¤ï¼šâˆ‚C_t/âˆ‚C_{t-1} = âˆ‚C_{t-1}/âˆ‚C_{t-1} = Iï¼ˆå•ä½çŸ©é˜µï¼‰</p>
                            <p>æ¢¯åº¦å®Œå…¨ä¿ç•™ï¼Œå®ç°æ— æŸä¼ æ’­ï¼</p>
                        </div>
                    </div>
                </div>

                <div class="practice-item">
                    <h3 style="color: var(--accent-orange); margin-bottom: 1rem;">
                        ç»ƒä¹ 3ï¼šé—¨çš„ç›¸å…³æ€§åˆ†æ
                    </h3>
                    <p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé—å¿˜é—¨å’Œè¾“å…¥é—¨å¾€å¾€å‘ˆç°è´Ÿç›¸å…³ã€‚è§£é‡Šè¿™ç§ç°è±¡çš„åŸå› ã€‚</p>
                    <div class="practice-solution">
                        <h4 style="color: var(--accent-green); margin-bottom: 1rem;">è§£ç­”ï¼š</h4>
                        <div style="padding: 1rem; background: rgba(34, 197, 94, 0.1); border-radius: 0.5rem;">
                            <p><strong>ç›´è§‚è§£é‡Šï¼š</strong>ç»†èƒçŠ¶æ€çš„"å®¹é‡"æœ‰é™ã€‚å½“éœ€è¦å­˜å‚¨æ–°ä¿¡æ¯æ—¶ï¼Œé€šå¸¸éœ€è¦å…ˆé—å¿˜ä¸€äº›æ—§ä¿¡æ¯è…¾å‡ºç©ºé—´ã€‚</p>
                            <p><strong>æ•°å­¦è§’åº¦ï¼š</strong>ä¸ºäº†ä¿æŒC_tçš„æ•°å€¼ç¨³å®šï¼Œf_t + i_t â‰ˆ 1 æ˜¯ä¸€ä¸ªåˆç†çš„çº¦æŸã€‚</p>
                            <p><strong>å®é™…æ„ä¹‰ï¼š</strong>è¿™ä½“ç°äº†LSTMçš„"é€‰æ‹©æ€§æ›´æ–°"ç‰¹æ€§â€”â€”æœ‰é€‰æ‹©åœ°é—å¿˜å’Œè®°å¿†ã€‚</p>
                        </div>
                    </div>
                </div>

                <div class="practice-item">
                    <h3 style="color: var(--accent-cyan); margin-bottom: 1rem;">
                        ç»ƒä¹ 4ï¼šLSTMå˜ç§è®¾è®¡
                    </h3>
                    <p>è®¾è®¡ä¸€ä¸ªä»‹äºLSTMå’ŒGRUä¹‹é—´çš„æ¨¡å‹ï¼Œåªä½¿ç”¨ä¸¤ä¸ªé—¨ä½†ä¿ç•™ç‹¬ç«‹çš„ç»†èƒçŠ¶æ€ã€‚</p>
                    <div class="practice-solution">
                        <h4 style="color: var(--accent-green); margin-bottom: 1rem;">è®¾è®¡æ€è·¯ï¼š</h4>
                        <div style="padding: 1rem; background: rgba(34, 197, 94, 0.1); border-radius: 0.5rem;">
                            <p><strong>ç®€åŒ–æ–¹æ¡ˆï¼š</strong>åˆå¹¶é—å¿˜é—¨å’Œè¾“å…¥é—¨ä¸º"æ›´æ–°é—¨"z_t</p>
                            <p>f_t = z_t, i_t = 1 - z_t</p>
                            <p>C_t = z_t âŠ™ C_{t-1} + (1-z_t) âŠ™ CÌƒ_t</p>
                            <p>h_t = o_t âŠ™ tanh(C_t)</p>
                            <p><strong>ä¼˜åŠ¿ï¼š</strong>å‚æ•°å‡å°‘25%ï¼Œè®¡ç®—æ›´é«˜æ•ˆï¼ŒåŒæ—¶ä¿ç•™ç»†èƒçŠ¶æ€çš„æ¢¯åº¦é«˜é€Ÿè·¯ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="think-card" style="margin-top: 2rem;">
                <h3>ğŸ¤” æ·±åº¦æ€è€ƒé¢˜</h3>
                <ol style="margin-left: 1.5rem; line-height: 2;">
                    <li><strong>åº”ç”¨åœºæ™¯ï¼š</strong>ä¸ºä»€ä¹ˆLSTMåœ¨å¤„ç†æ–‡æœ¬æ—¶é€šå¸¸æ¯”å¤„ç†å›¾åƒæ›´æœ‰æ•ˆï¼Ÿ</li>
                    <li><strong>è®¤çŸ¥å¯¹æ¯”ï¼š</strong>å¦‚ä½•è§£é‡ŠLSTMä¸­çš„"è®°å¿†"ä¸äººç±»è®°å¿†çš„ç›¸ä¼¼æ€§å’Œå·®å¼‚ï¼Ÿ</li>
                    <li><strong>æ¨¡å‹é€‰æ‹©ï¼š</strong>åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œç®€å•çš„RNNå¯èƒ½æ¯”LSTMè¡¨ç°æ›´å¥½ï¼Ÿ</li>
                    <li><strong>æ¶æ„ä¼˜åŒ–ï¼š</strong>LSTMçš„å“ªäº›è®¾è®¡å¯ä»¥è¢«è¿›ä¸€æ­¥ç®€åŒ–è€Œä¸æ˜¾è‘—å½±å“æ€§èƒ½ï¼Ÿ</li>
                    <li><strong>æœªæ¥å‘å±•ï¼š</strong>éšç€Transformerçš„å…´èµ·ï¼ŒLSTMè¿˜æœ‰å“ªäº›ç‹¬ç‰¹ä¼˜åŠ¿ï¼Ÿ</li>
                </ol>
            </div>
        </section>

        <!-- æ€»ç»“ä¸å±•æœ› -->
        <section id="summary" class="section-card">
            <h2 style="color: var(--accent-purple); margin-bottom: 2rem;">ğŸ¯ æœ¬ç« æ€»ç»“ï¼šLSTMçš„ç²¾å¦™è®¾è®¡</h2>

            <div class="concept-grid">
                <div class="concept-card forget">
                    <h3 style="color: var(--accent-pink); margin-bottom: 1rem;">ğŸ¯ æ ¸å¿ƒåˆ›æ–°</h3>
                    <ul style="margin-left: 1.5rem;">
                        <li>ç»†èƒçŠ¶æ€ï¼šçº¿æ€§ä¿¡æ¯é«˜é€Ÿå…¬è·¯</li>
                        <li>é—¨æ§æœºåˆ¶ï¼šç²¾ç¡®çš„ä¿¡æ¯æµæ§åˆ¶</li>
                        <li>æ¢¯åº¦é«˜é€Ÿè·¯ï¼šè§£å†³é•¿æœŸä¾èµ–</li>
                        <li>æ¨¡å—åŒ–è®¾è®¡ï¼šæ¸…æ™°çš„æ•°å­¦ç»“æ„</li>
                    </ul>
                </div>

                <div class="concept-card input">
                    <h3 style="color: var(--accent-blue); margin-bottom: 1rem;">ğŸ’¡ è®¾è®¡æ™ºæ…§</h3>
                    <ul style="margin-left: 1.5rem;">
                        <li>é—å¿˜é—¨ï¼šé€‰æ‹©æ€§é—å¿˜</li>
                        <li>è¾“å…¥é—¨ï¼šé€‰æ‹©æ€§è®°å¿†</li>
                        <li>è¾“å‡ºé—¨ï¼šæŒ‰éœ€æå–</li>
                        <li>çº¿æ€§è·¯å¾„ï¼šæ¢¯åº¦ä¿æŠ¤</li>
                    </ul>
                </div>

                <div class="concept-card output">
                    <h3 style="color: var(--accent-green); margin-bottom: 1rem;">ğŸš€ åº”ç”¨é¢†åŸŸ</h3>
                    <ul style="margin-left: 1.5rem;">
                        <li>è‡ªç„¶è¯­è¨€å¤„ç†</li>
                        <li>è¯­éŸ³è¯†åˆ«</li>
                        <li>æ—¶åºé¢„æµ‹</li>
                        <li>éŸ³ä¹ç”Ÿæˆ</li>
                    </ul>
                </div>

                <div class="concept-card cell">
                    <h3 style="color: var(--accent-orange); margin-bottom: 1rem;">âš ï¸ å±€é™æ€§</h3>
                    <ul style="margin-left: 1.5rem;">
                        <li>è®¡ç®—å¤æ‚åº¦é«˜</li>
                        <li>éš¾ä»¥å¹¶è¡ŒåŒ–</li>
                        <li>å‚æ•°é‡å¤§</li>
                        <li>è®­ç»ƒæ—¶é—´é•¿</li>
                    </ul>
                </div>
            </div>

            <div class="timeline" style="margin-top: 3rem;">
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-pink);">è¿‡å»ï¼šRNNæ—¶ä»£</h4>
                    <p>ç®€å•ä½†æ¢¯åº¦æ¶ˆå¤±ä¸¥é‡</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-blue);">ç°åœ¨ï¼šLSTMä¸»å¯¼</h4>
                    <p>è§£å†³é•¿æœŸä¾èµ–ï¼Œå¹¿æ³›åº”ç”¨</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-green);">æœªæ¥ï¼šTransformerå´›èµ·</h4>
                    <p>å¹¶è¡Œè®¡ç®—ï¼Œè‡ªæ³¨æ„åŠ›æœºåˆ¶</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h4 style="color: var(--accent-orange);">å±•æœ›ï¼šæ··åˆæ¶æ„</h4>
                    <p>LSTM + Attention ä¼˜åŠ¿äº’è¡¥</p>
                </div>
            </div>

            <div class="tip success" style="margin-top: 3rem;">
                <span style="font-size: 2rem;">ğŸ“</span>
                <div>
                    <h3 style="margin-bottom: 1rem;">å­¦ä¹ LSTMçš„æ”¶è·</h3>
                    <p style="font-size: 1.1rem; line-height: 1.8;">
                        é€šè¿‡æœ¬ç« çš„æ·±åº¦å­¦ä¹ ï¼Œä½ å·²ç»æŒæ¡äº†ï¼š<br>
                        â€¢ LSTMå¦‚ä½•é€šè¿‡å·§å¦™çš„é—¨æ§æœºåˆ¶è§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜<br>
                        â€¢ ç»†èƒçŠ¶æ€ä½œä¸ºä¿¡æ¯é«˜é€Ÿå…¬è·¯çš„è®¾è®¡æ™ºæ…§<br>
                        â€¢ ä»é›¶å®ç°LSTMçš„å®Œæ•´ä»£ç å’Œæ•°å­¦æ¨å¯¼<br>
                        â€¢ LSTMä¸GRUçš„è¯¦ç»†å¯¹æ¯”å’Œé€‰æ‹©ç­–ç•¥<br>
                        â€¢ åœ¨å®é™…åº”ç”¨ä¸­çš„ä¼˜åŒ–æŠ€å·§å’Œæœ€ä½³å®è·µ
                    </p>
                    <p style="margin-top: 1rem; font-size: 1.2rem; color: var(--accent-cyan);">
                        <strong>ä¸‹ä¸€æ­¥ï¼š</strong>å­¦ä¹ Transformerå’Œè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œäº†è§£åºåˆ—å»ºæ¨¡çš„æœ€æ–°çªç ´ï¼
                    </p>
                </div>
            </div>
        </section>

        <!-- å‚è€ƒèµ„æº -->
        <section class="section-card" style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(59, 130, 246, 0.05));">
            <h2 style="color: var(--accent-cyan); margin-bottom: 2rem;">ğŸ“š å»¶ä¼¸é˜…è¯»ä¸èµ„æº</h2>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 1rem;">
                    <h3 style="color: var(--accent-blue); margin-bottom: 1rem;">ğŸ“„ ç»å…¸è®ºæ–‡</h3>
                    <ul style="line-height: 2;">
                        <li><strong>Hochreiter & Schmidhuber (1997)</strong> - Long Short-Term Memory</li>
                        <li><strong>Gers et al. (2000)</strong> - Learning to Forget: Continual Prediction with LSTM</li>
                        <li><strong>Graves (2013)</strong> - Generating Sequences with RNNs</li>
                        <li><strong>Cho et al. (2014)</strong> - Learning Phrase Representations using RNN Encoder-Decoder for Statistical Machine Translation (GRU)</li>
                    </ul>
                </div>

                <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 1rem;">
                    <h3 style="color: var(--accent-green); margin-bottom: 1rem;">ğŸ¥ æ¨èæ•™ç¨‹</h3>
                    <ul style="line-height: 2;">
                        <li><strong>Christopher Olah</strong> - Understanding LSTM Networks</li>
                        <li><strong>Andrej Karpathy</strong> - The Unreasonable Effectiveness of RNNs</li>
                        <li><strong>Fast.ai</strong> - Practical Deep Learning Course</li>
                        <li><strong>DeepLearning.ai</strong> - Sequence Models Course</li>
                    </ul>
                </div>

                <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 1rem;">
                    <h3 style="color: var(--accent-orange); margin-bottom: 1rem;">ğŸ’» ä»£ç èµ„æº</h3>
                    <ul style="line-height: 2;">
                        <li><strong>PyTorch</strong> - LSTM Tutorial & Examples</li>
                        <li><strong>TensorFlow</strong> - RNN Guide & Best Practices</li>
                        <li><strong>Keras</strong> - Sequential Models Documentation</li>
                        <li><strong>GitHub</strong> - LSTM Implementation Gallery</li>
                    </ul>
                </div>

                <div style="background: rgba(255, 255, 255, 0.05); padding: 2rem; border-radius: 1rem;">
                    <h3 style="color: var(--accent-purple); margin-bottom: 1rem;">ğŸ”¬ è¿›é˜¶ä¸»é¢˜</h3>
                    <ul style="line-height: 2;">
                        <li><strong>Attention Mechanisms</strong> - æ³¨æ„åŠ›æœºåˆ¶</li>
                        <li><strong>Transformer Architecture</strong> - è‡ªæ³¨æ„åŠ›æ¨¡å‹</li>
                        <li><strong>BERT & GPT</strong> - é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹</li>
                        <li><strong>Neural Architecture Search</strong> - è‡ªåŠ¨åŒ–æ¶æ„è®¾è®¡</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- ç»“è¯­ -->
        <section class="section-card" style="background: var(--lstm-gradient); color: #0f172a; margin-bottom: 0;">
            <div style="text-align: center; padding: 2rem;">
                <h2 style="font-size: 3rem; margin-bottom: 1.5rem;">ğŸŠ æ­å–œå®Œæˆæœ¬ç« å­¦ä¹ ï¼</h2>
                <p style="font-size: 1.3rem; margin-bottom: 2rem; line-height: 1.8;">
                    ä½ å·²ç»æ·±åº¦æŒæ¡äº†LSTMçš„ç²¾é«“ â€”â€” é€šè¿‡ç²¾å¦™çš„é—¨æ§è®¾è®¡è®©ç¥ç»ç½‘ç»œå­¦ä¼šé€‰æ‹©æ€§çš„é—å¿˜ä¸è®°å¿†ã€‚<br>
                    è¿™ä¸ä»…æ˜¯æ·±åº¦å­¦ä¹ å†å²ä¸Šçš„é‡è¦é‡Œç¨‹ç¢‘ï¼Œæ›´æ˜¯é€šå‘ç°ä»£AIçš„å…³é”®åŸºçŸ³ã€‚<br>
                    <strong>ä»RNNçš„å›°å¢ƒåˆ°LSTMçš„çªç ´ï¼Œä½ è§è¯äº†AIå¦‚ä½•å­¦ä¼š"è®°å¿†"ï¼</strong>
                </p>
                <div style="display: flex; justify-content: center; gap: 2rem; flex-wrap: wrap;">
                    <a href="#" class="btn" style="background: white; color: #0f172a; padding: 1rem 2rem; font-size: 1.1rem; text-decoration: none;">
                        â¬…ï¸ ä¸Šä¸€ç« ï¼šRNNåŸºç¡€
                    </a>
                    <a href="#" class="btn" style="background: #0f172a; color: white; padding: 1rem 2rem; font-size: 1.1rem; text-decoration: none;">
                        ä¸‹ä¸€ç« ï¼šæ³¨æ„åŠ›æœºåˆ¶ â¡ï¸
                    </a>
                </div>
            </div>
        </section>

    </div>
</main>

<!-- é¡µè„š -->
<footer style="background: var(--bg-section); padding: 3rem 0; border-top: 1px solid var(--border-color);">
    <div class="container">
        <div style="text-align: center; color: var(--text-secondary);">
            <p style="margin-bottom: 1rem; font-size: 1.1rem;">
                ğŸ“– æ·±åº¦å­¦ä¹ åºåˆ—å»ºæ¨¡ | ç¬¬8ç« ï¼šé•¿çŸ­æœŸè®°å¿†ç½‘ç»œLSTM
            </p>
            <p style="margin-bottom: 1rem;">
                ç”¨â¤ï¸åˆ¶ä½œ | è®©AIçŸ¥è¯†è§¦æ‰‹å¯åŠ |
                <span style="color: var(--accent-cyan);">äº¤äº’å¼å­¦ä¹ ï¼Œæ·±åº¦ç†è§£</span>
            </p>
            <p style="font-size: 0.9rem; color: var(--text-muted);">
                Â© 2024 Deep Learning Tutorial Series. æ•™è‚²ç›®çš„ä½¿ç”¨ã€‚
            </p>
        </div>
    </div>
</footer>

<!-- JavaScriptæ¨¡å—åŒ–å°è£… -->
<script>
    (function() {
        'use strict';

        // ===== å…¨å±€æ¨¡å—å¯¹è±¡ =====
        window.lstmTutorial = {
            // çŠ¶æ€ç®¡ç†
            state: {
                currentStep: 0,
                totalSteps: 4,
                animationsEnabled: true,
                seedMelody: [],
                currentInputText: '',
                savedUserInput: localStorage.getItem('lstm-tutorial-input') || 'è¿™ä¸ªäº§å“å¤ªæ£’äº†ï¼æˆ‘éå¸¸å–œæ¬¢ï¼'
            },

            // ===== åˆå§‹åŒ–å‡½æ•° =====
            init: function() {
                this.setupEventListeners();
                this.createBackgroundAnimation();
                this.initializeComponents();
                this.restoreUserState();
                console.log('ğŸ§  LSTMäº¤äº’å¼æ•™ç¨‹å·²åŠ è½½å®Œæˆï¼');
            },

            // ===== äº‹ä»¶ç›‘å¬å™¨è®¾ç½® =====
            setupEventListeners: function() {
                // å¯¼èˆªç›¸å…³
                const toggleSidebar = document.getElementById('toggle-sidebar');
                const sidebar = document.getElementById('sidebar');

                if (toggleSidebar && sidebar) {
                    toggleSidebar.addEventListener('click', () => {
                        sidebar.classList.toggle('open');
                    });
                }

                // æ»šåŠ¨ç›¸å…³
                this.setupScrollHandlers();

                // äº¤äº’å¼å…ƒç´ 
                this.setupInteractiveElements();

                // æ­¥è¿›åŠ¨ç”»æ§åˆ¶
                this.setupStepAnimation();

                // ä»£ç å±‚åˆ‡æ¢
                this.setupCodeLayerTabs();

                // æ€è€ƒé¢˜äº¤äº’
                this.setupThinkingQuestions();

                // å®æ—¶æ¼”ç¤º
                this.setupLiveDemo();

                // é’¢ç´é”®ç›˜
                this.setupPianoKeyboard();

                // ä¸»é¢˜å’ŒåŠ¨ç”»åˆ‡æ¢
                this.setupThemeControls();
            },

            // ===== æ»šåŠ¨å¤„ç† =====
            setupScrollHandlers: function() {
                const navHeader = document.querySelector('.nav-header');
                let lastScrollTop = 0;

                window.addEventListener('scroll', () => {
                    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

                    // è‡ªåŠ¨éšè—å¯¼èˆªæ 
                    if (scrollTop > lastScrollTop && scrollTop > 100) {
                        navHeader?.classList.add('hidden');
                    } else {
                        navHeader?.classList.remove('hidden');
                    }
                    lastScrollTop = scrollTop;

                    // æ›´æ–°è¿›åº¦æ¡
                    this.updateProgressBar();

                    // æ›´æ–°ä¾§è¾¹æ é«˜äº®
                    this.updateSidebarHighlight();
                });
            },

            // ===== è¿›åº¦æ¡æ›´æ–° =====
            updateProgressBar: function() {
                const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
                const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                const scrolled = (winScroll / height) * 100;
                const progressBar = document.getElementById('progress-bar');
                if (progressBar) {
                    progressBar.style.width = scrolled + '%';
                }
            },

            // ===== ä¾§è¾¹æ é«˜äº®æ›´æ–° =====
            updateSidebarHighlight: function() {
                const sections = document.querySelectorAll('section[id]');
                const tocItems = document.querySelectorAll('.toc-item');
                let current = '';

                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 200) {
                        current = section.getAttribute('id');
                    }
                });

                tocItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('href') === `#${current}`) {
                        item.classList.add('active');
                    }
                });
            },

            // ===== äº¤äº’å¼å…ƒç´ è®¾ç½® =====
            setupInteractiveElements: function() {
                // å…¬å¼é«˜äº®äº¤äº’
                document.querySelectorAll('.highlight-target').forEach(elem => {
                    elem.addEventListener('mouseenter', () => {
                        const symbol = elem.getAttribute('data-symbol');
                        this.highlightSymbol(symbol, true);
                    });

                    elem.addEventListener('mouseleave', () => {
                        const symbol = elem.getAttribute('data-symbol');
                        this.highlightSymbol(symbol, false);
                    });

                    // æ·»åŠ ç‚¹å‡»åŠŸèƒ½ï¼Œæ˜¾ç¤ºè¯¦ç»†è§£é‡Š
                    elem.addEventListener('click', () => {
                        const symbol = elem.getAttribute('data-symbol');
                        this.showSymbolDetails(symbol);
                    });
                });

                // ç»ƒä¹ é¢˜å±•å¼€
                document.querySelectorAll('.practice-item').forEach(item => {
                    item.addEventListener('click', function() {
                        this.classList.toggle('open');
                    });
                });

                // æŠ˜å æ§åˆ¶
                document.querySelectorAll('.collapsible-header').forEach(header => {
                    header.addEventListener('click', function() {
                        const collapsible = this.closest('.collapsible');
                        collapsible.classList.toggle('open');
                    });
                });
            },

            // ===== ç¬¦å·é«˜äº® =====
            highlightSymbol: function(symbol, highlight) {
                // é«˜äº®æ‰€æœ‰ç›¸å…³å…ƒç´ 
                document.querySelectorAll(`[data-symbol="${symbol}"]`).forEach(elem => {
                    if (highlight) {
                        elem.classList.add('highlight-active');
                    } else {
                        elem.classList.remove('highlight-active');
                    }
                });

                // é«˜äº®å¯¹åº”çš„å«ä¹‰é¡¹
                document.querySelectorAll('.meaning-item').forEach(item => {
                    const strongText = item.querySelector('strong')?.textContent || '';
                    if (strongText.includes(symbol.replace('_', ''))) {
                        if (highlight) {
                            item.style.background = 'rgba(79, 172, 254, 0.2)';
                            item.style.borderColor = 'var(--accent-blue)';
                        } else {
                            item.style.background = '';
                            item.style.borderColor = 'transparent';
                        }
                    }
                });

                // å®æ—¶è”åŠ¨ï¼šåœ¨å…¬å¼æ¼”ç¤ºåŒºåŸŸæ·»åŠ é«˜äº®
                if (highlight) {
                    this.triggerLiveHighlight(symbol);
                }
            },

            // ===== å®æ—¶è”åŠ¨é«˜äº® =====
            triggerLiveHighlight: function(symbol) {
                const forgetGateExplainer = document.getElementById('forgetGateExplainer');
                if (forgetGateExplainer) {
                    const targetElement = forgetGateExplainer.querySelector(`[data-symbol="${symbol}"]`);
                    if (targetElement) {
                        targetElement.classList.add('live-highlight');
                        setTimeout(() => {
                            targetElement.classList.remove('live-highlight');
                        }, 1000);
                    }
                }
            },

            // ===== ç¬¦å·è¯¦ç»†ä¿¡æ¯ =====
            showSymbolDetails: function(symbol) {
                const details = {
                    'f_t': {
                        title: 'é—å¿˜é—¨ f_t',
                        description: 'é—å¿˜é—¨å†³å®šä»ç»†èƒçŠ¶æ€ä¸­ä¸¢å¼ƒå“ªäº›ä¿¡æ¯ã€‚å®ƒçš„è¾“å‡ºåœ¨[0,1]ä¹‹é—´ï¼Œ0è¡¨ç¤ºå®Œå…¨é—å¿˜ï¼Œ1è¡¨ç¤ºå®Œå…¨ä¿ç•™ã€‚',
                        formula: 'f_t = Ïƒ(W_f Â· [h_{t-1}, x_t] + b_f)'
                    },
                    'i_t': {
                        title: 'è¾“å…¥é—¨ i_t',
                        description: 'è¾“å…¥é—¨å†³å®šæ–°ä¿¡æ¯çš„é‡è¦æ€§æƒé‡ã€‚é…åˆå€™é€‰å€¼CÌƒ_tï¼Œå…±åŒå†³å®šéœ€è¦å­˜å‚¨çš„æ–°ä¿¡æ¯ã€‚',
                        formula: 'i_t = Ïƒ(W_i Â· [h_{t-1}, x_t] + b_i)'
                    },
                    'o_t': {
                        title: 'è¾“å‡ºé—¨ o_t',
                        description: 'è¾“å‡ºé—¨æ§åˆ¶åŸºäºç»†èƒçŠ¶æ€è¾“å‡ºä»€ä¹ˆä¿¡æ¯ç»™éšè—çŠ¶æ€ã€‚',
                        formula: 'o_t = Ïƒ(W_o Â· [h_{t-1}, x_t] + b_o)'
                    },
                    'sigma': {
                        title: 'Sigmoidå‡½æ•° Ïƒ',
                        description: 'Sigmoidå‡½æ•°å°†ä»»æ„å®æ•°æ˜ å°„åˆ°[0,1]åŒºé—´ï¼Œåœ¨LSTMä¸­ç”¨ä½œ"é—¨"ï¼Œæ§åˆ¶ä¿¡æ¯é€šè¿‡çš„æ¯”ä¾‹ã€‚',
                        formula: 'Ïƒ(x) = 1/(1 + e^(-x))'
                    }
                };

                const detail = details[symbol];
                if (detail) {
                    // åˆ›å»ºå¼¹çª—æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
                    this.showModal(detail);
                }
            },

            // ===== æ¨¡æ€æ¡†æ˜¾ç¤º =====
            showModal: function(content) {
                // ç§»é™¤å·²å­˜åœ¨çš„æ¨¡æ€æ¡†
                const existingModal = document.querySelector('.symbol-modal');
                if (existingModal) {
                    existingModal.remove();
                }

                // åˆ›å»ºæ–°çš„æ¨¡æ€æ¡†
                const modal = document.createElement('div');
                modal.className = 'symbol-modal';
                modal.innerHTML = `
                <div class="modal-overlay" onclick="this.parentElement.remove()">
                    <div class="modal-content" onclick="event.stopPropagation()">
                        <div class="modal-header">
                            <h3>${content.title}</h3>
                            <button class="modal-close" onclick="this.closest('.symbol-modal').remove()">Ã—</button>
                        </div>
                        <div class="modal-body">
                            <p>${content.description}</p>
                            <div class="modal-formula">
                                <code>${content.formula}</code>
                            </div>
                        </div>
                    </div>
                </div>
            `;

                // æ·»åŠ æ ·å¼
                const style = document.createElement('style');
                style.textContent = `
                .symbol-modal {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    z-index: 10000;
                }
                .modal-overlay {
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 2rem;
                }
                .modal-content {
                    background: var(--bg-section);
                    border-radius: 1rem;
                    max-width: 500px;
                    width: 100%;
                    border: 1px solid var(--border-color);
                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
                    animation: modalAppear 0.3s ease;
                }
                @keyframes modalAppear {
                    from { opacity: 0; transform: scale(0.9); }
                    to { opacity: 1; transform: scale(1); }
                }
                .modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 1.5rem;
                    border-bottom: 1px solid var(--border-color);
                }
                .modal-header h3 {
                    color: var(--accent-cyan);
                    margin: 0;
                }
                .modal-close {
                    background: none;
                    border: none;
                    color: var(--text-secondary);
                    font-size: 1.5rem;
                    cursor: pointer;
                    padding: 0.5rem;
                    border-radius: 0.25rem;
                    transition: all 0.3s ease;
                }
                .modal-close:hover {
                    background: rgba(255, 255, 255, 0.1);
                    color: var(--text-primary);
                }
                .modal-body {
                    padding: 1.5rem;
                }
                .modal-body p {
                    line-height: 1.6;
                    margin-bottom: 1rem;
                }
                .modal-formula {
                    background: rgba(255, 255, 255, 0.05);
                    padding: 1rem;
                    border-radius: 0.5rem;
                    border-left: 4px solid var(--accent-cyan);
                }
                .modal-formula code {
                    font-size: 1.1rem;
                    color: var(--accent-cyan);
                }
            `;
                document.head.appendChild(style);

                document.body.appendChild(modal);
            },

            // ===== æ­¥è¿›åŠ¨ç”»è®¾ç½® =====
            setupStepAnimation: function() {
                // æ­¥éª¤ç‚¹å‡»
                document.querySelectorAll('.step-dot').forEach(dot => {
                    dot.addEventListener('click', () => {
                        this.state.currentStep = parseInt(dot.getAttribute('data-step'));
                        this.updateStep();
                    });
                });

                // å¯¼èˆªæŒ‰é’®
                const prevBtn = document.getElementById('prevStep');
                const nextBtn = document.getElementById('nextStep');

                if (prevBtn) {
                    prevBtn.addEventListener('click', () => {
                        if (this.state.currentStep > 0) {
                            this.state.currentStep--;
                            this.updateStep();
                        }
                    });
                }

                if (nextBtn) {
                    nextBtn.addEventListener('click', () => {
                        if (this.state.currentStep < this.state.totalSteps - 1) {
                            this.state.currentStep++;
                            this.updateStep();
                        }
                    });
                }
            },

            // ===== æ­¥éª¤æ›´æ–° =====
            updateStep: function() {
                // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
                document.querySelectorAll('.step-dot').forEach((dot, index) => {
                    dot.classList.toggle('active', index === this.state.currentStep);
                });

                // æ›´æ–°æ­¥éª¤å†…å®¹
                document.querySelectorAll('.step-visual').forEach((visual, index) => {
                    visual.classList.toggle('active', index === this.state.currentStep);
                });

                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                const prevBtn = document.getElementById('prevStep');
                const nextBtn = document.getElementById('nextStep');

                if (prevBtn) prevBtn.disabled = this.state.currentStep === 0;
                if (nextBtn) nextBtn.disabled = this.state.currentStep === this.state.totalSteps - 1;
            },

            // ===== ä»£ç å±‚åˆ‡æ¢è®¾ç½® =====
            setupCodeLayerTabs: function() {
                document.querySelectorAll('.code-layer-tab').forEach(tab => {
                    tab.addEventListener('click', function() {
                        const layer = this.getAttribute('data-layer');

                        // æ›´æ–°æ ‡ç­¾çŠ¶æ€
                        document.querySelectorAll('.code-layer-tab').forEach(t => t.classList.remove('active'));
                        this.classList.add('active');

                        // æ›´æ–°å†…å®¹æ˜¾ç¤º
                        document.querySelectorAll('.code-layer-content').forEach(content => {
                            if (content.getAttribute('data-layer-content') === layer) {
                                content.classList.add('active');
                            } else {
                                content.classList.remove('active');
                            }
                        });
                    });
                });
            },

            // ===== æ€è€ƒé¢˜äº¤äº’è®¾ç½® =====
            setupThinkingQuestions: function() {
                document.querySelectorAll('.think-option').forEach(option => {
                    option.addEventListener('click', function() {
                        const answer = this.getAttribute('data-answer');
                        const thinkCard = this.closest('.think-card');
                        const feedbackId = thinkCard.querySelector('.think-feedback').id;

                        // ç§»é™¤å…¶ä»–é€‰é¡¹çš„é€‰ä¸­çŠ¶æ€
                        this.parentElement.querySelectorAll('.think-option').forEach(opt => {
                            opt.classList.remove('selected');
                        });

                        // æ·»åŠ é€‰ä¸­çŠ¶æ€
                        this.classList.add('selected');

                        // æ˜¾ç¤ºåé¦ˆ
                        window.lstmTutorial.showThinkFeedback(feedbackId, answer);
                    });
                });
            },

            // ===== æ€è€ƒé¢˜åé¦ˆ =====
            showThinkFeedback: function(feedbackId, answer) {
                const feedbackElement = document.getElementById(feedbackId);
                const feedbacks = {
                    'thinkFeedback1': {
                        'a': { correct: false, text: 'é€Ÿåº¦ç¡®å®æ˜¯ä¸ªé—®é¢˜ï¼Œä½†ä¸æ˜¯RNNå¤±è´¥çš„ä¸»è¦åŸå› ã€‚RNNçš„è®¡ç®—è™½ç„¶ä¸èƒ½å¹¶è¡ŒåŒ–ï¼Œä½†è¿™ä¸æ˜¯å¯¼è‡´é•¿åºåˆ—å»ºæ¨¡å¤±è´¥çš„æ ¹æœ¬åŸå› ã€‚' },
                        'b': { correct: true, text: 'ğŸ¯ å®Œå…¨æ­£ç¡®ï¼æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸æ˜¯RNNå¤„ç†é•¿åºåˆ—å¤±è´¥çš„æ ¹æœ¬åŸå› ã€‚å½“åºåˆ—å¾ˆé•¿æ—¶ï¼Œæ¢¯åº¦ä¼šæŒ‡æ•°çº§è¡°å‡ï¼Œä½¿å¾—ç½‘ç»œæ— æ³•å­¦ä¹ åˆ°é•¿è·ç¦»çš„ä¾èµ–å…³ç³»ã€‚LSTMæ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œè®¾è®¡çš„ã€‚' },
                        'c': { correct: false, text: 'RNNçš„å‚æ•°é‡å…¶å®ç›¸å¯¹è¾ƒå°‘ï¼Œè¿™ä¸æ˜¯ä¸»è¦é—®é¢˜ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œç°ä»£çš„Transformeræ¨¡å‹å‚æ•°é‡æ›´å¤§ï¼Œä½†æ€§èƒ½æ›´å¥½ã€‚' },
                        'd': { correct: false, text: 'æ¿€æ´»å‡½æ•°çš„é€‰æ‹©ç¡®å®ä¼šå½±å“æ€§èƒ½ï¼Œä½†å³ä½¿ä½¿ç”¨æœ€ä¼˜çš„æ¿€æ´»å‡½æ•°ï¼ŒRNNä»ç„¶æ— æ³•æ ¹æœ¬è§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚' }
                    },
                    'thinkFeedback2': {
                        'a': { correct: false, text: 'å¢åŠ æ¨¡å‹å®¹é‡ä¸æ˜¯ä¸»è¦ç›®çš„ã€‚å®é™…ä¸Šï¼Œåˆ†ç¦»è®¾è®¡æœ‰æ—¶ä¼šå¢åŠ è®¡ç®—å¤æ‚åº¦ã€‚' },
                        'b': { correct: true, text: 'ğŸ¯ æ­£ç¡®ï¼åˆ†ç¦»"ä»€ä¹ˆ"ï¼ˆå€™é€‰å€¼CÌƒ_tï¼‰å’Œ"å¤šå°‘"ï¼ˆæƒé‡i_tï¼‰è®©ç½‘ç»œå¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶ä¿¡æ¯æµã€‚è¿™å°±åƒæ˜¯åˆ†åˆ«å†³å®š"è¦å­˜å‚¨çš„å†…å®¹"å’Œ"å­˜å‚¨çš„é‡è¦ç¨‹åº¦"ï¼Œæä¾›äº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶ã€‚' },
                        'c': { correct: false, text: 'å®é™…ä¸Šè¿™æ ·çš„è®¾è®¡å¢åŠ äº†è®¡ç®—é‡ï¼Œéœ€è¦è®¡ç®—ä¸¤ä¸ªç‹¬ç«‹çš„å‘é‡ã€‚' },
                        'd': { correct: false, text: 'è™½ç„¶æœ‰ä¸€å®šçš„ç”Ÿç‰©å­¦åˆç†æ€§ï¼Œä½†ä¸»è¦è¿˜æ˜¯ä¸ºäº†æ›´å¥½çš„ä¿¡æ¯æ§åˆ¶èƒ½åŠ›ã€‚' }
                    }
                };

                const feedback = feedbacks[feedbackId]?.[answer];
                if (feedback) {
                    feedbackElement.innerHTML = `
                    <div style="padding: 1rem; background: ${feedback.correct ? 'rgba(34, 197, 94, 0.1)' : 'rgba(239, 68, 68, 0.1)'}; border-radius: 0.5rem; border-left: 4px solid ${feedback.correct ? 'var(--accent-green)' : 'var(--accent-red)'};">
                        <p style="font-weight: bold; color: ${feedback.correct ? 'var(--accent-green)' : 'var(--accent-red)'}; margin-bottom: 0.5rem;">
                            ${feedback.correct ? 'âœ… æ­£ç¡®ï¼' : 'âŒ ä¸å¤ªå¯¹å“¦'}
                        </p>
                        <p style="line-height: 1.6;">${feedback.text}</p>
                    </div>
                `;
                    feedbackElement.classList.add('show');
                }
            },

            // ===== å®æ—¶æ¼”ç¤ºè®¾ç½® =====
            setupLiveDemo: function() {
                const input = document.getElementById('sentimentInput');
                const analyzeBtn = document.getElementById('analyzeBtn');
                const predictionPreview = document.getElementById('predictionPreview');

                if (input) {
                    // è®¾ç½®ä¿å­˜çš„ç”¨æˆ·è¾“å…¥
                    input.value = this.state.savedUserInput;

                    // å®æ—¶è¾“å…¥é¢„æµ‹
                    let timeoutId;
                    input.addEventListener('input', (e) => {
                        this.state.currentInputText = e.target.value;

                        // ä¿å­˜ç”¨æˆ·è¾“å…¥
                        localStorage.setItem('lstm-tutorial-input', e.target.value);

                        // é˜²æŠ–å¤„ç†
                        clearTimeout(timeoutId);
                        timeoutId = setTimeout(() => {
                            this.showNextCharPrediction(e.target.value);
                        }, 300);
                    });

                    // ç„¦ç‚¹äº‹ä»¶
                    input.addEventListener('focus', () => {
                        if (predictionPreview) {
                            predictionPreview.style.display = 'block';
                        }
                    });

                    input.addEventListener('blur', () => {
                        setTimeout(() => {
                            if (predictionPreview) {
                                predictionPreview.style.display = 'none';
                            }
                        }, 200);
                    });
                }

                if (analyzeBtn) {
                    analyzeBtn.addEventListener('click', async () => {
                        await this.analyzeSentiment();
                    });
                }
            },

            // ===== ä¸‹ä¸€å­—ç¬¦é¢„æµ‹ =====
            showNextCharPrediction: function(text) {
                const predictionPreview = document.getElementById('predictionPreview');
                if (!predictionPreview || !text.trim()) return;

                // ç®€å•çš„ä¸‹ä¸€å­—ç¬¦é¢„æµ‹é€»è¾‘
                const predictions = this.predictNextChar(text);

                if (predictions.length > 0) {
                    const input = document.getElementById('sentimentInput');
                    const rect = input.getBoundingClientRect();

                    predictionPreview.style.left = (rect.left + text.length * 8) + 'px';
                    predictionPreview.style.top = (rect.top - 40) + 'px';
                    predictionPreview.innerHTML = `
                    <div style="font-size: 0.9rem;">
                        <div style="color: var(--accent-cyan); margin-bottom: 0.25rem;">å¯èƒ½çš„ä¸‹ä¸€ä¸ªå­—ï¼š</div>
                        ${predictions.map(p => `<span style="margin-right: 0.5rem; color: var(--accent-green);">${p}</span>`).join('')}
                    </div>
                `;
                    predictionPreview.style.display = 'block';
                }
            },

            // ===== é¢„æµ‹ä¸‹ä¸€ä¸ªå­—ç¬¦ =====
            predictNextChar: function(text) {
                // ç®€åŒ–çš„è§„åˆ™åŸºé¢„æµ‹
                const patterns = {
                    'è¿™ä¸ª': ['äº§å“', 'ä¸œè¥¿', 'æƒ³æ³•'],
                    'å¤ª': ['æ£’äº†', 'å¥½äº†', 'å·®äº†'],
                    'æˆ‘': ['å¾ˆ', 'éå¸¸', 'è§‰å¾—'],
                    'å¾ˆ': ['å¥½', 'æ£’', 'å–œæ¬¢'],
                    'éå¸¸': ['å¥½', 'æ£’', 'æ»¡æ„'],
                    'ä¸': ['é”™', 'å¥½', 'è¡Œ']
                };

                // è·å–æœ€åå‡ ä¸ªå­—ç¬¦
                const lastChars = text.slice(-2);
                return patterns[lastChars] || patterns[text.slice(-1)] || ['å¥½', 'çš„', 'äº†'];
            },

            // ===== æƒ…æ„Ÿåˆ†æ =====
            analyzeSentiment: async function() {
                const input = document.getElementById('sentimentInput');
                const btn = document.getElementById('analyzeBtn');

                if (!input || !btn) return;

                const text = input.value.trim();
                if (!text) {
                    alert('è¯·è¾“å…¥ä¸€äº›æ–‡å­—è¿›è¡Œåˆ†æï¼');
                    return;
                }

                // æ·»åŠ åŠ è½½åŠ¨ç”»
                btn.innerHTML = '<span class="loading"></span> åˆ†æä¸­...';
                btn.disabled = true;

                // æ¨¡æ‹Ÿå¤„ç†å»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 1500));

                // æ‰§è¡Œåˆ†æ
                const result = this.performSentimentAnalysis(text);
                this.updatePredictionResult(result);
                this.drawGateActivations(text);
                this.drawCellStateChart();
                this.drawHiddenStateChart();

                // å®æ—¶è”åŠ¨ï¼šé«˜äº®ç›¸å…³å…¬å¼éƒ¨åˆ†
                this.triggerFormulaHighlight();

                // æ¢å¤æŒ‰é’®
                btn.innerHTML = 'åˆ†ææƒ…æ„Ÿ âœ¨';
                btn.disabled = false;
            },

            // ===== æ‰§è¡Œæƒ…æ„Ÿåˆ†æ =====
            performSentimentAnalysis: function(text) {
                // æƒ…æ„Ÿè¯å…¸
                const positiveWords = ['æ£’', 'å¥½', 'å–œæ¬¢', 'ä¼˜ç§€', 'æ¨è', 'æ»¡æ„', 'å®Œç¾', 'èµ', 'å¤ªå¥½äº†', 'ä¸é”™', 'å¾ˆæ£’', 'å–œçˆ±', 'å‰å®³'];
                const negativeWords = ['å·®', 'ç³Ÿ', 'å¤±æœ›', 'ä¸å¥½', 'åƒåœ¾', 'è®¨åŒ', 'ç³Ÿç³•', 'çƒ‚', 'å¤ªå·®', 'ä¸è¡Œ', 'ä¸æ»¡', 'è®¨åŒ'];
                const neutralWords = ['è¿˜è¡Œ', 'ä¸€èˆ¬', 'æ™®é€š', 'å‡‘åˆ', 'è¿˜å¯ä»¥'];

                let score = 0.5; // åŸºç¡€åˆ†æ•°
                let wordCount = 0;

                // åˆ†ææ­£é¢è¯æ±‡
                positiveWords.forEach(word => {
                    const count = (text.match(new RegExp(word, 'g')) || []).length;
                    score += count * 0.15;
                    wordCount += count;
                });

                // åˆ†æè´Ÿé¢è¯æ±‡
                negativeWords.forEach(word => {
                    const count = (text.match(new RegExp(word, 'g')) || []).length;
                    score -= count * 0.2;
                    wordCount += count;
                });

                // åˆ†æä¸­æ€§è¯æ±‡
                neutralWords.forEach(word => {
                    const count = (text.match(new RegExp(word, 'g')) || []).length;
                    score += count * 0.02;
                    wordCount += count;
                });

                // æ–‡æœ¬é•¿åº¦å½±å“
                if (text.length > 10) score += 0.05;
                if (text.includes('ï¼') || text.includes('!')) score += 0.1;
                if (text.includes('ï¼Ÿ') || text.includes('?')) score -= 0.05;

                // ç¡®ä¿åˆ†æ•°åœ¨åˆç†èŒƒå›´å†…
                score = Math.max(0.1, Math.min(0.9, score));

                return {
                    score: score,
                    confidence: Math.min(0.95, 0.6 + wordCount * 0.1),
                    wordCount: wordCount,
                    textLength: text.length
                };
            },

            // ===== æ›´æ–°é¢„æµ‹ç»“æœ =====
            updatePredictionResult: function(result) {
                const resultDiv = document.getElementById('predictionResult');
                if (!resultDiv) return;

                const isPositive = result.score > 0.5;
                const sentiment = isPositive ? 'æ­£é¢æƒ…æ„Ÿ' : 'è´Ÿé¢æƒ…æ„Ÿ';
                const emoji = isPositive ? 'ğŸ˜Š' : 'ğŸ˜”';
                const color = isPositive ? 'var(--accent-green)' : 'var(--accent-red)';

                resultDiv.innerHTML = `
                <div style="font-size: 4rem; margin-bottom: 1rem;">${emoji}</div>
                <div style="font-size: 1.5rem; font-weight: bold; color: ${color}; margin-bottom: 0.5rem;">
                    ${sentiment}
                </div>
                <div style="font-size: 1.2rem; color: var(--text-secondary); margin-bottom: 1rem;">
                    ç½®ä¿¡åº¦ï¼š${Math.round(result.confidence * 100)}%
                </div>
                <div style="margin-top: 1.5rem;">
                    <div style="background: rgba(255, 255, 255, 0.1); border-radius: 0.5rem; height: 20px; overflow: hidden;">
                        <div style="height: 100%; width: ${result.confidence * 100}%; background: ${color}; transition: width 0.8s ease; border-radius: 0.5rem;"></div>
                    </div>
                </div>
                <div style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-muted);">
                    åˆ†æäº† ${result.textLength} ä¸ªå­—ç¬¦ï¼Œè¯†åˆ«å‡º ${result.wordCount} ä¸ªæƒ…æ„Ÿè¯æ±‡
                </div>
            `;
            },

            // ===== å…¬å¼è”åŠ¨é«˜äº® =====
            triggerFormulaHighlight: function() {
                // ä¾æ¬¡é«˜äº®å„ä¸ªé—¨çš„å…¬å¼
                const symbols = ['f_t', 'i_t', 'o_t'];
                let index = 0;

                const highlightNext = () => {
                    if (index < symbols.length) {
                        this.highlightSymbol(symbols[index], true);
                        setTimeout(() => {
                            this.highlightSymbol(symbols[index], false);
                            index++;
                            setTimeout(highlightNext, 200);
                        }, 800);
                    }
                };

                setTimeout(highlightNext, 500);
            },

            // ===== ç»˜åˆ¶é—¨æ¿€æ´»å›¾ =====
            drawGateActivations: function(text = '') {
                const canvas = document.getElementById('gateChart');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                canvas.width = 400;
                canvas.height = 250;

                // æ¸…ç©ºç”»å¸ƒ
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // æ ¹æ®æ–‡æœ¬å†…å®¹æ¨¡æ‹Ÿé—¨æ¿€æ´»å€¼
                const sentiment = this.performSentimentAnalysis(text);
                const gates = {
                    'é—å¿˜é—¨': 0.3 + Math.random() * 0.4, // é—å¿˜ä¸é‡è¦ä¿¡æ¯
                    'è¾“å…¥é—¨': 0.6 + Math.random() * 0.3, // æ¥å—æ–°ä¿¡æ¯
                    'è¾“å‡ºé—¨': Math.max(0.4, sentiment.score) + Math.random() * 0.2 // åŸºäºæƒ…æ„Ÿè¾“å‡º
                };

                const colors = ['#f5576c', '#4facfe', '#43e97b'];
                const labels = Object.keys(gates);
                const values = Object.values(gates);

                // ç»˜åˆ¶åŠ¨ç”»æŸ±çŠ¶å›¾
                const barWidth = 80;
                const spacing = 40;
                const startX = (canvas.width - (barWidth * 3 + spacing * 2)) / 2;

                values.forEach((value, i) => {
                    const x = startX + i * (barWidth + spacing);
                    const maxHeight = 150;
                    const height = value * maxHeight;
                    const y = canvas.height - height - 60;

                    // ç»˜åˆ¶æŸ±å­ï¼ˆå¸¦åŠ¨ç”»æ•ˆæœï¼‰
                    const gradient = ctx.createLinearGradient(0, y, 0, y + height);
                    gradient.addColorStop(0, colors[i]);
                    gradient.addColorStop(1, colors[i] + '80');

                    ctx.fillStyle = gradient;
                    ctx.fillRect(x, y, barWidth, height);

                    // ç»˜åˆ¶è¾¹æ¡†
                    ctx.strokeStyle = colors[i];
                    ctx.lineWidth = 2;
                    ctx.strokeRect(x, y, barWidth, height);

                    // ç»˜åˆ¶æ ‡ç­¾
                    ctx.fillStyle = '#f1f5f9';
                    ctx.font = 'bold 14px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(labels[i], x + barWidth/2, canvas.height - 35);

                    // ç»˜åˆ¶æ•°å€¼
                    ctx.fillStyle = colors[i];
                    ctx.font = 'bold 16px Arial';
                    ctx.fillText((value * 100).toFixed(0) + '%', x + barWidth/2, y - 10);
                });

                // ç»˜åˆ¶ç½‘æ ¼çº¿
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                ctx.lineWidth = 1;
                for (let i = 0; i <= 5; i++) {
                    const y = canvas.height - 60 - (i * 30);
                    ctx.beginPath();
                    ctx.moveTo(startX - 10, y);
                    ctx.lineTo(startX + barWidth * 3 + spacing * 2 + 10, y);
                    ctx.stroke();
                }
            },

            // ===== ç»˜åˆ¶ç»†èƒçŠ¶æ€å›¾ =====
            drawCellStateChart: function() {
                const canvas = document.getElementById('cellStateChart');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                canvas.width = canvas.offsetWidth || 300;
                canvas.height = 200;

                // æ¸…ç©ºç”»å¸ƒ
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // æ¨¡æ‹Ÿç»†èƒçŠ¶æ€å˜åŒ–
                const steps = 20;
                const values = [];
                let current = 0;

                for (let i = 0; i < steps; i++) {
                    // æ·»åŠ ä¸€äº›è¶‹åŠ¿å’Œéšæœºå˜åŒ–
                    const trend = Math.sin(i * 0.3) * 0.3;
                    const noise = (Math.random() - 0.5) * 0.2;
                    current = current * 0.7 + trend + noise;
                    values.push(current);
                }

                // ç»˜åˆ¶æŠ˜çº¿å›¾
                const stepWidth = canvas.width / steps;
                const midY = canvas.height / 2;
                const scale = 60;

                // èƒŒæ™¯ç½‘æ ¼
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                ctx.lineWidth = 1;
                for (let i = 0; i <= 4; i++) {
                    const y = (canvas.height / 4) * i;
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(canvas.width, y);
                    ctx.stroke();
                }

                // ç»˜åˆ¶ç»†èƒçŠ¶æ€çº¿
                ctx.strokeStyle = '#fa709a';
                ctx.lineWidth = 3;
                ctx.beginPath();

                values.forEach((value, i) => {
                    const x = i * stepWidth;
                    const y = midY - value * scale;

                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }

                    // ç»˜åˆ¶æ•°æ®ç‚¹
                    ctx.save();
                    ctx.fillStyle = '#fa709a';
                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.restore();
                });

                ctx.stroke();

                // ç»˜åˆ¶åŸºå‡†çº¿
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
                ctx.lineWidth = 1;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(0, midY);
                ctx.lineTo(canvas.width, midY);
                ctx.stroke();
                ctx.setLineDash([]);

                // æ ‡ç­¾
                ctx.fillStyle = '#f1f5f9';
                ctx.font = '12px Arial';
                ctx.fillText('æ—¶é—´ â†’', canvas.width - 50, canvas.height - 10);
                ctx.save();
                ctx.translate(15, canvas.height / 2);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText('ç»†èƒçŠ¶æ€å€¼', 0, 0);
                ctx.restore();
            },

            // ===== ç»˜åˆ¶éšè—çŠ¶æ€çƒ­å›¾ =====
            drawHiddenStateChart: function() {
                const canvas = document.getElementById('hiddenStateChart');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                canvas.width = canvas.offsetWidth || 300;
                canvas.height = 200;

                // æ¸…ç©ºç”»å¸ƒ
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // æ¨¡æ‹Ÿéšè—çŠ¶æ€çƒ­å›¾
                const width = 24;
                const height = 12;
                const cellWidth = canvas.width / width;
                const cellHeight = canvas.height / height;

                for (let i = 0; i < width; i++) {
                    for (let j = 0; j < height; j++) {
                        const value = Math.random();

                        // ä½¿ç”¨æ›´ä¸°å¯Œçš„é¢œè‰²æ˜ å°„
                        let r, g, b;
                        if (value > 0.7) {
                            // é«˜æ¿€æ´» - çº¢è‰²
                            r = Math.floor(255 * value);
                            g = Math.floor(100 * (1 - value));
                            b = Math.floor(100 * (1 - value));
                        } else if (value > 0.3) {
                            // ä¸­ç­‰æ¿€æ´» - è“è‰²
                            r = Math.floor(100 * value);
                            g = Math.floor(150 * value);
                            b = Math.floor(255 * value);
                        } else {
                            // ä½æ¿€æ´» - ç»¿è‰²
                            r = Math.floor(100 * value);
                            g = Math.floor(200 * value);
                            b = Math.floor(150 * value);
                        }

                        ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;
                        ctx.fillRect(i * cellWidth, j * cellHeight, cellWidth - 1, cellHeight - 1);
                    }
                }

                // æ·»åŠ æ ‡ç­¾
                ctx.fillStyle = '#f1f5f9';
                ctx.font = '10px Arial';
                ctx.fillText('éšè—å±‚ç»´åº¦ â†’', canvas.width - 80, canvas.height - 5);
                ctx.save();
                ctx.translate(5, 20);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText('æ—¶é—´æ­¥', 0, 0);
                ctx.restore();
            },

            // ===== é’¢ç´é”®ç›˜è®¾ç½® =====
            setupPianoKeyboard: function() {
                const keyboard = document.getElementById('pianoKeyboard');
                if (!keyboard) return;

                // æ¸…ç©ºç°æœ‰å†…å®¹
                keyboard.innerHTML = '';

                // åˆ›å»ºé’¢ç´é”®
                const whiteKeys = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];
                const blackKeys = ['C#', 'D#', null, 'F#', 'G#', 'A#', null];

                for (let octave = 4; octave <= 5; octave++) {
                    for (let i = 0; i < whiteKeys.length; i++) {
                        // ç™½é”®
                        const whiteKey = document.createElement('div');
                        whiteKey.className = 'piano-key';
                        whiteKey.dataset.note = whiteKeys[i] + octave;
                        whiteKey.addEventListener('click', () => {
                            this.playNote(whiteKeys[i] + octave);
                        });
                        keyboard.appendChild(whiteKey);

                        // é»‘é”®
                        if (blackKeys[i]) {
                            const blackKey = document.createElement('div');
                            blackKey.className = 'piano-key black';
                            blackKey.dataset.note = blackKeys[i] + octave;
                            blackKey.addEventListener('click', () => {
                                this.playNote(blackKeys[i] + octave);
                            });
                            keyboard.appendChild(blackKey);
                        }
                    }
                }
            },

            // ===== æ’­æ”¾éŸ³ç¬¦ =====
            playNote: function(note) {
                // éŸ³ç¬¦åˆ°é¢‘ç‡çš„æ˜ å°„
                const noteFreq = {
                    'C4': 261.63, 'C#4': 277.18, 'D4': 293.66, 'D#4': 311.13,
                    'E4': 329.63, 'F4': 349.23, 'F#4': 369.99, 'G4': 392.00,
                    'G#4': 415.30, 'A4': 440.00, 'A#4': 466.16, 'B4': 493.88,
                    'C5': 523.25, 'C#5': 554.37, 'D5': 587.33, 'D#5': 622.25,
                    'E5': 659.25, 'F5': 698.46, 'F#5': 739.99, 'G5': 783.99,
                    'G#5': 830.61, 'A5': 880.00, 'A#5': 932.33, 'B5': 987.77
                };

                const freq = noteFreq[note];
                if (!freq) return;

                // æ·»åŠ åˆ°ç§å­æ—‹å¾‹
                this.state.seedMelody.push(note);
                this.updateSeedMelodyDisplay();

                // é«˜äº®æŒ‰é”®
                const key = document.querySelector(`[data-note="${note}"]`);
                if (key) {
                    key.classList.add('active');
                    setTimeout(() => {
                        key.classList.remove('active');
                    }, 200);
                }

                // ä½¿ç”¨Web Audio APIæ’­æ”¾éŸ³ç¬¦
                this.playSynthNote(freq);
            },

            // ===== åˆæˆéŸ³é¢‘æ’­æ”¾ =====
            playSynthNote: function(frequency) {
                if (!window.AudioContext && !window.webkitAudioContext) return;

                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                oscillator.type = 'sine';

                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            },

            // ===== æ›´æ–°ç§å­æ—‹å¾‹æ˜¾ç¤º =====
            updateSeedMelodyDisplay: function() {
                const display = document.getElementById('seedMelody');
                if (display) {
                    if (this.state.seedMelody.length === 0) {
                        display.textContent = '[]';
                    } else {
                        display.textContent = `[${this.state.seedMelody.join(', ')}]`;
                    }
                }
            },

            // ===== æ¸…ç©ºæ—‹å¾‹ =====
            clearMelody: function() {
                this.state.seedMelody = [];
                this.updateSeedMelodyDisplay();
            },

            // ===== ä»ç§å­ç”Ÿæˆæ—‹å¾‹ =====
            generateFromSeed: function() {
                if (this.state.seedMelody.length === 0) {
                    alert('è¯·å…ˆåœ¨é’¢ç´ä¸Šè¾“å…¥ä¸€äº›éŸ³ç¬¦ä½œä¸ºç§å­æ—‹å¾‹ï¼');
                    return;
                }

                // åŸºäºç§å­ç”Ÿæˆæ›´é•¿çš„æ—‹å¾‹
                const generatedMelody = this.extendMelody(this.state.seedMelody);
                this.visualizeMelody(generatedMelody, 'ç§å­ç»­å†™');
            },

            // ===== æ‰©å±•æ—‹å¾‹ =====
            extendMelody: function(seed) {
                const allNotes = ['C4', 'D4', 'E4', 'F4', 'G4', 'A4', 'B4', 'C5', 'D5', 'E5', 'F5', 'G5'];
                const extended = [...seed];

                // ç®€å•çš„é©¬å°”å¯å¤«é“¾ç”Ÿæˆ
                for (let i = 0; i < 8; i++) {
                    const lastNote = extended[extended.length - 1];
                    const lastIndex = allNotes.indexOf(lastNote);

                    if (lastIndex !== -1) {
                        // å€¾å‘äºé€‰æ‹©ç›¸é‚»çš„éŸ³ç¬¦
                        const choices = [
                            lastIndex - 1,
                            lastIndex,
                            lastIndex + 1,
                            lastIndex + 2
                        ].filter(idx => idx >= 0 && idx < allNotes.length);

                        const nextIndex = choices[Math.floor(Math.random() * choices.length)];
                        extended.push(allNotes[nextIndex]);
                    } else {
                        extended.push(allNotes[Math.floor(Math.random() * allNotes.length)]);
                    }
                }

                return extended;
            },

            // ===== ç”Ÿæˆé¢„è®¾æ—‹å¾‹ =====
            generateMelody: function(mood) {
                const melodyPatterns = {
                    happy: ['C4', 'E4', 'G4', 'C5', 'G4', 'E4', 'C4', 'E4', 'G4', 'C5'],
                    sad: ['A4', 'F4', 'D4', 'F4', 'A4', 'G4', 'F4', 'E4', 'D4', 'C4'],
                    energetic: ['C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4', 'F4', 'F4', 'E4'],
                    calm: ['C4', 'D4', 'E4', 'F4', 'E4', 'D4', 'C4', 'D4', 'E4', 'C4']
                };

                const melody = melodyPatterns[mood] || melodyPatterns.happy;
                this.visualizeMelody(melody, this.getMoodTitle(mood));
            },

            // ===== è·å–æƒ…ç»ªæ ‡é¢˜ =====
            getMoodTitle: function(mood) {
                const titles = {
                    happy: 'ğŸ˜Š æ¬¢å¿«æ—‹å¾‹',
                    sad: 'ğŸ˜¢ å¿§ä¼¤æ—‹å¾‹',
                    energetic: 'âš¡ æ¿€æ˜‚æ—‹å¾‹',
                    calm: 'ğŸŒŠ å¹³é™æ—‹å¾‹'
                };
                return titles[mood] || 'ğŸµ ç”Ÿæˆæ—‹å¾‹';
            },

            // ===== å¯è§†åŒ–æ—‹å¾‹ =====
            visualizeMelody: function(melody, title = 'ç”Ÿæˆçš„æ—‹å¾‹') {
                const canvas = document.getElementById('musicCanvas');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                canvas.width = canvas.offsetWidth || 800;
                canvas.height = 300;

                // æ¸…ç©ºç”»å¸ƒ
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                if (melody.length === 0) return;

                // éŸ³ç¬¦æ˜ å°„åˆ°Yåæ ‡
                const noteToY = {
                    'C4': 250, 'C#4': 240, 'D4': 230, 'D#4': 220, 'E4': 210,
                    'F4': 200, 'F#4': 190, 'G4': 180, 'G#4': 170, 'A4': 160,
                    'A#4': 150, 'B4': 140, 'C5': 130, 'C#5': 120, 'D5': 110,
                    'D#5': 100, 'E5': 90, 'F5': 80, 'F#5': 70, 'G5': 60
                };

                const noteWidth = canvas.width / melody.length;

                // ç»˜åˆ¶äº”çº¿è°±èƒŒæ™¯
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
                ctx.lineWidth = 1;
                for (let i = 0; i < 5; i++) {
                    const y = 160 + i * 20;
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(canvas.width, y);
                    ctx.stroke();
                }

                // ç»˜åˆ¶æ ‡é¢˜
                ctx.fillStyle = '#f1f5f9';
                ctx.font = 'bold 18px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(title, canvas.width / 2, 30);

                // ç»˜åˆ¶éŸ³ç¬¦
                melody.forEach((note, i) => {
                    const x = i * noteWidth + noteWidth / 2;
                    const y = noteToY[note] || 160;

                    // ç»˜åˆ¶éŸ³ç¬¦
                    ctx.beginPath();
                    ctx.arc(x, y, 8, 0, 2 * Math.PI);
                    ctx.fillStyle = this.getNoteColor(note);
                    ctx.fill();
                    ctx.strokeStyle = 'white';
                    ctx.lineWidth = 2;
                    ctx.stroke();

                    // è¿æ¥çº¿
                    if (i > 0) {
                        const prevY = noteToY[melody[i-1]] || 160;
                        ctx.beginPath();
                        ctx.moveTo((i-1) * noteWidth + noteWidth / 2, prevY);
                        ctx.lineTo(x, y);
                        ctx.strokeStyle = this.getNoteColor(note);
                        ctx.lineWidth = 3;
                        ctx.stroke();
                    }

                    // éŸ³ç¬¦æ ‡ç­¾
                    ctx.fillStyle = 'white';
                    ctx.font = '10px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(note, x, y + 25);
                });

                // æ’­æ”¾æ—‹å¾‹
                this.playMelody(melody);
            },

            // ===== è·å–éŸ³ç¬¦é¢œè‰² =====
            getNoteColor: function(note) {
                const colors = {
                    'C': '#ff4757', 'D': '#ff6b7a', 'E': '#ffa502',
                    'F': '#ffda79', 'G': '#7bed9f', 'A': '#5352ed',
                    'B': '#a4b0be'
                };
                return colors[note[0]] || '#70a1ff';
            },

            // ===== æ’­æ”¾æ—‹å¾‹ =====
            playMelody: function(melody) {
                if (!melody || melody.length === 0) return;

                melody.forEach((note, index) => {
                    setTimeout(() => {
                        this.playNote(note);
                    }, index * 400);
                });
            },

            // ===== ä¸»é¢˜æ§åˆ¶è®¾ç½® =====
            setupThemeControls: function() {
                const themeToggle = document.getElementById('toggle-theme');
                const animationToggle = document.getElementById('toggle-animations');

                if (themeToggle) {
                    themeToggle.addEventListener('click', () => {
                        document.body.classList.toggle('light-theme');
                        // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šä¸»é¢˜åˆ‡æ¢é€»è¾‘
                    });
                }

                if (animationToggle) {
                    animationToggle.addEventListener('click', () => {
                        this.state.animationsEnabled = !this.state.animationsEnabled;
                        document.body.style.setProperty('--animation-duration',
                            this.state.animationsEnabled ? '0.3s' : '0s');

                        animationToggle.innerHTML = this.state.animationsEnabled ?
                            '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M10 8l6 4-6 4V8z"></path></svg>' :
                            '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><rect x="9" y="9" width="6" height="6"></rect></svg>';
                    });
                }
            },

            // ===== æ¢¯åº¦æ¶ˆå¤±åŠ¨ç”» =====
            animateGradientVanishing: function() {
                const canvas = document.getElementById('gradientVanishingCanvas');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                canvas.width = 900;
                canvas.height = 300;

                let step = 0;
                const totalSteps = 20;

                const animate = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    // ç»˜åˆ¶æ ‡é¢˜
                    ctx.fillStyle = '#f1f5f9';
                    ctx.font = 'bold 16px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('RNNæ¢¯åº¦ä¼ æ’­ï¼šæ¯å±‚è¡°å‡90%', canvas.width / 2, 30);

                    // ç»˜åˆ¶æ—¶é—´æ­¥
                    const stepWidth = canvas.width / totalSteps;

                    for (let i = 0; i <= step; i++) {
                        const x = i * stepWidth;
                        const gradientStrength = Math.pow(0.9, i); // æ¯æ­¥è¡°å‡90%

                        // ç»˜åˆ¶æ¢¯åº¦å¼ºåº¦æ¡
                        const barHeight = gradientStrength * 200;
                        ctx.fillStyle = `rgba(239, 68, 68, ${gradientStrength})`;
                        ctx.fillRect(x + 5, 250 - barHeight, stepWidth - 10, barHeight);

                        // ç»˜åˆ¶è¾¹æ¡†
                        ctx.strokeStyle = '#ef4444';
                        ctx.lineWidth = 1;
                        ctx.strokeRect(x + 5, 250 - barHeight, stepWidth - 10, barHeight);

                        // ç»˜åˆ¶æ—¶é—´æ­¥æ ‡ç­¾
                        ctx.fillStyle = '#f1f5f9';
                        ctx.font = '12px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(`t=${i+1}`, x + stepWidth/2, 275);

                        // ç»˜åˆ¶æ•°å€¼
                        ctx.fillStyle = gradientStrength > 0.1 ? '#f1f5f9' : '#ef4444';
                        ctx.font = '10px Arial';
                        ctx.fillText(gradientStrength.toFixed(3), x + stepWidth/2, 150);
                    }

                    // ç»˜åˆ¶è­¦å‘Šä¿¡æ¯
                    if (step >= 10) {
                        ctx.fillStyle = '#ef4444';
                        ctx.font = 'bold 14px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('æ¢¯åº¦å‡ ä¹æ¶ˆå¤±ï¼æ— æ³•å­¦ä¹ é•¿æœŸä¾èµ–', canvas.width / 2, canvas.height - 20);
                    }

                    step++;
                    if (step <= totalSteps) {
                        setTimeout(animate, 300);
                    }
                };

                animate();
            },

            // ===== é‡ç½®æ¢¯åº¦åŠ¨ç”» =====
            resetGradientAnimation: function() {
                const canvas = document.getElementById('gradientVanishingCanvas');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // ç»˜åˆ¶åˆå§‹çŠ¶æ€
                ctx.fillStyle = '#f1f5f9';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('ç‚¹å‡»"æ¼”ç¤ºæ¢¯åº¦æ¶ˆå¤±"æŒ‰é’®å¼€å§‹', canvas.width / 2, canvas.height / 2);
            },

            // ===== LSTMå•å…ƒäº¤äº’åŠŸèƒ½ =====
            highlightForgetGate: function() {
                this.updateGateDescription('forget', '#f5576c');
                this.drawLSTMHighlight('forget');
            },

            highlightInputGate: function() {
                this.updateGateDescription('input', '#4facfe');
                this.drawLSTMHighlight('input');
            },

            highlightOutputGate: function() {
                this.updateGateDescription('output', '#43e97b');
                this.drawLSTMHighlight('output');
            },

            animateDataFlow: function() {
                this.updateGateDescription('flow', '#a8edea');
                this.drawLSTMDataFlow();
            },

            // ===== æ›´æ–°é—¨æè¿° =====
            updateGateDescription: function(gateType, color) {
                const descriptions = {
                    forget: {
                        title: 'é—å¿˜é—¨ (Forget Gate)',
                        formula: 'f_t = Ïƒ(W_f Â· [h_{t-1}, x_t] + b_f)',
                        description: 'é—å¿˜é—¨å†³å®šä»ç»†èƒçŠ¶æ€ä¸­ä¸¢å¼ƒä»€ä¹ˆä¿¡æ¯ã€‚å®ƒæŸ¥çœ‹ h_{t-1} å’Œ x_tï¼Œè¾“å‡ºä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„æ•°å€¼ç»™æ¯ä¸ªç»†èƒçŠ¶æ€ã€‚1 è¡¨ç¤º"å®Œå…¨ä¿ç•™"ï¼Œ0 è¡¨ç¤º"å®Œå…¨ä¸¢å¼ƒ"ã€‚è¿™ä¸ªé—¨è®©LSTMèƒ½å¤Ÿä¸»åŠ¨é—å¿˜ä¸å†é‡è¦çš„å†å²ä¿¡æ¯ã€‚',
                        keyPoints: ['é€‰æ‹©æ€§é—å¿˜è¿‡æ—¶ä¿¡æ¯', 'è¾“å‡ºèŒƒå›´[0,1]', '0=å®Œå…¨é—å¿˜ï¼Œ1=å®Œå…¨ä¿ç•™', 'Sigmoidæ¿€æ´»å‡½æ•°']
                    },
                    input: {
                        title: 'è¾“å…¥é—¨ (Input Gate)',
                        formula: 'i_t = Ïƒ(W_i Â· [h_{t-1}, x_t] + b_i)',
                        description: 'è¾“å…¥é—¨å†³å®šä»€ä¹ˆæ–°ä¿¡æ¯è¦å­˜å‚¨åˆ°ç»†èƒçŠ¶æ€ä¸­ã€‚å®ƒåŒ…å«ä¸¤éƒ¨åˆ†ï¼šsigmoid å±‚å†³å®šå“ªäº›å€¼è¦æ›´æ–°ï¼Œtanh å±‚åˆ›å»ºæ–°çš„å€™é€‰å€¼å‘é‡ã€‚ä¸¤è€…ç»“åˆå®ç°é€‰æ‹©æ€§çš„ä¿¡æ¯å­˜å‚¨ã€‚',
                        keyPoints: ['æ§åˆ¶æ–°ä¿¡æ¯çš„é‡è¦æ€§', 'ä¸å€™é€‰å€¼é…åˆå·¥ä½œ', 'å®ç°é€‰æ‹©æ€§æ›´æ–°', 'é˜²æ­¢ä¿¡æ¯è¿‡è½½']
                    },
                    output: {
                        title: 'è¾“å‡ºé—¨ (Output Gate)',
                        formula: 'o_t = Ïƒ(W_o Â· [h_{t-1}, x_t] + b_o)',
                        description: 'è¾“å‡ºé—¨å†³å®šåŸºäºç»†èƒçŠ¶æ€è¾“å‡ºä»€ä¹ˆã€‚é¦–å…ˆè¿è¡Œ sigmoid å±‚å†³å®šç»†èƒçŠ¶æ€çš„å“ªäº›éƒ¨åˆ†è¦è¾“å‡ºï¼Œç„¶åå°†ç»†èƒçŠ¶æ€é€šè¿‡ tanh å¹¶ä¹˜ä»¥ sigmoid çš„è¾“å‡ºï¼Œå¾—åˆ°æœ€ç»ˆçš„éšè—çŠ¶æ€ã€‚',
                        keyPoints: ['æ§åˆ¶è¾“å‡ºä¿¡æ¯', 'åŸºäºç»†èƒçŠ¶æ€è¿‡æ»¤', 'tanhå‹ç¼©åˆ°[-1,1]', 'äº§ç”Ÿæœ€ç»ˆéšè—çŠ¶æ€']
                    },
                    flow: {
                        title: 'æ•°æ®æµåŠ¨ (Data Flow)',
                        formula: 'C_t = f_t âŠ™ C_{t-1} + i_t âŠ™ CÌƒ_t',
                        description: 'è§‚å¯Ÿæ•°æ®å¦‚ä½•åœ¨LSTMä¸­æµåŠ¨ï¼šè¾“å…¥ç»è¿‡ä¸‰ä¸ªé—¨çš„å¤„ç†ï¼Œç»†èƒçŠ¶æ€åœ¨é«˜é€Ÿå…¬è·¯ä¸Šçº¿æ€§ä¼ æ’­ï¼Œæœ€ç»ˆé€šè¿‡è¾“å‡ºé—¨äº§ç”Ÿéšè—çŠ¶æ€ã€‚è¿™ç§è®¾è®¡ç¡®ä¿äº†æ¢¯åº¦çš„ç¨³å®šä¼ æ’­ã€‚',
                        keyPoints: ['ä¿¡æ¯é«˜é€Ÿå…¬è·¯', 'çº¿æ€§ç»†èƒçŠ¶æ€ä¼ æ’­', 'ä¸‰é—¨ååŒå·¥ä½œ', 'æ¢¯åº¦ç¨³å®šä¼ æ’­']
                    }
                };

                const desc = descriptions[gateType];
                if (!desc) return;

                const descriptionDiv = document.getElementById('gateDescription');
                if (descriptionDiv) {
                    descriptionDiv.innerHTML = `
                    <div style="border-left: 4px solid ${color}; padding-left: 1rem;">
                        <h3 style="color: ${color}; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            ${desc.title}
                            <span style="font-size: 0.8rem; background: rgba(255,255,255,0.1); padding: 0.25rem 0.5rem; border-radius: 0.25rem;">å®æ—¶åˆ†æ</span>
                        </h3>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                            <code style="font-size: 1.1rem; color: ${color};">${desc.formula}</code>
                        </div>
                        <p style="line-height: 1.8; margin-bottom: 1rem;">${desc.description}</p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">
                            ${desc.keyPoints.map(point => `
                                <div style="background: rgba(255,255,255,0.05); padding: 0.5rem; border-radius: 0.25rem; font-size: 0.9rem;">
                                    â€¢ ${point}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                }
            },

            // ===== ç»˜åˆ¶LSTMé«˜äº® =====
            drawLSTMHighlight: function(gateType) {
                const canvas = document.getElementById('lstmCanvas');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                canvas.width = canvas.offsetWidth;
                canvas.height = 500;

                // æ¸…ç©ºç”»å¸ƒ
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // ç»˜åˆ¶åŸºæœ¬LSTMç»“æ„
                this.drawBasicLSTMStructure(ctx, canvas.width, canvas.height);

                // é«˜äº®ç‰¹å®šé—¨
                this.highlightSpecificGate(ctx, canvas.width, canvas.height, gateType);
            },

            // ===== ç»˜åˆ¶åŸºæœ¬LSTMç»“æ„ =====
            drawBasicLSTMStructure: function(ctx, width, height) {
                // ç»˜åˆ¶ç»†èƒçŠ¶æ€é«˜é€Ÿå…¬è·¯
                ctx.strokeStyle = '#a8edea';
                ctx.lineWidth = 6;
                ctx.beginPath();
                ctx.moveTo(50, height/2);
                ctx.lineTo(width - 50, height/2);
                ctx.stroke();

                // æ·»åŠ ç®­å¤´
                this.drawArrow(ctx, width - 80, height/2, width - 50, height/2, '#a8edea');

                // ç»˜åˆ¶ç»†èƒçŠ¶æ€æ ‡ç­¾
                ctx.fillStyle = '#a8edea';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('ç»†èƒçŠ¶æ€ C_t', width/2, height/2 - 20);

                // ç»˜åˆ¶é—¨çš„ä½ç½®
                const gates = [
                    { name: 'é—å¿˜é—¨', x: width * 0.25, y: height * 0.25, color: '#f5576c', symbol: 'f_t' },
                    { name: 'è¾“å…¥é—¨', x: width * 0.5, y: height * 0.25, color: '#4facfe', symbol: 'i_t' },
                    { name: 'è¾“å‡ºé—¨', x: width * 0.75, y: height * 0.75, color: '#43e97b', symbol: 'o_t' }
                ];

                gates.forEach(gate => {
                    // ç»˜åˆ¶é—¨åœ†åœˆ
                    ctx.beginPath();
                    ctx.arc(gate.x, gate.y, 35, 0, 2 * Math.PI);
                    ctx.fillStyle = gate.color + '40';
                    ctx.fill();
                    ctx.strokeStyle = gateç»†ï¼š</strong>ç‹¬ç«‹æ§åˆ¶é—å¿˜å’Œè®°å¿†</li>
                </ul>

                    <div style="margin: 1.5rem 0;">
                        <canvas id="lstmArchCanvas" width="300" height="200"></canvas>
                    </div>

                    <div class="tip info">
                        <span>ğŸ’¡</span>
                        <div>
                            <strong>ä¼˜åŠ¿ï¼š</strong>è¡¨è¾¾èƒ½åŠ›å¼ºï¼Œé€‚åˆå¤æ‚ä»»åŠ¡<br>
                            <strong>åŠ£åŠ¿ï¼š</strong>å‚æ•°å¤šï¼Œè®­ç»ƒæ…¢
                        </div>
                    </div>
                </div>

                    <!-- JavaScriptæ¨¡å—åŒ–å°è£… -->
                    <script>
                        (function() {
                        'use strict';

                        // ===== å…¨å±€æ¨¡å—å¯¹è±¡ =====
                        window.lstmTutorial = {
                        // çŠ¶æ€ç®¡ç†
                        state: {
                        currentStep: 0,
                        totalSteps: 4,
                        animationsEnabled: true,
                        seedMelody: [],
                        currentInputText: '',
                        savedUserInput: localStorage.getItem('lstm-tutorial-input') || 'è¿™ä¸ªäº§å“å¤ªæ£’äº†ï¼æˆ‘éå¸¸å–œæ¬¢ï¼'
                    },

                        // ===== åˆå§‹åŒ–å‡½æ•° =====
                        init: function() {
                        this.setupEventListeners();
                        this.createBackgroundAnimation();
                        this.initializeComponents();
                        this.restoreUserState();
                        console.log('ğŸ§  LSTMäº¤äº’å¼æ•™ç¨‹å·²åŠ è½½å®Œæˆï¼');
                    },

                        // ===== äº‹ä»¶ç›‘å¬å™¨è®¾ç½® =====
                        setupEventListeners: function() {
                        // å¯¼èˆªç›¸å…³
                        const toggleSidebar = document.getElementById('toggle-sidebar');
                        const sidebar = document.getElementById('sidebar');

                        if (toggleSidebar && sidebar) {
                        toggleSidebar.addEventListener('click', () => {
                        sidebar.classList.toggle('open');
                    });
                    }

                        // æ»šåŠ¨ç›¸å…³
                        this.setupScrollHandlers();

                        // äº¤äº’å¼å…ƒç´ 
                        this.setupInteractiveElements();

                        // æ­¥è¿›åŠ¨ç”»æ§åˆ¶
                        this.setupStepAnimation();

                        // ä»£ç å±‚åˆ‡æ¢
                        this.setupCodeLayerTabs();

                        // æ€è€ƒé¢˜äº¤äº’
                        this.setupThinkingQuestions();

                        // å®æ—¶æ¼”ç¤º
                        this.setupLiveDemo();

                        // é’¢ç´é”®ç›˜
                        this.setupPianoKeyboard();

                        // ä¸»é¢˜å’ŒåŠ¨ç”»åˆ‡æ¢
                        this.setupThemeControls();
                    },

                        // ===== æ»šåŠ¨å¤„ç† =====
                        setupScrollHandlers: function() {
                        const navHeader = document.querySelector('.nav-header');
                        let lastScrollTop = 0;

                        window.addEventListener('scroll', () => {
                        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

                        // è‡ªåŠ¨éšè—å¯¼èˆªæ 
                        if (scrollTop > lastScrollTop && scrollTop > 100) {
                        navHeader?.classList.add('hidden');
                    } else {
                        navHeader?.classList.remove('hidden');
                    }
                        lastScrollTop = scrollTop;

                        // æ›´æ–°è¿›åº¦æ¡
                        this.updateProgressBar();

                        // æ›´æ–°ä¾§è¾¹æ é«˜äº®
                        this.updateSidebarHighlight();
                    });
                    },

                        // ===== è¿›åº¦æ¡æ›´æ–° =====
                        updateProgressBar: function() {
                        const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
                        const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                        const scrolled = (winScroll / height) * 100;
                        const progressBar = document.getElementById('progress-bar');
                        if (progressBar) {
                        progressBar.style.width = scrolled + '%';
                    }
                    },

                        // ===== ä¾§è¾¹æ é«˜äº®æ›´æ–° =====
                        updateSidebarHighlight: function() {
                        const sections = document.querySelectorAll('section[id]');
                        const tocItems = document.querySelectorAll('.toc-item');
                        let current = '';

                        sections.forEach(section => {
                        const sectionTop = section.offsetTop;
                        if (pageYOffset >= sectionTop - 200) {
                        current = section.getAttribute('id');
                    }
                    });

                        tocItems.forEach(item => {
                        item.classList.remove('active');
                        if (item.getAttribute('href') === `#${current}`) {
                        item.classList.add('active');
                    }
                    });
                    },

                        // ===== äº¤äº’å¼å…ƒç´ è®¾ç½® =====
                        setupInteractiveElements: function() {
                        // å…¬å¼é«˜äº®äº¤äº’
                        document.querySelectorAll('.highlight-target').forEach(elem => {
                        elem.addEventListener('mouseenter', () => {
                        const symbol = elem.getAttribute('data-symbol');
                        this.highlightSymbol(symbol, true);
                    });

                        elem.addEventListener('mouseleave', () => {
                        const symbol = elem.getAttribute('data-symbol');
                        this.highlightSymbol(symbol, false);
                    });

                        // æ·»åŠ ç‚¹å‡»åŠŸèƒ½ï¼Œæ˜¾ç¤ºè¯¦ç»†è§£é‡Š
                        elem.addEventListener('click', () => {
                        const symbol = elem.getAttribute('data-symbol');
                        this.showSymbolDetails(symbol);
                    });
                    });

                        // ç»ƒä¹ é¢˜å±•å¼€
                        document.querySelectorAll('.practice-item').forEach(item => {
                        item.addEventListener('click', function() {
                        this.classList.toggle('open');
                    });
                    });

                        // æŠ˜å æ§åˆ¶
                        document.querySelectorAll('.collapsible-header').forEach(header => {
                        header.addEventListener('click', function() {
                        const collapsible = this.closest('.collapsible');
                        collapsible.classList.toggle('open');
                    });
                    });
                    },

                        // ===== ç¬¦å·é«˜äº® =====
                        highlightSymbol: function(symbol, highlight) {
                        // é«˜äº®æ‰€æœ‰ç›¸å…³å…ƒç´ 
                        document.querySelectorAll(`[data-symbol="${symbol}"]`).forEach(elem => {
                        if (highlight) {
                        elem.classList.add('highlight-active');
                    } else {
                        elem.classList.remove('highlight-active');
                    }
                    });

                        // é«˜äº®å¯¹åº”çš„å«ä¹‰é¡¹
                        document.querySelectorAll('.meaning-item').forEach(item => {
                        const strongText = item.querySelector('strong')?.textContent || '';
                        if (strongText.includes(symbol.replace('_', ''))) {
                        if (highlight) {
                        item.style.background = 'rgba(79, 172, 254, 0.2)';
                        item.style.borderColor = 'var(--accent-blue)';
                    } else {
                        item.style.background = '';
                        item.style.borderColor = 'transparent';
                    }
                    }
                    });

                        // å®æ—¶è”åŠ¨ï¼šåœ¨å…¬å¼æ¼”ç¤ºåŒºåŸŸæ·»åŠ é«˜äº®
                        if (highlight) {
                        this.triggerLiveHighlight(symbol);
                    }
                    },

                        // ===== å®æ—¶è”åŠ¨é«˜äº® =====
                        triggerLiveHighlight: function(symbol) {
                        const forgetGateExplainer = document.getElementById('forgetGateExplainer');
                        if (forgetGateExplainer) {
                        const targetElement = forgetGateExplainer.querySelector(`[data-symbol="${symbol}"]`);
                        if (targetElement) {
                        targetElement.classList.add('live-highlight');
                        setTimeout(() => {
                        targetElement.classList.remove('live-highlight');
                    }, 1000);
                    }
                    }
                    },

                        // ===== ç¬¦å·è¯¦ç»†ä¿¡æ¯ =====
                        showSymbolDetails: function(symbol) {
                        const details = {
                        'f_t': {
                        title: 'é—å¿˜é—¨ f_t',
                        description: 'é—å¿˜é—¨å†³å®šä»ç»†èƒçŠ¶æ€ä¸­ä¸¢å¼ƒå“ªäº›ä¿¡æ¯ã€‚å®ƒçš„è¾“å‡ºåœ¨[0,1]ä¹‹é—´ï¼Œ0è¡¨ç¤ºå®Œå…¨é—å¿˜ï¼Œ1è¡¨ç¤ºå®Œå…¨ä¿ç•™ã€‚',
                        formula: 'f_t = Ïƒ(W_f Â· [h_{t-1}, x_t] + b_f)'
                    },
                        'i_t': {
                        title: 'è¾“å…¥é—¨ i_t',
                        description: 'è¾“å…¥é—¨å†³å®šæ–°ä¿¡æ¯çš„é‡è¦æ€§æƒé‡ã€‚é…åˆå€™é€‰å€¼CÌƒ_tï¼Œå…±åŒå†³å®šéœ€è¦å­˜å‚¨çš„æ–°ä¿¡æ¯ã€‚',
                        formula: 'i_t = Ïƒ(W_i Â· [h_{t-1}, x_t] + b_i)'
                    },
                        'o_t': {
                        title: 'è¾“å‡ºé—¨ o_t',
                        description: 'è¾“å‡ºé—¨æ§åˆ¶åŸºäºç»†èƒçŠ¶æ€è¾“å‡ºä»€ä¹ˆä¿¡æ¯ç»™éšè—çŠ¶æ€ã€‚',
                        formula: 'o_t = Ïƒ(W_o Â· [h_{t-1}, x_t] + b_o)'
                    },
                        'sigma': {
                        title: 'Sigmoidå‡½æ•° Ïƒ',
                        description: 'Sigmoidå‡½æ•°å°†ä»»æ„å®æ•°æ˜ å°„åˆ°[0,1]åŒºé—´ï¼Œåœ¨LSTMä¸­ç”¨ä½œ"é—¨"ï¼Œæ§åˆ¶ä¿¡æ¯é€šè¿‡çš„æ¯”ä¾‹ã€‚',
                        formula: 'Ïƒ(x) = 1/(1 + e^(-x))'
                    }
                    };

                        const detail = details[symbol];
                        if (detail) {
                        // åˆ›å»ºå¼¹çª—æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
                        this.showModal(detail);
                    }
                    },

                        // ===== æ¨¡æ€æ¡†æ˜¾ç¤º =====
                        showModal: function(content) {
                        // ç§»é™¤å·²å­˜åœ¨çš„æ¨¡æ€æ¡†
                        const existingModal = document.querySelector('.symbol-modal');
                        if (existingModal) {
                        existingModal.remove();
                    }

                        // åˆ›å»ºæ–°çš„æ¨¡æ€æ¡†
                        const modal = document.createElement('div');
                        modal.className = 'symbol-modal';
                        modal.innerHTML = `
                <div class="modal-overlay" onclick="this.parentElement.remove()">
                    <div class="modal-content" onclick="event.stopPropagation()">
                        <div class="modal-header">
                            <h3>${content.title}</h3>
                            <button class="modal-close" onclick="this.closest('.symbol-modal').remove()">Ã—</button>
                        </div>
                        <div class="modal-body">
                            <p>${content.description}</p>
                            <div class="modal-formula">
                                <code>${content.formula}</code>
                            </div>
                        </div>
                    </div>
                </div>
            `;

                        // æ·»åŠ æ ·å¼
                        const style = document.createElement('style');
                        style.textContent = `
                .symbol-modal {
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    z-index: 10000;
                }
                .modal-overlay {
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 2rem;
                }
                .modal-content {
                    background: var(--bg-section);
                    border-radius: 1rem;
                    max-width: 500px;
                    width: 100%;
                    border: 1px solid var(--border-color);
                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
                    animation: modalAppear 0.3s ease;
                }
                @keyframes modalAppear {
                    from { opacity: 0; transform: scale(0.9); }
                    to { opacity: 1; transform: scale(1); }
                }
                .modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 1.5rem;
                    border-bottom: 1px solid var(--border-color);
                }
                .modal-header h3 {
                    color: var(--accent-cyan);
                    margin: 0;
                }
                .modal-close {
                    background: none;
                    border: none;
                    color: var(--text-secondary);
                    font-size: 1.5rem;
                    cursor: pointer;
                    padding: 0.5rem;
                    border-radius: 0.25rem;
                    transition: all 0.3s ease;
                }
                .modal-close:hover {
                    background: rgba(255, 255, 255, 0.1);
                    color: var(--text-primary);
                }
                .modal-body {
                    padding: 1.5rem;
                }
                .modal-body p {
                    line-height: 1.6;
                    margin-bottom: 1rem;
                }
                .modal-formula {
                    background: rgba(255, 255, 255, 0.05);
                    padding: 1rem;
                    border-radius: 0.5rem;
                    border-left: 4px solid var(--accent-cyan);
                }
                .modal-formula code {
                    font-size: 1.1rem;
                    color: var(--accent-cyan);
                }
            `;
                        document.head.appendChild(style);

                        document.body.appendChild(modal);
                    },

                        // ===== æ­¥è¿›åŠ¨ç”»è®¾ç½® =====
                        setupStepAnimation: function() {
                        // æ­¥éª¤ç‚¹å‡»
                        document.querySelectorAll('.step-dot').forEach(dot => {
                        dot.addEventListener('click', () => {
                        this.state.currentStep = parseInt(dot.getAttribute('data-step'));
                        this.updateStep();
                    });
                    });

                        // å¯¼èˆªæŒ‰é’®
                        const prevBtn = document.getElementById('prevStep');
                        const nextBtn = document.getElementById('nextStep');

                        if (prevBtn) {
                        prevBtn.addEventListener('click', () => {
                        if (this.state.currentStep > 0) {
                        this.state.currentStep--;
                        this.updateStep();
                    }
                    });
                    }

                        if (nextBtn) {
                        nextBtn.addEventListener('click', () => {
                        if (this.state.currentStep < this.state.totalSteps - 1) {
                        this.state.currentStep++;
                        this.updateStep();
                    }
                    });
                    }
                    },

                        // ===== æ­¥éª¤æ›´æ–° =====
                        updateStep: function() {
                        // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
                        document.querySelectorAll('.step-dot').forEach((dot, index) => {
                        dot.classList.toggle('active', index === this.state.currentStep);
                    });

                        // æ›´æ–°æ­¥éª¤å†…å®¹
                        document.querySelectorAll('.step-visual').forEach((visual, index) => {
                        visual.classList.toggle('active', index === this.state.currentStep);
                    });

                        // æ›´æ–°æŒ‰é’®çŠ¶æ€
                        const prevBtn = document.getElementById('prevStep');
                        const nextBtn = document.getElementById('nextStep');

                        if (prevBtn) prevBtn.disabled = this.state.currentStep === 0;
                        if (nextBtn) nextBtn.disabled = this.state.currentStep === this.state.totalSteps - 1;
                    },

                        // ===== ä»£ç å±‚åˆ‡æ¢è®¾ç½® =====
                        setupCodeLayerTabs: function() {
                        document.querySelectorAll('.code-layer-tab').forEach(tab => {
                        tab.addEventListener('click', function() {
                        const layer = this.getAttribute('data-layer');

                        // æ›´æ–°æ ‡ç­¾çŠ¶æ€
                        document.querySelectorAll('.code-layer-tab').forEach(t => t.classList.remove('active'));
                        this.classList.add('active');

                        // æ›´æ–°å†…å®¹æ˜¾ç¤º
                        document.querySelectorAll('.code-layer-content').forEach(content => {
                        if (content.getAttribute('data-layer-content') === layer) {
                        content.classList.add('active');
                    } else {
                        content.classList.remove('active');
                    }
                    });
                    });
                    });
                    },

                        // ===== æ€è€ƒé¢˜äº¤äº’è®¾ç½® =====
                        setupThinkingQuestions: function() {
                        document.querySelectorAll('.think-option').forEach(option => {
                        option.addEventListener('click', function() {
                        const answer = this.getAttribute('data-answer');
                        const thinkCard = this.closest('.think-card');
                        const feedbackId = thinkCard.querySelector('.think-feedback').id;

                        // ç§»é™¤å…¶ä»–é€‰é¡¹çš„é€‰ä¸­çŠ¶æ€
                        this.parentElement.querySelectorAll('.think-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });

                        // æ·»åŠ é€‰ä¸­çŠ¶æ€
                        this.classList.add('selected');

                        // æ˜¾ç¤ºåé¦ˆ
                        window.lstmTutorial.showThinkFeedback(feedbackId, answer);
                    });
                    });
                    },

                        // ===== æ€è€ƒé¢˜åé¦ˆ =====
                        showThinkFeedback: function(feedbackId, answer) {
                        const feedbackElement = document.getElementById(feedbackId);
                        const feedbacks = {
                        'thinkFeedback1': {
                        'a': { correct: false, text: 'é€Ÿåº¦ç¡®å®æ˜¯ä¸ªé—®é¢˜ï¼Œä½†ä¸æ˜¯RNNå¤±è´¥çš„ä¸»è¦åŸå› ã€‚RNNçš„è®¡ç®—è™½ç„¶ä¸èƒ½å¹¶è¡ŒåŒ–ï¼Œä½†è¿™ä¸æ˜¯å¯¼è‡´é•¿åºåˆ—å»ºæ¨¡å¤±è´¥çš„æ ¹æœ¬åŸå› ã€‚' },
                        'b': { correct: true, text: 'ğŸ¯ å®Œå…¨æ­£ç¡®ï¼æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸æ˜¯RNNå¤„ç†é•¿åºåˆ—å¤±è´¥çš„æ ¹æœ¬åŸå› ã€‚å½“åºåˆ—å¾ˆé•¿æ—¶ï¼Œæ¢¯åº¦ä¼šæŒ‡æ•°çº§è¡°å‡ï¼Œä½¿å¾—ç½‘ç»œæ— æ³•å­¦ä¹ åˆ°é•¿è·ç¦»çš„ä¾èµ–å…³ç³»ã€‚LSTMæ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œè®¾è®¡çš„ã€‚' },
                        'c': { correct: false, text: 'RNNçš„å‚æ•°é‡å…¶å®ç›¸å¯¹è¾ƒå°‘ï¼Œè¿™ä¸æ˜¯ä¸»è¦é—®é¢˜ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œç°ä»£çš„Transformeræ¨¡å‹å‚æ•°é‡æ›´å¤§ï¼Œä½†æ€§èƒ½æ›´å¥½ã€‚' },
                        'd': { correct: false, text: 'æ¿€æ´»å‡½æ•°çš„é€‰æ‹©ç¡®å®ä¼šå½±å“æ€§èƒ½ï¼Œä½†å³ä½¿ä½¿ç”¨æœ€ä¼˜çš„æ¿€æ´»å‡½æ•°ï¼ŒRNNä»ç„¶æ— æ³•æ ¹æœ¬è§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚' }
                    },
                        'thinkFeedback2': {
                        'a': { correct: false, text: 'å¢åŠ æ¨¡å‹å®¹é‡ä¸æ˜¯ä¸»è¦ç›®çš„ã€‚å®é™…ä¸Šï¼Œåˆ†ç¦»è®¾è®¡æœ‰æ—¶ä¼šå¢åŠ è®¡ç®—å¤æ‚åº¦ã€‚' },
                        'b': { correct: true, text: 'ğŸ¯ æ­£ç¡®ï¼åˆ†ç¦»"ä»€ä¹ˆ"ï¼ˆå€™é€‰å€¼CÌƒ_tï¼‰å’Œ"å¤šå°‘"ï¼ˆæƒé‡i_tï¼‰è®©ç½‘ç»œå¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶ä¿¡æ¯æµã€‚è¿™å°±åƒæ˜¯åˆ†åˆ«å†³å®š"è¦å­˜å‚¨çš„å†…å®¹"å’Œ"å­˜å‚¨çš„é‡è¦ç¨‹åº¦"ï¼Œæä¾›äº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶ã€‚' },
                        'c': { correct: false, text: 'å®é™…ä¸Šè¿™æ ·çš„è®¾è®¡å¢åŠ äº†è®¡ç®—é‡ï¼Œéœ€è¦è®¡ç®—ä¸¤ä¸ªç‹¬ç«‹çš„å‘é‡ã€‚' },
                        'd': { correct: false, text: 'è™½ç„¶æœ‰ä¸€å®šçš„ç”Ÿç‰©å­¦åˆç†æ€§ï¼Œä½†ä¸»è¦è¿˜æ˜¯ä¸ºäº†æ›´å¥½çš„ä¿¡æ¯æ§åˆ¶èƒ½åŠ›ã€‚' }
                    }
                    };

                        const feedback = feedbacks[feedbackId]?.[answer];
                        if (feedback) {
                        feedbackElement.innerHTML = `
                    <div style="padding: 1rem; background: ${feedback.correct ? 'rgba(34, 197, 94, 0.1)' : 'rgba(239, 68, 68, 0.1)'}; border-radius: 0.5rem; border-left: 4px solid ${feedback.correct ? 'var(--accent-green)' : 'var(--accent-red)'};">
                        <p style="font-weight: bold; color: ${feedback.correct ? 'var(--accent-green)' : 'var(--accent-red)'}; margin-bottom: 0.5rem;">
                            ${feedback.correct ? 'âœ… æ­£ç¡®ï¼' : 'âŒ ä¸å¤ªå¯¹å“¦'}
                        </p>
                        <p style="line-height: 1.6;">${feedback.text}</p>
                    </div>
                `;
                        feedbackElement.classList.add('show');
                    }
                    },

                        // ===== å®æ—¶æ¼”ç¤ºè®¾ç½® =====
                        setupLiveDemo: function() {
                        const input = document.getElementById('sentimentInput');
                        const analyzeBtn = document.getElementById('analyzeBtn');
                        const predictionPreview = document.getElementById('predictionPreview');

                        if (input) {
                        // è®¾ç½®ä¿å­˜çš„ç”¨æˆ·è¾“å…¥
                        input.value = this.state.savedUserInput;

                        // å®æ—¶è¾“å…¥é¢„æµ‹
                        let timeoutId;
                        input.addEventListener('input', (e) => {
                        this.state.currentInputText = e.target.value;

                        // ä¿å­˜ç”¨æˆ·è¾“å…¥
                        localStorage.setItem('lstm-tutorial-input', e.target.value);

                        // é˜²æŠ–å¤„ç†
                        clearTimeout(timeoutId);
                        timeoutId = setTimeout(() => {
                        this.showNextCharPrediction(e.target.value);
                    }, 300);
                    });

                        // ç„¦ç‚¹äº‹ä»¶
                        input.addEventListener('focus', () => {
                        if (predictionPreview) {
                        predictionPreview.style.display = 'block';
                    }
                    });

                        input.addEventListener('blur', () => {
                        setTimeout(() => {
                        if (predictionPreview) {
                        predictionPreview.style.display = 'none';
                    }
                    }, 200);
                    });
                    }

                        if (analyzeBtn) {
                        analyzeBtn.addEventListener('click', async () => {
                        await this.analyzeSentiment();
                    });
                    }
                    },

                        // ===== ä¸‹ä¸€å­—ç¬¦é¢„æµ‹ =====
                        showNextCharPrediction: function(text) {
                        const predictionPreview = document.getElementById('predictionPreview');
                        if (!predictionPreview || !text.trim()) return;

                        // ç®€å•çš„ä¸‹ä¸€å­—ç¬¦é¢„æµ‹é€»è¾‘
                        const predictions = this.predictNextChar(text);

                        if (predictions.length > 0) {
                        const input = document.getElementById('sentimentInput');
                        const rect = input.getBoundingClientRect();

                        predictionPreview.style.left = (rect.left + text.length * 8) + 'px';
                        predictionPreview.style.top = (rect.top - 40) + 'px';
                        predictionPreview.innerHTML = `
                    <div style="font-size: 0.9rem;">
                        <div style="color: var(--accent-cyan); margin-bottom: 0.25rem;">å¯èƒ½çš„ä¸‹ä¸€ä¸ªå­—ï¼š</div>
                        ${predictions.map(p => `<span style="margin-right: 0.5rem; color: var(--accent-green);">${p}</span>`).join('')}
                    </div>
                `;
                        predictionPreview.style.display = 'block';
                    }
                    },

                        // ===== é¢„æµ‹ä¸‹ä¸€ä¸ªå­—ç¬¦ =====
                        predictNextChar: function(text) {
                        // ç®€åŒ–çš„è§„åˆ™åŸºé¢„æµ‹
                        const patterns = {
                        'è¿™ä¸ª': ['äº§å“', 'ä¸œè¥¿', 'æƒ³æ³•'],
                        'å¤ª': ['æ£’äº†', 'å¥½äº†', 'å·®äº†'],
                        'æˆ‘': ['å¾ˆ', 'éå¸¸', 'è§‰å¾—'],
                        'å¾ˆ': ['å¥½', 'æ£’', 'å–œæ¬¢'],
                        'éå¸¸': ['å¥½', 'æ£’', 'æ»¡æ„'],
                        'ä¸': ['é”™', 'å¥½', 'è¡Œ']
                    };

                        // è·å–æœ€åå‡ ä¸ªå­—ç¬¦
                        const lastChars = text.slice(-2);
                        return patterns[lastChars] || patterns[text.slice(-1)] || ['å¥½', 'çš„', 'äº†'];
                    },

                        // ===== æƒ…æ„Ÿåˆ†æ =====
                        analyzeSentiment: async function() {
                        const input = document.getElementById('sentimentInput');
                        const btn = document.getElementById('analyzeBtn');

                        if (!input || !btn) return;

                        const text = input.value.trim();
                        if (!text) {
                        alert('è¯·è¾“å…¥ä¸€äº›æ–‡å­—è¿›è¡Œåˆ†æï¼');
                        return;
                    }

                        // æ·»åŠ åŠ è½½åŠ¨ç”»
                        btn.innerHTML = '<span class="loading"></span> åˆ†æä¸­...';
                        btn.disabled = true;

                        // æ¨¡æ‹Ÿå¤„ç†å»¶è¿Ÿ
                        await new Promise(resolve => setTimeout(resolve, 1500));

                        // æ‰§è¡Œåˆ†æ
                        const result = this.performSentimentAnalysis(text);
                        this.updatePredictionResult(result);
                        this.drawGateActivations(text);
                        this.drawCellStateChart();
                        this.drawHiddenStateChart();

                        // å®æ—¶è”åŠ¨ï¼šé«˜äº®ç›¸å…³å…¬å¼éƒ¨åˆ†
                        this.triggerFormulaHighlight();

                        // æ¢å¤æŒ‰é’®
                        btn.innerHTML = 'åˆ†ææƒ…æ„Ÿ âœ¨';
                        btn.disabled = false;
                    },

                        // ===== æ‰§è¡Œæƒ…æ„Ÿåˆ†æ =====
                        performSentimentAnalysis: function(text) {
                        // æƒ…æ„Ÿè¯å…¸
                        const positiveWords = ['æ£’', 'å¥½', 'å–œæ¬¢', 'ä¼˜ç§€', 'æ¨è', 'æ»¡æ„', 'å®Œç¾', 'èµ', 'å¤ªå¥½äº†', 'ä¸é”™', 'å¾ˆæ£’', 'å–œçˆ±', 'å‰å®³'];
                        const negativeWords = ['å·®', 'ç³Ÿ', 'å¤±æœ›', 'ä¸å¥½', 'åƒåœ¾', 'è®¨åŒ', 'ç³Ÿç³•', 'çƒ‚', 'å¤ªå·®', 'ä¸è¡Œ', 'ä¸æ»¡', 'è®¨åŒ'];
                        const neutralWords = ['è¿˜è¡Œ', 'ä¸€èˆ¬', 'æ™®é€š', 'å‡‘åˆ', 'è¿˜å¯ä»¥'];

                        let score = 0.5; // åŸºç¡€åˆ†æ•°
                        let wordCount = 0;

                        // åˆ†ææ­£é¢è¯æ±‡
                        positiveWords.forEach(word => {
                        const count = (text.match(new RegExp(word, 'g')) || []).length;
                        score += count * 0.15;
                        wordCount += count;
                    });

                        // åˆ†æè´Ÿé¢è¯æ±‡
                        negativeWords.forEach(word => {
                        const count = (text.match(new RegExp(word, 'g')) || []).length;
                        score -= count * 0.2;
                        wordCount += count;
                    });

                        // åˆ†æä¸­æ€§è¯æ±‡
                        neutralWords.forEach(word => {
                        const count = (text.match(new RegExp(word, 'g')) || []).length;
                        score += count * 0.02;
                        wordCount += count;
                    });

                        // æ–‡æœ¬é•¿åº¦å½±å“
                        if (text.length > 10) score += 0.05;
                        if (text.includes('ï¼') || text.includes('!')) score += 0.1;
                        if (text.includes('ï¼Ÿ') || text.includes('?')) score -= 0.05;

                        // ç¡®ä¿åˆ†æ•°åœ¨åˆç†èŒƒå›´å†…
                        score = Math.max(0.1, Math.min(0.9, score));

                        return {
                        score: score,
                        confidence: Math.min(0.95, 0.6 + wordCount * 0.1),
                        wordCount: wordCount,
                        textLength: text.length
                    };
                    },

                        // ===== æ›´æ–°é¢„æµ‹ç»“æœ =====
                        updatePredictionResult: function(result) {
                        const resultDiv = document.getElementById('predictionResult');
                        if (!resultDiv) return;

                        const isPositive = result.score > 0.5;
                        const sentiment = isPositive ? 'æ­£é¢æƒ…æ„Ÿ' : 'è´Ÿé¢æƒ…æ„Ÿ';
                        const emoji = isPositive ? 'ğŸ˜Š' : 'ğŸ˜”';
                        const color = isPositive ? 'var(--accent-green)' : 'var(--accent-red)';

                        resultDiv.innerHTML = `
                <div style="font-size: 4rem; margin-bottom: 1rem;">${emoji}</div>
                <div style="font-size: 1.5rem; font-weight: bold; color: ${color}; margin-bottom: 0.5rem;">
                    ${sentiment}
                </div>
                <div style="font-size: 1.2rem; color: var(--text-secondary); margin-bottom: 1rem;">
                    ç½®ä¿¡åº¦ï¼š${Math.round(result.confidence * 100)}%
                </div>
                <div style="margin-top: 1.5rem;">
                    <div style="background: rgba(255, 255, 255, 0.1); border-radius: 0.5rem; height: 20px; overflow: hidden;">
                        <div style="height: 100%; width: ${result.confidence * 100}%; background: ${color}; transition: width 0.8s ease; border-radius: 0.5rem;"></div>
                    </div>
                </div>
                <div style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-muted);">
                    åˆ†æäº† ${result.textLength} ä¸ªå­—ç¬¦ï¼Œè¯†åˆ«å‡º ${result.wordCount} ä¸ªæƒ…æ„Ÿè¯æ±‡
                </div>
            `;
                    },

                        // ===== å…¬å¼è”åŠ¨é«˜äº® =====
                        triggerFormulaHighlight: function() {
                        // ä¾æ¬¡é«˜äº®å„ä¸ªé—¨çš„å…¬å¼
                        const symbols = ['f_t', 'i_t', 'o_t'];
                        let index = 0;

                        const highlightNext = () => {
                        if (index < symbols.length) {
                        this.highlightSymbol(symbols[index], true);
                        setTimeout(() => {
                        this.highlightSymbol(symbols[index], false);
                        index++;
                        setTimeout(highlightNext, 200);
                    }, 800);
                    }
                    };

                        setTimeout(highlightNext, 500);
                    },

                        // ===== ç»˜åˆ¶é—¨æ¿€æ´»å›¾ =====
                        drawGateActivations: function(text = '') {
                        const canvas = document.getElementById('gateChart');
                        if (!canvas) return;

                        const ctx = canvas.getContext('2d');
                        canvas.width = 400;
                        canvas.height = 250;

                        // æ¸…ç©ºç”»å¸ƒ
                        ctx.clearRect(0, 0, canvas.width, canvas.height);

                        // æ ¹æ®æ–‡æœ¬å†…å®¹æ¨¡æ‹Ÿé—¨æ¿€æ´»å€¼
                        const sentiment = this.performSentimentAnalysis(text);
                        const gates = {
                        'é—å¿˜é—¨': 0.3 + Math.random() * 0.4, // é—å¿˜ä¸é‡è¦ä¿¡æ¯
                        'è¾“å…¥é—¨': 0.6 + Math.random() * 0.3, // æ¥å—æ–°ä¿¡æ¯
                        'è¾“å‡ºé—¨': Math.max(0.4, sentiment.score) + Math.random() * 0.2 // åŸºäºæƒ…æ„Ÿè¾“å‡º
                    };

                        const colors = ['#f5576c', '#4facfe', '#43e97b'];
                        const labels = Object.keys(gates);
                        const values = Object.values(gates);

                        // ç»˜åˆ¶åŠ¨ç”»æŸ±çŠ¶å›¾
                        const barWidth = 80;
                        const spacing = 40;
                        const startX = (canvas.width - (barWidth * 3 + spacing * 2)) / 2;

                        values.forEach((value, i) => {
                        const x = startX + i * (barWidth + spacing);
                        const maxHeight = 150;
                        const height = value * maxHeight;
                        const y = canvas.height - height - 60;

                        // ç»˜åˆ¶æŸ±å­ï¼ˆå¸¦åŠ¨ç”»æ•ˆæœï¼‰
                        const gradient = ctx.createLinearGradient(0, y, 0, y + height);
                        gradient.addColorStop(0, colors[i]);
                        gradient.addColorStop(1, colors[i] + '80');

                        ctx.fillStyle = gradient;
                        ctx.fillRect(x, y, barWidth, height);

                        // ç»˜åˆ¶è¾¹æ¡†
                        ctx.strokeStyle = colors[i];
                        ctx.lineWidth = 2;
                        ctx.strokeRect(x, y, barWidth, height);

                        // ç»˜åˆ¶æ ‡ç­¾
                        ctx.fillStyle = '#f1f5f9';
                        ctx.font = 'bold 14px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(labels[i], x + barWidth/2, canvas.height - 35);

                        // ç»˜åˆ¶æ•°å€¼
                        ctx.fillStyle = colors[i];
                        ctx.font = 'bold 16px Arial';
                        ctx.fillText((value * 100).toFixed(0) + '%', x + barWidth/2, y - 10);
                    });

                        // ç»˜åˆ¶ç½‘æ ¼çº¿
                        ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                        ctx.lineWidth = 1;
                        for (let i = 0; i <= 5; i++) {
                        const y = canvas.height - 60 - (i * 30);
                        ctx.beginPath();
                        ctx.moveTo(startX - 10, y);
                        ctx.lineTo(startX + barWidth * 3 + spacing * 2 + 10, y);
                        ctx.stroke();
                    }
                    },

                        // ===== ç»˜åˆ¶ç»†èƒçŠ¶æ€å›¾ =====
                        drawCellStateChart: function() {
                        const canvas = document.getElementById('cellStateChart');
                        if (!canvas) return;

                        const ctx = canvas.getContext('2d');
                        canvas.width = canvas.offsetWidth || 300;
                        canvas.height = 200;

                        // æ¸…ç©ºç”»å¸ƒ
                        ctx.clearRect(0, 0, canvas.width, canvas.height);

                        // æ¨¡æ‹Ÿç»†èƒçŠ¶æ€å˜åŒ–
                        const steps = 20;
                        const values = [];
                        let current = 0;

                        for (let i = 0; i < steps; i++) {
                        // æ·»åŠ ä¸€äº›è¶‹åŠ¿å’Œéšæœºå˜åŒ–
                        const trend = Math.sin(i * 0.3) * 0.3;
                        const noise = (Math.random() - 0.5) * 0.2;
                        current = current * 0.7 + trend + noise;
                        values.push(current);
                    }

                        // ç»˜åˆ¶æŠ˜çº¿å›¾
                        const stepWidth = canvas.width / steps;
                        const midY = canvas.height / 2;
                        const scale = 60;

                        // èƒŒæ™¯ç½‘æ ¼
                        ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                        ctx.lineWidth = 1;
                        for (let i = 0; i <= 4; i++) {
                        const y = (canvas.height / 4) * i;
                        ctx.beginPath();
                        ctx.moveTo(0, y);
                        ctx.lineTo(canvas.width, y);
                        ctx.stroke();
                    }

                        // ç»˜åˆ¶ç»†èƒçŠ¶æ€çº¿
                        ctx.strokeStyle = '#fa709a';
                        ctx.lineWidth = 3;
                        ctx.beginPath();

                        values.forEach((value, i) => {
                        const x = i * stepWidth;
                        const y = midY - value * scale;

                        if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }

                        // ç»˜åˆ¶æ•°æ®ç‚¹
                        ctx.save();
                        ctx.fillStyle = '#fa709a';
                        ctx.beginPath();
                        ctx.arc(x, y, 3, 0, 2 * Math.PI);
                        ctx.fill();
                        ctx.restore();
                    });

                        ctx.stroke();

                        // ç»˜åˆ¶åŸºå‡†çº¿
                        ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
                        ctx.lineWidth = 1;
                        ctx.setLineDash([5, 5]);
                        ctx.beginPath();
                        ctx.moveTo(0, midY);
                        ctx.lineTo(canvas.width, midY);
                        ctx.stroke();
                        ctx.setLineDash([]);

                        // æ ‡ç­¾
                        ctx.fillStyle = '#f1f5f9';
                        ctx.font = '12px Arial';
                        ctx.fillText('æ—¶é—´ â†’', canvas.width - 50, canvas.height - 10);
                        ctx.save();
                        ctx.translate(15, canvas.height / 2);
                        ctx.rotate(-Math.PI / 2);
                        ctx.fillText('ç»†èƒçŠ¶æ€å€¼', 0, 0);
                        ctx.restore();
                    },

                        // ===== ç»˜åˆ¶éšè—çŠ¶æ€çƒ­å›¾ =====
                        drawHiddenStateChart: function() {
                        const canvas = document.getElementById('hiddenStateChart');
                        if (!canvas) return;

                        const ctx = canvas.getContext('2d');
                        canvas.width = canvas.offsetWidth || 300;
                        canvas.height = 200;

                        // æ¸…ç©ºç”»å¸ƒ
                        ctx.clearRect(0, 0, canvas.width, canvas.height);

                        // æ¨¡æ‹Ÿéšè—çŠ¶æ€çƒ­å›¾
                        const width = 24;
                        const height = 12;
                        const cellWidth = canvas.width / width;
                        const cellHeight = canvas.height / height;

                        for (let i = 0; i < width; i++) {
                        for (let j = 0; j < height; j++) {
                        const value = Math.random();

                        // ä½¿ç”¨æ›´ä¸°å¯Œçš„é¢œè‰²æ˜ å°„
                        let r, g, b;
                        if (value > 0.7) {
                        // é«˜æ¿€æ´» - çº¢è‰²
                        r = Math.floor(255 * value);
                        g = Math.floor(100 * (1 - value));
                        b = Math.floor(100 * (1 - value));
                    } else if (value > 0.3) {
                        // ä¸­ç­‰æ¿€æ´» - è“è‰²
                        r = Math.floor(100 * value);
                        g = Math.floor(150 * value);
                        b = Math.floor(255 * value);
                    } else {
                        // ä½æ¿€æ´» - ç»¿è‰²
                        r = Math.floor(100 * value);
                        g = Math.floor(200 * value);
                        b = Math.floor(150 * value);
                    }

                        ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;
                        ctx.fillRect(i * cellWidth, j * cellHeight, cellWidth - 1, cellHeight - 1);
                    }
                    }

                        // æ·»åŠ æ ‡ç­¾
                        ctx.fillStyle = '#f1f5f9';
                        ctx.font = '10px Arial';
                        ctx.fillText('éšè—å±‚ç»´åº¦ â†’', canvas.width - 80, canvas.height - 5);
                        ctx.save();
                        ctx.translate(5, 20);
                        ctx.rotate(-Math.PI / 2);
                        ctx.fillText('æ—¶é—´æ­¥', 0, 0);
                        ctx.restore();
                    },

                        // ===== é’¢ç´é”®ç›˜è®¾ç½® =====
                        setupPianoKeyboard: function() {
                        const keyboard = document.getElementById('pianoKeyboard');
                        if (!keyboard) return;

                        // æ¸…ç©ºç°æœ‰å†…å®¹
                        keyboard.innerHTML = '';

                        // åˆ›å»ºé’¢ç´é”®
                        const whiteKeys = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];
                        const blackKeys = ['C#', 'D#', null, 'F#', 'G#', 'A#', null];

                        for (let octave = 4; octave <= 5; octave++) {
                        for (let i = 0; i < whiteKeys.length; i++) {
                        // ç™½é”®
                        const whiteKey = document.createElement('div');
                        whiteKey.className = 'piano-key';
                        whiteKey.dataset.note = whiteKeys[i] + octave;
                        whiteKey.addEventListener('click', () => {
                        this.playNote(whiteKeys[i] + octave);
                    });
                        keyboard.appendChild(whiteKey);

                        // é»‘é”®
                        if (blackKeys[i]) {
                        const blackKey = document.createElement('div');
                        blackKey.className = 'piano-key black';
                        blackKey.dataset.note = blackKeys[i] + octave;
                        blackKey.addEventListener('click', () => {
                        this.playNote(blackKeys[i] + octave);
                    });
                        keyboard.appendChild(blackKey);
                    }
                    }
                    }
                    },

                        // ===== æ’­æ”¾éŸ³ç¬¦ =====
                        playNote: function(note) {
                        // éŸ³ç¬¦åˆ°é¢‘ç‡çš„æ˜ å°„
                        const noteFreq = {
                        'C4': 261.63, 'C#4': 277.18, 'D4': 293.66, 'D#4': 311.13,
                        'E4': 329.63, 'F4': 349.23, 'F#4': 369.99, 'G4': 392.00,
                        'G#4': 415.30, 'A4': 440.00, 'A#4': 466.16, 'B4': 493.88,
                        'C5': 523.25, 'C#5': 554.37, 'D5': 587.33, 'D#5': 622.25,
                        'E5': 659.25, 'F5': 698.46, 'F#5': 739.99, 'G5': 783.99,
                        'G#5': 830.61, 'A5': 880.00, 'A#5': 932.33, 'B5': 987.77
                    };

                        const freq = noteFreq[note];
                        if (!freq) return;

                        // æ·»åŠ åˆ°ç§å­æ—‹å¾‹
                        this.state.seedMelody.push(note);
                        this.updateSeedMelodyDisplay();

                        // é«˜äº®æŒ‰é”®
                        const key = document.querySelector(`[data-note="${note}"]`);
                        if (key) {
                        key.classList.add('active');
                        setTimeout(() => {
                        key.classList.remove('active');
                    }, 200);
                    }

                        // ä½¿ç”¨Web Audio APIæ’­æ”¾éŸ³ç¬¦
                        this.playSynthNote(freq);
                    },

                        // ===== åˆæˆéŸ³é¢‘æ’­æ”¾ =====
                        playSynthNote: function(frequency) {
                        if (!window.AudioContext && !window.webkitAudioContext) return;

                        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();

                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);

                        oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                        oscillator.type = 'sine';

                        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 0.5);
                    },

                        // ===== æ›´æ–°ç§å­æ—‹å¾‹æ˜¾ç¤º =====
                        updateSeedMelodyDisplay: function() {
                        const display = document.getElementById('seedMelody');
                        if (display) {
                        if (this.state.seedMelody.length === 0) {
                        display.textContent = '[]';
                    } else {
                        display.textContent = `[${this.state.seedMelody.join(', ')}]`;
                    }
                    }
                    },

                        // ===== æ¸…ç©ºæ—‹å¾‹ =====
                        clearMelody: function() {
                        this.state.seedMelody = [];
                        this.updateSeedMelodyDisplay();
                    },

                        // ===== ä»ç§å­ç”Ÿæˆæ—‹å¾‹ =====
                        generateFromSeed: function() {
                        if (this.state.seedMelody.length === 0) {
                        alert('è¯·å…ˆåœ¨é’¢ç´ä¸Šè¾“å…¥ä¸€äº›éŸ³ç¬¦ä½œä¸ºç§å­æ—‹å¾‹ï¼');
                        return;
                    }

                        // åŸºäºç§å­ç”Ÿæˆæ›´é•¿çš„æ—‹å¾‹
                        const generatedMelody = this.extendMelody(this.state.seedMelody);
                        this.visualizeMelody(generatedMelody, 'ç§å­ç»­å†™');
                    },

                        // ===== æ‰©å±•æ—‹å¾‹ =====
                        extendMelody: function(seed) {
                        const allNotes = ['C4', 'D4', 'E4', 'F4', 'G4', 'A4', 'B4', 'C5', 'D5', 'E5', 'F5', 'G5'];
                        const extended = [...seed];

                        // ç®€å•çš„é©¬å°”å¯å¤«é“¾ç”Ÿæˆ
                        for (let i = 0; i < 8; i++) {
                        const lastNote = extended[extended.length - 1];
                        const lastIndex = allNotes.indexOf(lastNote);

                        if (lastIndex !== -1) {
                        // å€¾å‘äºé€‰æ‹©ç›¸é‚»çš„éŸ³ç¬¦
                        const choices = [
                        lastIndex - 1,
                        lastIndex,
                        lastIndex + 1,
                        lastIndex + 2
                        ].filter(idx => idx >= 0 && idx < allNotes.length);

                        const nextIndex = choices[Math.floor(Math.random() * choices.length)];
                        extended.push(allNotes[nextIndex]);
                    } else {
                        extended.push(allNotes[Math.floor(Math.random() * allNotes.length)]);
                    }
                    }

                        return extended;
                    },

                        // ===== ç”Ÿæˆé¢„è®¾æ—‹å¾‹ =====
                        generateMelody: function(mood) {
                        const melodyPatterns = {
                        happy: ['C4', 'E4', 'G4', 'C5', 'G4', 'E4', 'C4', 'E4', 'G4', 'C5'],
                        sad: ['A4', 'F4', 'D4', 'F4', 'A4', 'G4', 'F4', 'E4', 'D4', 'C4'],
                        energetic: ['C4', 'C4', 'G4', 'G4', 'A4', 'A4', 'G4', 'F4', 'F4', 'E4'],
                        calm: ['C4', 'D4', 'E4', 'F4', 'E4', 'D4', 'C4', 'D4', 'E4', 'C4']
                    };

                        const melody = melodyPatterns[mood] || melodyPatterns.happy;
                        this.visualizeMelody(melody, this.getMoodTitle(mood));
                    },

                        // ===== è·å–æƒ…ç»ªæ ‡é¢˜ =====
                        getMoodTitle: function(mood) {
                        const titles = {
                        happy: 'ğŸ˜Š æ¬¢å¿«æ—‹å¾‹',
                        sad: 'ğŸ˜¢ å¿§ä¼¤æ—‹å¾‹',
                        energetic: 'âš¡ æ¿€æ˜‚æ—‹å¾‹',
                        calm: 'ğŸŒŠ å¹³é™æ—‹å¾‹'
                    };
                        return titles[mood] || 'ğŸµ ç”Ÿæˆæ—‹å¾‹';
                    },

                        // ===== å¯è§†åŒ–æ—‹å¾‹ =====
                        visualizeMelody: function(melody, title = 'ç”Ÿæˆçš„æ—‹å¾‹') {
                        const canvas = document.getElementById('musicCanvas');
                        if (!canvas) return;

                        const ctx = canvas.getContext('2d');
                        canvas.width = canvas.offsetWidth || 800;
                        canvas.height = 300;

                        // æ¸…ç©ºç”»å¸ƒ
                        ctx.clearRect(0, 0, canvas.width, canvas.height);

                        if (melody.length === 0) return;

                        // éŸ³ç¬¦æ˜ å°„åˆ°Yåæ ‡
                        const noteToY = {
                        'C4': 250, 'C#4': 240, 'D4': 230, 'D#4': 220, 'E4': 210,
                        'F4': 200, 'F#4': 190, 'G4': 180, 'G#4': 170, 'A4': 160,
                        'A#4': 150, 'B4': 140, 'C5': 130, 'C#5': 120, 'D5': 110,
                        'D#5': 100, 'E5': 90, 'F5': 80, 'F#5': 70, 'G5': 60
                    };

                        const noteWidth = canvas.width / melody.length;

                        // ç»˜åˆ¶äº”çº¿è°±èƒŒæ™¯
                        ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
                        ctx.lineWidth = 1;
                        for (let i = 0; i < 5; i++) {
                        const y = 160 + i * 20;
                        ctx.beginPath();
                        ctx.moveTo(0, y);
                        ctx.lineTo(canvas.width, y);
                        ctx.stroke();
                    }

                        // ç»˜åˆ¶æ ‡é¢˜
                        ctx.fillStyle = '#f1f5f9';
                        ctx.font = 'bold 18px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(title, canvas.width / 2, 30);

                        // ç»˜åˆ¶éŸ³ç¬¦
                        melody.forEach((note, i) => {
                        const x = i * noteWidth + noteWidth / 2;
                        const y = noteToY[note] || 160;

                        // ç»˜åˆ¶éŸ³ç¬¦
                        ctx.beginPath();
                        ctx.arc(x, y, 8, 0, 2 * Math.PI);
                        ctx.fillStyle = this.getNoteColor(note);
                        ctx.fill();
                        ctx.strokeStyle = 'white';
                        ctx.lineWidth = 2;
                        ctx.stroke();

                        // è¿æ¥çº¿
                        if (i > 0) {
                        const prevY = noteToY[melody[i-1]] || 160;
                        ctx.beginPath();
                        ctx.moveTo((i-1) * noteWidth + noteWidth / 2, prevY);
                        ctx.lineTo(x, y);
                        ctx.strokeStyle = this.getNoteColor(note);
                        ctx.lineWidth = 3;
                        ctx.stroke();
                    }

                        // éŸ³ç¬¦æ ‡ç­¾
                        ctx.fillStyle = 'white';
                        ctx.font = '10px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(note, x, y + 25);
                    });

                        // æ’­æ”¾æ—‹å¾‹
                        this.playMelody(melody);
                    },

                        // ===== è·å–éŸ³ç¬¦é¢œè‰² =====
                        getNoteColor: function(note) {
                        const colors = {
                        'C': '#ff4757', 'D': '#ff6b7a', 'E': '#ffa502',
                        'F': '#ffda79', 'G': '#7bed9f', 'A': '#5352ed',
                        'B': '#a4b0be'
                    };
                        return colors[note[0]] || '#70a1ff';
                    },

                        // ===== æ’­æ”¾æ—‹å¾‹ =====
                        playMelody: function(melody) {
                        if (!melody || melody.length === 0) return;

                        melody.forEach((note, index) => {
                        setTimeout(() => {
                        this.playNote(note);
                    }, index * 400);
                    });
                    },

                        // ===== ä¸»é¢˜æ§åˆ¶è®¾ç½® =====
                        setupThemeControls: function() {
                        const themeToggle = document.getElementById('toggle-theme');
                        const animationToggle = document.getElementById('toggle-animations');

                        if (themeToggle) {
                        themeToggle.addEventListener('click', () => {
                        document.body.classList.toggle('light-theme');
                        // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šä¸»é¢˜åˆ‡æ¢é€»è¾‘
                    });
                    }

                        if (animationToggle) {
                        animationToggle.addEventListener('click', () => {
                        this.state.animationsEnabled = !this.state.animationsEnabled;
                        document.body.style.setProperty('--animation-duration',
                        this.state.animationsEnabled ? '0.3s' : '0s');

                        animationToggle.innerHTML = this.state.animationsEnabled ?
                        '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M10 8l6 4-6 4V8z"></path></svg>' :
                        '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><rect x="9" y="9" width="6" height="6"></rect></svg>';
                    });
                    }
                    },

                        // ===== æ¢¯åº¦æ¶ˆå¤±åŠ¨ç”» =====
                        animateGradientVanishing: function() {
                        const canvas = document.getElementById('gradientVanishingCanvas');
                        if (!canvas) return;

                        const ctx = canvas.getContext('2d');
                        canvas.width = 900;
                        canvas.height = 300;

                        let step = 0;
                        const totalSteps = 20;

                        const animate = () => {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);

                        // ç»˜åˆ¶æ ‡é¢˜
                        ctx.fillStyle = '#f1f5f9';
                        ctx.font = 'bold 16px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('RNNæ¢¯åº¦ä¼ æ’­ï¼šæ¯å±‚è¡°å‡90%', canvas.width / 2, 30);

                        // ç»˜åˆ¶æ—¶é—´æ­¥
                        const stepWidth = canvas.width / totalSteps;

                        for (let i = 0; i <= step; i++) {
                        const x = i * stepWidth;
                        const gradientStrength = Math.pow(0.9, i); // æ¯æ­¥è¡°å‡90%

                        // ç»˜åˆ¶æ¢¯åº¦å¼ºåº¦æ¡
                        const barHeight = gradientStrength * 200;
                        ctx.fillStyle = `rgba(239, 68, 68, ${gradientStrength})`;
                        ctx.fillRect(x + 5, 250 - barHeight, stepWidth - 10, barHeight);

                        // ç»˜åˆ¶è¾¹æ¡†
                        ctx.strokeStyle = '#ef4444';
                        ctx.lineWidth = 1;
                        ctx.strokeRect(x + 5, 250 - barHeight, stepWidth - 10, barHeight);

                        // ç»˜åˆ¶æ—¶é—´æ­¥æ ‡ç­¾
                        ctx.fillStyle = '#f1f5f9';
                        ctx.font = '12px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(`t=${i+1}`, x + stepWidth/2, 275);

                        // ç»˜åˆ¶æ•°å€¼
                        ctx.fillStyle = gradientStrength > 0.1 ? '#f1f5f9' : '#ef4444';
                        ctx.font = '10px Arial';
                        ctx.fillText(gradientStrength.toFixed(3), x + stepWidth/2, 150);
                    }

                        // ç»˜åˆ¶è­¦å‘Šä¿¡æ¯
                        if (step >= 10) {
                        ctx.fillStyle = '#ef4444';
                        ctx.font = 'bold 14px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('æ¢¯åº¦å‡ ä¹æ¶ˆå¤±ï¼æ— æ³•å­¦ä¹ é•¿æœŸä¾èµ–', canvas.width / 2, canvas.height - 20);
                    }

                        step++;
                        if (step <= totalSteps) {
                        setTimeout(animate, 300);
                    }
                    };

                        animate();
                    },

                        // ===== é‡ç½®æ¢¯åº¦åŠ¨ç”» =====
                        resetGradientAnimation: function() {
                        const canvas = document.getElementById('gradientVanishingCanvas');
                        if (!canvas) return;

                        const ctx = canvas.getContext('2d');
                        ctx.clearRect(0, 0, canvas.width, canvas.height);

                        // ç»˜åˆ¶åˆå§‹çŠ¶æ€
                        ctx.fillStyle = '#f1f5f9';
                        ctx.font = 'bold 16px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('ç‚¹å‡»"æ¼”ç¤ºæ¢¯åº¦æ¶ˆå¤±"æŒ‰é’®å¼€å§‹', canvas.width / 2, canvas.height / 2);
                    },

                        // ===== LSTMå•å…ƒäº¤äº’åŠŸèƒ½ =====
                        highlightForgetGate: function() {
                        this.updateGateDescription('forget', '#f5576c');
                        this.drawLSTMHighlight('forget');
                    },

                        highlightInputGate: function() {
                        this.updateGateDescription('input', '#4facfe');
                        this.drawLSTMHighlight('input');
                    },

                        highlightOutputGate: function() {
                        this.updateGateDescription('output', '#43e97b');
                        this.drawLSTMHighlight('output');
                    },

                        animateDataFlow: function() {
                        this.updateGateDescription('flow', '#a8edea');
                        this.drawLSTMDataFlow();
                    },

                        // ===== æ›´æ–°é—¨æè¿° =====
                        updateGateDescription: function(gateType, color) {
                        const descriptions = {
                        forget: {
                        title: 'é—å¿˜é—¨ (Forget Gate)',
                        formula: 'f_t = Ïƒ(W_f Â· [h_{t-1}, x_t] + b_f)',
                        description: 'é—å¿˜é—¨å†³å®šä»ç»†èƒçŠ¶æ€ä¸­ä¸¢å¼ƒä»€ä¹ˆä¿¡æ¯ã€‚å®ƒæŸ¥çœ‹ h_{t-1} å’Œ x_tï¼Œè¾“å‡ºä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„æ•°å€¼ç»™æ¯ä¸ªç»†èƒçŠ¶æ€ã€‚1 è¡¨ç¤º"å®Œå…¨ä¿ç•™"ï¼Œ0 è¡¨ç¤º"å®Œå…¨ä¸¢å¼ƒ"ã€‚è¿™ä¸ªé—¨è®©LSTMèƒ½å¤Ÿä¸»åŠ¨é—å¿˜ä¸å†é‡è¦çš„å†å²ä¿¡æ¯ã€‚',
                        keyPoints: ['é€‰æ‹©æ€§é—å¿˜è¿‡æ—¶ä¿¡æ¯', 'è¾“å‡ºèŒƒå›´[0,1]', '0=å®Œå…¨é—å¿˜ï¼Œ1=å®Œå…¨ä¿ç•™', 'Sigmoidæ¿€æ´»å‡½æ•°']
                    },
                        input: {
                        title: 'è¾“å…¥é—¨ (Input Gate)',
                        formula: 'i_t = Ïƒ(W_i Â· [h_{t-1}, x_t] + b_i)',
                        description: 'è¾“å…¥é—¨å†³å®šä»€ä¹ˆæ–°ä¿¡æ¯è¦å­˜å‚¨åˆ°ç»†èƒçŠ¶æ€ä¸­ã€‚å®ƒåŒ…å«ä¸¤éƒ¨åˆ†ï¼šsigmoid å±‚å†³å®šå“ªäº›å€¼è¦æ›´æ–°ï¼Œtanh å±‚åˆ›å»ºæ–°çš„å€™é€‰å€¼å‘é‡ã€‚ä¸¤è€…ç»“åˆå®ç°é€‰æ‹©æ€§çš„ä¿¡æ¯å­˜å‚¨ã€‚',
                        keyPoints: ['æ§åˆ¶æ–°ä¿¡æ¯çš„é‡è¦æ€§', 'ä¸å€™é€‰å€¼é…åˆå·¥ä½œ', 'å®ç°é€‰æ‹©æ€§æ›´æ–°', 'é˜²æ­¢ä¿¡æ¯è¿‡è½½']
                    },
                        output: {
                        title: 'è¾“å‡ºé—¨ (Output Gate)',
                        formula: 'o_t = Ïƒ(W_o Â· [h_{t-1}, x_t] + b_o)',
                        description: 'è¾“å‡ºé—¨å†³å®šåŸºäºç»†èƒçŠ¶æ€è¾“å‡ºä»€ä¹ˆã€‚é¦–å…ˆè¿è¡Œ sigmoid å±‚å†³å®šç»†èƒçŠ¶æ€çš„å“ªäº›éƒ¨åˆ†è¦è¾“å‡ºï¼Œç„¶åå°†ç»†èƒçŠ¶æ€é€šè¿‡ tanh å¹¶ä¹˜ä»¥ sigmoid çš„è¾“å‡ºï¼Œå¾—åˆ°æœ€ç»ˆçš„éšè—çŠ¶æ€ã€‚',
                        keyPoints: ['æ§åˆ¶è¾“å‡ºä¿¡æ¯', 'åŸºäºç»†èƒçŠ¶æ€è¿‡æ»¤', 'tanhå‹ç¼©åˆ°[-1,1]', 'äº§ç”Ÿæœ€ç»ˆéšè—çŠ¶æ€']
                    },
                        flow: {
                        title: 'æ•°æ®æµåŠ¨ (Data Flow)',
                        formula: 'C_t = f_t âŠ™ C_{t-1} + i_t âŠ™ CÌƒ_t',
                        description: 'è§‚å¯Ÿæ•°æ®å¦‚ä½•åœ¨LSTMä¸­æµåŠ¨ï¼šè¾“å…¥ç»è¿‡ä¸‰ä¸ªé—¨çš„å¤„ç†ï¼Œç»†èƒçŠ¶æ€åœ¨é«˜é€Ÿå…¬è·¯ä¸Šçº¿æ€§ä¼ æ’­ï¼Œæœ€ç»ˆé€šè¿‡è¾“å‡ºé—¨äº§ç”Ÿéšè—çŠ¶æ€ã€‚è¿™ç§è®¾è®¡ç¡®ä¿äº†æ¢¯åº¦çš„ç¨³å®šä¼ æ’­ã€‚',
                        keyPoints: ['ä¿¡æ¯é«˜é€Ÿå…¬è·¯', 'çº¿æ€§ç»†èƒçŠ¶æ€ä¼ æ’­', 'ä¸‰é—¨ååŒå·¥ä½œ', 'æ¢¯åº¦ç¨³å®šä¼ æ’­']
                    }
                    };

                        const desc = descriptions[gateType];
                        if (!desc) return;

                        const descriptionDiv = document.getElementById('gateDescription');
                        if (descriptionDiv) {
                        descriptionDiv.innerHTML = `
                    <div style="border-left: 4px solid ${color}; padding-left: 1rem;">
                        <h3 style="color: ${color}; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            ${desc.title}
                            <span style="font-size: 0.8rem; background: rgba(255,255,255,0.1); padding: 0.25rem 0.5rem; border-radius: 0.25rem;">å®æ—¶åˆ†æ</span>
                        </h3>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                            <code style="font-size: 1.1rem; color: ${color};">${desc.formula}</code>
                        </div>
                        <p style="line-height: 1.8; margin-bottom: 1rem;">${desc.description}</p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">
                            ${desc.keyPoints.map(point => `
                                <div style="background: rgba(255,255,255,0.05); padding: 0.5rem; border-radius: 0.25rem; font-size: 0.9rem;">
                                    â€¢ ${point}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                    }
                    },

                        // ===== ç»˜åˆ¶LSTMé«˜äº® =====
                        drawLSTMHighlight: function(gateType) {
                        const canvas = document.getElementById('lstmCanvas');
                        if (!canvas) return;

                        const ctx = canvas.getContext('2d');
                        canvas.width = canvas.offsetWidth;
                        canvas.height = 500;

                        // æ¸…ç©ºç”»å¸ƒ
                        ctx.clearRect(0, 0, canvas.width, canvas.height);

                        // ç»˜åˆ¶åŸºæœ¬LSTMç»“æ„
                        this.drawBasicLSTMStructure(ctx, canvas.width, canvas.height);

                        // é«˜äº®ç‰¹å®šé—¨
                        this.highlightSpecificGate(ctx, canvas.width, canvas.height, gateType);
                    },

                        // ===== ç»˜åˆ¶åŸºæœ¬LSTMç»“æ„ =====
                        drawBasicLSTMStructure: function(ctx, width, height) {
                        // ç»˜åˆ¶ç»†èƒçŠ¶æ€é«˜é€Ÿå…¬è·¯
                        ctx.strokeStyle = '#a8edea';
                        ctx.lineWidth = 6;
                        ctx.beginPath();
                        ctx.moveTo(50, height/2);
                        ctx.lineTo(width - 50, height/2);
                        ctx.stroke();

                        // æ·»åŠ ç®­å¤´
                        this.drawArrow(ctx, width - 80, height/2, width - 50, height/2, '#a8edea');

                        // ç»˜åˆ¶ç»†èƒçŠ¶æ€æ ‡ç­¾
                        ctx.fillStyle = '#a8edea';
                        ctx.font = 'bold 16px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('ç»†èƒçŠ¶æ€ C_t', width/2, height/2 - 20);

                        // ç»˜åˆ¶é—¨çš„ä½ç½®
                        const gates = [
                    { name: 'é—å¿˜é—¨', x: width * 0.25, y: height * 0.25, color: '#f5576c', symbol: 'f_t' },
                    { name: 'è¾“å…¥é—¨', x: width * 0.5, y: height * 0.25, color: '#4facfe', symbol: 'i_t' },
                    { name: 'è¾“å‡ºé—¨', x: width * 0.75, y: height * 0.75, color: '#43e97b', symbol: 'o_t' }
                        ];

                        gates.forEach(gate => {
                        // ç»˜åˆ¶é—¨åœ†åœˆ
                        ctx.beginPath();
                        ctx.arc(gate.x, gate.y, 35, 0, 2 * Math.PI);
                        ctx.fillStyle = gate.color + '40';
                        ctx.fill();
                        ctx.strokeStyle= gate.color;
                        ctx.lineWidth = 3;
                        ctx.stroke();

                        // ç»˜åˆ¶é—¨æ ‡ç­¾
                        ctx.fillStyle = 'white';
                        ctx.font = 'bold 14px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(gate.symbol, gate.x, gate.y + 5);

                        // ç»˜åˆ¶é—¨åç§°
                        ctx.fillStyle = gate.color;
                        ctx.font = '12px Arial';
                        ctx.fillText(gate.name, gate.x, gate.y + 55);
                    });

                        // ç»˜åˆ¶è¾“å…¥ç®­å¤´
                        this.drawArrow(ctx, 50, height * 0.8, width * 0.2, height * 0.6, '#ffffff');
                        ctx.fillStyle = '#ffffff';
                        ctx.font = '14px Arial';
                        ctx.textAlign = 'left';
                        ctx.fillText('x_t', 60, height * 0.8 + 5);

                        // ç»˜åˆ¶è¾“å‡ºç®­å¤´
                        this.drawArrow(ctx, width * 0.8, height * 0.8, width - 50, height * 0.8, '#ffffff');
                        ctx.fillStyle = '#ffffff';
                        ctx.font = '14px Arial';
                        ctx.textAlign = 'right';
                        ctx.fillText('h_t', width - 60, height * 0.8 + 5);
                    },

                        // ===== ç»˜åˆ¶ç®­å¤´ =====
                        drawArrow: function(ctx, fromX, fromY, toX, toY, color) {
                        const headlen = 10;
                        const dx = toX - fromX;
                        const dy = toY - fromY;
                        const angle = Math.atan2(dy, dx);

                        ctx.strokeStyle = color;
                        ctx.fillStyle = color;
                        ctx.lineWidth = 2;

                        // ç»˜åˆ¶çº¿æ®µ
                        ctx.beginPath();
                        ctx.moveTo(fromX, fromY);
                        ctx.lineTo(toX, toY);
                        ctx.stroke();

                        // ç»˜åˆ¶ç®­å¤´å¤´éƒ¨
                        ctx.beginPath();
                        ctx.moveTo(toX, toY);
                        ctx.lineTo(toX - headlen * Math.cos(angle - Math.PI / 6), toY - headlen * Math.sin(angle - Math.PI / 6));
                        ctx.lineTo(toX - headlen * Math.cos(angle + Math.PI / 6), toY - headlen * Math.sin(angle + Math.PI / 6));
                        ctx.closePath();
                        ctx.fill();
                    },

                        // ===== é«˜äº®ç‰¹å®šé—¨ =====
                        highlightSpecificGate: function(ctx, width, height, gateType) {
                        const gates = {
                        forget: { x: width * 0.25, y: height * 0.25, color: '#f5576c' },
                        input: { x: width * 0.5, y: height * 0.25, color: '#4facfe' },
                        output: { x: width * 0.75, y: height * 0.75, color: '#43e97b' }
                    };

                        const gate = gates[gateType];
                        if (!gate) return;

                        // ç»˜åˆ¶é«˜äº®æ•ˆæœ
                        ctx.shadowColor = gate.color;
                        ctx.shadowBlur = 20;

                        ctx.beginPath();
                        ctx.arc(gate.x, gate.y, 45, 0, 2 * Math.PI);
                        ctx.strokeStyle = gate.color;
                        ctx.lineWidth = 4;
                        ctx.stroke();

                        // é‡ç½®é˜´å½±
                        ctx.shadowColor = 'transparent';
                        ctx.shadowBlur = 0;

                        // æ·»åŠ è„‰å†²åŠ¨ç”»æ•ˆæœ
                        let pulse = 0;
                        const pulseAnimation = () => {
                        if (pulse < 20) {
                        ctx.beginPath();
                        ctx.arc(gate.x, gate.y, 45 + pulse * 2, 0, 2 * Math.PI);
                        ctx.strokeStyle = gate.color + Math.floor((1 - pulse / 20) * 255).toString(16).padStart(2, '0');
                        ctx.lineWidth = 2;
                        ctx.stroke();
                        pulse++;
                        requestAnimationFrame(pulseAnimation);
                    }
                    };
                        pulseAnimation();
                    },

                        // ===== ç»˜åˆ¶LSTMæ•°æ®æµ =====
                        drawLSTMDataFlow: function() {
                        const canvas = document.getElementById('lstmCanvas');
                        if (!canvas) return;

                        const ctx = canvas.getContext('2d');
                        canvas.width = canvas.offsetWidth;
                        canvas.height = 500;

                        // æ¸…ç©ºç”»å¸ƒ
                        ctx.clearRect(0, 0, canvas.width, canvas.height);

                        // ç»˜åˆ¶åŸºæœ¬ç»“æ„
                        this.drawBasicLSTMStructure(ctx, canvas.width, canvas.height);

                        // åŠ¨ç”»æ˜¾ç¤ºæ•°æ®æµ
                        this.animateDataFlowPath(ctx, canvas.width, canvas.height);
                    },

                        // ===== åŠ¨ç”»æ•°æ®æµè·¯å¾„ =====
                        animateDataFlowPath: function(ctx, width, height) {
                        const paths = [
                        // è¾“å…¥åˆ°é—å¿˜é—¨
                    { from: { x: width * 0.2, y: height * 0.6 }, to: { x: width * 0.25, y: height * 0.25 }, color: '#f5576c', delay: 0 },
                        // è¾“å…¥åˆ°è¾“å…¥é—¨
                    { from: { x: width * 0.2, y: height * 0.6 }, to: { x: width * 0.5, y: height * 0.25 }, color: '#4facfe', delay: 500 },
                        // ç»†èƒçŠ¶æ€æ›´æ–°
                    { from: { x: width * 0.25, y: height * 0.5 }, to: { x: width * 0.5, y: height * 0.5 }, color: '#a8edea', delay: 1000 },
                        // è¾“å‡ºé—¨
                    { from: { x: width * 0.5, y: height * 0.5 }, to: { x: width * 0.75, y: height * 0.75 }, color: '#43e97b', delay: 1500 }
                        ];

                        paths.forEach((path, index) => {
                        setTimeout(() => {
                        this.animatePath(ctx, path.from, path.to, path.color);
                    }, path.delay);
                    });
                    },

                        // ===== åŠ¨ç”»è·¯å¾„ =====
                        animatePath: function(ctx, from, to, color) {
                        let progress = 0;
                        const duration = 1000; // 1ç§’

                        const animate = (timestamp) => {
                        if (!this.startTime) this.startTime = timestamp;
                        progress = (timestamp - this.startTime) / duration;

                        if (progress <= 1) {
                        const currentX = from.x + (to.x - from.x) * progress;
                        const currentY = from.y + (to.y - from.y) * progress;

                        // ç»˜åˆ¶æµåŠ¨çš„ç‚¹
                        ctx.beginPath();
                        ctx.arc(currentX, currentY, 8, 0, 2 * Math.PI);
                        ctx.fillStyle = color;
                        ctx.shadowColor = color;
                        ctx.shadowBlur = 15;
                        ctx.fill();
                        ctx.shadowColor = 'transparent';
                        ctx.shadowBlur = 0;

                        requestAnimationFrame(animate);
                    } else {
                        this.startTime = null;
                    }
                    };

                        requestAnimationFrame(animate);
                    },

                        // ===== åˆ›å»ºèƒŒæ™¯åŠ¨ç”» =====
                        createBackgroundAnimation: function() {
                        const bgAnimation = document.getElementById('bgAnimation');
                        if (!bgAnimation) return;

                        // åˆ›å»ºæµ®åŠ¨ç²’å­
                        for (let i = 0; i < 20; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'bg-particle';
                        particle.style.left = Math.random() * 100 + '%';
                        particle.style.animationDelay = Math.random() * 20 + 's';
                        particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                        bgAnimation.appendChild(particle);
                    }
                    },

                        // ===== åˆå§‹åŒ–ç»„ä»¶ =====
                        initializeComponents: function() {
                        // åˆå§‹åŒ–è¯­æ³•é«˜äº®
                        if (typeof hljs !== 'undefined') {
                        hljs.highlightAll();
                    }

                        // åˆå§‹åŒ–æ•°å­¦å…¬å¼æ¸²æŸ“
                        if (typeof katex !== 'undefined') {
                        document.querySelectorAll('script[type="math/tex"]').forEach(element => {
                        const math = element.textContent;
                        const rendered = katex.renderToString(math, {
                        displayMode: element.type === 'math/tex; mode=display'
                    });
                        const wrapper = document.createElement('span');
                        wrapper.innerHTML = rendered;
                        element.parentNode.replaceChild(wrapper, element);
                    });
                    }

                        // åˆå§‹åŒ–å›¾è¡¨
                        this.initializeCharts();

                        // è®¾ç½®é»˜è®¤çŠ¶æ€
                        this.updateStep();
                    },

                        // ===== åˆå§‹åŒ–å›¾è¡¨ =====
                        initializeCharts: function() {
                        // ç»˜åˆ¶åˆå§‹çš„é—¨æ¿€æ´»å›¾
                        this.drawGateActivations();

                        // ç»˜åˆ¶åˆå§‹çš„ç»†èƒçŠ¶æ€å›¾
                        this.drawCellStateChart();

                        // ç»˜åˆ¶åˆå§‹çš„éšè—çŠ¶æ€å›¾
                        this.drawHiddenStateChart();

                        // åˆå§‹åŒ–LSTMæ¶æ„å›¾
                        this.drawLSTMArchitecture();
                        this.drawGRUArchitecture();
                    },

                        // ===== ç»˜åˆ¶LSTMæ¶æ„å›¾ =====
                        drawLSTMArchitecture: function() {
                        const canvas = document.getElementById('lstmArchCanvas');
                        if (!canvas) return;

                        const ctx = canvas.getContext('2d');
                        canvas.width = 300;
                        canvas.height = 200;

                        // æ¸…ç©ºç”»å¸ƒ
                        ctx.clearRect(0, 0, canvas.width, canvas.height);

                        // ç»˜åˆ¶LSTMç»“æ„ç®€å›¾
                        const centerX = canvas.width / 2;
                        const centerY = canvas.height / 2;

                        // ç»†èƒçŠ¶æ€çº¿
                        ctx.strokeStyle = '#a8edea';
                        ctx.lineWidth = 4;
                        ctx.beginPath();
                        ctx.moveTo(20, centerY);
                        ctx.lineTo(280, centerY);
                        ctx.stroke();

                        // ä¸‰ä¸ªé—¨
                        const gates = [
                    { x: centerX - 60, y: centerY - 50, color: '#f5576c', label: 'f' },
                    { x: centerX, y: centerY - 50, color: '#4facfe', label: 'i' },
                    { x: centerX + 60, y: centerY + 50, color: '#43e97b', label: 'o' }
                        ];

                        gates.forEach(gate => {
                        ctx.beginPath();
                        ctx.arc(gate.x, gate.y, 15, 0, 2 * Math.PI);
                        ctx.fillStyle = gate.color;
                        ctx.fill();
                        ctx.strokeStyle = 'white';
                        ctx.lineWidth = 2;
                        ctx.stroke();

                        ctx.fillStyle = 'white';
                        ctx.font = 'bold 12px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(gate.label, gate.x, gate.y + 4);
                    });

                        // æ ‡ç­¾
                        ctx.fillStyle = '#f1f5f9';
                        ctx.font = '12px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('LSTMå•å…ƒ', centerX, 20);
                    },

                        // ===== ç»˜åˆ¶GRUæ¶æ„å›¾ =====
                        drawGRUArchitecture: function() {
                        const canvas = document.getElementById('gruArchCanvas');
                        if (!canvas) return;

                        const ctx = canvas.getContext('2d');
                        canvas.width = 300;
                        canvas.height = 200;

                        // æ¸…ç©ºç”»å¸ƒ
                        ctx.clearRect(0, 0, canvas.width, canvas.height);

                        // ç»˜åˆ¶GRUç»“æ„ç®€å›¾
                        const centerX = canvas.width / 2;
                        const centerY = canvas.height / 2;

                        // éšè—çŠ¶æ€çº¿
                        ctx.strokeStyle = '#fdbb2d';
                        ctx.lineWidth = 4;
                        ctx.beginPath();
                        ctx.moveTo(20, centerY);
                        ctx.lineTo(280, centerY);
                        ctx.stroke();

                        // ä¸¤ä¸ªé—¨
                        const gates = [
                    { x: centerX - 40, y: centerY - 40, color: '#ff6b7a', label: 'r' },
                    { x: centerX + 40, y: centerY - 40, color: '#4facfe', label: 'z' }
                        ];

                        gates.forEach(gate => {
                        ctx.beginPath();
                        ctx.arc(gate.x, gate.y, 15, 0, 2 * Math.PI);
                        ctx.fillStyle = gate.color;
                        ctx.fill();
                        ctx.strokeStyle = 'white';
                        ctx.lineWidth = 2;
                        ctx.stroke();

                        ctx.fillStyle = 'white';
                        ctx.font = 'bold 12px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(gate.label, gate.x, gate.y + 4);
                    });

                        // æ ‡ç­¾
                        ctx.fillStyle = '#f1f5f9';
                        ctx.font = '12px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('GRUå•å…ƒ', centerX, 20);
                    },

                        // ===== æ¢å¤ç”¨æˆ·çŠ¶æ€ =====
                        restoreUserState: function() {
                        // æ¢å¤ç”¨æˆ·è¾“å…¥
                        const sentimentInput = document.getElementById('sentimentInput');
                        if (sentimentInput && this.state.savedUserInput) {
                        sentimentInput.value = this.state.savedUserInput;
                        this.state.currentInputText = this.state.savedUserInput;
                    }

                        // æ¢å¤å…¶ä»–ç”¨æˆ·è®¾ç½®
                        const animationsEnabled = localStorage.getItem('lstm-animations-enabled');
                        if (animationsEnabled !== null) {
                        this.state.animationsEnabled = JSON.parse(animationsEnabled);
                        document.body.style.setProperty('--animation-duration',
                        this.state.animationsEnabled ? '0.3s' : '0s');
                    }
                    },

                        // ===== å·¥å…·å‡½æ•°ï¼šé˜²æŠ– =====
                        debounce: function(func, wait) {
                        let timeout;
                        return function executedFunction(...args) {
                        const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                        clearTimeout(timeout);
                        timeout = setTimeout(later, wait);
                    };
                    },

                        // ===== å·¥å…·å‡½æ•°ï¼šèŠ‚æµ =====
                        throttle: function(func, limit) {
                        let inThrottle;
                        return function(...args) {
                        if (!inThrottle) {
                        func.apply(this, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                    };
                    },

                        // ===== é”™è¯¯å¤„ç† =====
                        handleError: function(error, context = '') {
                        console.error(`LSTM Tutorial Error ${context}:`, error);

                        // æ˜¾ç¤ºç”¨æˆ·å‹å¥½çš„é”™è¯¯æ¶ˆæ¯
                        const errorMessage = document.createElement('div');
                        errorMessage.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #ef4444;
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 0.5rem;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
                        errorMessage.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span>âš ï¸</span>
                    <span>å‡ºç°äº†ä¸€ä¸ªå°é—®é¢˜ï¼Œä½†ä¸å½±å“ç»§ç»­å­¦ä¹ </span>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: white; font-size: 1.2rem; margin-left: 0.5rem; cursor: pointer;">Ã—</button>
                </div>
            `;

                        document.body.appendChild(errorMessage);

                        // 5ç§’åè‡ªåŠ¨ç§»é™¤
                        setTimeout(() => {
                        if (errorMessage.parentNode) {
                        errorMessage.remove();
                    }
                    }, 5000);
                    },

                        // ===== æ¸…ç†å‡½æ•° =====
                        cleanup: function() {
                        // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
                        window.removeEventListener('scroll', this.handleScroll);
                        window.removeEventListener('resize', this.handleResize);

                        // æ¸…ç†åŠ¨ç”»
                        if (this.animationFrame) {
                        cancelAnimationFrame(this.animationFrame);
                    }

                        // æ¸…ç†å®šæ—¶å™¨
                        if (this.timers) {
                        this.timers.forEach(timer => clearTimeout(timer));
                    }
                    }
                    };

                        // ===== å…¨å±€é”™è¯¯å¤„ç† =====
                        window.addEventListener('error', (event) => {
                        window.lstmTutorial.handleError(event.error, 'Global');
                    });

                        // ===== é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ– =====
                        if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', () => {
                        try {
                        window.lstmTutorial.init();
                    } catch (error) {
                        window.lstmTutorial.handleError(error, 'Initialization');
                    }
                    });
                    } else {
                        try {
                        window.lstmTutorial.init();
                    } catch (error) {
                        window.lstmTutorial.handleError(error, 'Initialization');
                    }
                    }

                        // ===== é¡µé¢å¸è½½æ—¶æ¸…ç† =====
                        window.addEventListener('beforeunload', () => {
                        try {
                        window.lstmTutorial.cleanup();
                    } catch (error) {
                        console.error('Cleanup error:', error);
                    }
                    });

                        // ===== å¯¼å‡ºæ¨¡å—ï¼ˆå¯é€‰ï¼Œç”¨äºå…¶ä»–è„šæœ¬è°ƒç”¨ï¼‰ =====
                        if (typeof module !== 'undefined' && module.exports) {
                        module.exports = window.lstmTutorial;
                    }

                    })();

                        // ===== KaTeXæ•°å­¦å…¬å¼æ”¯æŒ =====
                        document.addEventListener('DOMContentLoaded', function() {
                        // æ¸²æŸ“è¡Œå†…æ•°å­¦å…¬å¼
                        const inlineMath = document.querySelectorAll('span:not(.katex)');
                        inlineMath.forEach(span => {
                        const text = span.textContent;
                        if (text.includes('$$') && window.katex) {
                        try {
                        const mathText = text.replace(/\$\$(.*?)\$\$/g, '$1');
                        if (mathText !== text) {
                        span.innerHTML = katex.renderToString(mathText, {
                        displayMode: false,
                        throwOnError: false
                    });
                    }
                    } catch (e) {
                        console.warn('KaTeX render error:', e);
                    }
                    }
                    });

                        // æ¸²æŸ“å—çº§æ•°å­¦å…¬å¼
                        const blockMath = document.querySelectorAll('div:not(.katex-display)');
                        blockMath.forEach(div => {
                        const text = div.textContent;
                        if (text.includes('$$') && window.katex) {
                        try {
                        const mathText = text.replace(/\$\$(.*?)\$\$/g, '$1');
                        if (mathText !== text) {
                        div.innerHTML = katex.renderToString(mathText, {
                        displayMode: true,
                        throwOnError: false
                    });
                    }
                    } catch (e) {
                        console.warn('KaTeX render error:', e);
                    }
                    }
                    });
                    });

                        // ===== æ€§èƒ½ç›‘æ§ =====
                        if (window.performance && window.performance.mark) {
                        window.performance.mark('lstm-tutorial-start');

                        window.addEventListener('load', () => {
                        window.performance.mark('lstm-tutorial-end');
                        window.performance.measure('lstm-tutorial-load', 'lstm-tutorial-start', 'lstm-tutorial-end');

                        const measures = window.performance.getEntriesByName('lstm-tutorial-load');
                        if (measures.length > 0) {
                        console.log(`ğŸš€ LSTMæ•™ç¨‹åŠ è½½å®Œæˆï¼Œè€—æ—¶: ${measures[0].duration.toFixed(2)}ms`);
                    }
                    });
                    }
</script>

<!-- å¤–éƒ¨ä¾èµ–åŠ è½½ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>

<!-- æœ€ç»ˆåˆå§‹åŒ– -->
<script>
    // ç¡®ä¿æ‰€æœ‰ä¾èµ–åŠ è½½å®Œæˆåå†æ¸²æŸ“æ•°å­¦å…¬å¼
    window.addEventListener('load', function() {
        if (window.renderMathInElement) {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                    {left: '\\(', right: '\\)', display: false},
                    {left: '\\[', right: '\\]', display: true}
                ],
                throwOnError: false
            });
        }

        // æ·»åŠ åŠ è½½å®Œæˆçš„è§†è§‰åé¦ˆ
        document.body.style.opacity = '1';
        console.log('ğŸ‰ LSTMäº¤äº’å¼æ•™ç¨‹å·²å®Œå…¨åŠ è½½å¹¶å‡†å¤‡å°±ç»ªï¼');
    });

    // é¡µé¢åŠ è½½è¿›åº¦
    document.body.style.opacity = '0';
    document.body.style.transition = 'opacity 0.5s ease';
</script>

</body>
</html>